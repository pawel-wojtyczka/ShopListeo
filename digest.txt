Directory structure:
└── ShopListeo/
    ├── README.md
    ├── app_specs.md
    ├── astro.config.mjs
    ├── components.json
    ├── db_planning.md
    ├── eslint.config.js
    ├── package.json
    ├── plan_session.md
    ├── test-plan.mdc
    ├── toc.dat
    ├── tsconfig.json
    ├── vitest.config.ts
    ├── .env.example
    ├── .env.test
    ├── .nvmrc
    ├── .prettierrc.json
    ├── .windsurfrules
    ├── playwright-report/
    │   └── index.html
    ├── public/
    ├── src/
    │   ├── env.d.ts
    │   ├── types.ts
    │   ├── __mocks__/
    │   │   ├── astro-middleware.ts
    │   │   ├── handlers.ts
    │   │   ├── server.ts
    │   │   └── @supabase/
    │   │       └── supabase-js.ts
    │   ├── __tests__/
    │   │   ├── setup.ts
    │   │   ├── setupTests.ts
    │   │   ├── e2e/
    │   │   │   └── shopping-lists.spec.ts
    │   │   ├── fixtures/
    │   │   ├── helpers/
    │   │   │   └── auth.ts
    │   │   ├── integration/
    │   │   ├── mocks/
    │   │   └── unit/
    │   │       ├── api/
    │   │       │   ├── auth.test.ts
    │   │       │   ├── shopping-lists.test.ts
    │   │       │   └── users.test.ts
    │   │       ├── auth/
    │   │       │   └── AuthContext.test.tsx
    │   │       ├── hooks/
    │   │       │   └── useShoppingLists.test.ts
    │   │       └── middleware/
    │   │           └── auth.test.ts
    │   ├── components/
    │   │   ├── Example.tsx
    │   │   ├── MinimalQueryClientUser.tsx
    │   │   ├── PageHeader.tsx
    │   │   ├── QueryProvider.tsx
    │   │   ├── ShoppingListsView.tsx
    │   │   ├── ToastProvider.tsx
    │   │   ├── Welcome.astro
    │   │   ├── auth/
    │   │   │   ├── AuthStatus.tsx
    │   │   │   ├── LoginForm.tsx
    │   │   │   ├── LoginView.tsx
    │   │   │   ├── RecoverPasswordForm.tsx
    │   │   │   ├── RecoverPasswordView.tsx
    │   │   │   ├── RegisterForm.tsx
    │   │   │   ├── RegisterView.tsx
    │   │   │   ├── RequestPasswordResetForm.tsx
    │   │   │   ├── RequestPasswordResetView.tsx
    │   │   │   ├── ResetPasswordForm.tsx
    │   │   │   ├── ResetPasswordView.tsx
    │   │   │   ├── SetNewPasswordForm.tsx
    │   │   │   └── SetNewPasswordView.tsx
    │   │   ├── features/
    │   │   │   └── shopping-list/
    │   │   │       ├── ProductInputArea.tsx
    │   │   │       ├── ProductItem.tsx
    │   │   │       └── ProductList.tsx
    │   │   ├── layouts/
    │   │   │   └── MainLayoutContent.tsx
    │   │   ├── shared/
    │   │   │   └── EditableShoppingListTitle.tsx
    │   │   ├── shopping-lists/
    │   │   │   ├── CreateListButton.tsx
    │   │   │   ├── ShoppingListItem.tsx
    │   │   │   └── ShoppingLists.tsx
    │   │   ├── ui/
    │   │   │   ├── PageHeader.tsx
    │   │   │   ├── alert-dialog.tsx
    │   │   │   ├── alert.tsx
    │   │   │   ├── avatar.tsx
    │   │   │   ├── button.tsx
    │   │   │   ├── card.tsx
    │   │   │   ├── checkbox.tsx
    │   │   │   ├── input.tsx
    │   │   │   ├── label.tsx
    │   │   │   ├── sonner.tsx
    │   │   │   └── textarea.tsx
    │   │   └── views/
    │   │       └── ShoppingListDetailView.tsx
    │   ├── db/
    │   │   ├── database.types.ts
    │   │   ├── supabase.client.ts
    │   │   ├── supabase.server.ts
    │   │   └── supabase.types.ts.
    │   ├── docs/
    │   │   └── api/
    │   │       ├── auth.md
    │   │       ├── shopping-lists.md
    │   │       └── users.md
    │   ├── layouts/
    │   │   ├── AuthLayout.astro
    │   │   ├── Layout.astro
    │   │   └── MainLayout.astro
    │   ├── lib/
    │   │   ├── auth.service.ts
    │   │   ├── logger.ts
    │   │   ├── openrouter.service.ts
    │   │   ├── test-utils.ts
    │   │   ├── test-utils.tsx
    │   │   ├── utils.ts
    │   │   ├── auth/
    │   │   │   ├── AuthContext.tsx
    │   │   │   ├── adminAuth.ts
    │   │   │   └── validate-session.ts
    │   │   ├── hooks/
    │   │   │   ├── useShoppingListDetail.ts
    │   │   │   └── useShoppingLists.ts
    │   │   ├── schemas/
    │   │   │   └── userSchemas.ts
    │   │   ├── services/
    │   │   │   ├── shopping-list.service.ts
    │   │   │   ├── toast-service.ts
    │   │   │   └── userService.ts
    │   │   ├── utils/
    │   │   │   └── error.ts
    │   │   └── validators/
    │   │       └── shopping-list.validators.ts
    │   ├── middleware/
    │   │   └── index.ts
    │   ├── pages/
    │   │   ├── index.astro
    │   │   ├── login.astro
    │   │   ├── recover-password.astro
    │   │   ├── recover.astro
    │   │   ├── register.astro
    │   │   ├── reset-password.astro
    │   │   ├── api/
    │   │   │   ├── auth/
    │   │   │   │   ├── login.ts
    │   │   │   │   ├── logout.ts
    │   │   │   │   ├── register.ts
    │   │   │   │   ├── request-reset.ts
    │   │   │   │   └── set-new-password.ts
    │   │   │   ├── client/
    │   │   │   │   └── shopping-lists/
    │   │   │   │       └── [listId].ts
    │   │   │   ├── shopping-lists/
    │   │   │   │   ├── [listId].ts
    │   │   │   │   ├── index.ts
    │   │   │   │   └── [listId]/
    │   │   │   │       ├── ai-parse.ts
    │   │   │   │       ├── clear-items.ts
    │   │   │   │       └── items/
    │   │   │   │           ├── [itemId].ts
    │   │   │   │           └── index.ts
    │   │   │   └── users/
    │   │   │       ├── [id].ts
    │   │   │       ├── index.ts
    │   │   │       └── me.ts
    │   │   ├── list/
    │   │   │   └── [id].astro
    │   │   └── shopping-lists/
    │   │       └── index.astro
    │   ├── styles/
    │   │   └── global.css
    │   └── types/
    │       ├── api.ts
    │       └── locals.ts
    ├── supabase/
    │   ├── 20240424_1405_schema_dump_latest.sql
    │   ├── config.toml
    │   ├── .gitignore
    │   ├── migrations/
    │   │   ├── 20240612130015_initial_schema.sql
    │   │   ├── 20240620150045_add_admin_column.sql
    │   │   ├── 20240620151530_fix_user_timestamp_trigger.sql
    │   │   ├── 20250428090746_fix_apply_changes_function_schema.sql
    │   │   └── 23240612130015_create_user_sync_trigger.sql
    │   └── .branches/
    │       └── _current_branch
    ├── test-results/
    │   └── .last-run.json
    ├── tests/
    ├── .ai/
    │   ├── admin-user-details-view-implementation-plan.md
    │   ├── admin-users-list-view-implementation-plan.md
    │   ├── api-plan.md
    │   ├── auth-endpoint-implementation-plan.md
    │   ├── auth-spec.md
    │   ├── authentication-views-implementation-plan.md
    │   ├── db-plan.md
    │   ├── openrouter-service-implementation-plan.md
    │   ├── prd.md
    │   ├── shopping-list-details-view-implementation-plan.md
    │   ├── shopping-list-endpoint-implementation-plan.md
    │   ├── shopping-lists-view-implementation-plan.md
    │   ├── tech-stack.md
    │   ├── test-plan-gemini.md
    │   ├── test-plan.md
    │   ├── ui-plan.md
    │   ├── ui-planning-session.md
    │   ├── users-endpoint-implementation-plan.md
    │   └── diagrams/
    │       └── auth-flow.mmd
    ├── .astro/
    │   ├── content-assets.mjs
    │   ├── content-modules.mjs
    │   ├── content.d.ts
    │   ├── data-store.json
    │   ├── settings.json
    │   ├── types.d.ts
    │   └── collections/
    ├── .cursor/
    │   └── rules/
    │       ├── api-supabase-astro-init.mdc
    │       ├── astro.mdc
    │       ├── backend.mdc
    │       ├── db-supabase-migrations.mdc
    │       ├── diagram-auth.mdc
    │       ├── diagram-journey.mdc
    │       ├── diagram-ui.mdc
    │       ├── frontend.mdc
    │       ├── react.mdc
    │       ├── shared.mdc
    │       ├── supabase-auth.mdc
    │       ├── test-plan-rule.mdc
    │       ├── testing-e2e-playwright.mdc
    │       ├── testing-unit-vitest.mdc
    │       └── ui-shadcn-helper.mdc
    ├── .github/
    │   └── copilot-instructions.md
    └── .husky/
        └── pre-commit

================================================
File: README.md
================================================
# ShopListeo

Aplikacja webowa zaprojektowana w celu uproszczenia procesu tworzenia i zarządzania listami zakupów. Główną cechą aplikacji jest wykorzystanie asystenta AI do inteligentnego parsowania tekstu wprowadzonego przez użytkownika i przekształcania go w uporządkowaną listę produktów. Umożliwia tworzenie, edycję list, oznaczanie zakupionych produktów oraz zarządzanie kontem. Zawiera również panel administracyjny.

## Tech Stack

### Główne Technologie
- **[Astro](https://astro.build/) v5.5.5**: Nowoczesny web framework do budowy szybkich stron (SSR/SSG).
- **[React](https://react.dev/) v19.0.0**: Biblioteka UI do budowy interaktywnych komponentów.
- **[TypeScript](https://www.typescriptlang.org/) v5**: Statyczne typowanie dla JavaScript.
- **[Tailwind CSS](https://tailwindcss.com/) v4.0.17**: Framework CSS typu utility-first.
- **[Shadcn/ui](https://ui.shadcn.com/)**: Biblioteka komponentów UI oparta na Radix UI i Tailwind CSS.

### Backend & Baza Danych
- **[Supabase](https://supabase.com/)**: Platforma Backend-as-a-Service (BaaS) z bazą danych PostgreSQL, uwierzytelnianiem i API.

### Sztuczna Inteligencja
- **[OpenRouter.ai](https://openrouter.ai/)**: Agregator API modeli językowych (LLM) do przetwarzania list zakupów.

### Narzędzia Deweloperskie
- **[ESLint](https://eslint.org/) v9**: Lintowanie kodu.
- **[Prettier](https://prettier.io/)**: Formatowanie kodu.
- **[Zod](https://zod.dev/)**: Walidacja schematów danych.
- **[React Hook Form](https://react-hook-form.com/)**: Zarządzanie formularzami w React.
- **[Husky](https://typicode.github.io/husky/) & [lint-staged](https://github.com/okonet/lint-staged)**: Git hooks do automatyzacji sprawdzania jakości kodu.

### Narzędzia Testowe
- **[Vitest](https://vitest.dev/)**: Framework do testów jednostkowych i integracyjnych.
- **[React Testing Library](https://testing-library.com/docs/react-testing-library/intro/)**: Biblioteka do testowania komponentów React.
- **[Playwright](https://playwright.dev/)**: Framework do testów End-to-End (E2E).
- **[Mock Service Worker (MSW)](https://mswjs.io/)**: Biblioteka do mockowania API w testach.

## Wymagania Wstępne

- Node.js v22.14.0 (zgodnie z `.nvmrc`)
- npm (dostarczany z Node.js)
- Dostęp do instancji Supabase (lokalnej lub zdalnej)
- Klucz API dla OpenRouter.ai

## Rozpoczęcie Pracy Lokalnej

1.  Sklonuj repozytorium:
    ```bash
    git clone git@github.com:pawel-wojtyczka/ShopListeo.git
    cd ShopListeo
    ```
2.  Zainstaluj zależności:
    ```bash
    npm install
    ```
3.  Skonfiguruj zmienne środowiskowe (utwórz plik `.env` na podstawie `.env.example` i uzupełnij wartości):
    ```bash
    cp .env.example .env
    # Edytuj plik .env z własnymi kluczami Supabase i OpenRouter
    ```
4.  Uruchom serwer deweloperski:
    ```bash
    npm run dev
    ```
5.  Aplikacja będzie dostępna pod adresem `http://localhost:3000` (lub innym skonfigurowanym portem).

## Dostępne Skrypty

-   `npm run dev`: Uruchamia serwer deweloperski Astro.
-   `npm run build`: Buduje aplikację do wdrożenia produkcyjnego.
-   `npm run preview`: Uruchamia podgląd zbudowanej aplikacji produkcyjnej.
-   `npm run astro`: Dostęp do komend CLI Astro.
-   `npm run lint`: Uruchamia ESLint do sprawdzenia jakości kodu.
-   `npm run lint:fix`: Uruchamia ESLint z automatycznym poprawianiem błędów.
-   `npm run format`: Uruchamia Prettier do formatowania kodu.
-   `npm run test`: Uruchamia testy jednostkowe i integracyjne (Vitest).
-   `npm run test:watch`: Uruchamia Vitest w trybie watch.
-   `npm run test:coverage`: Uruchamia testy z generowaniem raportu pokrycia.
-   `npm run test:ui`: Uruchamia interfejs graficzny Vitest UI.
    *(Uwaga: Skrypty dla Playwright (`test:e2e*`) nie są zdefiniowane w `package.json`)*

## Wsparcie Rozwoju z AI

Projekt jest skonfigurowany do współpracy z narzędziami AI w celu usprawnienia procesu deweloperskiego:

-   **Cursor IDE:** Reguły AI w katalogu `.cursor/rules/` pomagają IDE zrozumieć strukturę projektu i dostarczać lepsze sugestie kodu.
-   **GitHub Copilot:** Instrukcje dla Copilota znajdują się w `.github/copilot-instructions.md`.
-   **Windsurf:** Plik `.windsurfrules` zawiera konfigurację AI dla Windsurf.

## Testowanie

Projekt ShopListeo wykorzystuje kompleksowe podejście do testowania:

### Testy Jednostkowe i Integracyjne (Vitest)

Oparte na [Vitest](https://vitest.dev/) i [React Testing Library](https://testing-library.com/docs/react-testing-library/intro/). Testują poszczególne komponenty React, hooki, funkcje pomocnicze i logikę serwisów w izolacji lub w małych grupach. Do mockowania API używany jest [MSW](https://mswjs.io/).

Aby uruchomić testy jednostkowe/integracyjne:
```bash
# Jednorazowe uruchomienie
npm run test

# Uruchomienie w trybie watch
npm run test:watch

# Uruchomienie z raportem pokrycia
npm run test:coverage

# Uruchomienie z interfejsem graficznym
npm run test:ui

### Testy End-to-End (Playwright)

Oparte na Playwright. Testują aplikację jako całość z perspektywy użytkownika końcowego, symulując interakcje w przeglądarce.
(Aktualnie brak zdefiniowanych skryptów npm run test:e2e* w package.json. Należy je dodać, aby uruchomić testy E2E.)

### Struktura Testów

src/__tests__/unit/: Testy jednostkowe dla komponentów, hooków, serwisów.
src/__tests__/integration/: Testy integracyjne (np. interakcji komponentów, API).
src/__tests__/e2e/: Testy End-to-End z Playwright.
src/__tests__/helpers/: Funkcje pomocnicze dla testów (np. auth.ts).
src/__tests__/setup.ts: Globalna konfiguracja dla Vitest (np. mockowanie, rozszerzenia matcherów).

### Contributing

Proszę o przestrzeganie wytycznych AI i praktyk kodowania zdefiniowanych w plikach konfiguracyjnych AI podczas pracy nad projektem. Używaj npm run lint i npm run format przed commitem.

### Licencja

MIT


================================================
File: app_specs.md
================================================
# Aplikacja - ShopListeo (MVP)

## Główny problem
Tworzenie list zakupów jets czasochłonne i żmudne. Ludzie albo nie robią takich list i później zapominają co trzeba kupić w sklepie lub robią, ale zajmuje im to dużo czasu. Aplikacja umożliwia użytkownikom łatwe tworzenie, zarządzanie oraz edycję list zakupów poprzez przeglądarkę internetową, z wykorzystaniem sztucznej inteligencji (AI) do organizacji treści.


## Najmniejszy zestaw funkcjonalności
- Logowanie i zakłądanie konta przez użytkowników poprzez web
- Tworzenie listy zakupów na podstawie treści przekazanej w panelu web
- Modyfikowanie listy zakupów poprzez podawanie kolejnej treści w panelu web

## Co NIE wchodzi w zakres MVP
- Aplikacje mobilne (na początek tylko web)

## Kryteria sukcesu
- 75% list zakupów wygenerowanych przez AI jest akceptowane przez użytkownika

## Opis funkcjonalności aplikacji

### Proces rejestracji i logowania:
1. Użytkownik odwiedza stronę aplikacji.
2. Loguje się przy użyciu adresu email oraz hasła.
3. Jeśli użytkownik nie posiada jeszcze konta, może je założyć podając email oraz ustawiając hasło.

### Zarządzanie listami zakupów:
- Po zalogowaniu użytkownik widzi wszystkie swoje dotychczas utworzone listy zakupów.
- Każdą z tych list można przeglądać, edytować lub utworzyć nową.

### Tworzenie nowej listy zakupów:
1. Użytkownik klika „Utwórz nową listę zakupów” i przechodzi do formularza.
2. W formularzu wpisuje dowolne produkty, które chce zakupić (opis może być nieuporządkowany i chaotyczny, po to właśnie jest użyty AI aby to uporządkował).
3. Po kliknięciu „Stwórz mi listę zakupów”:
   - Treść jest przekazywana przez API OpenRouter do Asystenta AI.
   - Asystent AI zwraca uporządkowaną listę zakupów.
4. Produkty wyświetlane są w panelu aplikacji jako osobne bloczki, które użytkownik może:
   - Zatwierdzić (klikając ptaszek).
   - Odrzucić (klikając krzyżyk).

### Edycja i uzupełnianie listy zakupów:
- Użytkownik może dodać komentarze lub dodatkowe produkty do istniejącej listy poprzez formularz.
- Informacje przesyłane są ponownie do Asystenta AI, razem z aktualnym stanem listy.
- AI generuje nową, uzupełnioną wersję listy zakupów, która ponownie jest przedstawiana użytkownikowi w formie bloczków.

### Zapisanie finalnej listy:
- Po ostatecznym zatwierdzeniu użytkownik może wrócić do widoku wszystkich list zakupów.
- Utworzona i zatwierdzona lista zostaje zapisana i jest dostępna do późniejszego wglądu oraz edycji.

### Panel administracyjny:
- Administrator loguje się do aplikacji w taki sam sposób jak użytkownik standardowy.
- Po zalogowaniu administrator, oprócz własnych list zakupów, posiada dostęp do opcji administracyjnych.
- Funkcjonalności administracyjne obejmują:
  - Przeglądanie listy wszystkich użytkowników.
  - Szczegółowe informacje o każdym użytkowniku (email, data rejestracji, data ostatniego logowania oraz liczba utworzonych przez niego list zakupów).
  - Możliwość aktualizacji danych użytkownika (zmiana adresu email).
  - Możliwość usunięcia konta użytkownika z aplikacji.









================================================
File: astro.config.mjs
================================================
// @ts-check
import { defineConfig } from "astro/config";

import react from "@astrojs/react";
import sitemap from "@astrojs/sitemap";
import tailwindcss from "@tailwindcss/vite";
import node from "@astrojs/node";

// https://astro.build/config
export default defineConfig({
  output: "server",
  integrations: [react(), sitemap()],
  server: { port: 3000 },
  vite: {
    plugins: [tailwindcss()],
  },
  adapter: node({
    mode: "standalone",
  }),
  experimental: { session: true },
});



================================================
File: components.json
================================================
{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "new-york",
  "rsc": false,
  "tsx": true,
  "tailwind": {
    "config": "",
    "css": "src/styles/global.css",
    "baseColor": "neutral",
    "cssVariables": true,
    "prefix": ""
  },
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  },
  "iconLibrary": "lucide"
}


================================================
File: db_planning.md
================================================
<conversation_summary>
    <decisions>
        Zdecydowano o usunięciu encji dotyczącej "planów dnia".
        Dane użytkowników będą zawierały: unikalne ID (UUID), e-mail (VARCHAR o maksymalnej długości 128 znaków, unikalny i z indeksem), zaszyfrowane hasło, datę rejestracji, datę ostatniego logowania oraz datę ostatniej aktualizacji danych.
        Sesje konwersacji/logi będą przechowywane w jednej tabeli.
        Do przechowywania dat zastosowany zostanie standardowy typ TIMESTAMP.
        Ustalono relację jeden-do-wielu między użytkownikami a sesjami konwersacji/logów oraz użytkownikami a listami zakupów.
        Historyczne dane (pełna historia konwersacji) będą przechowywane w jednej tabeli.
        Na etapie MVP nie będzie wdrażanych reguł RLS.
    </decisions>
    <matched_recommendations>
        Utworzenie osobnych tabel dla użytkowników, sesji (konwersacji/logów) oraz list zakupów z relacją jeden-do-wielu.
        Definicja tabeli użytkowników z polami: UUID, e-mail (VARCHAR(128) z unikalnym indeksem), password_hash, registration_date, last_login_date oraz updated_date.
        Zastosowanie standardowego typu TIMESTAMP dla przechowywania dat.
        Przechowywanie historycznych danych w jednej tabeli, co upraszcza zarządzanie audytem.
        Wyłączenie implementacji Row Level Security (RLS) na etapie MVP.
    </matched_recommendations>
    <database_planning_summary>
        Główne wymagania dotyczące schematu bazy danych obejmują przechowywanie danych użytkowników, sesji konwersacji/logów oraz list zakupów. Kluczowe encje to:
        Użytkownicy: z unikalnym ID (UUID), e-mailem (VARCHAR(128) z ograniczeniem UNIQUE), zaszyfrowanym hasłem, datą rejestracji, datą ostatniego logowania i datą aktualizacji danych.
        Sesje konwersacji/logów: przechowywane w jednej tabeli z unikalnym ID sesji oraz znacznikiem czasu (TIMESTAMP).
        Listy zakupów: posiadające własne unikalne ID, związane relacją jeden-do-wielu z użytkownikami.
        Relacje są ustalone w taki sposób, że jeden użytkownik może mieć wiele sesji oraz wiele list zakupów. Kluczowymi kwestiami bezpieczeństwa są: przechowywanie haseł w postaci zaszyfrowanej oraz wyłączenie RLS na etapie MVP. Skalowalność nie jest priorytetem na tym etapie, a wszystkie historyczne dane będą przechowywane w jednej tabeli.
    </database_planning_summary>
    <unresolved_issues>
        Brak nierozwiązanych kwestii – wszystkie główne decyzje zostały potwierdzone i ustalone.
    </unresolved_issues>
</conversation_summary>


================================================
File: eslint.config.js
================================================
import { includeIgnoreFile } from "@eslint/compat";
import eslint from "@eslint/js";
import eslintPluginPrettier from "eslint-plugin-prettier/recommended";
import eslintPluginAstro from "eslint-plugin-astro";
import jsxA11y from "eslint-plugin-jsx-a11y";
import pluginReact from "eslint-plugin-react";
import reactCompiler from "eslint-plugin-react-compiler";
import eslintPluginReactHooks from "eslint-plugin-react-hooks";
import path from "node:path";
import { fileURLToPath } from "node:url";
import tseslint from "typescript-eslint";

// File path setup
const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);
const gitignorePath = path.resolve(__dirname, ".gitignore");

const baseConfig = tseslint.config({
  extends: [eslint.configs.recommended, tseslint.configs.strict, tseslint.configs.stylistic],
  rules: {
    "no-console": "warn",
    "no-unused-vars": "off",
  },
});

const jsxA11yConfig = tseslint.config({
  files: ["**/*.{js,jsx,ts,tsx}"],
  extends: [jsxA11y.flatConfigs.recommended],
  languageOptions: {
    ...jsxA11y.flatConfigs.recommended.languageOptions,
  },
  rules: {
    ...jsxA11y.flatConfigs.recommended.rules,
  },
});

const reactConfig = tseslint.config({
  files: ["**/*.{js,jsx,ts,tsx}"],
  extends: [pluginReact.configs.flat.recommended],
  languageOptions: {
    ...pluginReact.configs.flat.recommended.languageOptions,
    globals: {
      window: true,
      document: true,
    },
  },
  plugins: {
    "react-hooks": eslintPluginReactHooks,
    "react-compiler": reactCompiler,
  },
  settings: { react: { version: "detect" } },
  rules: {
    ...eslintPluginReactHooks.configs.recommended.rules,
    "react/react-in-jsx-scope": "off",
    "react-compiler/react-compiler": "error",
  },
});

export default tseslint.config(
  includeIgnoreFile(gitignorePath),
  baseConfig,
  jsxA11yConfig,
  reactConfig,
  eslintPluginAstro.configs["flat/recommended"],
  eslintPluginPrettier
);



================================================
File: package.json
================================================
{
  "name": "shop-listeo-app",
  "type": "module",
  "version": "0.1.0",
  "scripts": {
    "dev": "astro dev",
    "build": "astro build",
    "preview": "astro preview",
    "astro": "astro",
    "lint": "eslint .",
    "lint:fix": "eslint . --fix",
    "format": "prettier --write .",
    "test": "vitest run",
    "test:watch": "vitest",
    "test:coverage": "vitest run --coverage",
    "test:ui": "vitest --ui"
  },
  "dependencies": {
    "@astrojs/check": "^0.9.4",
    "@astrojs/node": "^9.1.3",
    "@astrojs/react": "4.2.2",
    "@astrojs/sitemap": "3.3.0",
    "@hookform/resolvers": "^5.0.1",
    "@prisma/client": "^6.6.0",
    "@radix-ui/react-alert-dialog": "^1.1.7",
    "@radix-ui/react-avatar": "^1.1.4",
    "@radix-ui/react-checkbox": "^1.1.5",
    "@radix-ui/react-icons": "^1.3.2",
    "@radix-ui/react-label": "^2.1.3",
    "@radix-ui/react-slot": "^1.2.0",
    "@radix-ui/react-tooltip": "^1.2.3",
    "@supabase/ssr": "^0.6.1",
    "@supabase/supabase-js": "^2.49.4",
    "@tailwindcss/vite": "4.0.17",
    "@types/react": "19.0.12",
    "@types/react-dom": "19.0.4",
    "astro": "5.5.5",
    "class-variance-authority": "^0.7.1",
    "clsx": "^2.1.1",
    "lucide-react": "^0.487.0",
    "next-themes": "^0.4.6",
    "prisma": "^6.6.0",
    "react": "19.0.0",
    "react-dom": "19.0.0",
    "react-hook-form": "^7.55.0",
    "sonner": "^2.0.3",
    "tailwind-merge": "^3.1.0",
    "tailwindcss": "4.0.17",
    "tw-animate-css": "^1.2.5",
    "typescript": "^5.8.3",
    "zod": "^3.24.3"
  },
  "devDependencies": {
    "@eslint/compat": "1.2.7",
    "@eslint/js": "9.23.0",
    "@testing-library/jest-dom": "^6.4.2",
    "@testing-library/react": "^14.2.1",
    "@testing-library/user-event": "^14.5.2",
    "@types/jest": "^29.5.12",
    "@typescript-eslint/eslint-plugin": "8.28.0",
    "@typescript-eslint/parser": "8.28.0",
    "@vitejs/plugin-react": "^4.2.1",
    "@vitest/coverage-v8": "^3.1.2",
    "eslint": "9.23.0",
    "eslint-config-prettier": "10.1.1",
    "eslint-import-resolver-typescript": "4.2.5",
    "eslint-plugin-astro": "1.3.1",
    "eslint-plugin-import": "2.31.0",
    "eslint-plugin-jsx-a11y": "6.10.2",
    "eslint-plugin-prettier": "5.2.5",
    "eslint-plugin-react": "7.37.4",
    "eslint-plugin-react-compiler": "19.0.0-beta-aeaed83-20250323",
    "eslint-plugin-react-hooks": "5.2.0",
    "husky": "9.1.7",
    "jsdom": "^24.0.0",
    "lint-staged": "15.5.0",
    "msw": "^2.7.5",
    "prettier-plugin-astro": "0.14.1",
    "typescript-eslint": "8.28.0",
    "vite-tsconfig-paths": "^5.1.4",
    "vitest": "^3.1.2"
  },
  "lint-staged": {
    "*.{ts,tsx,astro}": [
      "eslint --fix"
    ],
    "*.{json,css,md}": [
      "prettier --write"
    ]
  }
}



================================================
File: plan_session.md
================================================
<conversation_summary>
    <decisions>
        1. Wdrożyć mechanizm przełączania (toggle) służący do oznaczania produktów jako zakupionych, z aktualizacjami interfejsu w czasie rzeczywistym.
        2. Przechowywać dane rejestracyjne użytkownika, w tym e-mail, zaszyfrowane hasło, datę rejestracji, ostatnie logowanie oraz datę ostatniej aktualizacji (w formacie ISO 8601).
        3. Używać formatu JSON do komunikacji z AI, zapewniając rejestrowanie wszystkich interakcji w ramach jednego wątku (zarówno wiadomości od użytkownika, jak i odpowiedzi AI) w bazie danych.
        4. Powiązać zatwierdzenie (finalizację) listy zakupów z odpowiadającą konwersacją z AI, rejestrując ją w bazie danych.
        5. Wyświetlać użytkownikowi przejrzyste komunikaty o błędach, jednocześnie logując szczegółowe informacje o błędach (treść błędu, czas wystąpienia, identyfikator użytkownika, typ błędu oraz poziom krytyczności) w bazie danych `errors_log`.
        6. Zaprojektować system w sposób modułowy, umożliwiający łatwe rozbudowywanie w przyszłości (np. współdzielenie list zakupów, dyktowanie treści przez speech-to-text oraz aplikacja mobilna).
    </decisions>
    <matched_recommendations>
        1. Wdrożyć mechanizm przełączania (toggle) pozwalający na oznaczanie produktów jako zakupionych lub niezakupionych za pomocą pojedynczego kliknięcia.
        2. Rozszerzyć model danych użytkownika o pole przechowujące datę ostatniej aktualizacji oprócz innych danych rejestracyjnych.
        3. Ustandaryzować i wymusić użycie formatu JSON do komunikacji z AI, włączając pełną historię rozmowy jako kontekst.
        4. Rejestrować akcję zatwierdzenia listy zakupów i powiązać ją z pełną historią konwersacji dla potrzeb analitycznych.
        5. Zintegrować obsługę błędów, która wyświetla przyjazne komunikaty użytkownikowi oraz rejestruje pełne szczegóły błędów w bazie `errors_log`.
        6. Zaprojektować modułową architekturę systemu, ułatwiając wdrażanie przyszłych funkcjonalności.
    </matched_recommendations>
    <prd_planning_summary>
        1. Główne wymagania funkcjonalne:
           - Uwierzytelnianie użytkownika: Proces rejestracji i logowania, przy czym przechowywane są dane takie jak e-mail, zaszyfrowane hasło, data rejestracji, ostatnie logowanie oraz data ostatniej aktualizacji.
           - Zarządzanie listami zakupów: Możliwość tworzenia, ręcznej edycji i usuwania list zakupów, z opcją dodawania lub modyfikowania poszczególnych produktów.
           - Integracja z AI: Przetwarzanie nieuporządkowanych danych zakupowych do uporządkowanej listy zakupów przez asystenta AI, z pełną komunikacją w formacie JSON.
           - Funkcja przełączania stanu produktu: Umożliwienie użytkownikowi oznaczania produktów jako zakupionych (co skutkuje wyszarzeniem i przekreśleniem) oraz cofania tej akcji.
           - Finalizacja i analityka: Konieczność oznaczenia listy jako kompletnej przez użytkownika, co powoduje zapisanie pełnej historii rozmowy do późniejszej analizy.
        2. Kluczowe historie użytkownika i ścieżki korzystania:
           - Użytkownik rejestruje konto i loguje się.
           - Użytkownik wprowadza listę produktów w formie wolnego tekstu, którą AI przetwarza i zwraca jako uporządkowaną listę zakupów.
           - Użytkownik dokonuje ręcznej edycji listy, dodając nowe produkty lub modyfikując istniejące.
           - Podczas zakupów użytkownik oznacza poszczególne produkty jako zakupione za pomocą funkcji przełączania.
           - Po zakończeniu zakupów użytkownik zatwierdza listę, która zostaje zarchiwizowana wraz z pełną historią rozmowy między użytkownikiem a AI.
        3. Kryteria sukcesu i sposoby ich mierzenia:
           - Wysoki poziom akceptacji przez użytkowników list zakupów generowanych przez AI, zatwierdzonych jako kompletne.
           - Dokładne rejestrowanie i możliwość odtworzenia pełnej historii rozmowy dla każdej listy zakupów.
           - Efektywna obsługa błędów, obejmująca wyświetlanie komunikatów użytkownikowi oraz rejestrowanie szczegółowych danych o błędach w bazie `errors_log`.
        4. Nierozwiązane kwestie lub obszary wymagające dalszego wyjaśnienia:
           - Brak nierozwiązanych kwestii; wszystkie aspekty PRD dla MVP zostały w pełni omówione.
    </prd_planning_summary>
    <unresolved_issues>
        Brak.
    </unresolved_issues>
</conversation_summary>


================================================
File: test-plan.mdc
================================================
 


================================================
File: toc.dat
================================================
[Non-text file]


================================================
File: tsconfig.json
================================================
{
  "extends": "astro/tsconfigs/strict",
  "include": [".astro/types.d.ts", "**/*"],
  "exclude": ["dist"],
  "compilerOptions": {
    "jsx": "react-jsx",
    "jsxImportSource": "react",
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    },
    "esModuleInterop": true
  }
}



================================================
File: vitest.config.ts
================================================
/// <reference types="vitest" />
import { defineConfig, mergeConfig } from "vite";
import { configDefaults, defineConfig as defineVitestConfig } from "vitest/config";
import react from "@vitejs/plugin-react";
import { resolve } from "path";

const viteConfig = defineConfig({
  plugins: [react()],
  resolve: {
    alias: {
      "@": resolve(__dirname, "./src"),
      "astro:middleware": resolve(__dirname, "./src/__mocks__/astro-middleware.ts"),
    },
  },
});

const vitestConfig = defineVitestConfig({
  test: {
    globals: true,
    environment: "jsdom",
    setupFiles: ["./src/__tests__/setup.ts"],
    include: ["src/__tests__/unit/**/*.{test,spec}.{ts,tsx}"],
    exclude: [...configDefaults.exclude, ".astro", "dist"],
    coverage: {
      provider: "v8",
      reporter: ["text", "json", "html"],
      include: ["src/lib/**/*.{ts,tsx}", "src/pages/api/**/*.ts"],
      exclude: ["**/*.d.ts", "**/*.test.ts", "**/*.spec.ts"],
    },
  },
});

export default mergeConfig(viteConfig, vitestConfig);



================================================
File: .env.example
================================================
SUPABASE_URL=###
SUPABASE_KEY=###
OPENROUTER_API_KEY=###


================================================
File: .env.test
================================================
SUPABASE_URL=http://127.0.0.1:54321
SUPABASE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24iLCJleHAiOjE5ODM4MTI5OTZ9.CRXP1A7WOeoJeXxjNni43kdQwgnWNReilDMblYTn_I0
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImV4cCI6MTk4MzgxMjk5Nn0.EGIM96RAZx35lJzdJsyH-qQwv8Hdp7fsn3W0YpN81IU
PUBLIC_SUPABASE_URL=https://rydnomwagefozvnsnaby.supabase.co
PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ5ZG5vbXdhZ2Vmb3p2bnNuYWJ5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDU0Nzc4OTgsImV4cCI6MjA2MTA1Mzg5OH0.4nZxqpKkLxcZlSHIPr5skNKJogAuIEpCqM7VHKkrREQ

OPENROUTER_API_KEY=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

E2E_USERNAME_ID=752324d6-a408-4575-8ef1-73dc43ca387c
E2E_USERNAME=e2e_test@asperit.com
E2E_PASSWORD=gsj4423_!SSFAS!!11


================================================
File: .nvmrc
================================================
22.14.0


================================================
File: .prettierrc.json
================================================
{
  "semi": true,
  "singleQuote": false,
  "tabWidth": 2,
  "printWidth": 120,
  "trailingComma": "es5",
  "plugins": ["prettier-plugin-astro"],
  "overrides": [
    {
      "files": "*.astro",
      "options": {
        "parser": "astro"
      }
    }
  ]
}



================================================
File: .windsurfrules
================================================
# AI Rules for {{project-name}}

{{project-description}}

## Tech Stack

- Astro 5
- TypeScript 5
- React 19
- Tailwind 4
- Shadcn/ui

## Project Structure

When introducing changes to the project, always follow the directory structure below:

- `./src` - source code
- `./src/layouts` - Astro layouts
- `./src/pages` - Astro pages
- `./src/pages/api` - API endpoints
- `./src/middleware/index.ts` - Astro middleware
- `./src/db` - Supabase clients and types
- `./src/types.ts` - Shared types for backend and frontend (Entities, DTOs)
- `./src/components` - Client-side components written in Astro (static) and React (dynamic)
- `./src/components/ui` - Client-side components from Shadcn/ui
- `./src/lib` - Services and helpers
- `./src/assets` - static internal assets
- `./public` - public assets

When modifying the directory structure, always update this section.

## Coding practices

### Guidelines for clean code

- Use feedback from linters to improve the code when making changes.
- Prioritize error handling and edge cases.
- Handle errors and edge cases at the beginning of functions.
- Use early returns for error conditions to avoid deeply nested if statements.
- Place the happy path last in the function for improved readability.
- Avoid unnecessary else statements; use if-return pattern instead.
- Use guard clauses to handle preconditions and invalid states early.
- Implement proper error logging and user-friendly error messages.
- Consider using custom error types or error factories for consistent error handling.

## Frontend

### General Guidelines

- Use Astro components (.astro) for static content and layout
- Implement framework components in React only when interactivity is needed

### Guidelines for Styling

#### Tailwind

- Use the @layer directive to organize styles into components, utilities, and base layers
- Use arbitrary values with square brackets (e.g., w-[123px]) for precise one-off designs
- Implement the Tailwind configuration file for customizing theme, plugins, and variants
- Leverage the theme() function in CSS for accessing Tailwind theme values
- Implement dark mode with the dark: variant
- Use responsive variants (sm:, md:, lg:, etc.) for adaptive designs
- Leverage state variants (hover:, focus-visible:, active:, etc.) for interactive elements

### Guidelines for Accessibility

#### ARIA Best Practices

- Use ARIA landmarks to identify regions of the page (main, navigation, search, etc.)
- Apply appropriate ARIA roles to custom interface elements that lack semantic HTML equivalents
- Set aria-expanded and aria-controls for expandable content like accordions and dropdowns
- Use aria-live regions with appropriate politeness settings for dynamic content updates
- Implement aria-hidden to hide decorative or duplicative content from screen readers
- Apply aria-label or aria-labelledby for elements without visible text labels
- Use aria-describedby to associate descriptive text with form inputs or complex elements
- Implement aria-current for indicating the current item in a set, navigation, or process
- Avoid redundant ARIA that duplicates the semantics of native HTML elements

### Guidelines for Astro

- Leverage View Transitions API for smooth page transitions (use ClientRouter)
- Use content collections with type safety for blog posts, documentation, etc.
- Leverage Server Endpoints for API routes
- Use POST, GET  - uppercase format for endpoint handlers
- Use `export const prerender = false` for API routes
- Use zod for input validation in API routes
- Extract logic into services in `src/lib/services`
- Implement middleware for request/response modification
- Use image optimization with the Astro Image integration
- Implement hybrid rendering with server-side rendering where needed
- Use Astro.cookies for server-side cookie management
- Leverage import.meta.env for environment variables

### Guidelines for React

- Use functional components with hooks instead of class components
- Never use "use client" and other Next.js directives as we use React with Astro
- Extract logic into custom hooks in `src/components/hooks`
- Implement React.memo() for expensive components that render often with the same props
- Utilize React.lazy() and Suspense for code-splitting and performance optimization
- Use the useCallback hook for event handlers passed to child components to prevent unnecessary re-renders
- Prefer useMemo for expensive calculations to avoid recomputation on every render
- Implement useId() for generating unique IDs for accessibility attributes
- Consider using the new useOptimistic hook for optimistic UI updates in forms
- Use useTransition for non-urgent state updates to keep the UI responsive

### Backend and Database

- Use Supabase for backend services, including authentication and database interactions.
- Follow Supabase guidelines for security and performance.
- Use Zod schemas to validate data exchanged with the backend.
- Use supabase from context.locals in Astro routes instead of importing supabaseClient directly
- Use SupabaseClient type from `src/db/supabase.client.ts`, not from `@supabase/supabase-js`


================================================
File: playwright-report/index.html
================================================


<!DOCTYPE html>
<html style='scrollbar-gutter: stable both-edges;'>
  <head>
    <meta charset='UTF-8'>
    <meta name='color-scheme' content='dark light'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <title>Playwright Test Report</title>
    <script type="module">var _h=Object.defineProperty;var $h=(s,l,r)=>l in s?_h(s,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[l]=r;var Gt=(s,l,r)=>$h(s,typeof l!="symbol"?l+"":l,r);(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))a(c);new MutationObserver(c=>{for(const f of c)if(f.type==="childList")for(const d of f.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function r(c){const f={};return c.integrity&&(f.integrity=c.integrity),c.referrerPolicy&&(f.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?f.credentials="include":c.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function a(c){if(c.ep)return;c.ep=!0;const f=r(c);fetch(c.href,f)}})();function e1(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Yo={exports:{}},hi={},zo={exports:{}},he={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rf;function t1(){if(Rf)return he;Rf=1;var s=Symbol.for("react.element"),l=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),f=Symbol.for("react.provider"),d=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),w=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),S=Symbol.iterator;function I(R){return R===null||typeof R!="object"?null:(R=S&&R[S]||R["@@iterator"],typeof R=="function"?R:null)}var B={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},V=Object.assign,A={};function y(R,M,$){this.props=R,this.context=M,this.refs=A,this.updater=$||B}y.prototype.isReactComponent={},y.prototype.setState=function(R,M){if(typeof R!="object"&&typeof R!="function"&&R!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,R,M,"setState")},y.prototype.forceUpdate=function(R){this.updater.enqueueForceUpdate(this,R,"forceUpdate")};function E(){}E.prototype=y.prototype;function j(R,M,$){this.props=R,this.context=M,this.refs=A,this.updater=$||B}var O=j.prototype=new E;O.constructor=j,V(O,y.prototype),O.isPureReactComponent=!0;var H=Array.isArray,G=Object.prototype.hasOwnProperty,D={current:null},F={key:!0,ref:!0,__self:!0,__source:!0};function Q(R,M,$){var pe,me={},ge=null,Ee=null;if(M!=null)for(pe in M.ref!==void 0&&(Ee=M.ref),M.key!==void 0&&(ge=""+M.key),M)G.call(M,pe)&&!F.hasOwnProperty(pe)&&(me[pe]=M[pe]);var xe=arguments.length-2;if(xe===1)me.children=$;else if(1<xe){for(var Ce=Array(xe),Xe=0;Xe<xe;Xe++)Ce[Xe]=arguments[Xe+2];me.children=Ce}if(R&&R.defaultProps)for(pe in xe=R.defaultProps,xe)me[pe]===void 0&&(me[pe]=xe[pe]);return{$$typeof:s,type:R,key:ge,ref:Ee,props:me,_owner:D.current}}function X(R,M){return{$$typeof:s,type:R.type,key:M,ref:R.ref,props:R.props,_owner:R._owner}}function U(R){return typeof R=="object"&&R!==null&&R.$$typeof===s}function W(R){var M={"=":"=0",":":"=2"};return"$"+R.replace(/[=:]/g,function($){return M[$]})}var re=/\/+/g;function J(R,M){return typeof R=="object"&&R!==null&&R.key!=null?W(""+R.key):M.toString(36)}function ce(R,M,$,pe,me){var ge=typeof R;(ge==="undefined"||ge==="boolean")&&(R=null);var Ee=!1;if(R===null)Ee=!0;else switch(ge){case"string":case"number":Ee=!0;break;case"object":switch(R.$$typeof){case s:case l:Ee=!0}}if(Ee)return Ee=R,me=me(Ee),R=pe===""?"."+J(Ee,0):pe,H(me)?($="",R!=null&&($=R.replace(re,"$&/")+"/"),ce(me,M,$,"",function(Xe){return Xe})):me!=null&&(U(me)&&(me=X(me,$+(!me.key||Ee&&Ee.key===me.key?"":(""+me.key).replace(re,"$&/")+"/")+R)),M.push(me)),1;if(Ee=0,pe=pe===""?".":pe+":",H(R))for(var xe=0;xe<R.length;xe++){ge=R[xe];var Ce=pe+J(ge,xe);Ee+=ce(ge,M,$,Ce,me)}else if(Ce=I(R),typeof Ce=="function")for(R=Ce.call(R),xe=0;!(ge=R.next()).done;)ge=ge.value,Ce=pe+J(ge,xe++),Ee+=ce(ge,M,$,Ce,me);else if(ge==="object")throw M=String(R),Error("Objects are not valid as a React child (found: "+(M==="[object Object]"?"object with keys {"+Object.keys(R).join(", ")+"}":M)+"). If you meant to render a collection of children, use an array instead.");return Ee}function oe(R,M,$){if(R==null)return R;var pe=[],me=0;return ce(R,pe,"","",function(ge){return M.call($,ge,me++)}),pe}function ie(R){if(R._status===-1){var M=R._result;M=M(),M.then(function($){(R._status===0||R._status===-1)&&(R._status=1,R._result=$)},function($){(R._status===0||R._status===-1)&&(R._status=2,R._result=$)}),R._status===-1&&(R._status=0,R._result=M)}if(R._status===1)return R._result.default;throw R._result}var de={current:null},b={transition:null},ee={ReactCurrentDispatcher:de,ReactCurrentBatchConfig:b,ReactCurrentOwner:D};function L(){throw Error("act(...) is not supported in production builds of React.")}return he.Children={map:oe,forEach:function(R,M,$){oe(R,function(){M.apply(this,arguments)},$)},count:function(R){var M=0;return oe(R,function(){M++}),M},toArray:function(R){return oe(R,function(M){return M})||[]},only:function(R){if(!U(R))throw Error("React.Children.only expected to receive a single React element child.");return R}},he.Component=y,he.Fragment=r,he.Profiler=c,he.PureComponent=j,he.StrictMode=a,he.Suspense=g,he.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ee,he.act=L,he.cloneElement=function(R,M,$){if(R==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+R+".");var pe=V({},R.props),me=R.key,ge=R.ref,Ee=R._owner;if(M!=null){if(M.ref!==void 0&&(ge=M.ref,Ee=D.current),M.key!==void 0&&(me=""+M.key),R.type&&R.type.defaultProps)var xe=R.type.defaultProps;for(Ce in M)G.call(M,Ce)&&!F.hasOwnProperty(Ce)&&(pe[Ce]=M[Ce]===void 0&&xe!==void 0?xe[Ce]:M[Ce])}var Ce=arguments.length-2;if(Ce===1)pe.children=$;else if(1<Ce){xe=Array(Ce);for(var Xe=0;Xe<Ce;Xe++)xe[Xe]=arguments[Xe+2];pe.children=xe}return{$$typeof:s,type:R.type,key:me,ref:ge,props:pe,_owner:Ee}},he.createContext=function(R){return R={$$typeof:d,_currentValue:R,_currentValue2:R,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},R.Provider={$$typeof:f,_context:R},R.Consumer=R},he.createElement=Q,he.createFactory=function(R){var M=Q.bind(null,R);return M.type=R,M},he.createRef=function(){return{current:null}},he.forwardRef=function(R){return{$$typeof:m,render:R}},he.isValidElement=U,he.lazy=function(R){return{$$typeof:v,_payload:{_status:-1,_result:R},_init:ie}},he.memo=function(R,M){return{$$typeof:w,type:R,compare:M===void 0?null:M}},he.startTransition=function(R){var M=b.transition;b.transition={};try{R()}finally{b.transition=M}},he.unstable_act=L,he.useCallback=function(R,M){return de.current.useCallback(R,M)},he.useContext=function(R){return de.current.useContext(R)},he.useDebugValue=function(){},he.useDeferredValue=function(R){return de.current.useDeferredValue(R)},he.useEffect=function(R,M){return de.current.useEffect(R,M)},he.useId=function(){return de.current.useId()},he.useImperativeHandle=function(R,M,$){return de.current.useImperativeHandle(R,M,$)},he.useInsertionEffect=function(R,M){return de.current.useInsertionEffect(R,M)},he.useLayoutEffect=function(R,M){return de.current.useLayoutEffect(R,M)},he.useMemo=function(R,M){return de.current.useMemo(R,M)},he.useReducer=function(R,M,$){return de.current.useReducer(R,M,$)},he.useRef=function(R){return de.current.useRef(R)},he.useState=function(R){return de.current.useState(R)},he.useSyncExternalStore=function(R,M,$){return de.current.useSyncExternalStore(R,M,$)},he.useTransition=function(){return de.current.useTransition()},he.version="18.3.1",he}var Tf;function ya(){return Tf||(Tf=1,zo.exports=t1()),zo.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jf;function n1(){if(jf)return hi;jf=1;var s=ya(),l=Symbol.for("react.element"),r=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,c=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,f={key:!0,ref:!0,__self:!0,__source:!0};function d(m,g,w){var v,S={},I=null,B=null;w!==void 0&&(I=""+w),g.key!==void 0&&(I=""+g.key),g.ref!==void 0&&(B=g.ref);for(v in g)a.call(g,v)&&!f.hasOwnProperty(v)&&(S[v]=g[v]);if(m&&m.defaultProps)for(v in g=m.defaultProps,g)S[v]===void 0&&(S[v]=g[v]);return{$$typeof:l,type:m,key:I,ref:B,props:S,_owner:c.current}}return hi.Fragment=r,hi.jsx=d,hi.jsxs=d,hi}var Pf;function r1(){return Pf||(Pf=1,Yo.exports=n1()),Yo.exports}var h=r1();const i1=15,ye=0,Jt=1,l1=2,at=-2,Re=-3,Of=-4,qt=-5,pt=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],Fd=1440,s1=0,o1=4,a1=9,u1=5,c1=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],f1=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],d1=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],p1=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],h1=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],m1=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],xn=15;function sa(){const s=this;let l,r,a,c,f,d;function m(w,v,S,I,B,V,A,y,E,j,O){let H,G,D,F,Q,X,U,W,re,J,ce,oe,ie,de,b;J=0,Q=S;do a[w[v+J]]++,J++,Q--;while(Q!==0);if(a[0]==S)return A[0]=-1,y[0]=0,ye;for(W=y[0],X=1;X<=xn&&a[X]===0;X++);for(U=X,W<X&&(W=X),Q=xn;Q!==0&&a[Q]===0;Q--);for(D=Q,W>Q&&(W=Q),y[0]=W,de=1<<X;X<Q;X++,de<<=1)if((de-=a[X])<0)return Re;if((de-=a[Q])<0)return Re;for(a[Q]+=de,d[1]=X=0,J=1,ie=2;--Q!==0;)d[ie]=X+=a[J],ie++,J++;Q=0,J=0;do(X=w[v+J])!==0&&(O[d[X]++]=Q),J++;while(++Q<S);for(S=d[D],d[0]=Q=0,J=0,F=-1,oe=-W,f[0]=0,ce=0,b=0;U<=D;U++)for(H=a[U];H--!==0;){for(;U>oe+W;){if(F++,oe+=W,b=D-oe,b=b>W?W:b,(G=1<<(X=U-oe))>H+1&&(G-=H+1,ie=U,X<b))for(;++X<b&&!((G<<=1)<=a[++ie]);)G-=a[ie];if(b=1<<X,j[0]+b>Fd)return Re;f[F]=ce=j[0],j[0]+=b,F!==0?(d[F]=Q,c[0]=X,c[1]=W,X=Q>>>oe-W,c[2]=ce-f[F-1]-X,E.set(c,(f[F-1]+X)*3)):A[0]=ce}for(c[1]=U-oe,J>=S?c[0]=192:O[J]<I?(c[0]=O[J]<256?0:96,c[2]=O[J++]):(c[0]=V[O[J]-I]+16+64,c[2]=B[O[J++]-I]),G=1<<U-oe,X=Q>>>oe;X<b;X+=G)E.set(c,(ce+X)*3);for(X=1<<U-1;(Q&X)!==0;X>>>=1)Q^=X;for(Q^=X,re=(1<<oe)-1;(Q&re)!=d[F];)F--,oe-=W,re=(1<<oe)-1}return de!==0&&D!=1?qt:ye}function g(w){let v;for(l||(l=[],r=[],a=new Int32Array(xn+1),c=[],f=new Int32Array(xn),d=new Int32Array(xn+1)),r.length<w&&(r=[]),v=0;v<w;v++)r[v]=0;for(v=0;v<xn+1;v++)a[v]=0;for(v=0;v<3;v++)c[v]=0;f.set(a.subarray(0,xn),0),d.set(a.subarray(0,xn+1),0)}s.inflate_trees_bits=function(w,v,S,I,B){let V;return g(19),l[0]=0,V=m(w,0,19,19,null,null,S,v,I,l,r),V==Re?B.msg="oversubscribed dynamic bit lengths tree":(V==qt||v[0]===0)&&(B.msg="incomplete dynamic bit lengths tree",V=Re),V},s.inflate_trees_dynamic=function(w,v,S,I,B,V,A,y,E){let j;return g(288),l[0]=0,j=m(S,0,w,257,d1,p1,V,I,y,l,r),j!=ye||I[0]===0?(j==Re?E.msg="oversubscribed literal/length tree":j!=Of&&(E.msg="incomplete literal/length tree",j=Re),j):(g(288),j=m(S,w,v,0,h1,m1,A,B,y,l,r),j!=ye||B[0]===0&&w>257?(j==Re?E.msg="oversubscribed distance tree":j==qt?(E.msg="incomplete distance tree",j=Re):j!=Of&&(E.msg="empty distance tree with lengths",j=Re),j):ye)}}sa.inflate_trees_fixed=function(s,l,r,a){return s[0]=a1,l[0]=u1,r[0]=c1,a[0]=f1,ye};const Ml=0,Df=1,Nf=2,Mf=3,Bf=4,Hf=5,Ff=6,Xo=7,Qf=8,Bl=9;function g1(){const s=this;let l,r=0,a,c=0,f=0,d=0,m=0,g=0,w=0,v=0,S,I=0,B,V=0;function A(y,E,j,O,H,G,D,F){let Q,X,U,W,re,J,ce,oe,ie,de,b,ee,L,R,M,$;ce=F.next_in_index,oe=F.avail_in,re=D.bitb,J=D.bitk,ie=D.write,de=ie<D.read?D.read-ie-1:D.end-ie,b=pt[y],ee=pt[E];do{for(;J<20;)oe--,re|=(F.read_byte(ce++)&255)<<J,J+=8;if(Q=re&b,X=j,U=O,$=(U+Q)*3,(W=X[$])===0){re>>=X[$+1],J-=X[$+1],D.win[ie++]=X[$+2],de--;continue}do{if(re>>=X[$+1],J-=X[$+1],(W&16)!==0){for(W&=15,L=X[$+2]+(re&pt[W]),re>>=W,J-=W;J<15;)oe--,re|=(F.read_byte(ce++)&255)<<J,J+=8;Q=re&ee,X=H,U=G,$=(U+Q)*3,W=X[$];do if(re>>=X[$+1],J-=X[$+1],(W&16)!==0){for(W&=15;J<W;)oe--,re|=(F.read_byte(ce++)&255)<<J,J+=8;if(R=X[$+2]+(re&pt[W]),re>>=W,J-=W,de-=L,ie>=R)M=ie-R,ie-M>0&&2>ie-M?(D.win[ie++]=D.win[M++],D.win[ie++]=D.win[M++],L-=2):(D.win.set(D.win.subarray(M,M+2),ie),ie+=2,M+=2,L-=2);else{M=ie-R;do M+=D.end;while(M<0);if(W=D.end-M,L>W){if(L-=W,ie-M>0&&W>ie-M)do D.win[ie++]=D.win[M++];while(--W!==0);else D.win.set(D.win.subarray(M,M+W),ie),ie+=W,M+=W,W=0;M=0}}if(ie-M>0&&L>ie-M)do D.win[ie++]=D.win[M++];while(--L!==0);else D.win.set(D.win.subarray(M,M+L),ie),ie+=L,M+=L,L=0;break}else if((W&64)===0)Q+=X[$+2],Q+=re&pt[W],$=(U+Q)*3,W=X[$];else return F.msg="invalid distance code",L=F.avail_in-oe,L=J>>3<L?J>>3:L,oe+=L,ce-=L,J-=L<<3,D.bitb=re,D.bitk=J,F.avail_in=oe,F.total_in+=ce-F.next_in_index,F.next_in_index=ce,D.write=ie,Re;while(!0);break}if((W&64)===0){if(Q+=X[$+2],Q+=re&pt[W],$=(U+Q)*3,(W=X[$])===0){re>>=X[$+1],J-=X[$+1],D.win[ie++]=X[$+2],de--;break}}else return(W&32)!==0?(L=F.avail_in-oe,L=J>>3<L?J>>3:L,oe+=L,ce-=L,J-=L<<3,D.bitb=re,D.bitk=J,F.avail_in=oe,F.total_in+=ce-F.next_in_index,F.next_in_index=ce,D.write=ie,Jt):(F.msg="invalid literal/length code",L=F.avail_in-oe,L=J>>3<L?J>>3:L,oe+=L,ce-=L,J-=L<<3,D.bitb=re,D.bitk=J,F.avail_in=oe,F.total_in+=ce-F.next_in_index,F.next_in_index=ce,D.write=ie,Re)}while(!0)}while(de>=258&&oe>=10);return L=F.avail_in-oe,L=J>>3<L?J>>3:L,oe+=L,ce-=L,J-=L<<3,D.bitb=re,D.bitk=J,F.avail_in=oe,F.total_in+=ce-F.next_in_index,F.next_in_index=ce,D.write=ie,ye}s.init=function(y,E,j,O,H,G){l=Ml,w=y,v=E,S=j,I=O,B=H,V=G,a=null},s.proc=function(y,E,j){let O,H,G,D=0,F=0,Q=0,X,U,W,re;for(Q=E.next_in_index,X=E.avail_in,D=y.bitb,F=y.bitk,U=y.write,W=U<y.read?y.read-U-1:y.end-U;;)switch(l){case Ml:if(W>=258&&X>=10&&(y.bitb=D,y.bitk=F,E.avail_in=X,E.total_in+=Q-E.next_in_index,E.next_in_index=Q,y.write=U,j=A(w,v,S,I,B,V,y,E),Q=E.next_in_index,X=E.avail_in,D=y.bitb,F=y.bitk,U=y.write,W=U<y.read?y.read-U-1:y.end-U,j!=ye)){l=j==Jt?Xo:Bl;break}f=w,a=S,c=I,l=Df;case Df:for(O=f;F<O;){if(X!==0)j=ye;else return y.bitb=D,y.bitk=F,E.avail_in=X,E.total_in+=Q-E.next_in_index,E.next_in_index=Q,y.write=U,y.inflate_flush(E,j);X--,D|=(E.read_byte(Q++)&255)<<F,F+=8}if(H=(c+(D&pt[O]))*3,D>>>=a[H+1],F-=a[H+1],G=a[H],G===0){d=a[H+2],l=Ff;break}if((G&16)!==0){m=G&15,r=a[H+2],l=Nf;break}if((G&64)===0){f=G,c=H/3+a[H+2];break}if((G&32)!==0){l=Xo;break}return l=Bl,E.msg="invalid literal/length code",j=Re,y.bitb=D,y.bitk=F,E.avail_in=X,E.total_in+=Q-E.next_in_index,E.next_in_index=Q,y.write=U,y.inflate_flush(E,j);case Nf:for(O=m;F<O;){if(X!==0)j=ye;else return y.bitb=D,y.bitk=F,E.avail_in=X,E.total_in+=Q-E.next_in_index,E.next_in_index=Q,y.write=U,y.inflate_flush(E,j);X--,D|=(E.read_byte(Q++)&255)<<F,F+=8}r+=D&pt[O],D>>=O,F-=O,f=v,a=B,c=V,l=Mf;case Mf:for(O=f;F<O;){if(X!==0)j=ye;else return y.bitb=D,y.bitk=F,E.avail_in=X,E.total_in+=Q-E.next_in_index,E.next_in_index=Q,y.write=U,y.inflate_flush(E,j);X--,D|=(E.read_byte(Q++)&255)<<F,F+=8}if(H=(c+(D&pt[O]))*3,D>>=a[H+1],F-=a[H+1],G=a[H],(G&16)!==0){m=G&15,g=a[H+2],l=Bf;break}if((G&64)===0){f=G,c=H/3+a[H+2];break}return l=Bl,E.msg="invalid distance code",j=Re,y.bitb=D,y.bitk=F,E.avail_in=X,E.total_in+=Q-E.next_in_index,E.next_in_index=Q,y.write=U,y.inflate_flush(E,j);case Bf:for(O=m;F<O;){if(X!==0)j=ye;else return y.bitb=D,y.bitk=F,E.avail_in=X,E.total_in+=Q-E.next_in_index,E.next_in_index=Q,y.write=U,y.inflate_flush(E,j);X--,D|=(E.read_byte(Q++)&255)<<F,F+=8}g+=D&pt[O],D>>=O,F-=O,l=Hf;case Hf:for(re=U-g;re<0;)re+=y.end;for(;r!==0;){if(W===0&&(U==y.end&&y.read!==0&&(U=0,W=U<y.read?y.read-U-1:y.end-U),W===0&&(y.write=U,j=y.inflate_flush(E,j),U=y.write,W=U<y.read?y.read-U-1:y.end-U,U==y.end&&y.read!==0&&(U=0,W=U<y.read?y.read-U-1:y.end-U),W===0)))return y.bitb=D,y.bitk=F,E.avail_in=X,E.total_in+=Q-E.next_in_index,E.next_in_index=Q,y.write=U,y.inflate_flush(E,j);y.win[U++]=y.win[re++],W--,re==y.end&&(re=0),r--}l=Ml;break;case Ff:if(W===0&&(U==y.end&&y.read!==0&&(U=0,W=U<y.read?y.read-U-1:y.end-U),W===0&&(y.write=U,j=y.inflate_flush(E,j),U=y.write,W=U<y.read?y.read-U-1:y.end-U,U==y.end&&y.read!==0&&(U=0,W=U<y.read?y.read-U-1:y.end-U),W===0)))return y.bitb=D,y.bitk=F,E.avail_in=X,E.total_in+=Q-E.next_in_index,E.next_in_index=Q,y.write=U,y.inflate_flush(E,j);j=ye,y.win[U++]=d,W--,l=Ml;break;case Xo:if(F>7&&(F-=8,X++,Q--),y.write=U,j=y.inflate_flush(E,j),U=y.write,W=U<y.read?y.read-U-1:y.end-U,y.read!=y.write)return y.bitb=D,y.bitk=F,E.avail_in=X,E.total_in+=Q-E.next_in_index,E.next_in_index=Q,y.write=U,y.inflate_flush(E,j);l=Qf;case Qf:return j=Jt,y.bitb=D,y.bitk=F,E.avail_in=X,E.total_in+=Q-E.next_in_index,E.next_in_index=Q,y.write=U,y.inflate_flush(E,j);case Bl:return j=Re,y.bitb=D,y.bitk=F,E.avail_in=X,E.total_in+=Q-E.next_in_index,E.next_in_index=Q,y.write=U,y.inflate_flush(E,j);default:return j=at,y.bitb=D,y.bitk=F,E.avail_in=X,E.total_in+=Q-E.next_in_index,E.next_in_index=Q,y.write=U,y.inflate_flush(E,j)}},s.free=function(){}}const Lf=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Ar=0,Go=1,Uf=2,Wf=3,Vf=4,bf=5,Hl=6,Fl=7,Yf=8,zn=9;function v1(s,l){const r=this;let a=Ar,c=0,f=0,d=0,m;const g=[0],w=[0],v=new g1;let S=0,I=new Int32Array(Fd*3);const B=0,V=new sa;r.bitk=0,r.bitb=0,r.win=new Uint8Array(l),r.end=l,r.read=0,r.write=0,r.reset=function(A,y){y&&(y[0]=B),a==Hl&&v.free(A),a=Ar,r.bitk=0,r.bitb=0,r.read=r.write=0},r.reset(s,null),r.inflate_flush=function(A,y){let E,j,O;return j=A.next_out_index,O=r.read,E=(O<=r.write?r.write:r.end)-O,E>A.avail_out&&(E=A.avail_out),E!==0&&y==qt&&(y=ye),A.avail_out-=E,A.total_out+=E,A.next_out.set(r.win.subarray(O,O+E),j),j+=E,O+=E,O==r.end&&(O=0,r.write==r.end&&(r.write=0),E=r.write-O,E>A.avail_out&&(E=A.avail_out),E!==0&&y==qt&&(y=ye),A.avail_out-=E,A.total_out+=E,A.next_out.set(r.win.subarray(O,O+E),j),j+=E,O+=E),A.next_out_index=j,r.read=O,y},r.proc=function(A,y){let E,j,O,H,G,D,F,Q;for(H=A.next_in_index,G=A.avail_in,j=r.bitb,O=r.bitk,D=r.write,F=D<r.read?r.read-D-1:r.end-D;;){let X,U,W,re,J,ce,oe,ie;switch(a){case Ar:for(;O<3;){if(G!==0)y=ye;else return r.bitb=j,r.bitk=O,A.avail_in=G,A.total_in+=H-A.next_in_index,A.next_in_index=H,r.write=D,r.inflate_flush(A,y);G--,j|=(A.read_byte(H++)&255)<<O,O+=8}switch(E=j&7,S=E&1,E>>>1){case 0:j>>>=3,O-=3,E=O&7,j>>>=E,O-=E,a=Go;break;case 1:X=[],U=[],W=[[]],re=[[]],sa.inflate_trees_fixed(X,U,W,re),v.init(X[0],U[0],W[0],0,re[0],0),j>>>=3,O-=3,a=Hl;break;case 2:j>>>=3,O-=3,a=Wf;break;case 3:return j>>>=3,O-=3,a=zn,A.msg="invalid block type",y=Re,r.bitb=j,r.bitk=O,A.avail_in=G,A.total_in+=H-A.next_in_index,A.next_in_index=H,r.write=D,r.inflate_flush(A,y)}break;case Go:for(;O<32;){if(G!==0)y=ye;else return r.bitb=j,r.bitk=O,A.avail_in=G,A.total_in+=H-A.next_in_index,A.next_in_index=H,r.write=D,r.inflate_flush(A,y);G--,j|=(A.read_byte(H++)&255)<<O,O+=8}if((~j>>>16&65535)!=(j&65535))return a=zn,A.msg="invalid stored block lengths",y=Re,r.bitb=j,r.bitk=O,A.avail_in=G,A.total_in+=H-A.next_in_index,A.next_in_index=H,r.write=D,r.inflate_flush(A,y);c=j&65535,j=O=0,a=c!==0?Uf:S!==0?Fl:Ar;break;case Uf:if(G===0||F===0&&(D==r.end&&r.read!==0&&(D=0,F=D<r.read?r.read-D-1:r.end-D),F===0&&(r.write=D,y=r.inflate_flush(A,y),D=r.write,F=D<r.read?r.read-D-1:r.end-D,D==r.end&&r.read!==0&&(D=0,F=D<r.read?r.read-D-1:r.end-D),F===0)))return r.bitb=j,r.bitk=O,A.avail_in=G,A.total_in+=H-A.next_in_index,A.next_in_index=H,r.write=D,r.inflate_flush(A,y);if(y=ye,E=c,E>G&&(E=G),E>F&&(E=F),r.win.set(A.read_buf(H,E),D),H+=E,G-=E,D+=E,F-=E,(c-=E)!==0)break;a=S!==0?Fl:Ar;break;case Wf:for(;O<14;){if(G!==0)y=ye;else return r.bitb=j,r.bitk=O,A.avail_in=G,A.total_in+=H-A.next_in_index,A.next_in_index=H,r.write=D,r.inflate_flush(A,y);G--,j|=(A.read_byte(H++)&255)<<O,O+=8}if(f=E=j&16383,(E&31)>29||(E>>5&31)>29)return a=zn,A.msg="too many length or distance symbols",y=Re,r.bitb=j,r.bitk=O,A.avail_in=G,A.total_in+=H-A.next_in_index,A.next_in_index=H,r.write=D,r.inflate_flush(A,y);if(E=258+(E&31)+(E>>5&31),!m||m.length<E)m=[];else for(Q=0;Q<E;Q++)m[Q]=0;j>>>=14,O-=14,d=0,a=Vf;case Vf:for(;d<4+(f>>>10);){for(;O<3;){if(G!==0)y=ye;else return r.bitb=j,r.bitk=O,A.avail_in=G,A.total_in+=H-A.next_in_index,A.next_in_index=H,r.write=D,r.inflate_flush(A,y);G--,j|=(A.read_byte(H++)&255)<<O,O+=8}m[Lf[d++]]=j&7,j>>>=3,O-=3}for(;d<19;)m[Lf[d++]]=0;if(g[0]=7,E=V.inflate_trees_bits(m,g,w,I,A),E!=ye)return y=E,y==Re&&(m=null,a=zn),r.bitb=j,r.bitk=O,A.avail_in=G,A.total_in+=H-A.next_in_index,A.next_in_index=H,r.write=D,r.inflate_flush(A,y);d=0,a=bf;case bf:for(;E=f,!(d>=258+(E&31)+(E>>5&31));){let de,b;for(E=g[0];O<E;){if(G!==0)y=ye;else return r.bitb=j,r.bitk=O,A.avail_in=G,A.total_in+=H-A.next_in_index,A.next_in_index=H,r.write=D,r.inflate_flush(A,y);G--,j|=(A.read_byte(H++)&255)<<O,O+=8}if(E=I[(w[0]+(j&pt[E]))*3+1],b=I[(w[0]+(j&pt[E]))*3+2],b<16)j>>>=E,O-=E,m[d++]=b;else{for(Q=b==18?7:b-14,de=b==18?11:3;O<E+Q;){if(G!==0)y=ye;else return r.bitb=j,r.bitk=O,A.avail_in=G,A.total_in+=H-A.next_in_index,A.next_in_index=H,r.write=D,r.inflate_flush(A,y);G--,j|=(A.read_byte(H++)&255)<<O,O+=8}if(j>>>=E,O-=E,de+=j&pt[Q],j>>>=Q,O-=Q,Q=d,E=f,Q+de>258+(E&31)+(E>>5&31)||b==16&&Q<1)return m=null,a=zn,A.msg="invalid bit length repeat",y=Re,r.bitb=j,r.bitk=O,A.avail_in=G,A.total_in+=H-A.next_in_index,A.next_in_index=H,r.write=D,r.inflate_flush(A,y);b=b==16?m[Q-1]:0;do m[Q++]=b;while(--de!==0);d=Q}}if(w[0]=-1,J=[],ce=[],oe=[],ie=[],J[0]=9,ce[0]=6,E=f,E=V.inflate_trees_dynamic(257+(E&31),1+(E>>5&31),m,J,ce,oe,ie,I,A),E!=ye)return E==Re&&(m=null,a=zn),y=E,r.bitb=j,r.bitk=O,A.avail_in=G,A.total_in+=H-A.next_in_index,A.next_in_index=H,r.write=D,r.inflate_flush(A,y);v.init(J[0],ce[0],I,oe[0],I,ie[0]),a=Hl;case Hl:if(r.bitb=j,r.bitk=O,A.avail_in=G,A.total_in+=H-A.next_in_index,A.next_in_index=H,r.write=D,(y=v.proc(r,A,y))!=Jt)return r.inflate_flush(A,y);if(y=ye,v.free(A),H=A.next_in_index,G=A.avail_in,j=r.bitb,O=r.bitk,D=r.write,F=D<r.read?r.read-D-1:r.end-D,S===0){a=Ar;break}a=Fl;case Fl:if(r.write=D,y=r.inflate_flush(A,y),D=r.write,F=D<r.read?r.read-D-1:r.end-D,r.read!=r.write)return r.bitb=j,r.bitk=O,A.avail_in=G,A.total_in+=H-A.next_in_index,A.next_in_index=H,r.write=D,r.inflate_flush(A,y);a=Yf;case Yf:return y=Jt,r.bitb=j,r.bitk=O,A.avail_in=G,A.total_in+=H-A.next_in_index,A.next_in_index=H,r.write=D,r.inflate_flush(A,y);case zn:return y=Re,r.bitb=j,r.bitk=O,A.avail_in=G,A.total_in+=H-A.next_in_index,A.next_in_index=H,r.write=D,r.inflate_flush(A,y);default:return y=at,r.bitb=j,r.bitk=O,A.avail_in=G,A.total_in+=H-A.next_in_index,A.next_in_index=H,r.write=D,r.inflate_flush(A,y)}}},r.free=function(A){r.reset(A,null),r.win=null,I=null},r.set_dictionary=function(A,y,E){r.win.set(A.subarray(y,y+E),0),r.read=r.write=E},r.sync_point=function(){return a==Go?1:0}}const y1=32,x1=8,w1=0,zf=1,Xf=2,Gf=3,Kf=4,Zf=5,Ko=6,mi=7,Jf=12,wn=13,A1=[0,0,255,255];function E1(){const s=this;s.mode=0,s.method=0,s.was=[0],s.need=0,s.marker=0,s.wbits=0;function l(r){return!r||!r.istate?at:(r.total_in=r.total_out=0,r.msg=null,r.istate.mode=mi,r.istate.blocks.reset(r,null),ye)}s.inflateEnd=function(r){return s.blocks&&s.blocks.free(r),s.blocks=null,ye},s.inflateInit=function(r,a){return r.msg=null,s.blocks=null,a<8||a>15?(s.inflateEnd(r),at):(s.wbits=a,r.istate.blocks=new v1(r,1<<a),l(r),ye)},s.inflate=function(r,a){let c,f;if(!r||!r.istate||!r.next_in)return at;const d=r.istate;for(a=a==o1?qt:ye,c=qt;;)switch(d.mode){case w1:if(r.avail_in===0)return c;if(c=a,r.avail_in--,r.total_in++,((d.method=r.read_byte(r.next_in_index++))&15)!=x1){d.mode=wn,r.msg="unknown compression method",d.marker=5;break}if((d.method>>4)+8>d.wbits){d.mode=wn,r.msg="invalid win size",d.marker=5;break}d.mode=zf;case zf:if(r.avail_in===0)return c;if(c=a,r.avail_in--,r.total_in++,f=r.read_byte(r.next_in_index++)&255,((d.method<<8)+f)%31!==0){d.mode=wn,r.msg="incorrect header check",d.marker=5;break}if((f&y1)===0){d.mode=mi;break}d.mode=Xf;case Xf:if(r.avail_in===0)return c;c=a,r.avail_in--,r.total_in++,d.need=(r.read_byte(r.next_in_index++)&255)<<24&4278190080,d.mode=Gf;case Gf:if(r.avail_in===0)return c;c=a,r.avail_in--,r.total_in++,d.need+=(r.read_byte(r.next_in_index++)&255)<<16&16711680,d.mode=Kf;case Kf:if(r.avail_in===0)return c;c=a,r.avail_in--,r.total_in++,d.need+=(r.read_byte(r.next_in_index++)&255)<<8&65280,d.mode=Zf;case Zf:return r.avail_in===0?c:(c=a,r.avail_in--,r.total_in++,d.need+=r.read_byte(r.next_in_index++)&255,d.mode=Ko,l1);case Ko:return d.mode=wn,r.msg="need dictionary",d.marker=0,at;case mi:if(c=d.blocks.proc(r,c),c==Re){d.mode=wn,d.marker=0;break}if(c==ye&&(c=a),c!=Jt)return c;c=a,d.blocks.reset(r,d.was),d.mode=Jf;case Jf:return r.avail_in=0,Jt;case wn:return Re;default:return at}},s.inflateSetDictionary=function(r,a,c){let f=0,d=c;if(!r||!r.istate||r.istate.mode!=Ko)return at;const m=r.istate;return d>=1<<m.wbits&&(d=(1<<m.wbits)-1,f=c-d),m.blocks.set_dictionary(a,f,d),m.mode=mi,ye},s.inflateSync=function(r){let a,c,f,d,m;if(!r||!r.istate)return at;const g=r.istate;if(g.mode!=wn&&(g.mode=wn,g.marker=0),(a=r.avail_in)===0)return qt;for(c=r.next_in_index,f=g.marker;a!==0&&f<4;)r.read_byte(c)==A1[f]?f++:r.read_byte(c)!==0?f=0:f=4-f,c++,a--;return r.total_in+=c-r.next_in_index,r.next_in_index=c,r.avail_in=a,g.marker=f,f!=4?Re:(d=r.total_in,m=r.total_out,l(r),r.total_in=d,r.total_out=m,g.mode=mi,ye)},s.inflateSyncPoint=function(r){return!r||!r.istate||!r.istate.blocks?at:r.istate.blocks.sync_point()}}function Qd(){}Qd.prototype={inflateInit(s){const l=this;return l.istate=new E1,s||(s=i1),l.istate.inflateInit(l,s)},inflate(s){const l=this;return l.istate?l.istate.inflate(l,s):at},inflateEnd(){const s=this;if(!s.istate)return at;const l=s.istate.inflateEnd(s);return s.istate=null,l},inflateSync(){const s=this;return s.istate?s.istate.inflateSync(s):at},inflateSetDictionary(s,l){const r=this;return r.istate?r.istate.inflateSetDictionary(r,s,l):at},read_byte(s){return this.next_in[s]},read_buf(s,l){return this.next_in.subarray(s,s+l)}};function C1(s){const l=this,r=new Qd,a=s&&s.chunkSize?Math.floor(s.chunkSize*2):128*1024,c=s1,f=new Uint8Array(a);let d=!1;r.inflateInit(),r.next_out=f,l.append=function(m,g){const w=[];let v,S,I=0,B=0,V=0;if(m.length!==0){r.next_in_index=0,r.next_in=m,r.avail_in=m.length;do{if(r.next_out_index=0,r.avail_out=a,r.avail_in===0&&!d&&(r.next_in_index=0,d=!0),v=r.inflate(c),d&&v===qt){if(r.avail_in!==0)throw new Error("inflating: bad input")}else if(v!==ye&&v!==Jt)throw new Error("inflating: "+r.msg);if((d||v===Jt)&&r.avail_in===m.length)throw new Error("inflating: bad input");r.next_out_index&&(r.next_out_index===a?w.push(new Uint8Array(f)):w.push(f.subarray(0,r.next_out_index))),V+=r.next_out_index,g&&r.next_in_index>0&&r.next_in_index!=I&&(g(r.next_in_index),I=r.next_in_index)}while(r.avail_in>0||r.avail_out===0);return w.length>1?(S=new Uint8Array(V),w.forEach(function(A){S.set(A,B),B+=A.length})):S=w[0]?new Uint8Array(w[0]):new Uint8Array,S}},l.flush=function(){r.inflateEnd()}}const Xn=4294967295,Cn=65535,S1=8,k1=0,I1=99,R1=67324752,T1=134695760,qf=33639248,j1=101010256,_f=101075792,P1=117853008,Sn=22,Zo=20,Jo=56,O1=1,D1=39169,N1=10,M1=1,B1=21589,H1=28789,F1=25461,Q1=6534,$f=1,L1=6,ed=8,td=2048,nd=16,rd=16384,id=73,ld="/",qe=void 0,Rn="undefined",Ci="function";class sd{constructor(l){return class extends TransformStream{constructor(r,a){const c=new l(a);super({transform(f,d){d.enqueue(c.append(f))},flush(f){const d=c.flush();d&&f.enqueue(d)}})}}}}const U1=64;let Ld=2;try{typeof navigator!=Rn&&navigator.hardwareConcurrency&&(Ld=navigator.hardwareConcurrency)}catch{}const W1={chunkSize:512*1024,maxWorkers:Ld,terminateWorkerTimeout:5e3,useWebWorkers:!0,useCompressionStream:!0,workerScripts:qe,CompressionStreamNative:typeof CompressionStream!=Rn&&CompressionStream,DecompressionStreamNative:typeof DecompressionStream!=Rn&&DecompressionStream},kn=Object.assign({},W1);function Ud(){return kn}function V1(s){return Math.max(s.chunkSize,U1)}function Wd(s){const{baseURL:l,chunkSize:r,maxWorkers:a,terminateWorkerTimeout:c,useCompressionStream:f,useWebWorkers:d,Deflate:m,Inflate:g,CompressionStream:w,DecompressionStream:v,workerScripts:S}=s;if(An("baseURL",l),An("chunkSize",r),An("maxWorkers",a),An("terminateWorkerTimeout",c),An("useCompressionStream",f),An("useWebWorkers",d),m&&(kn.CompressionStream=new sd(m)),g&&(kn.DecompressionStream=new sd(g)),An("CompressionStream",w),An("DecompressionStream",v),S!==qe){const{deflate:I,inflate:B}=S;if((I||B)&&(kn.workerScripts||(kn.workerScripts={})),I){if(!Array.isArray(I))throw new Error("workerScripts.deflate must be an array");kn.workerScripts.deflate=I}if(B){if(!Array.isArray(B))throw new Error("workerScripts.inflate must be an array");kn.workerScripts.inflate=B}}}function An(s,l){l!==qe&&(kn[s]=l)}function b1(){return"application/octet-stream"}const Vd=[];for(let s=0;s<256;s++){let l=s;for(let r=0;r<8;r++)l&1?l=l>>>1^3988292384:l=l>>>1;Vd[s]=l}class Yl{constructor(l){this.crc=l||-1}append(l){let r=this.crc|0;for(let a=0,c=l.length|0;a<c;a++)r=r>>>8^Vd[(r^l[a])&255];this.crc=r}get(){return~this.crc}}class bd extends TransformStream{constructor(){let l;const r=new Yl;super({transform(a,c){r.append(a),c.enqueue(a)},flush(){const a=new Uint8Array(4);new DataView(a.buffer).setUint32(0,r.get()),l.value=a}}),l=this}}function Y1(s){if(typeof TextEncoder==Rn){s=unescape(encodeURIComponent(s));const l=new Uint8Array(s.length);for(let r=0;r<l.length;r++)l[r]=s.charCodeAt(r);return l}else return new TextEncoder().encode(s)}const tt={concat(s,l){if(s.length===0||l.length===0)return s.concat(l);const r=s[s.length-1],a=tt.getPartial(r);return a===32?s.concat(l):tt._shiftRight(l,a,r|0,s.slice(0,s.length-1))},bitLength(s){const l=s.length;if(l===0)return 0;const r=s[l-1];return(l-1)*32+tt.getPartial(r)},clamp(s,l){if(s.length*32<l)return s;s=s.slice(0,Math.ceil(l/32));const r=s.length;return l=l&31,r>0&&l&&(s[r-1]=tt.partial(l,s[r-1]&2147483648>>l-1,1)),s},partial(s,l,r){return s===32?l:(r?l|0:l<<32-s)+s*1099511627776},getPartial(s){return Math.round(s/1099511627776)||32},_shiftRight(s,l,r,a){for(a===void 0&&(a=[]);l>=32;l-=32)a.push(r),r=0;if(l===0)return a.concat(s);for(let d=0;d<s.length;d++)a.push(r|s[d]>>>l),r=s[d]<<32-l;const c=s.length?s[s.length-1]:0,f=tt.getPartial(c);return a.push(tt.partial(l+f&31,l+f>32?r:a.pop(),1)),a}},zl={bytes:{fromBits(s){const r=tt.bitLength(s)/8,a=new Uint8Array(r);let c;for(let f=0;f<r;f++)(f&3)===0&&(c=s[f/4]),a[f]=c>>>24,c<<=8;return a},toBits(s){const l=[];let r,a=0;for(r=0;r<s.length;r++)a=a<<8|s[r],(r&3)===3&&(l.push(a),a=0);return r&3&&l.push(tt.partial(8*(r&3),a)),l}}},Yd={};Yd.sha1=class{constructor(s){const l=this;l.blockSize=512,l._init=[1732584193,4023233417,2562383102,271733878,3285377520],l._key=[1518500249,1859775393,2400959708,3395469782],s?(l._h=s._h.slice(0),l._buffer=s._buffer.slice(0),l._length=s._length):l.reset()}reset(){const s=this;return s._h=s._init.slice(0),s._buffer=[],s._length=0,s}update(s){const l=this;typeof s=="string"&&(s=zl.utf8String.toBits(s));const r=l._buffer=tt.concat(l._buffer,s),a=l._length,c=l._length=a+tt.bitLength(s);if(c>9007199254740991)throw new Error("Cannot hash more than 2^53 - 1 bits");const f=new Uint32Array(r);let d=0;for(let m=l.blockSize+a-(l.blockSize+a&l.blockSize-1);m<=c;m+=l.blockSize)l._block(f.subarray(16*d,16*(d+1))),d+=1;return r.splice(0,16*d),l}finalize(){const s=this;let l=s._buffer;const r=s._h;l=tt.concat(l,[tt.partial(1,1)]);for(let a=l.length+2;a&15;a++)l.push(0);for(l.push(Math.floor(s._length/4294967296)),l.push(s._length|0);l.length;)s._block(l.splice(0,16));return s.reset(),r}_f(s,l,r,a){if(s<=19)return l&r|~l&a;if(s<=39)return l^r^a;if(s<=59)return l&r|l&a|r&a;if(s<=79)return l^r^a}_S(s,l){return l<<s|l>>>32-s}_block(s){const l=this,r=l._h,a=Array(80);for(let w=0;w<16;w++)a[w]=s[w];let c=r[0],f=r[1],d=r[2],m=r[3],g=r[4];for(let w=0;w<=79;w++){w>=16&&(a[w]=l._S(1,a[w-3]^a[w-8]^a[w-14]^a[w-16]));const v=l._S(5,c)+l._f(w,f,d,m)+g+a[w]+l._key[Math.floor(w/20)]|0;g=m,m=d,d=l._S(30,f),f=c,c=v}r[0]=r[0]+c|0,r[1]=r[1]+f|0,r[2]=r[2]+d|0,r[3]=r[3]+m|0,r[4]=r[4]+g|0}};const zd={};zd.aes=class{constructor(s){const l=this;l._tables=[[[],[],[],[],[]],[[],[],[],[],[]]],l._tables[0][0][0]||l._precompute();const r=l._tables[0][4],a=l._tables[1],c=s.length;let f,d,m,g=1;if(c!==4&&c!==6&&c!==8)throw new Error("invalid aes key size");for(l._key=[d=s.slice(0),m=[]],f=c;f<4*c+28;f++){let w=d[f-1];(f%c===0||c===8&&f%c===4)&&(w=r[w>>>24]<<24^r[w>>16&255]<<16^r[w>>8&255]<<8^r[w&255],f%c===0&&(w=w<<8^w>>>24^g<<24,g=g<<1^(g>>7)*283)),d[f]=d[f-c]^w}for(let w=0;f;w++,f--){const v=d[w&3?f:f-4];f<=4||w<4?m[w]=v:m[w]=a[0][r[v>>>24]]^a[1][r[v>>16&255]]^a[2][r[v>>8&255]]^a[3][r[v&255]]}}encrypt(s){return this._crypt(s,0)}decrypt(s){return this._crypt(s,1)}_precompute(){const s=this._tables[0],l=this._tables[1],r=s[4],a=l[4],c=[],f=[];let d,m,g,w;for(let v=0;v<256;v++)f[(c[v]=v<<1^(v>>7)*283)^v]=v;for(let v=d=0;!r[v];v^=m||1,d=f[d]||1){let S=d^d<<1^d<<2^d<<3^d<<4;S=S>>8^S&255^99,r[v]=S,a[S]=v,w=c[g=c[m=c[v]]];let I=w*16843009^g*65537^m*257^v*16843008,B=c[S]*257^S*16843008;for(let V=0;V<4;V++)s[V][v]=B=B<<24^B>>>8,l[V][S]=I=I<<24^I>>>8}for(let v=0;v<5;v++)s[v]=s[v].slice(0),l[v]=l[v].slice(0)}_crypt(s,l){if(s.length!==4)throw new Error("invalid aes block size");const r=this._key[l],a=r.length/4-2,c=[0,0,0,0],f=this._tables[l],d=f[0],m=f[1],g=f[2],w=f[3],v=f[4];let S=s[0]^r[0],I=s[l?3:1]^r[1],B=s[2]^r[2],V=s[l?1:3]^r[3],A=4,y,E,j;for(let O=0;O<a;O++)y=d[S>>>24]^m[I>>16&255]^g[B>>8&255]^w[V&255]^r[A],E=d[I>>>24]^m[B>>16&255]^g[V>>8&255]^w[S&255]^r[A+1],j=d[B>>>24]^m[V>>16&255]^g[S>>8&255]^w[I&255]^r[A+2],V=d[V>>>24]^m[S>>16&255]^g[I>>8&255]^w[B&255]^r[A+3],A+=4,S=y,I=E,B=j;for(let O=0;O<4;O++)c[l?3&-O:O]=v[S>>>24]<<24^v[I>>16&255]<<16^v[B>>8&255]<<8^v[V&255]^r[A++],y=S,S=I,I=B,B=V,V=y;return c}};const z1={getRandomValues(s){const l=new Uint32Array(s.buffer),r=a=>{let c=987654321;const f=4294967295;return function(){return c=36969*(c&65535)+(c>>16)&f,a=18e3*(a&65535)+(a>>16)&f,(((c<<16)+a&f)/4294967296+.5)*(Math.random()>.5?1:-1)}};for(let a=0,c;a<s.length;a+=4){const f=r((c||Math.random())*4294967296);c=f()*987654071,l[a/4]=f()*4294967296|0}return s}},Xd={};Xd.ctrGladman=class{constructor(s,l){this._prf=s,this._initIv=l,this._iv=l}reset(){this._iv=this._initIv}update(s){return this.calculate(this._prf,s,this._iv)}incWord(s){if((s>>24&255)===255){let l=s>>16&255,r=s>>8&255,a=s&255;l===255?(l=0,r===255?(r=0,a===255?a=0:++a):++r):++l,s=0,s+=l<<16,s+=r<<8,s+=a}else s+=1<<24;return s}incCounter(s){(s[0]=this.incWord(s[0]))===0&&(s[1]=this.incWord(s[1]))}calculate(s,l,r){let a;if(!(a=l.length))return[];const c=tt.bitLength(l);for(let f=0;f<a;f+=4){this.incCounter(r);const d=s.encrypt(r);l[f]^=d[0],l[f+1]^=d[1],l[f+2]^=d[2],l[f+3]^=d[3]}return tt.clamp(l,c)}};const Kn={importKey(s){return new Kn.hmacSha1(zl.bytes.toBits(s))},pbkdf2(s,l,r,a){if(r=r||1e4,a<0||r<0)throw new Error("invalid params to pbkdf2");const c=(a>>5)+1<<2;let f,d,m,g,w;const v=new ArrayBuffer(c),S=new DataView(v);let I=0;const B=tt;for(l=zl.bytes.toBits(l),w=1;I<(c||1);w++){for(f=d=s.encrypt(B.concat(l,[w])),m=1;m<r;m++)for(d=s.encrypt(d),g=0;g<d.length;g++)f[g]^=d[g];for(m=0;I<(c||1)&&m<f.length;m++)S.setInt32(I,f[m]),I+=4}return v.slice(0,a/8)}};Kn.hmacSha1=class{constructor(s){const l=this,r=l._hash=Yd.sha1,a=[[],[]];l._baseHash=[new r,new r];const c=l._baseHash[0].blockSize/32;s.length>c&&(s=new r().update(s).finalize());for(let f=0;f<c;f++)a[0][f]=s[f]^909522486,a[1][f]=s[f]^1549556828;l._baseHash[0].update(a[0]),l._baseHash[1].update(a[1]),l._resultHash=new r(l._baseHash[0])}reset(){const s=this;s._resultHash=new s._hash(s._baseHash[0]),s._updated=!1}update(s){const l=this;l._updated=!0,l._resultHash.update(s)}digest(){const s=this,l=s._resultHash.finalize(),r=new s._hash(s._baseHash[1]).update(l).finalize();return s.reset(),r}encrypt(s){if(this._updated)throw new Error("encrypt on already updated hmac called!");return this.update(s),this.digest(s)}};const X1=typeof crypto!=Rn&&typeof crypto.getRandomValues==Ci,xa="Invalid password",wa="Invalid signature",Aa="zipjs-abort-check-password";function Gd(s){return X1?crypto.getRandomValues(s):z1.getRandomValues(s)}const Er=16,G1="raw",Kd={name:"PBKDF2"},K1={name:"HMAC"},Z1="SHA-1",J1=Object.assign({hash:K1},Kd),oa=Object.assign({iterations:1e3,hash:{name:Z1}},Kd),q1=["deriveBits"],yi=[8,12,16],gi=[16,24,32],En=10,_1=[0,0,0,0],Jl=typeof crypto!=Rn,Si=Jl&&crypto.subtle,Zd=Jl&&typeof Si!=Rn,Ht=zl.bytes,$1=zd.aes,e2=Xd.ctrGladman,t2=Kn.hmacSha1;let od=Jl&&Zd&&typeof Si.importKey==Ci,ad=Jl&&Zd&&typeof Si.deriveBits==Ci;class n2 extends TransformStream{constructor({password:l,rawPassword:r,signed:a,encryptionStrength:c,checkPasswordOnly:f}){super({start(){Object.assign(this,{ready:new Promise(d=>this.resolveReady=d),password:_d(l,r),signed:a,strength:c-1,pending:new Uint8Array})},async transform(d,m){const g=this,{password:w,strength:v,resolveReady:S,ready:I}=g;w?(await i2(g,v,w,At(d,0,yi[v]+2)),d=At(d,yi[v]+2),f?m.error(new Error(Aa)):S()):await I;const B=new Uint8Array(d.length-En-(d.length-En)%Er);m.enqueue(Jd(g,d,B,0,En,!0))},async flush(d){const{signed:m,ctr:g,hmac:w,pending:v,ready:S}=this;if(w&&g){await S;const I=At(v,0,v.length-En),B=At(v,v.length-En);let V=new Uint8Array;if(I.length){const A=wi(Ht,I);w.update(A);const y=g.update(A);V=xi(Ht,y)}if(m){const A=At(xi(Ht,w.digest()),0,En);for(let y=0;y<En;y++)if(A[y]!=B[y])throw new Error(wa)}d.enqueue(V)}}})}}class r2 extends TransformStream{constructor({password:l,rawPassword:r,encryptionStrength:a}){let c;super({start(){Object.assign(this,{ready:new Promise(f=>this.resolveReady=f),password:_d(l,r),strength:a-1,pending:new Uint8Array})},async transform(f,d){const m=this,{password:g,strength:w,resolveReady:v,ready:S}=m;let I=new Uint8Array;g?(I=await l2(m,w,g),v()):await S;const B=new Uint8Array(I.length+f.length-f.length%Er);B.set(I,0),d.enqueue(Jd(m,f,B,I.length,0))},async flush(f){const{ctr:d,hmac:m,pending:g,ready:w}=this;if(m&&d){await w;let v=new Uint8Array;if(g.length){const S=d.update(wi(Ht,g));m.update(S),v=xi(Ht,S)}c.signature=xi(Ht,m.digest()).slice(0,En),f.enqueue(Ea(v,c.signature))}}}),c=this}}function Jd(s,l,r,a,c,f){const{ctr:d,hmac:m,pending:g}=s,w=l.length-c;g.length&&(l=Ea(g,l),r=a2(r,w-w%Er));let v;for(v=0;v<=w-Er;v+=Er){const S=wi(Ht,At(l,v,v+Er));f&&m.update(S);const I=d.update(S);f||m.update(I),r.set(xi(Ht,I),v+a)}return s.pending=At(l,v),r}async function i2(s,l,r,a){const c=await qd(s,l,r,At(a,0,yi[l])),f=At(a,yi[l]);if(c[0]!=f[0]||c[1]!=f[1])throw new Error(xa)}async function l2(s,l,r){const a=Gd(new Uint8Array(yi[l])),c=await qd(s,l,r,a);return Ea(a,c)}async function qd(s,l,r,a){s.password=null;const c=await s2(G1,r,J1,!1,q1),f=await o2(Object.assign({salt:a},oa),c,8*(gi[l]*2+2)),d=new Uint8Array(f),m=wi(Ht,At(d,0,gi[l])),g=wi(Ht,At(d,gi[l],gi[l]*2)),w=At(d,gi[l]*2);return Object.assign(s,{keys:{key:m,authentication:g,passwordVerification:w},ctr:new e2(new $1(m),Array.from(_1)),hmac:new t2(g)}),w}async function s2(s,l,r,a,c){if(od)try{return await Si.importKey(s,l,r,a,c)}catch{return od=!1,Kn.importKey(l)}else return Kn.importKey(l)}async function o2(s,l,r){if(ad)try{return await Si.deriveBits(s,l,r)}catch{return ad=!1,Kn.pbkdf2(l,s.salt,oa.iterations,r)}else return Kn.pbkdf2(l,s.salt,oa.iterations,r)}function _d(s,l){return l===qe?Y1(s):l}function Ea(s,l){let r=s;return s.length+l.length&&(r=new Uint8Array(s.length+l.length),r.set(s,0),r.set(l,s.length)),r}function a2(s,l){if(l&&l>s.length){const r=s;s=new Uint8Array(l),s.set(r,0)}return s}function At(s,l,r){return s.subarray(l,r)}function xi(s,l){return s.fromBits(l)}function wi(s,l){return s.toBits(l)}const Cr=12;class u2 extends TransformStream{constructor({password:l,passwordVerification:r,checkPasswordOnly:a}){super({start(){Object.assign(this,{password:l,passwordVerification:r}),$d(this,l)},transform(c,f){const d=this;if(d.password){const m=ud(d,c.subarray(0,Cr));if(d.password=null,m[Cr-1]!=d.passwordVerification)throw new Error(xa);c=c.subarray(Cr)}a?f.error(new Error(Aa)):f.enqueue(ud(d,c))}})}}class c2 extends TransformStream{constructor({password:l,passwordVerification:r}){super({start(){Object.assign(this,{password:l,passwordVerification:r}),$d(this,l)},transform(a,c){const f=this;let d,m;if(f.password){f.password=null;const g=Gd(new Uint8Array(Cr));g[Cr-1]=f.passwordVerification,d=new Uint8Array(a.length+g.length),d.set(cd(f,g),0),m=Cr}else d=new Uint8Array(a.length),m=0;d.set(cd(f,a),m),c.enqueue(d)}})}}function ud(s,l){const r=new Uint8Array(l.length);for(let a=0;a<l.length;a++)r[a]=e0(s)^l[a],Ca(s,r[a]);return r}function cd(s,l){const r=new Uint8Array(l.length);for(let a=0;a<l.length;a++)r[a]=e0(s)^l[a],Ca(s,l[a]);return r}function $d(s,l){const r=[305419896,591751049,878082192];Object.assign(s,{keys:r,crcKey0:new Yl(r[0]),crcKey2:new Yl(r[2])});for(let a=0;a<l.length;a++)Ca(s,l.charCodeAt(a))}function Ca(s,l){let[r,a,c]=s.keys;s.crcKey0.append([l]),r=~s.crcKey0.get(),a=fd(Math.imul(fd(a+t0(r)),134775813)+1),s.crcKey2.append([a>>>24]),c=~s.crcKey2.get(),s.keys=[r,a,c]}function e0(s){const l=s.keys[2]|2;return t0(Math.imul(l,l^1)>>>8)}function t0(s){return s&255}function fd(s){return s&4294967295}const dd="deflate-raw";class f2 extends TransformStream{constructor(l,{chunkSize:r,CompressionStream:a,CompressionStreamNative:c}){super({});const{compressed:f,encrypted:d,useCompressionStream:m,zipCrypto:g,signed:w,level:v}=l,S=this;let I,B,V=n0(super.readable);(!d||g)&&w&&(I=new bd,V=Ft(V,I)),f&&(V=i0(V,m,{level:v,chunkSize:r},c,a)),d&&(g?V=Ft(V,new c2(l)):(B=new r2(l),V=Ft(V,B))),r0(S,V,()=>{let A;d&&!g&&(A=B.signature),(!d||g)&&w&&(A=new DataView(I.value.buffer).getUint32(0)),S.signature=A})}}class d2 extends TransformStream{constructor(l,{chunkSize:r,DecompressionStream:a,DecompressionStreamNative:c}){super({});const{zipCrypto:f,encrypted:d,signed:m,signature:g,compressed:w,useCompressionStream:v}=l;let S,I,B=n0(super.readable);d&&(f?B=Ft(B,new u2(l)):(I=new n2(l),B=Ft(B,I))),w&&(B=i0(B,v,{chunkSize:r},c,a)),(!d||f)&&m&&(S=new bd,B=Ft(B,S)),r0(this,B,()=>{if((!d||f)&&m){const V=new DataView(S.value.buffer);if(g!=V.getUint32(0,!1))throw new Error(wa)}})}}function n0(s){return Ft(s,new TransformStream({transform(l,r){l&&l.length&&r.enqueue(l)}}))}function r0(s,l,r){l=Ft(l,new TransformStream({flush:r})),Object.defineProperty(s,"readable",{get(){return l}})}function i0(s,l,r,a,c){try{const f=l&&a?a:c;s=Ft(s,new f(dd,r))}catch{if(l)try{s=Ft(s,new c(dd,r))}catch{return s}else return s}return s}function Ft(s,l){return s.pipeThrough(l)}const p2="message",h2="start",m2="pull",pd="data",g2="ack",hd="close",v2="deflate",l0="inflate";class y2 extends TransformStream{constructor(l,r){super({});const a=this,{codecType:c}=l;let f;c.startsWith(v2)?f=f2:c.startsWith(l0)&&(f=d2);let d=0,m=0;const g=new f(l,r),w=super.readable,v=new TransformStream({transform(I,B){I&&I.length&&(m+=I.length,B.enqueue(I))},flush(){Object.assign(a,{inputSize:m})}}),S=new TransformStream({transform(I,B){I&&I.length&&(d+=I.length,B.enqueue(I))},flush(){const{signature:I}=g;Object.assign(a,{signature:I,outputSize:d,inputSize:m})}});Object.defineProperty(a,"readable",{get(){return w.pipeThrough(v).pipeThrough(g).pipeThrough(S)}})}}class x2 extends TransformStream{constructor(l){let r;super({transform:a,flush(c){r&&r.length&&c.enqueue(r)}});function a(c,f){if(r){const d=new Uint8Array(r.length+c.length);d.set(r),d.set(c,r.length),c=d,r=null}c.length>l?(f.enqueue(c.slice(0,l)),a(c.slice(l),f)):r=c}}}let s0=typeof Worker!=Rn;class qo{constructor(l,{readable:r,writable:a},{options:c,config:f,streamOptions:d,useWebWorkers:m,transferStreams:g,scripts:w},v){const{signal:S}=d;return Object.assign(l,{busy:!0,readable:r.pipeThrough(new x2(f.chunkSize)).pipeThrough(new w2(r,d),{signal:S}),writable:a,options:Object.assign({},c),scripts:w,transferStreams:g,terminate(){return new Promise(I=>{const{worker:B,busy:V}=l;B?(V?l.resolveTerminated=I:(B.terminate(),I()),l.interface=null):I()})},onTaskFinished(){const{resolveTerminated:I}=l;I&&(l.resolveTerminated=null,l.terminated=!0,l.worker.terminate(),I()),l.busy=!1,v(l)}}),(m&&s0?A2:o0)(l,f)}}class w2 extends TransformStream{constructor(l,{onstart:r,onprogress:a,size:c,onend:f}){let d=0;super({async start(){r&&await _o(r,c)},async transform(m,g){d+=m.length,a&&await _o(a,d,c),g.enqueue(m)},async flush(){l.size=d,f&&await _o(f,d)}})}}async function _o(s,...l){try{await s(...l)}catch{}}function o0(s,l){return{run:()=>E2(s,l)}}function A2(s,l){const{baseURL:r,chunkSize:a}=l;if(!s.interface){let c;try{c=k2(s.scripts[0],r,s)}catch{return s0=!1,o0(s,l)}Object.assign(s,{worker:c,interface:{run:()=>C2(s,{chunkSize:a})}})}return s.interface}async function E2({options:s,readable:l,writable:r,onTaskFinished:a},c){try{const f=new y2(s,c);await l.pipeThrough(f).pipeTo(r,{preventClose:!0,preventAbort:!0});const{signature:d,inputSize:m,outputSize:g}=f;return{signature:d,inputSize:m,outputSize:g}}finally{a()}}async function C2(s,l){let r,a;const c=new Promise((I,B)=>{r=I,a=B});Object.assign(s,{reader:null,writer:null,resolveResult:r,rejectResult:a,result:c});const{readable:f,options:d,scripts:m}=s,{writable:g,closed:w}=S2(s.writable),v=Ul({type:h2,scripts:m.slice(1),options:d,config:l,readable:f,writable:g},s);v||Object.assign(s,{reader:f.getReader(),writer:g.getWriter()});const S=await c;return v||await g.getWriter().close(),await w,S}function S2(s){let l;const r=new Promise(c=>l=c);return{writable:new WritableStream({async write(c){const f=s.getWriter();await f.ready,await f.write(c),f.releaseLock()},close(){l()},abort(c){return s.getWriter().abort(c)}}),closed:r}}let md=!0,gd=!0;function k2(s,l,r){const a={type:"module"};let c,f;typeof s==Ci&&(s=s());try{c=new URL(s,l)}catch{c=s}if(md)try{f=new Worker(c)}catch{md=!1,f=new Worker(c,a)}else f=new Worker(c,a);return f.addEventListener(p2,d=>I2(d,r)),f}function Ul(s,{worker:l,writer:r,onTaskFinished:a,transferStreams:c}){try{const{value:f,readable:d,writable:m}=s,g=[];if(f&&(f.byteLength<f.buffer.byteLength?s.value=f.buffer.slice(0,f.byteLength):s.value=f.buffer,g.push(s.value)),c&&gd?(d&&g.push(d),m&&g.push(m)):s.readable=s.writable=null,g.length)try{return l.postMessage(s,g),!0}catch{gd=!1,s.readable=s.writable=null,l.postMessage(s)}else l.postMessage(s)}catch(f){throw r&&r.releaseLock(),a(),f}}async function I2({data:s},l){const{type:r,value:a,messageId:c,result:f,error:d}=s,{reader:m,writer:g,resolveResult:w,rejectResult:v,onTaskFinished:S}=l;try{if(d){const{message:B,stack:V,code:A,name:y}=d,E=new Error(B);Object.assign(E,{stack:V,code:A,name:y}),I(E)}else{if(r==m2){const{value:B,done:V}=await m.read();Ul({type:pd,value:B,done:V,messageId:c},l)}r==pd&&(await g.ready,await g.write(new Uint8Array(a)),Ul({type:g2,messageId:c},l)),r==hd&&I(null,f)}}catch(B){Ul({type:hd,messageId:c},l),I(B)}function I(B,V){B?v(B):w(V),g&&g.releaseLock(),S()}}let In=[];const $o=[];let vd=0;async function R2(s,l){const{options:r,config:a}=l,{transferStreams:c,useWebWorkers:f,useCompressionStream:d,codecType:m,compressed:g,signed:w,encrypted:v}=r,{workerScripts:S,maxWorkers:I}=a;l.transferStreams=c||c===qe;const B=!g&&!w&&!v&&!l.transferStreams;return l.useWebWorkers=!B&&(f||f===qe&&a.useWebWorkers),l.scripts=l.useWebWorkers&&S?S[m]:[],r.useCompressionStream=d||d===qe&&a.useCompressionStream,(await V()).run();async function V(){const y=In.find(E=>!E.busy);if(y)return aa(y),new qo(y,s,l,A);if(In.length<I){const E={indexWorker:vd};return vd++,In.push(E),new qo(E,s,l,A)}else return new Promise(E=>$o.push({resolve:E,stream:s,workerOptions:l}))}function A(y){if($o.length){const[{resolve:E,stream:j,workerOptions:O}]=$o.splice(0,1);E(new qo(y,j,O,A))}else y.worker?(aa(y),T2(y,l)):In=In.filter(E=>E!=y)}}function T2(s,l){const{config:r}=l,{terminateWorkerTimeout:a}=r;Number.isFinite(a)&&a>=0&&(s.terminated?s.terminated=!1:s.terminateTimeout=setTimeout(async()=>{In=In.filter(c=>c!=s);try{await s.terminate()}catch{}},a))}function aa(s){const{terminateTimeout:l}=s;l&&(clearTimeout(l),s.terminateTimeout=null)}async function j2(){await Promise.allSettled(In.map(s=>(aa(s),s.terminate())))}const a0="HTTP error ",ki="HTTP Range not supported",u0="Writer iterator completed too soon",P2="text/plain",O2="Content-Length",D2="Content-Range",N2="Accept-Ranges",M2="Range",B2="Content-Type",H2="HEAD",Sa="GET",c0="bytes",F2=64*1024,ka="writable";class ql{constructor(){this.size=0}init(){this.initialized=!0}}class Tn extends ql{get readable(){const l=this,{chunkSize:r=F2}=l,a=new ReadableStream({start(){this.chunkOffset=0},async pull(c){const{offset:f=0,size:d,diskNumberStart:m}=a,{chunkOffset:g}=this;c.enqueue(await ze(l,f+g,Math.min(r,d-g),m)),g+r>d?c.close():this.chunkOffset+=r}});return a}}class Ia extends ql{constructor(){super();const l=this,r=new WritableStream({write(a){return l.writeUint8Array(a)}});Object.defineProperty(l,ka,{get(){return r}})}writeUint8Array(){}}class Q2 extends Tn{constructor(l){super();let r=l.length;for(;l.charAt(r-1)=="=";)r--;const a=l.indexOf(",")+1;Object.assign(this,{dataURI:l,dataStart:a,size:Math.floor((r-a)*.75)})}readUint8Array(l,r){const{dataStart:a,dataURI:c}=this,f=new Uint8Array(r),d=Math.floor(l/3)*4,m=atob(c.substring(d+a,Math.ceil((l+r)/3)*4+a)),g=l-Math.floor(d/4)*3;for(let w=g;w<g+r;w++)f[w-g]=m.charCodeAt(w);return f}}class L2 extends Ia{constructor(l){super(),Object.assign(this,{data:"data:"+(l||"")+";base64,",pending:[]})}writeUint8Array(l){const r=this;let a=0,c=r.pending;const f=r.pending.length;for(r.pending="",a=0;a<Math.floor((f+l.length)/3)*3-f;a++)c+=String.fromCharCode(l[a]);for(;a<l.length;a++)r.pending+=String.fromCharCode(l[a]);c.length>2?r.data+=btoa(c):r.pending=c}getData(){return this.data+btoa(this.pending)}}class Ra extends Tn{constructor(l){super(),Object.assign(this,{blob:l,size:l.size})}async readUint8Array(l,r){const a=this,c=l+r;let d=await(l||c<a.size?a.blob.slice(l,c):a.blob).arrayBuffer();return d.byteLength>r&&(d=d.slice(l,c)),new Uint8Array(d)}}class f0 extends ql{constructor(l){super();const r=this,a=new TransformStream,c=[];l&&c.push([B2,l]),Object.defineProperty(r,ka,{get(){return a.writable}}),r.blob=new Response(a.readable,{headers:c}).blob()}getData(){return this.blob}}class U2 extends Ra{constructor(l){super(new Blob([l],{type:P2}))}}class W2 extends f0{constructor(l){super(l),Object.assign(this,{encoding:l,utf8:!l||l.toLowerCase()=="utf-8"})}async getData(){const{encoding:l,utf8:r}=this,a=await super.getData();if(a.text&&r)return a.text();{const c=new FileReader;return new Promise((f,d)=>{Object.assign(c,{onload:({target:m})=>f(m.result),onerror:()=>d(c.error)}),c.readAsText(a,l)})}}}class V2 extends Tn{constructor(l,r){super(),d0(this,l,r)}async init(){await p0(this,ua,yd),super.init()}readUint8Array(l,r){return h0(this,l,r,ua,yd)}}class b2 extends Tn{constructor(l,r){super(),d0(this,l,r)}async init(){await p0(this,ca,xd),super.init()}readUint8Array(l,r){return h0(this,l,r,ca,xd)}}function d0(s,l,r){const{preventHeadRequest:a,useRangeHeader:c,forceRangeRequests:f,combineSizeEocd:d}=r;r=Object.assign({},r),delete r.preventHeadRequest,delete r.useRangeHeader,delete r.forceRangeRequests,delete r.combineSizeEocd,delete r.useXHR,Object.assign(s,{url:l,options:r,preventHeadRequest:a,useRangeHeader:c,forceRangeRequests:f,combineSizeEocd:d})}async function p0(s,l,r){const{url:a,preventHeadRequest:c,useRangeHeader:f,forceRangeRequests:d,combineSizeEocd:m}=s;if(G2(a)&&(f||d)&&(typeof c>"u"||c)){const g=await l(Sa,s,m0(s,m?-22:void 0));if(!d&&g.headers.get(N2)!=c0)throw new Error(ki);{m&&(s.eocdCache=new Uint8Array(await g.arrayBuffer()));let w;const v=g.headers.get(D2);if(v){const S=v.trim().split(/\s*\/\s*/);if(S.length){const I=S[1];I&&I!="*"&&(w=Number(I))}}w===qe?await wd(s,l,r):s.size=w}}else await wd(s,l,r)}async function h0(s,l,r,a,c){const{useRangeHeader:f,forceRangeRequests:d,eocdCache:m,size:g,options:w}=s;if(f||d){if(m&&l==g-Sn&&r==Sn)return m;const v=await a(Sa,s,m0(s,l,r));if(v.status!=206)throw new Error(ki);return new Uint8Array(await v.arrayBuffer())}else{const{data:v}=s;return v||await c(s,w),new Uint8Array(s.data.subarray(l,l+r))}}function m0(s,l=0,r=1){return Object.assign({},Ta(s),{[M2]:c0+"="+(l<0?l:l+"-"+(l+r-1))})}function Ta({options:s}){const{headers:l}=s;if(l)return Symbol.iterator in l?Object.fromEntries(l):l}async function yd(s){await g0(s,ua)}async function xd(s){await g0(s,ca)}async function g0(s,l){const r=await l(Sa,s,Ta(s));s.data=new Uint8Array(await r.arrayBuffer()),s.size||(s.size=s.data.length)}async function wd(s,l,r){if(s.preventHeadRequest)await r(s,s.options);else{const c=(await l(H2,s,Ta(s))).headers.get(O2);c?s.size=Number(c):await r(s,s.options)}}async function ua(s,{options:l,url:r},a){const c=await fetch(r,Object.assign({},l,{method:s,headers:a}));if(c.status<400)return c;throw c.status==416?new Error(ki):new Error(a0+(c.statusText||c.status))}function ca(s,{url:l},r){return new Promise((a,c)=>{const f=new XMLHttpRequest;if(f.addEventListener("load",()=>{if(f.status<400){const d=[];f.getAllResponseHeaders().trim().split(/[\r\n]+/).forEach(m=>{const g=m.trim().split(/\s*:\s*/);g[0]=g[0].trim().replace(/^[a-z]|-[a-z]/g,w=>w.toUpperCase()),d.push(g)}),a({status:f.status,arrayBuffer:()=>f.response,headers:new Map(d)})}else c(f.status==416?new Error(ki):new Error(a0+(f.statusText||f.status)))},!1),f.addEventListener("error",d=>c(d.detail?d.detail.error:new Error("Network error")),!1),f.open(s,l),r)for(const d of Object.entries(r))f.setRequestHeader(d[0],d[1]);f.responseType="arraybuffer",f.send()})}class v0 extends Tn{constructor(l,r={}){super(),Object.assign(this,{url:l,reader:r.useXHR?new b2(l,r):new V2(l,r)})}set size(l){}get size(){return this.reader.size}async init(){await this.reader.init(),super.init()}readUint8Array(l,r){return this.reader.readUint8Array(l,r)}}class Y2 extends v0{constructor(l,r={}){r.useRangeHeader=!0,super(l,r)}}class z2 extends Tn{constructor(l){super(),Object.assign(this,{array:l,size:l.length})}readUint8Array(l,r){return this.array.slice(l,l+r)}}class X2 extends Ia{init(l=0){Object.assign(this,{offset:0,array:new Uint8Array(l)}),super.init()}writeUint8Array(l){const r=this;if(r.offset+l.length>r.array.length){const a=r.array;r.array=new Uint8Array(a.length+l.length),r.array.set(a)}r.array.set(l,r.offset),r.offset+=l.length}getData(){return this.array}}class ja extends Tn{constructor(l){super(),this.readers=l}async init(){const l=this,{readers:r}=l;l.lastDiskNumber=0,l.lastDiskOffset=0,await Promise.all(r.map(async(a,c)=>{await a.init(),c!=r.length-1&&(l.lastDiskOffset+=a.size),l.size+=a.size})),super.init()}async readUint8Array(l,r,a=0){const c=this,{readers:f}=this;let d,m=a;m==-1&&(m=f.length-1);let g=l;for(;g>=f[m].size;)g-=f[m].size,m++;const w=f[m],v=w.size;if(g+r<=v)d=await ze(w,g,r);else{const S=v-g;d=new Uint8Array(r),d.set(await ze(w,g,S)),d.set(await c.readUint8Array(l+S,r-S,a),S)}return c.lastDiskNumber=Math.max(m,c.lastDiskNumber),d}}class Xl extends ql{constructor(l,r=4294967295){super();const a=this;Object.assign(a,{diskNumber:0,diskOffset:0,size:0,maxSize:r,availableSize:r});let c,f,d;const m=new WritableStream({async write(v){const{availableSize:S}=a;if(d)v.length>=S?(await g(v.slice(0,S)),await w(),a.diskOffset+=c.size,a.diskNumber++,d=null,await this.write(v.slice(S))):await g(v);else{const{value:I,done:B}=await l.next();if(B&&!I)throw new Error(u0);c=I,c.size=0,c.maxSize&&(a.maxSize=c.maxSize),a.availableSize=a.maxSize,await Ai(c),f=I.writable,d=f.getWriter(),await this.write(v)}},async close(){await d.ready,await w()}});Object.defineProperty(a,ka,{get(){return m}});async function g(v){const S=v.length;S&&(await d.ready,await d.write(v),c.size+=S,a.size+=S,a.availableSize-=S)}async function w(){f.size=c.size,await d.close()}}}function G2(s){const{baseURL:l}=Ud(),{protocol:r}=new URL(s,l);return r=="http:"||r=="https:"}async function Ai(s,l){if(s.init&&!s.initialized)await s.init(l);else return Promise.resolve()}function y0(s){return Array.isArray(s)&&(s=new ja(s)),s instanceof ReadableStream&&(s={readable:s}),s}function x0(s){s.writable===qe&&typeof s.next==Ci&&(s=new Xl(s)),s instanceof WritableStream&&(s={writable:s});const{writable:l}=s;return l.size===qe&&(l.size=0),s instanceof Xl||Object.assign(s,{diskNumber:0,diskOffset:0,availableSize:1/0,maxSize:1/0}),s}function ze(s,l,r,a){return s.readUint8Array(l,r,a)}const K2=ja,Z2=Xl,w0="\0☺☻♥♦♣♠•◘○◙♂♀♪♫☼►◄↕‼¶§▬↨↑↓→←∟↔▲▼ !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~⌂ÇüéâäàåçêëèïîìÄÅÉæÆôöòûùÿÖÜ¢£¥₧ƒáíóúñÑªº¿⌐¬½¼¡«»░▒▓│┤╡╢╖╕╣║╗╝╜╛┐└┴┬├─┼╞╟╚╔╩╦╠═╬╧╨╤╥╙╘╒╓╫╪┘┌█▄▌▐▀αßΓπΣσµτΦΘΩδ∞φε∩≡±≥≤⌠⌡÷≈°∙·√ⁿ²■ ".split(""),J2=w0.length==256;function q2(s){if(J2){let l="";for(let r=0;r<s.length;r++)l+=w0[s[r]];return l}else return new TextDecoder().decode(s)}function Wl(s,l){return l&&l.trim().toLowerCase()=="cp437"?q2(s):new TextDecoder(l).decode(s)}const A0="filename",E0="rawFilename",C0="comment",S0="rawComment",k0="uncompressedSize",I0="compressedSize",R0="offset",fa="diskNumberStart",da="lastModDate",pa="rawLastModDate",T0="lastAccessDate",_2="rawLastAccessDate",j0="creationDate",$2="rawCreationDate",em="internalFileAttribute",tm="internalFileAttributes",nm="externalFileAttribute",rm="externalFileAttributes",im="msDosCompatible",lm="zip64",sm="encrypted",om="version",am="versionMadeBy",um="zipCrypto",cm="directory",fm="executable",dm=[A0,E0,I0,k0,da,pa,C0,S0,T0,j0,R0,fa,fa,em,tm,nm,rm,im,lm,sm,om,am,um,cm,fm,"bitFlag","signature","filenameUTF8","commentUTF8","compressionMethod","extraField","rawExtraField","extraFieldZip64","extraFieldUnicodePath","extraFieldUnicodeComment","extraFieldAES","extraFieldNTFS","extraFieldExtendedTimestamp"];class Ad{constructor(l){dm.forEach(r=>this[r]=l[r])}}const Vl="File format is not recognized",P0="End of central directory not found",O0="End of Zip64 central directory locator not found",D0="Central directory header not found",N0="Local file header not found",M0="Zip64 extra field not found",B0="File contains encrypted entry",H0="Encryption method not supported",ha="Compression method not supported",ma="Split zip file",Ed="utf-8",Cd="cp437",pm=[[k0,Xn],[I0,Xn],[R0,Xn],[fa,Cn]],hm={[Cn]:{getValue:Me,bytes:4},[Xn]:{getValue:bl,bytes:8}};class F0{constructor(l,r={}){Object.assign(this,{reader:y0(l),options:r,config:Ud()})}async*getEntriesGenerator(l={}){const r=this;let{reader:a}=r;const{config:c}=r;if(await Ai(a),(a.size===qe||!a.readUint8Array)&&(a=new Ra(await new Response(a.readable).blob()),await Ai(a)),a.size<Sn)throw new Error(Vl);a.chunkSize=V1(c);const f=await Am(a,j1,a.size,Sn,Cn*16);if(!f){const U=await ze(a,0,4),W=Ve(U);throw Me(W)==T1?new Error(ma):new Error(P0)}const d=Ve(f);let m=Me(d,12),g=Me(d,16);const w=f.offset,v=We(d,20),S=w+Sn+v;let I=We(d,4);const B=a.lastDiskNumber||0;let V=We(d,6),A=We(d,8),y=0,E=0;if(g==Xn||m==Xn||A==Cn||V==Cn){const U=await ze(a,f.offset-Zo,Zo),W=Ve(U);if(Me(W,0)==P1){g=bl(W,8);let re=await ze(a,g,Jo,-1),J=Ve(re);const ce=f.offset-Zo-Jo;if(Me(J,0)!=_f&&g!=ce){const oe=g;g=ce,y=g-oe,re=await ze(a,g,Jo,-1),J=Ve(re)}if(Me(J,0)!=_f)throw new Error(O0);I==Cn&&(I=Me(J,16)),V==Cn&&(V=Me(J,20)),A==Cn&&(A=bl(J,32)),m==Xn&&(m=bl(J,40)),g-=m}}if(g>=a.size&&(y=a.size-g-m-Sn,g=a.size-m-Sn),B!=I)throw new Error(ma);if(g<0)throw new Error(Vl);let j=0,O=await ze(a,g,m,V),H=Ve(O);if(m){const U=f.offset-m;if(Me(H,j)!=qf&&g!=U){const W=g;g=U,y+=g-W,O=await ze(a,g,m,V),H=Ve(O)}}const G=f.offset-g-(a.lastDiskOffset||0);if(m!=G&&G>=0&&(m=G,O=await ze(a,g,m,V),H=Ve(O)),g<0||g>=a.size)throw new Error(Vl);const D=et(r,l,"filenameEncoding"),F=et(r,l,"commentEncoding");for(let U=0;U<A;U++){const W=new gm(a,c,r.options);if(Me(H,j)!=qf)throw new Error(D0);Q0(W,H,j+6);const re=!!W.bitFlag.languageEncodingFlag,J=j+46,ce=J+W.filenameLength,oe=ce+W.extraFieldLength,ie=We(H,j+4),de=ie>>8==0,b=ie>>8==3,ee=O.subarray(J,ce),L=We(H,j+32),R=oe+L,M=O.subarray(oe,R),$=re,pe=re,me=Me(H,j+38),ge=de&&(Sr(H,j+38)&nd)==nd||b&&(me>>16&rd)==rd||ee.length&&ee[ee.length-1]==ld.charCodeAt(0),Ee=b&&(me>>16&id)==id,xe=Me(H,j+42)+y;Object.assign(W,{versionMadeBy:ie,msDosCompatible:de,compressedSize:0,uncompressedSize:0,commentLength:L,directory:ge,offset:xe,diskNumberStart:We(H,j+34),internalFileAttributes:We(H,j+36),externalFileAttributes:me,rawFilename:ee,filenameUTF8:$,commentUTF8:pe,rawExtraField:O.subarray(ce,oe),executable:Ee}),W.internalFileAttribute=W.internalFileAttributes,W.externalFileAttribute=W.externalFileAttributes;const Ce=et(r,l,"decodeText")||Wl,Xe=$?Ed:D||Cd,jn=pe?Ed:F||Cd;let Pn=Ce(ee,Xe);Pn===qe&&(Pn=Wl(ee,Xe));let _t=Ce(M,jn);_t===qe&&(_t=Wl(M,jn)),Object.assign(W,{rawComment:M,filename:Pn,comment:_t,directory:ge||Pn.endsWith(ld)}),E=Math.max(xe,E),L0(W,W,H,j+6),W.zipCrypto=W.encrypted&&!W.extraFieldAES;const On=new Ad(W);On.getData=(Rr,Tr)=>W.getData(Rr,On,Tr),j=R;const{onprogress:Ir}=l;if(Ir)try{await Ir(U+1,A,new Ad(W))}catch{}yield On}const Q=et(r,l,"extractPrependedData"),X=et(r,l,"extractAppendedData");return Q&&(r.prependedData=E>0?await ze(a,0,E):new Uint8Array),r.comment=v?await ze(a,w+Sn,v):new Uint8Array,X&&(r.appendedData=S<a.size?await ze(a,S,a.size-S):new Uint8Array),!0}async getEntries(l={}){const r=[];for await(const a of this.getEntriesGenerator(l))r.push(a);return r}async close(){}}class mm{constructor(l={}){const{readable:r,writable:a}=new TransformStream,c=new F0(r,l).getEntriesGenerator();this.readable=new ReadableStream({async pull(f){const{done:d,value:m}=await c.next();if(d)return f.close();const g={...m,readable:function(){const{readable:w,writable:v}=new TransformStream;if(m.getData)return m.getData(v),w}()};delete g.getData,f.enqueue(g)}}),this.writable=a}}class gm{constructor(l,r,a){Object.assign(this,{reader:l,config:r,options:a})}async getData(l,r,a={}){const c=this,{reader:f,offset:d,diskNumberStart:m,extraFieldAES:g,compressionMethod:w,config:v,bitFlag:S,signature:I,rawLastModDate:B,uncompressedSize:V,compressedSize:A}=c,y=r.localDirectory={},E=await ze(f,d,30,m),j=Ve(E);let O=et(c,a,"password"),H=et(c,a,"rawPassword");const G=et(c,a,"passThrough");if(O=O&&O.length&&O,H=H&&H.length&&H,g&&g.originalCompressionMethod!=I1)throw new Error(ha);if(w!=k1&&w!=S1&&!G)throw new Error(ha);if(Me(j,0)!=R1)throw new Error(N0);Q0(y,j,4),y.rawExtraField=y.extraFieldLength?await ze(f,d+30+y.filenameLength,y.extraFieldLength,m):new Uint8Array,L0(c,y,j,4,!0),Object.assign(r,{lastAccessDate:y.lastAccessDate,creationDate:y.creationDate});const D=c.encrypted&&y.encrypted&&!G,F=D&&!g;if(G||(r.zipCrypto=F),D){if(!F&&g.strength===qe)throw new Error(H0);if(!O&&!H)throw new Error(B0)}const Q=d+30+y.filenameLength+y.extraFieldLength,X=A,U=f.readable;Object.assign(U,{diskNumberStart:m,offset:Q,size:X});const W=et(c,a,"signal"),re=et(c,a,"checkPasswordOnly");re&&(l=new WritableStream),l=x0(l),await Ai(l,G?A:V);const{writable:J}=l,{onstart:ce,onprogress:oe,onend:ie}=a,de={options:{codecType:l0,password:O,rawPassword:H,zipCrypto:F,encryptionStrength:g&&g.strength,signed:et(c,a,"checkSignature")&&!G,passwordVerification:F&&(S.dataDescriptor?B>>>8&255:I>>>24&255),signature:I,compressed:w!=0&&!G,encrypted:c.encrypted&&!G,useWebWorkers:et(c,a,"useWebWorkers"),useCompressionStream:et(c,a,"useCompressionStream"),transferStreams:et(c,a,"transferStreams"),checkPasswordOnly:re},config:v,streamOptions:{signal:W,size:X,onstart:ce,onprogress:oe,onend:ie}};let b=0;try{({outputSize:b}=await R2({readable:U,writable:J},de))}catch(ee){if(!re||ee.message!=Aa)throw ee}finally{const ee=et(c,a,"preventClose");J.size+=b,!ee&&!J.locked&&await J.getWriter().close()}return re?qe:l.getData?l.getData():J}}function Q0(s,l,r){const a=s.rawBitFlag=We(l,r+2),c=(a&$f)==$f,f=Me(l,r+6);Object.assign(s,{encrypted:c,version:We(l,r),bitFlag:{level:(a&L1)>>1,dataDescriptor:(a&ed)==ed,languageEncodingFlag:(a&td)==td},rawLastModDate:f,lastModDate:Em(f),filenameLength:We(l,r+22),extraFieldLength:We(l,r+24)})}function L0(s,l,r,a,c){const{rawExtraField:f}=l,d=l.extraField=new Map,m=Ve(new Uint8Array(f));let g=0;try{for(;g<f.length;){const E=We(m,g),j=We(m,g+2);d.set(E,{type:E,data:f.slice(g+4,g+4+j)}),g+=4+j}}catch{}const w=We(r,a+4);Object.assign(l,{signature:Me(r,a+10),uncompressedSize:Me(r,a+18),compressedSize:Me(r,a+14)});const v=d.get(O1);v&&(vm(v,l),l.extraFieldZip64=v);const S=d.get(H1);S&&(Sd(S,A0,E0,l,s),l.extraFieldUnicodePath=S);const I=d.get(F1);I&&(Sd(I,C0,S0,l,s),l.extraFieldUnicodeComment=I);const B=d.get(D1);B?(ym(B,l,w),l.extraFieldAES=B):l.compressionMethod=w;const V=d.get(N1);V&&(xm(V,l),l.extraFieldNTFS=V);const A=d.get(B1);A&&(wm(A,l,c),l.extraFieldExtendedTimestamp=A);const y=d.get(Q1);y&&(l.extraFieldUSDZ=y)}function vm(s,l){l.zip64=!0;const r=Ve(s.data),a=pm.filter(([c,f])=>l[c]==f);for(let c=0,f=0;c<a.length;c++){const[d,m]=a[c];if(l[d]==m){const g=hm[m];l[d]=s[d]=g.getValue(r,f),f+=g.bytes}else if(s[d])throw new Error(M0)}}function Sd(s,l,r,a,c){const f=Ve(s.data),d=new Yl;d.append(c[r]);const m=Ve(new Uint8Array(4));m.setUint32(0,d.get(),!0);const g=Me(f,1);Object.assign(s,{version:Sr(f,0),[l]:Wl(s.data.subarray(5)),valid:!c.bitFlag.languageEncodingFlag&&g==Me(m,0)}),s.valid&&(a[l]=s[l],a[l+"UTF8"]=!0)}function ym(s,l,r){const a=Ve(s.data),c=Sr(a,4);Object.assign(s,{vendorVersion:Sr(a,0),vendorId:Sr(a,2),strength:c,originalCompressionMethod:r,compressionMethod:We(a,5)}),l.compressionMethod=s.compressionMethod}function xm(s,l){const r=Ve(s.data);let a=4,c;try{for(;a<s.data.length&&!c;){const f=We(r,a),d=We(r,a+2);f==M1&&(c=s.data.slice(a+4,a+4+d)),a+=4+d}}catch{}try{if(c&&c.length==24){const f=Ve(c),d=f.getBigUint64(0,!0),m=f.getBigUint64(8,!0),g=f.getBigUint64(16,!0);Object.assign(s,{rawLastModDate:d,rawLastAccessDate:m,rawCreationDate:g});const w=ea(d),v=ea(m),S=ea(g),I={lastModDate:w,lastAccessDate:v,creationDate:S};Object.assign(s,I),Object.assign(l,I)}}catch{}}function wm(s,l,r){const a=Ve(s.data),c=Sr(a,0),f=[],d=[];r?((c&1)==1&&(f.push(da),d.push(pa)),(c&2)==2&&(f.push(T0),d.push(_2)),(c&4)==4&&(f.push(j0),d.push($2))):s.data.length>=5&&(f.push(da),d.push(pa));let m=1;f.forEach((g,w)=>{if(s.data.length>=m+4){const v=Me(a,m);l[g]=s[g]=new Date(v*1e3);const S=d[w];s[S]=v}m+=4})}async function Am(s,l,r,a,c){const f=new Uint8Array(4),d=Ve(f);Cm(d,0,l);const m=a+c;return await g(a)||await g(Math.min(m,r));async function g(w){const v=r-w,S=await ze(s,v,w);for(let I=S.length-a;I>=0;I--)if(S[I]==f[0]&&S[I+1]==f[1]&&S[I+2]==f[2]&&S[I+3]==f[3])return{offset:v+I,buffer:S.slice(I,I+a).buffer}}}function et(s,l,r){return l[r]===qe?s.options[r]:l[r]}function Em(s){const l=(s&4294901760)>>16,r=s&65535;try{return new Date(1980+((l&65024)>>9),((l&480)>>5)-1,l&31,(r&63488)>>11,(r&2016)>>5,(r&31)*2,0)}catch{}}function ea(s){return new Date(Number(s/BigInt(1e4)-BigInt(116444736e5)))}function Sr(s,l){return s.getUint8(l)}function We(s,l){return s.getUint16(l,!0)}function Me(s,l){return s.getUint32(l,!0)}function bl(s,l){return Number(s.getBigUint64(l,!0))}function Cm(s,l,r){s.setUint32(l,r,!0)}function Ve(s){return new DataView(s.buffer)}Wd({Inflate:C1});const Sm=Object.freeze(Object.defineProperty({__proto__:null,BlobReader:Ra,BlobWriter:f0,Data64URIReader:Q2,Data64URIWriter:L2,ERR_BAD_FORMAT:Vl,ERR_CENTRAL_DIRECTORY_NOT_FOUND:D0,ERR_ENCRYPTED:B0,ERR_EOCDR_LOCATOR_ZIP64_NOT_FOUND:O0,ERR_EOCDR_NOT_FOUND:P0,ERR_EXTRAFIELD_ZIP64_NOT_FOUND:M0,ERR_HTTP_RANGE:ki,ERR_INVALID_PASSWORD:xa,ERR_INVALID_SIGNATURE:wa,ERR_ITERATOR_COMPLETED_TOO_SOON:u0,ERR_LOCAL_FILE_HEADER_NOT_FOUND:N0,ERR_SPLIT_ZIP_FILE:ma,ERR_UNSUPPORTED_COMPRESSION:ha,ERR_UNSUPPORTED_ENCRYPTION:H0,HttpRangeReader:Y2,HttpReader:v0,Reader:Tn,SplitDataReader:ja,SplitDataWriter:Xl,SplitZipReader:K2,SplitZipWriter:Z2,TextReader:U2,TextWriter:W2,Uint8ArrayReader:z2,Uint8ArrayWriter:X2,Writer:Ia,ZipReader:F0,ZipReaderStream:mm,configure:Wd,getMimeType:b1,initReader:y0,initStream:Ai,initWriter:x0,readUint8Array:ze,terminateWorkers:j2},Symbol.toStringTag,{value:"Module"}));var se=ya();const Gn=e1(se);var Ql={},ta={exports:{}},ot={},na={exports:{}},ra={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kd;function km(){return kd||(kd=1,function(s){function l(b,ee){var L=b.length;b.push(ee);e:for(;0<L;){var R=L-1>>>1,M=b[R];if(0<c(M,ee))b[R]=ee,b[L]=M,L=R;else break e}}function r(b){return b.length===0?null:b[0]}function a(b){if(b.length===0)return null;var ee=b[0],L=b.pop();if(L!==ee){b[0]=L;e:for(var R=0,M=b.length,$=M>>>1;R<$;){var pe=2*(R+1)-1,me=b[pe],ge=pe+1,Ee=b[ge];if(0>c(me,L))ge<M&&0>c(Ee,me)?(b[R]=Ee,b[ge]=L,R=ge):(b[R]=me,b[pe]=L,R=pe);else if(ge<M&&0>c(Ee,L))b[R]=Ee,b[ge]=L,R=ge;else break e}}return ee}function c(b,ee){var L=b.sortIndex-ee.sortIndex;return L!==0?L:b.id-ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var f=performance;s.unstable_now=function(){return f.now()}}else{var d=Date,m=d.now();s.unstable_now=function(){return d.now()-m}}var g=[],w=[],v=1,S=null,I=3,B=!1,V=!1,A=!1,y=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,j=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function O(b){for(var ee=r(w);ee!==null;){if(ee.callback===null)a(w);else if(ee.startTime<=b)a(w),ee.sortIndex=ee.expirationTime,l(g,ee);else break;ee=r(w)}}function H(b){if(A=!1,O(b),!V)if(r(g)!==null)V=!0,ie(G);else{var ee=r(w);ee!==null&&de(H,ee.startTime-b)}}function G(b,ee){V=!1,A&&(A=!1,E(Q),Q=-1),B=!0;var L=I;try{for(O(ee),S=r(g);S!==null&&(!(S.expirationTime>ee)||b&&!W());){var R=S.callback;if(typeof R=="function"){S.callback=null,I=S.priorityLevel;var M=R(S.expirationTime<=ee);ee=s.unstable_now(),typeof M=="function"?S.callback=M:S===r(g)&&a(g),O(ee)}else a(g);S=r(g)}if(S!==null)var $=!0;else{var pe=r(w);pe!==null&&de(H,pe.startTime-ee),$=!1}return $}finally{S=null,I=L,B=!1}}var D=!1,F=null,Q=-1,X=5,U=-1;function W(){return!(s.unstable_now()-U<X)}function re(){if(F!==null){var b=s.unstable_now();U=b;var ee=!0;try{ee=F(!0,b)}finally{ee?J():(D=!1,F=null)}}else D=!1}var J;if(typeof j=="function")J=function(){j(re)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,oe=ce.port2;ce.port1.onmessage=re,J=function(){oe.postMessage(null)}}else J=function(){y(re,0)};function ie(b){F=b,D||(D=!0,J())}function de(b,ee){Q=y(function(){b(s.unstable_now())},ee)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(b){b.callback=null},s.unstable_continueExecution=function(){V||B||(V=!0,ie(G))},s.unstable_forceFrameRate=function(b){0>b||125<b?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):X=0<b?Math.floor(1e3/b):5},s.unstable_getCurrentPriorityLevel=function(){return I},s.unstable_getFirstCallbackNode=function(){return r(g)},s.unstable_next=function(b){switch(I){case 1:case 2:case 3:var ee=3;break;default:ee=I}var L=I;I=ee;try{return b()}finally{I=L}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(b,ee){switch(b){case 1:case 2:case 3:case 4:case 5:break;default:b=3}var L=I;I=b;try{return ee()}finally{I=L}},s.unstable_scheduleCallback=function(b,ee,L){var R=s.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?R+L:R):L=R,b){case 1:var M=-1;break;case 2:M=250;break;case 5:M=1073741823;break;case 4:M=1e4;break;default:M=5e3}return M=L+M,b={id:v++,callback:ee,priorityLevel:b,startTime:L,expirationTime:M,sortIndex:-1},L>R?(b.sortIndex=L,l(w,b),r(g)===null&&b===r(w)&&(A?(E(Q),Q=-1):A=!0,de(H,L-R))):(b.sortIndex=M,l(g,b),V||B||(V=!0,ie(G))),b},s.unstable_shouldYield=W,s.unstable_wrapCallback=function(b){var ee=I;return function(){var L=I;I=ee;try{return b.apply(this,arguments)}finally{I=L}}}}(ra)),ra}var Id;function Im(){return Id||(Id=1,na.exports=km()),na.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rd;function Rm(){if(Rd)return ot;Rd=1;var s=ya(),l=Im();function r(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,c={};function f(e,t){d(e,t),d(e+"Capture",t)}function d(e,t){for(c[e]=t,e=0;e<t.length;e++)a.add(t[e])}var m=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),g=Object.prototype.hasOwnProperty,w=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,v={},S={};function I(e){return g.call(S,e)?!0:g.call(v,e)?!1:w.test(e)?S[e]=!0:(v[e]=!0,!1)}function B(e,t,n,i){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function V(e,t,n,i){if(t===null||typeof t>"u"||B(e,t,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function A(e,t,n,i,o,u,p){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=u,this.removeEmptyString=p}var y={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){y[e]=new A(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];y[t]=new A(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){y[e]=new A(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){y[e]=new A(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){y[e]=new A(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){y[e]=new A(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){y[e]=new A(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){y[e]=new A(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){y[e]=new A(e,5,!1,e.toLowerCase(),null,!1,!1)});var E=/[\-:]([a-z])/g;function j(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(E,j);y[t]=new A(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(E,j);y[t]=new A(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(E,j);y[t]=new A(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){y[e]=new A(e,1,!1,e.toLowerCase(),null,!1,!1)}),y.xlinkHref=new A("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){y[e]=new A(e,1,!1,e.toLowerCase(),null,!0,!0)});function O(e,t,n,i){var o=y.hasOwnProperty(t)?y[t]:null;(o!==null?o.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(V(t,n,o,i)&&(n=null),i||o===null?I(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=n===null?o.type===3?!1:"":n:(t=o.attributeName,i=o.attributeNamespace,n===null?e.removeAttribute(t):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}var H=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,G=Symbol.for("react.element"),D=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),Q=Symbol.for("react.strict_mode"),X=Symbol.for("react.profiler"),U=Symbol.for("react.provider"),W=Symbol.for("react.context"),re=Symbol.for("react.forward_ref"),J=Symbol.for("react.suspense"),ce=Symbol.for("react.suspense_list"),oe=Symbol.for("react.memo"),ie=Symbol.for("react.lazy"),de=Symbol.for("react.offscreen"),b=Symbol.iterator;function ee(e){return e===null||typeof e!="object"?null:(e=b&&e[b]||e["@@iterator"],typeof e=="function"?e:null)}var L=Object.assign,R;function M(e){if(R===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);R=t&&t[1]||""}return`
`+R+e}var $=!1;function pe(e,t){if(!e||$)return"";$=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(N){var i=N}Reflect.construct(e,[],t)}else{try{t.call()}catch(N){i=N}e.call(t.prototype)}else{try{throw Error()}catch(N){i=N}e()}}catch(N){if(N&&i&&typeof N.stack=="string"){for(var o=N.stack.split(`
`),u=i.stack.split(`
`),p=o.length-1,x=u.length-1;1<=p&&0<=x&&o[p]!==u[x];)x--;for(;1<=p&&0<=x;p--,x--)if(o[p]!==u[x]){if(p!==1||x!==1)do if(p--,x--,0>x||o[p]!==u[x]){var C=`
`+o[p].replace(" at new "," at ");return e.displayName&&C.includes("<anonymous>")&&(C=C.replace("<anonymous>",e.displayName)),C}while(1<=p&&0<=x);break}}}finally{$=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?M(e):""}function me(e){switch(e.tag){case 5:return M(e.type);case 16:return M("Lazy");case 13:return M("Suspense");case 19:return M("SuspenseList");case 0:case 2:case 15:return e=pe(e.type,!1),e;case 11:return e=pe(e.type.render,!1),e;case 1:return e=pe(e.type,!0),e;default:return""}}function ge(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case F:return"Fragment";case D:return"Portal";case X:return"Profiler";case Q:return"StrictMode";case J:return"Suspense";case ce:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case W:return(e.displayName||"Context")+".Consumer";case U:return(e._context.displayName||"Context")+".Provider";case re:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case oe:return t=e.displayName||null,t!==null?t:ge(e.type)||"Memo";case ie:t=e._payload,e=e._init;try{return ge(e(t))}catch{}}return null}function Ee(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ge(t);case 8:return t===Q?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function xe(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ce(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Xe(e){var t=Ce(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,u=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(p){i=""+p,u.call(this,p)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(p){i=""+p},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function jn(e){e._valueTracker||(e._valueTracker=Xe(e))}function Pn(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=Ce(e)?e.checked?"true":"false":e.value),e=i,e!==n?(t.setValue(e),!0):!1}function _t(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function On(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Ir(e,t){var n=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;n=xe(t.value!=null?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Rr(e,t){t=t.checked,t!=null&&O(e,"checked",t,!1)}function Tr(e,t){Rr(e,t);var n=xe(t.value),i=t.type;if(n!=null)i==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?_l(e,t.type,n):t.hasOwnProperty("defaultValue")&&_l(e,t.type,xe(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Ba(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function _l(e,t,n){(t!=="number"||_t(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var jr=Array.isArray;function Jn(e,t,n,i){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&i&&(e[n].defaultSelected=!0)}else{for(n=""+xe(n),t=null,o=0;o<e.length;o++){if(e[o].value===n){e[o].selected=!0,i&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function $l(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(r(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ha(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(r(92));if(jr(n)){if(1<n.length)throw Error(r(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:xe(n)}}function Fa(e,t){var n=xe(t.value),i=xe(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),i!=null&&(e.defaultValue=""+i)}function Qa(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function La(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function es(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?La(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ii,Ua=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,i,o){MSApp.execUnsafeLocalFunction(function(){return e(t,n,i,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ii=Ii||document.createElement("div"),Ii.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ii.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Pr(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Or={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},np=["Webkit","ms","Moz","O"];Object.keys(Or).forEach(function(e){np.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Or[t]=Or[e]})});function Wa(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Or.hasOwnProperty(e)&&Or[e]?(""+t).trim():t+"px"}function Va(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var i=n.indexOf("--")===0,o=Wa(n,t[n],i);n==="float"&&(n="cssFloat"),i?e.setProperty(n,o):e[n]=o}}var rp=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ts(e,t){if(t){if(rp[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(r(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(r(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(r(61))}if(t.style!=null&&typeof t.style!="object")throw Error(r(62))}}function ns(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rs=null;function is(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ls=null,qn=null,_n=null;function ba(e){if(e=$r(e)){if(typeof ls!="function")throw Error(r(280));var t=e.stateNode;t&&(t=Zi(t),ls(e.stateNode,e.type,t))}}function Ya(e){qn?_n?_n.push(e):_n=[e]:qn=e}function za(){if(qn){var e=qn,t=_n;if(_n=qn=null,ba(e),t)for(e=0;e<t.length;e++)ba(t[e])}}function Xa(e,t){return e(t)}function Ga(){}var ss=!1;function Ka(e,t,n){if(ss)return e(t,n);ss=!0;try{return Xa(e,t,n)}finally{ss=!1,(qn!==null||_n!==null)&&(Ga(),za())}}function Dr(e,t){var n=e.stateNode;if(n===null)return null;var i=Zi(n);if(i===null)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(r(231,t,typeof n));return n}var os=!1;if(m)try{var Nr={};Object.defineProperty(Nr,"passive",{get:function(){os=!0}}),window.addEventListener("test",Nr,Nr),window.removeEventListener("test",Nr,Nr)}catch{os=!1}function ip(e,t,n,i,o,u,p,x,C){var N=Array.prototype.slice.call(arguments,3);try{t.apply(n,N)}catch(z){this.onError(z)}}var Mr=!1,Ri=null,Ti=!1,as=null,lp={onError:function(e){Mr=!0,Ri=e}};function sp(e,t,n,i,o,u,p,x,C){Mr=!1,Ri=null,ip.apply(lp,arguments)}function op(e,t,n,i,o,u,p,x,C){if(sp.apply(this,arguments),Mr){if(Mr){var N=Ri;Mr=!1,Ri=null}else throw Error(r(198));Ti||(Ti=!0,as=N)}}function Dn(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Za(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Ja(e){if(Dn(e)!==e)throw Error(r(188))}function ap(e){var t=e.alternate;if(!t){if(t=Dn(e),t===null)throw Error(r(188));return t!==e?null:e}for(var n=e,i=t;;){var o=n.return;if(o===null)break;var u=o.alternate;if(u===null){if(i=o.return,i!==null){n=i;continue}break}if(o.child===u.child){for(u=o.child;u;){if(u===n)return Ja(o),e;if(u===i)return Ja(o),t;u=u.sibling}throw Error(r(188))}if(n.return!==i.return)n=o,i=u;else{for(var p=!1,x=o.child;x;){if(x===n){p=!0,n=o,i=u;break}if(x===i){p=!0,i=o,n=u;break}x=x.sibling}if(!p){for(x=u.child;x;){if(x===n){p=!0,n=u,i=o;break}if(x===i){p=!0,i=u,n=o;break}x=x.sibling}if(!p)throw Error(r(189))}}if(n.alternate!==i)throw Error(r(190))}if(n.tag!==3)throw Error(r(188));return n.stateNode.current===n?e:t}function qa(e){return e=ap(e),e!==null?_a(e):null}function _a(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=_a(e);if(t!==null)return t;e=e.sibling}return null}var $a=l.unstable_scheduleCallback,eu=l.unstable_cancelCallback,up=l.unstable_shouldYield,cp=l.unstable_requestPaint,De=l.unstable_now,fp=l.unstable_getCurrentPriorityLevel,us=l.unstable_ImmediatePriority,tu=l.unstable_UserBlockingPriority,ji=l.unstable_NormalPriority,dp=l.unstable_LowPriority,nu=l.unstable_IdlePriority,Pi=null,Pt=null;function pp(e){if(Pt&&typeof Pt.onCommitFiberRoot=="function")try{Pt.onCommitFiberRoot(Pi,e,void 0,(e.current.flags&128)===128)}catch{}}var Ct=Math.clz32?Math.clz32:gp,hp=Math.log,mp=Math.LN2;function gp(e){return e>>>=0,e===0?32:31-(hp(e)/mp|0)|0}var Oi=64,Di=4194304;function Br(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ni(e,t){var n=e.pendingLanes;if(n===0)return 0;var i=0,o=e.suspendedLanes,u=e.pingedLanes,p=n&268435455;if(p!==0){var x=p&~o;x!==0?i=Br(x):(u&=p,u!==0&&(i=Br(u)))}else p=n&~o,p!==0?i=Br(p):u!==0&&(i=Br(u));if(i===0)return 0;if(t!==0&&t!==i&&(t&o)===0&&(o=i&-i,u=t&-t,o>=u||o===16&&(u&4194240)!==0))return t;if((i&4)!==0&&(i|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=i;0<t;)n=31-Ct(t),o=1<<n,i|=e[n],t&=~o;return i}function vp(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yp(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,o=e.expirationTimes,u=e.pendingLanes;0<u;){var p=31-Ct(u),x=1<<p,C=o[p];C===-1?((x&n)===0||(x&i)!==0)&&(o[p]=vp(x,t)):C<=t&&(e.expiredLanes|=x),u&=~x}}function cs(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function ru(){var e=Oi;return Oi<<=1,(Oi&4194240)===0&&(Oi=64),e}function fs(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Hr(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ct(t),e[t]=n}function xp(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-Ct(n),u=1<<o;t[o]=0,i[o]=-1,e[o]=-1,n&=~u}}function ds(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-Ct(n),o=1<<i;o&t|e[i]&t&&(e[i]|=t),n&=~o}}var Ae=0;function iu(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var lu,ps,su,ou,au,hs=!1,Mi=[],$t=null,en=null,tn=null,Fr=new Map,Qr=new Map,nn=[],wp="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function uu(e,t){switch(e){case"focusin":case"focusout":$t=null;break;case"dragenter":case"dragleave":en=null;break;case"mouseover":case"mouseout":tn=null;break;case"pointerover":case"pointerout":Fr.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qr.delete(t.pointerId)}}function Lr(e,t,n,i,o,u){return e===null||e.nativeEvent!==u?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:u,targetContainers:[o]},t!==null&&(t=$r(t),t!==null&&ps(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function Ap(e,t,n,i,o){switch(t){case"focusin":return $t=Lr($t,e,t,n,i,o),!0;case"dragenter":return en=Lr(en,e,t,n,i,o),!0;case"mouseover":return tn=Lr(tn,e,t,n,i,o),!0;case"pointerover":var u=o.pointerId;return Fr.set(u,Lr(Fr.get(u)||null,e,t,n,i,o)),!0;case"gotpointercapture":return u=o.pointerId,Qr.set(u,Lr(Qr.get(u)||null,e,t,n,i,o)),!0}return!1}function cu(e){var t=Nn(e.target);if(t!==null){var n=Dn(t);if(n!==null){if(t=n.tag,t===13){if(t=Za(n),t!==null){e.blockedOn=t,au(e.priority,function(){su(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Bi(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=gs(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var i=new n.constructor(n.type,n);rs=i,n.target.dispatchEvent(i),rs=null}else return t=$r(n),t!==null&&ps(t),e.blockedOn=n,!1;t.shift()}return!0}function fu(e,t,n){Bi(e)&&n.delete(t)}function Ep(){hs=!1,$t!==null&&Bi($t)&&($t=null),en!==null&&Bi(en)&&(en=null),tn!==null&&Bi(tn)&&(tn=null),Fr.forEach(fu),Qr.forEach(fu)}function Ur(e,t){e.blockedOn===t&&(e.blockedOn=null,hs||(hs=!0,l.unstable_scheduleCallback(l.unstable_NormalPriority,Ep)))}function Wr(e){function t(o){return Ur(o,e)}if(0<Mi.length){Ur(Mi[0],e);for(var n=1;n<Mi.length;n++){var i=Mi[n];i.blockedOn===e&&(i.blockedOn=null)}}for($t!==null&&Ur($t,e),en!==null&&Ur(en,e),tn!==null&&Ur(tn,e),Fr.forEach(t),Qr.forEach(t),n=0;n<nn.length;n++)i=nn[n],i.blockedOn===e&&(i.blockedOn=null);for(;0<nn.length&&(n=nn[0],n.blockedOn===null);)cu(n),n.blockedOn===null&&nn.shift()}var $n=H.ReactCurrentBatchConfig,Hi=!0;function Cp(e,t,n,i){var o=Ae,u=$n.transition;$n.transition=null;try{Ae=1,ms(e,t,n,i)}finally{Ae=o,$n.transition=u}}function Sp(e,t,n,i){var o=Ae,u=$n.transition;$n.transition=null;try{Ae=4,ms(e,t,n,i)}finally{Ae=o,$n.transition=u}}function ms(e,t,n,i){if(Hi){var o=gs(e,t,n,i);if(o===null)Ns(e,t,i,Fi,n),uu(e,i);else if(Ap(o,e,t,n,i))i.stopPropagation();else if(uu(e,i),t&4&&-1<wp.indexOf(e)){for(;o!==null;){var u=$r(o);if(u!==null&&lu(u),u=gs(e,t,n,i),u===null&&Ns(e,t,i,Fi,n),u===o)break;o=u}o!==null&&i.stopPropagation()}else Ns(e,t,i,null,n)}}var Fi=null;function gs(e,t,n,i){if(Fi=null,e=is(i),e=Nn(e),e!==null)if(t=Dn(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Za(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Fi=e,null}function du(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(fp()){case us:return 1;case tu:return 4;case ji:case dp:return 16;case nu:return 536870912;default:return 16}default:return 16}}var rn=null,vs=null,Qi=null;function pu(){if(Qi)return Qi;var e,t=vs,n=t.length,i,o="value"in rn?rn.value:rn.textContent,u=o.length;for(e=0;e<n&&t[e]===o[e];e++);var p=n-e;for(i=1;i<=p&&t[n-i]===o[u-i];i++);return Qi=o.slice(e,1<i?1-i:void 0)}function Li(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ui(){return!0}function hu(){return!1}function ut(e){function t(n,i,o,u,p){this._reactName=n,this._targetInst=o,this.type=i,this.nativeEvent=u,this.target=p,this.currentTarget=null;for(var x in e)e.hasOwnProperty(x)&&(n=e[x],this[x]=n?n(u):u[x]);return this.isDefaultPrevented=(u.defaultPrevented!=null?u.defaultPrevented:u.returnValue===!1)?Ui:hu,this.isPropagationStopped=hu,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ui)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ui)},persist:function(){},isPersistent:Ui}),t}var er={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ys=ut(er),Vr=L({},er,{view:0,detail:0}),kp=ut(Vr),xs,ws,br,Wi=L({},Vr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Es,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==br&&(br&&e.type==="mousemove"?(xs=e.screenX-br.screenX,ws=e.screenY-br.screenY):ws=xs=0,br=e),xs)},movementY:function(e){return"movementY"in e?e.movementY:ws}}),mu=ut(Wi),Ip=L({},Wi,{dataTransfer:0}),Rp=ut(Ip),Tp=L({},Vr,{relatedTarget:0}),As=ut(Tp),jp=L({},er,{animationName:0,elapsedTime:0,pseudoElement:0}),Pp=ut(jp),Op=L({},er,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Dp=ut(Op),Np=L({},er,{data:0}),gu=ut(Np),Mp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Bp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Hp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Fp(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Hp[e])?!!t[e]:!1}function Es(){return Fp}var Qp=L({},Vr,{key:function(e){if(e.key){var t=Mp[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Li(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Bp[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Es,charCode:function(e){return e.type==="keypress"?Li(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Li(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Lp=ut(Qp),Up=L({},Wi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vu=ut(Up),Wp=L({},Vr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Es}),Vp=ut(Wp),bp=L({},er,{propertyName:0,elapsedTime:0,pseudoElement:0}),Yp=ut(bp),zp=L({},Wi,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Xp=ut(zp),Gp=[9,13,27,32],Cs=m&&"CompositionEvent"in window,Yr=null;m&&"documentMode"in document&&(Yr=document.documentMode);var Kp=m&&"TextEvent"in window&&!Yr,yu=m&&(!Cs||Yr&&8<Yr&&11>=Yr),xu=" ",wu=!1;function Au(e,t){switch(e){case"keyup":return Gp.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Eu(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var tr=!1;function Zp(e,t){switch(e){case"compositionend":return Eu(t);case"keypress":return t.which!==32?null:(wu=!0,xu);case"textInput":return e=t.data,e===xu&&wu?null:e;default:return null}}function Jp(e,t){if(tr)return e==="compositionend"||!Cs&&Au(e,t)?(e=pu(),Qi=vs=rn=null,tr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return yu&&t.locale!=="ko"?null:t.data;default:return null}}var qp={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Cu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!qp[e.type]:t==="textarea"}function Su(e,t,n,i){Ya(i),t=Xi(t,"onChange"),0<t.length&&(n=new ys("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var zr=null,Xr=null;function _p(e){Vu(e,0)}function Vi(e){var t=sr(e);if(Pn(t))return e}function $p(e,t){if(e==="change")return t}var ku=!1;if(m){var Ss;if(m){var ks="oninput"in document;if(!ks){var Iu=document.createElement("div");Iu.setAttribute("oninput","return;"),ks=typeof Iu.oninput=="function"}Ss=ks}else Ss=!1;ku=Ss&&(!document.documentMode||9<document.documentMode)}function Ru(){zr&&(zr.detachEvent("onpropertychange",Tu),Xr=zr=null)}function Tu(e){if(e.propertyName==="value"&&Vi(Xr)){var t=[];Su(t,Xr,e,is(e)),Ka(_p,t)}}function eh(e,t,n){e==="focusin"?(Ru(),zr=t,Xr=n,zr.attachEvent("onpropertychange",Tu)):e==="focusout"&&Ru()}function th(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Vi(Xr)}function nh(e,t){if(e==="click")return Vi(t)}function rh(e,t){if(e==="input"||e==="change")return Vi(t)}function ih(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var St=typeof Object.is=="function"?Object.is:ih;function Gr(e,t){if(St(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var o=n[i];if(!g.call(t,o)||!St(e[o],t[o]))return!1}return!0}function ju(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Pu(e,t){var n=ju(e);e=0;for(var i;n;){if(n.nodeType===3){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ju(n)}}function Ou(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ou(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Du(){for(var e=window,t=_t();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=_t(e.document)}return t}function Is(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function lh(e){var t=Du(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Ou(n.ownerDocument.documentElement,n)){if(i!==null&&Is(n)){if(t=i.start,e=i.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=n.textContent.length,u=Math.min(i.start,o);i=i.end===void 0?u:Math.min(i.end,o),!e.extend&&u>i&&(o=i,i=u,u=o),o=Pu(n,u);var p=Pu(n,i);o&&p&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==p.node||e.focusOffset!==p.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),u>i?(e.addRange(t),e.extend(p.node,p.offset)):(t.setEnd(p.node,p.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var sh=m&&"documentMode"in document&&11>=document.documentMode,nr=null,Rs=null,Kr=null,Ts=!1;function Nu(e,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ts||nr==null||nr!==_t(i)||(i=nr,"selectionStart"in i&&Is(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Kr&&Gr(Kr,i)||(Kr=i,i=Xi(Rs,"onSelect"),0<i.length&&(t=new ys("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=nr)))}function bi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var rr={animationend:bi("Animation","AnimationEnd"),animationiteration:bi("Animation","AnimationIteration"),animationstart:bi("Animation","AnimationStart"),transitionend:bi("Transition","TransitionEnd")},js={},Mu={};m&&(Mu=document.createElement("div").style,"AnimationEvent"in window||(delete rr.animationend.animation,delete rr.animationiteration.animation,delete rr.animationstart.animation),"TransitionEvent"in window||delete rr.transitionend.transition);function Yi(e){if(js[e])return js[e];if(!rr[e])return e;var t=rr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Mu)return js[e]=t[n];return e}var Bu=Yi("animationend"),Hu=Yi("animationiteration"),Fu=Yi("animationstart"),Qu=Yi("transitionend"),Lu=new Map,Uu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ln(e,t){Lu.set(e,t),f(t,[e])}for(var Ps=0;Ps<Uu.length;Ps++){var Os=Uu[Ps],oh=Os.toLowerCase(),ah=Os[0].toUpperCase()+Os.slice(1);ln(oh,"on"+ah)}ln(Bu,"onAnimationEnd"),ln(Hu,"onAnimationIteration"),ln(Fu,"onAnimationStart"),ln("dblclick","onDoubleClick"),ln("focusin","onFocus"),ln("focusout","onBlur"),ln(Qu,"onTransitionEnd"),d("onMouseEnter",["mouseout","mouseover"]),d("onMouseLeave",["mouseout","mouseover"]),d("onPointerEnter",["pointerout","pointerover"]),d("onPointerLeave",["pointerout","pointerover"]),f("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),f("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),f("onBeforeInput",["compositionend","keypress","textInput","paste"]),f("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),f("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),f("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uh=new Set("cancel close invalid load scroll toggle".split(" ").concat(Zr));function Wu(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,op(i,t,void 0,e),e.currentTarget=null}function Vu(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var i=e[n],o=i.event;i=i.listeners;e:{var u=void 0;if(t)for(var p=i.length-1;0<=p;p--){var x=i[p],C=x.instance,N=x.currentTarget;if(x=x.listener,C!==u&&o.isPropagationStopped())break e;Wu(o,x,N),u=C}else for(p=0;p<i.length;p++){if(x=i[p],C=x.instance,N=x.currentTarget,x=x.listener,C!==u&&o.isPropagationStopped())break e;Wu(o,x,N),u=C}}}if(Ti)throw e=as,Ti=!1,as=null,e}function ke(e,t){var n=t[Ls];n===void 0&&(n=t[Ls]=new Set);var i=e+"__bubble";n.has(i)||(bu(t,e,2,!1),n.add(i))}function Ds(e,t,n){var i=0;t&&(i|=4),bu(n,e,i,t)}var zi="_reactListening"+Math.random().toString(36).slice(2);function Jr(e){if(!e[zi]){e[zi]=!0,a.forEach(function(n){n!=="selectionchange"&&(uh.has(n)||Ds(n,!1,e),Ds(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[zi]||(t[zi]=!0,Ds("selectionchange",!1,t))}}function bu(e,t,n,i){switch(du(t)){case 1:var o=Cp;break;case 4:o=Sp;break;default:o=ms}n=o.bind(null,t,n,e),o=void 0,!os||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),i?o!==void 0?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):o!==void 0?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function Ns(e,t,n,i,o){var u=i;if((t&1)===0&&(t&2)===0&&i!==null)e:for(;;){if(i===null)return;var p=i.tag;if(p===3||p===4){var x=i.stateNode.containerInfo;if(x===o||x.nodeType===8&&x.parentNode===o)break;if(p===4)for(p=i.return;p!==null;){var C=p.tag;if((C===3||C===4)&&(C=p.stateNode.containerInfo,C===o||C.nodeType===8&&C.parentNode===o))return;p=p.return}for(;x!==null;){if(p=Nn(x),p===null)return;if(C=p.tag,C===5||C===6){i=u=p;continue e}x=x.parentNode}}i=i.return}Ka(function(){var N=u,z=is(n),K=[];e:{var Y=Lu.get(e);if(Y!==void 0){var q=ys,te=e;switch(e){case"keypress":if(Li(n)===0)break e;case"keydown":case"keyup":q=Lp;break;case"focusin":te="focus",q=As;break;case"focusout":te="blur",q=As;break;case"beforeblur":case"afterblur":q=As;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":q=mu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":q=Rp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":q=Vp;break;case Bu:case Hu:case Fu:q=Pp;break;case Qu:q=Yp;break;case"scroll":q=kp;break;case"wheel":q=Xp;break;case"copy":case"cut":case"paste":q=Dp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":q=vu}var ne=(t&4)!==0,Ne=!ne&&e==="scroll",T=ne?Y!==null?Y+"Capture":null:Y;ne=[];for(var k=N,P;k!==null;){P=k;var Z=P.stateNode;if(P.tag===5&&Z!==null&&(P=Z,T!==null&&(Z=Dr(k,T),Z!=null&&ne.push(qr(k,Z,P)))),Ne)break;k=k.return}0<ne.length&&(Y=new q(Y,te,null,n,z),K.push({event:Y,listeners:ne}))}}if((t&7)===0){e:{if(Y=e==="mouseover"||e==="pointerover",q=e==="mouseout"||e==="pointerout",Y&&n!==rs&&(te=n.relatedTarget||n.fromElement)&&(Nn(te)||te[Lt]))break e;if((q||Y)&&(Y=z.window===z?z:(Y=z.ownerDocument)?Y.defaultView||Y.parentWindow:window,q?(te=n.relatedTarget||n.toElement,q=N,te=te?Nn(te):null,te!==null&&(Ne=Dn(te),te!==Ne||te.tag!==5&&te.tag!==6)&&(te=null)):(q=null,te=N),q!==te)){if(ne=mu,Z="onMouseLeave",T="onMouseEnter",k="mouse",(e==="pointerout"||e==="pointerover")&&(ne=vu,Z="onPointerLeave",T="onPointerEnter",k="pointer"),Ne=q==null?Y:sr(q),P=te==null?Y:sr(te),Y=new ne(Z,k+"leave",q,n,z),Y.target=Ne,Y.relatedTarget=P,Z=null,Nn(z)===N&&(ne=new ne(T,k+"enter",te,n,z),ne.target=P,ne.relatedTarget=Ne,Z=ne),Ne=Z,q&&te)t:{for(ne=q,T=te,k=0,P=ne;P;P=ir(P))k++;for(P=0,Z=T;Z;Z=ir(Z))P++;for(;0<k-P;)ne=ir(ne),k--;for(;0<P-k;)T=ir(T),P--;for(;k--;){if(ne===T||T!==null&&ne===T.alternate)break t;ne=ir(ne),T=ir(T)}ne=null}else ne=null;q!==null&&Yu(K,Y,q,ne,!1),te!==null&&Ne!==null&&Yu(K,Ne,te,ne,!0)}}e:{if(Y=N?sr(N):window,q=Y.nodeName&&Y.nodeName.toLowerCase(),q==="select"||q==="input"&&Y.type==="file")var le=$p;else if(Cu(Y))if(ku)le=rh;else{le=th;var ae=eh}else(q=Y.nodeName)&&q.toLowerCase()==="input"&&(Y.type==="checkbox"||Y.type==="radio")&&(le=nh);if(le&&(le=le(e,N))){Su(K,le,n,z);break e}ae&&ae(e,Y,N),e==="focusout"&&(ae=Y._wrapperState)&&ae.controlled&&Y.type==="number"&&_l(Y,"number",Y.value)}switch(ae=N?sr(N):window,e){case"focusin":(Cu(ae)||ae.contentEditable==="true")&&(nr=ae,Rs=N,Kr=null);break;case"focusout":Kr=Rs=nr=null;break;case"mousedown":Ts=!0;break;case"contextmenu":case"mouseup":case"dragend":Ts=!1,Nu(K,n,z);break;case"selectionchange":if(sh)break;case"keydown":case"keyup":Nu(K,n,z)}var ue;if(Cs)e:{switch(e){case"compositionstart":var fe="onCompositionStart";break e;case"compositionend":fe="onCompositionEnd";break e;case"compositionupdate":fe="onCompositionUpdate";break e}fe=void 0}else tr?Au(e,n)&&(fe="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(fe="onCompositionStart");fe&&(yu&&n.locale!=="ko"&&(tr||fe!=="onCompositionStart"?fe==="onCompositionEnd"&&tr&&(ue=pu()):(rn=z,vs="value"in rn?rn.value:rn.textContent,tr=!0)),ae=Xi(N,fe),0<ae.length&&(fe=new gu(fe,e,null,n,z),K.push({event:fe,listeners:ae}),ue?fe.data=ue:(ue=Eu(n),ue!==null&&(fe.data=ue)))),(ue=Kp?Zp(e,n):Jp(e,n))&&(N=Xi(N,"onBeforeInput"),0<N.length&&(z=new gu("onBeforeInput","beforeinput",null,n,z),K.push({event:z,listeners:N}),z.data=ue))}Vu(K,t)})}function qr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Xi(e,t){for(var n=t+"Capture",i=[];e!==null;){var o=e,u=o.stateNode;o.tag===5&&u!==null&&(o=u,u=Dr(e,n),u!=null&&i.unshift(qr(e,u,o)),u=Dr(e,t),u!=null&&i.push(qr(e,u,o))),e=e.return}return i}function ir(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Yu(e,t,n,i,o){for(var u=t._reactName,p=[];n!==null&&n!==i;){var x=n,C=x.alternate,N=x.stateNode;if(C!==null&&C===i)break;x.tag===5&&N!==null&&(x=N,o?(C=Dr(n,u),C!=null&&p.unshift(qr(n,C,x))):o||(C=Dr(n,u),C!=null&&p.push(qr(n,C,x)))),n=n.return}p.length!==0&&e.push({event:t,listeners:p})}var ch=/\r\n?/g,fh=/\u0000|\uFFFD/g;function zu(e){return(typeof e=="string"?e:""+e).replace(ch,`
`).replace(fh,"")}function Gi(e,t,n){if(t=zu(t),zu(e)!==t&&n)throw Error(r(425))}function Ki(){}var Ms=null,Bs=null;function Hs(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Fs=typeof setTimeout=="function"?setTimeout:void 0,dh=typeof clearTimeout=="function"?clearTimeout:void 0,Xu=typeof Promise=="function"?Promise:void 0,ph=typeof queueMicrotask=="function"?queueMicrotask:typeof Xu<"u"?function(e){return Xu.resolve(null).then(e).catch(hh)}:Fs;function hh(e){setTimeout(function(){throw e})}function Qs(e,t){var n=t,i=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(i===0){e.removeChild(o),Wr(t);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=o}while(n);Wr(t)}function sn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Gu(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var lr=Math.random().toString(36).slice(2),Ot="__reactFiber$"+lr,_r="__reactProps$"+lr,Lt="__reactContainer$"+lr,Ls="__reactEvents$"+lr,mh="__reactListeners$"+lr,gh="__reactHandles$"+lr;function Nn(e){var t=e[Ot];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Lt]||n[Ot]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Gu(e);e!==null;){if(n=e[Ot])return n;e=Gu(e)}return t}e=n,n=e.parentNode}return null}function $r(e){return e=e[Ot]||e[Lt],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function sr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(r(33))}function Zi(e){return e[_r]||null}var Us=[],or=-1;function on(e){return{current:e}}function Ie(e){0>or||(e.current=Us[or],Us[or]=null,or--)}function Se(e,t){or++,Us[or]=e.current,e.current=t}var an={},Ge=on(an),nt=on(!1),Mn=an;function ar(e,t){var n=e.type.contextTypes;if(!n)return an;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var o={},u;for(u in n)o[u]=t[u];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function rt(e){return e=e.childContextTypes,e!=null}function Ji(){Ie(nt),Ie(Ge)}function Ku(e,t,n){if(Ge.current!==an)throw Error(r(168));Se(Ge,t),Se(nt,n)}function Zu(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var o in i)if(!(o in t))throw Error(r(108,Ee(e)||"Unknown",o));return L({},n,i)}function qi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||an,Mn=Ge.current,Se(Ge,e),Se(nt,nt.current),!0}function Ju(e,t,n){var i=e.stateNode;if(!i)throw Error(r(169));n?(e=Zu(e,t,Mn),i.__reactInternalMemoizedMergedChildContext=e,Ie(nt),Ie(Ge),Se(Ge,e)):Ie(nt),Se(nt,n)}var Ut=null,_i=!1,Ws=!1;function qu(e){Ut===null?Ut=[e]:Ut.push(e)}function vh(e){_i=!0,qu(e)}function un(){if(!Ws&&Ut!==null){Ws=!0;var e=0,t=Ae;try{var n=Ut;for(Ae=1;e<n.length;e++){var i=n[e];do i=i(!0);while(i!==null)}Ut=null,_i=!1}catch(o){throw Ut!==null&&(Ut=Ut.slice(e+1)),$a(us,un),o}finally{Ae=t,Ws=!1}}return null}var ur=[],cr=0,$i=null,el=0,mt=[],gt=0,Bn=null,Wt=1,Vt="";function Hn(e,t){ur[cr++]=el,ur[cr++]=$i,$i=e,el=t}function _u(e,t,n){mt[gt++]=Wt,mt[gt++]=Vt,mt[gt++]=Bn,Bn=e;var i=Wt;e=Vt;var o=32-Ct(i)-1;i&=~(1<<o),n+=1;var u=32-Ct(t)+o;if(30<u){var p=o-o%5;u=(i&(1<<p)-1).toString(32),i>>=p,o-=p,Wt=1<<32-Ct(t)+o|n<<o|i,Vt=u+e}else Wt=1<<u|n<<o|i,Vt=e}function Vs(e){e.return!==null&&(Hn(e,1),_u(e,1,0))}function bs(e){for(;e===$i;)$i=ur[--cr],ur[cr]=null,el=ur[--cr],ur[cr]=null;for(;e===Bn;)Bn=mt[--gt],mt[gt]=null,Vt=mt[--gt],mt[gt]=null,Wt=mt[--gt],mt[gt]=null}var ct=null,ft=null,Te=!1,kt=null;function $u(e,t){var n=wt(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function ec(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ct=e,ft=sn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ct=e,ft=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Bn!==null?{id:Wt,overflow:Vt}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=wt(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,ct=e,ft=null,!0):!1;default:return!1}}function Ys(e){return(e.mode&1)!==0&&(e.flags&128)===0}function zs(e){if(Te){var t=ft;if(t){var n=t;if(!ec(e,t)){if(Ys(e))throw Error(r(418));t=sn(n.nextSibling);var i=ct;t&&ec(e,t)?$u(i,n):(e.flags=e.flags&-4097|2,Te=!1,ct=e)}}else{if(Ys(e))throw Error(r(418));e.flags=e.flags&-4097|2,Te=!1,ct=e}}}function tc(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ct=e}function tl(e){if(e!==ct)return!1;if(!Te)return tc(e),Te=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Hs(e.type,e.memoizedProps)),t&&(t=ft)){if(Ys(e))throw nc(),Error(r(418));for(;t;)$u(e,t),t=sn(t.nextSibling)}if(tc(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(r(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){ft=sn(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}ft=null}}else ft=ct?sn(e.stateNode.nextSibling):null;return!0}function nc(){for(var e=ft;e;)e=sn(e.nextSibling)}function fr(){ft=ct=null,Te=!1}function Xs(e){kt===null?kt=[e]:kt.push(e)}var yh=H.ReactCurrentBatchConfig;function ei(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(r(309));var i=n.stateNode}if(!i)throw Error(r(147,e));var o=i,u=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===u?t.ref:(t=function(p){var x=o.refs;p===null?delete x[u]:x[u]=p},t._stringRef=u,t)}if(typeof e!="string")throw Error(r(284));if(!n._owner)throw Error(r(290,e))}return e}function nl(e,t){throw e=Object.prototype.toString.call(t),Error(r(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function rc(e){var t=e._init;return t(e._payload)}function ic(e){function t(T,k){if(e){var P=T.deletions;P===null?(T.deletions=[k],T.flags|=16):P.push(k)}}function n(T,k){if(!e)return null;for(;k!==null;)t(T,k),k=k.sibling;return null}function i(T,k){for(T=new Map;k!==null;)k.key!==null?T.set(k.key,k):T.set(k.index,k),k=k.sibling;return T}function o(T,k){return T=vn(T,k),T.index=0,T.sibling=null,T}function u(T,k,P){return T.index=P,e?(P=T.alternate,P!==null?(P=P.index,P<k?(T.flags|=2,k):P):(T.flags|=2,k)):(T.flags|=1048576,k)}function p(T){return e&&T.alternate===null&&(T.flags|=2),T}function x(T,k,P,Z){return k===null||k.tag!==6?(k=Qo(P,T.mode,Z),k.return=T,k):(k=o(k,P),k.return=T,k)}function C(T,k,P,Z){var le=P.type;return le===F?z(T,k,P.props.children,Z,P.key):k!==null&&(k.elementType===le||typeof le=="object"&&le!==null&&le.$$typeof===ie&&rc(le)===k.type)?(Z=o(k,P.props),Z.ref=ei(T,k,P),Z.return=T,Z):(Z=Il(P.type,P.key,P.props,null,T.mode,Z),Z.ref=ei(T,k,P),Z.return=T,Z)}function N(T,k,P,Z){return k===null||k.tag!==4||k.stateNode.containerInfo!==P.containerInfo||k.stateNode.implementation!==P.implementation?(k=Lo(P,T.mode,Z),k.return=T,k):(k=o(k,P.children||[]),k.return=T,k)}function z(T,k,P,Z,le){return k===null||k.tag!==7?(k=Yn(P,T.mode,Z,le),k.return=T,k):(k=o(k,P),k.return=T,k)}function K(T,k,P){if(typeof k=="string"&&k!==""||typeof k=="number")return k=Qo(""+k,T.mode,P),k.return=T,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case G:return P=Il(k.type,k.key,k.props,null,T.mode,P),P.ref=ei(T,null,k),P.return=T,P;case D:return k=Lo(k,T.mode,P),k.return=T,k;case ie:var Z=k._init;return K(T,Z(k._payload),P)}if(jr(k)||ee(k))return k=Yn(k,T.mode,P,null),k.return=T,k;nl(T,k)}return null}function Y(T,k,P,Z){var le=k!==null?k.key:null;if(typeof P=="string"&&P!==""||typeof P=="number")return le!==null?null:x(T,k,""+P,Z);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case G:return P.key===le?C(T,k,P,Z):null;case D:return P.key===le?N(T,k,P,Z):null;case ie:return le=P._init,Y(T,k,le(P._payload),Z)}if(jr(P)||ee(P))return le!==null?null:z(T,k,P,Z,null);nl(T,P)}return null}function q(T,k,P,Z,le){if(typeof Z=="string"&&Z!==""||typeof Z=="number")return T=T.get(P)||null,x(k,T,""+Z,le);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case G:return T=T.get(Z.key===null?P:Z.key)||null,C(k,T,Z,le);case D:return T=T.get(Z.key===null?P:Z.key)||null,N(k,T,Z,le);case ie:var ae=Z._init;return q(T,k,P,ae(Z._payload),le)}if(jr(Z)||ee(Z))return T=T.get(P)||null,z(k,T,Z,le,null);nl(k,Z)}return null}function te(T,k,P,Z){for(var le=null,ae=null,ue=k,fe=k=0,Ue=null;ue!==null&&fe<P.length;fe++){ue.index>fe?(Ue=ue,ue=null):Ue=ue.sibling;var we=Y(T,ue,P[fe],Z);if(we===null){ue===null&&(ue=Ue);break}e&&ue&&we.alternate===null&&t(T,ue),k=u(we,k,fe),ae===null?le=we:ae.sibling=we,ae=we,ue=Ue}if(fe===P.length)return n(T,ue),Te&&Hn(T,fe),le;if(ue===null){for(;fe<P.length;fe++)ue=K(T,P[fe],Z),ue!==null&&(k=u(ue,k,fe),ae===null?le=ue:ae.sibling=ue,ae=ue);return Te&&Hn(T,fe),le}for(ue=i(T,ue);fe<P.length;fe++)Ue=q(ue,T,fe,P[fe],Z),Ue!==null&&(e&&Ue.alternate!==null&&ue.delete(Ue.key===null?fe:Ue.key),k=u(Ue,k,fe),ae===null?le=Ue:ae.sibling=Ue,ae=Ue);return e&&ue.forEach(function(yn){return t(T,yn)}),Te&&Hn(T,fe),le}function ne(T,k,P,Z){var le=ee(P);if(typeof le!="function")throw Error(r(150));if(P=le.call(P),P==null)throw Error(r(151));for(var ae=le=null,ue=k,fe=k=0,Ue=null,we=P.next();ue!==null&&!we.done;fe++,we=P.next()){ue.index>fe?(Ue=ue,ue=null):Ue=ue.sibling;var yn=Y(T,ue,we.value,Z);if(yn===null){ue===null&&(ue=Ue);break}e&&ue&&yn.alternate===null&&t(T,ue),k=u(yn,k,fe),ae===null?le=yn:ae.sibling=yn,ae=yn,ue=Ue}if(we.done)return n(T,ue),Te&&Hn(T,fe),le;if(ue===null){for(;!we.done;fe++,we=P.next())we=K(T,we.value,Z),we!==null&&(k=u(we,k,fe),ae===null?le=we:ae.sibling=we,ae=we);return Te&&Hn(T,fe),le}for(ue=i(T,ue);!we.done;fe++,we=P.next())we=q(ue,T,fe,we.value,Z),we!==null&&(e&&we.alternate!==null&&ue.delete(we.key===null?fe:we.key),k=u(we,k,fe),ae===null?le=we:ae.sibling=we,ae=we);return e&&ue.forEach(function(qh){return t(T,qh)}),Te&&Hn(T,fe),le}function Ne(T,k,P,Z){if(typeof P=="object"&&P!==null&&P.type===F&&P.key===null&&(P=P.props.children),typeof P=="object"&&P!==null){switch(P.$$typeof){case G:e:{for(var le=P.key,ae=k;ae!==null;){if(ae.key===le){if(le=P.type,le===F){if(ae.tag===7){n(T,ae.sibling),k=o(ae,P.props.children),k.return=T,T=k;break e}}else if(ae.elementType===le||typeof le=="object"&&le!==null&&le.$$typeof===ie&&rc(le)===ae.type){n(T,ae.sibling),k=o(ae,P.props),k.ref=ei(T,ae,P),k.return=T,T=k;break e}n(T,ae);break}else t(T,ae);ae=ae.sibling}P.type===F?(k=Yn(P.props.children,T.mode,Z,P.key),k.return=T,T=k):(Z=Il(P.type,P.key,P.props,null,T.mode,Z),Z.ref=ei(T,k,P),Z.return=T,T=Z)}return p(T);case D:e:{for(ae=P.key;k!==null;){if(k.key===ae)if(k.tag===4&&k.stateNode.containerInfo===P.containerInfo&&k.stateNode.implementation===P.implementation){n(T,k.sibling),k=o(k,P.children||[]),k.return=T,T=k;break e}else{n(T,k);break}else t(T,k);k=k.sibling}k=Lo(P,T.mode,Z),k.return=T,T=k}return p(T);case ie:return ae=P._init,Ne(T,k,ae(P._payload),Z)}if(jr(P))return te(T,k,P,Z);if(ee(P))return ne(T,k,P,Z);nl(T,P)}return typeof P=="string"&&P!==""||typeof P=="number"?(P=""+P,k!==null&&k.tag===6?(n(T,k.sibling),k=o(k,P),k.return=T,T=k):(n(T,k),k=Qo(P,T.mode,Z),k.return=T,T=k),p(T)):n(T,k)}return Ne}var dr=ic(!0),lc=ic(!1),rl=on(null),il=null,pr=null,Gs=null;function Ks(){Gs=pr=il=null}function Zs(e){var t=rl.current;Ie(rl),e._currentValue=t}function Js(e,t,n){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function hr(e,t){il=e,Gs=pr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(it=!0),e.firstContext=null)}function vt(e){var t=e._currentValue;if(Gs!==e)if(e={context:e,memoizedValue:t,next:null},pr===null){if(il===null)throw Error(r(308));pr=e,il.dependencies={lanes:0,firstContext:e}}else pr=pr.next=e;return t}var Fn=null;function qs(e){Fn===null?Fn=[e]:Fn.push(e)}function sc(e,t,n,i){var o=t.interleaved;return o===null?(n.next=n,qs(t)):(n.next=o.next,o.next=n),t.interleaved=n,bt(e,i)}function bt(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var cn=!1;function _s(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function oc(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Yt(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function fn(e,t,n){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,(ve&2)!==0){var o=i.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),i.pending=t,bt(e,n)}return o=i.interleaved,o===null?(t.next=t,qs(i)):(t.next=o.next,o.next=t),i.interleaved=t,bt(e,n)}function ll(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,ds(e,n)}}function ac(e,t){var n=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var o=null,u=null;if(n=n.firstBaseUpdate,n!==null){do{var p={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};u===null?o=u=p:u=u.next=p,n=n.next}while(n!==null);u===null?o=u=t:u=u.next=t}else o=u=t;n={baseState:i.baseState,firstBaseUpdate:o,lastBaseUpdate:u,shared:i.shared,effects:i.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function sl(e,t,n,i){var o=e.updateQueue;cn=!1;var u=o.firstBaseUpdate,p=o.lastBaseUpdate,x=o.shared.pending;if(x!==null){o.shared.pending=null;var C=x,N=C.next;C.next=null,p===null?u=N:p.next=N,p=C;var z=e.alternate;z!==null&&(z=z.updateQueue,x=z.lastBaseUpdate,x!==p&&(x===null?z.firstBaseUpdate=N:x.next=N,z.lastBaseUpdate=C))}if(u!==null){var K=o.baseState;p=0,z=N=C=null,x=u;do{var Y=x.lane,q=x.eventTime;if((i&Y)===Y){z!==null&&(z=z.next={eventTime:q,lane:0,tag:x.tag,payload:x.payload,callback:x.callback,next:null});e:{var te=e,ne=x;switch(Y=t,q=n,ne.tag){case 1:if(te=ne.payload,typeof te=="function"){K=te.call(q,K,Y);break e}K=te;break e;case 3:te.flags=te.flags&-65537|128;case 0:if(te=ne.payload,Y=typeof te=="function"?te.call(q,K,Y):te,Y==null)break e;K=L({},K,Y);break e;case 2:cn=!0}}x.callback!==null&&x.lane!==0&&(e.flags|=64,Y=o.effects,Y===null?o.effects=[x]:Y.push(x))}else q={eventTime:q,lane:Y,tag:x.tag,payload:x.payload,callback:x.callback,next:null},z===null?(N=z=q,C=K):z=z.next=q,p|=Y;if(x=x.next,x===null){if(x=o.shared.pending,x===null)break;Y=x,x=Y.next,Y.next=null,o.lastBaseUpdate=Y,o.shared.pending=null}}while(!0);if(z===null&&(C=K),o.baseState=C,o.firstBaseUpdate=N,o.lastBaseUpdate=z,t=o.shared.interleaved,t!==null){o=t;do p|=o.lane,o=o.next;while(o!==t)}else u===null&&(o.shared.lanes=0);Un|=p,e.lanes=p,e.memoizedState=K}}function uc(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var i=e[t],o=i.callback;if(o!==null){if(i.callback=null,i=n,typeof o!="function")throw Error(r(191,o));o.call(i)}}}var ti={},Dt=on(ti),ni=on(ti),ri=on(ti);function Qn(e){if(e===ti)throw Error(r(174));return e}function $s(e,t){switch(Se(ri,t),Se(ni,e),Se(Dt,ti),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:es(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=es(t,e)}Ie(Dt),Se(Dt,t)}function mr(){Ie(Dt),Ie(ni),Ie(ri)}function cc(e){Qn(ri.current);var t=Qn(Dt.current),n=es(t,e.type);t!==n&&(Se(ni,e),Se(Dt,n))}function eo(e){ni.current===e&&(Ie(Dt),Ie(ni))}var je=on(0);function ol(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var to=[];function no(){for(var e=0;e<to.length;e++)to[e]._workInProgressVersionPrimary=null;to.length=0}var al=H.ReactCurrentDispatcher,ro=H.ReactCurrentBatchConfig,Ln=0,Pe=null,He=null,Qe=null,ul=!1,ii=!1,li=0,xh=0;function Ke(){throw Error(r(321))}function io(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!St(e[n],t[n]))return!1;return!0}function lo(e,t,n,i,o,u){if(Ln=u,Pe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,al.current=e===null||e.memoizedState===null?Ch:Sh,e=n(i,o),ii){u=0;do{if(ii=!1,li=0,25<=u)throw Error(r(301));u+=1,Qe=He=null,t.updateQueue=null,al.current=kh,e=n(i,o)}while(ii)}if(al.current=dl,t=He!==null&&He.next!==null,Ln=0,Qe=He=Pe=null,ul=!1,t)throw Error(r(300));return e}function so(){var e=li!==0;return li=0,e}function Nt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Qe===null?Pe.memoizedState=Qe=e:Qe=Qe.next=e,Qe}function yt(){if(He===null){var e=Pe.alternate;e=e!==null?e.memoizedState:null}else e=He.next;var t=Qe===null?Pe.memoizedState:Qe.next;if(t!==null)Qe=t,He=e;else{if(e===null)throw Error(r(310));He=e,e={memoizedState:He.memoizedState,baseState:He.baseState,baseQueue:He.baseQueue,queue:He.queue,next:null},Qe===null?Pe.memoizedState=Qe=e:Qe=Qe.next=e}return Qe}function si(e,t){return typeof t=="function"?t(e):t}function oo(e){var t=yt(),n=t.queue;if(n===null)throw Error(r(311));n.lastRenderedReducer=e;var i=He,o=i.baseQueue,u=n.pending;if(u!==null){if(o!==null){var p=o.next;o.next=u.next,u.next=p}i.baseQueue=o=u,n.pending=null}if(o!==null){u=o.next,i=i.baseState;var x=p=null,C=null,N=u;do{var z=N.lane;if((Ln&z)===z)C!==null&&(C=C.next={lane:0,action:N.action,hasEagerState:N.hasEagerState,eagerState:N.eagerState,next:null}),i=N.hasEagerState?N.eagerState:e(i,N.action);else{var K={lane:z,action:N.action,hasEagerState:N.hasEagerState,eagerState:N.eagerState,next:null};C===null?(x=C=K,p=i):C=C.next=K,Pe.lanes|=z,Un|=z}N=N.next}while(N!==null&&N!==u);C===null?p=i:C.next=x,St(i,t.memoizedState)||(it=!0),t.memoizedState=i,t.baseState=p,t.baseQueue=C,n.lastRenderedState=i}if(e=n.interleaved,e!==null){o=e;do u=o.lane,Pe.lanes|=u,Un|=u,o=o.next;while(o!==e)}else o===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ao(e){var t=yt(),n=t.queue;if(n===null)throw Error(r(311));n.lastRenderedReducer=e;var i=n.dispatch,o=n.pending,u=t.memoizedState;if(o!==null){n.pending=null;var p=o=o.next;do u=e(u,p.action),p=p.next;while(p!==o);St(u,t.memoizedState)||(it=!0),t.memoizedState=u,t.baseQueue===null&&(t.baseState=u),n.lastRenderedState=u}return[u,i]}function fc(){}function dc(e,t){var n=Pe,i=yt(),o=t(),u=!St(i.memoizedState,o);if(u&&(i.memoizedState=o,it=!0),i=i.queue,uo(mc.bind(null,n,i,e),[e]),i.getSnapshot!==t||u||Qe!==null&&Qe.memoizedState.tag&1){if(n.flags|=2048,oi(9,hc.bind(null,n,i,o,t),void 0,null),Le===null)throw Error(r(349));(Ln&30)!==0||pc(n,t,o)}return o}function pc(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Pe.updateQueue,t===null?(t={lastEffect:null,stores:null},Pe.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function hc(e,t,n,i){t.value=n,t.getSnapshot=i,gc(t)&&vc(e)}function mc(e,t,n){return n(function(){gc(t)&&vc(e)})}function gc(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!St(e,n)}catch{return!0}}function vc(e){var t=bt(e,1);t!==null&&jt(t,e,1,-1)}function yc(e){var t=Nt();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:si,lastRenderedState:e},t.queue=e,e=e.dispatch=Eh.bind(null,Pe,e),[t.memoizedState,e]}function oi(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},t=Pe.updateQueue,t===null?(t={lastEffect:null,stores:null},Pe.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e)),e}function xc(){return yt().memoizedState}function cl(e,t,n,i){var o=Nt();Pe.flags|=e,o.memoizedState=oi(1|t,n,void 0,i===void 0?null:i)}function fl(e,t,n,i){var o=yt();i=i===void 0?null:i;var u=void 0;if(He!==null){var p=He.memoizedState;if(u=p.destroy,i!==null&&io(i,p.deps)){o.memoizedState=oi(t,n,u,i);return}}Pe.flags|=e,o.memoizedState=oi(1|t,n,u,i)}function wc(e,t){return cl(8390656,8,e,t)}function uo(e,t){return fl(2048,8,e,t)}function Ac(e,t){return fl(4,2,e,t)}function Ec(e,t){return fl(4,4,e,t)}function Cc(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Sc(e,t,n){return n=n!=null?n.concat([e]):null,fl(4,4,Cc.bind(null,t,e),n)}function co(){}function kc(e,t){var n=yt();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&io(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Ic(e,t){var n=yt();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&io(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Rc(e,t,n){return(Ln&21)===0?(e.baseState&&(e.baseState=!1,it=!0),e.memoizedState=n):(St(n,t)||(n=ru(),Pe.lanes|=n,Un|=n,e.baseState=!0),t)}function wh(e,t){var n=Ae;Ae=n!==0&&4>n?n:4,e(!0);var i=ro.transition;ro.transition={};try{e(!1),t()}finally{Ae=n,ro.transition=i}}function Tc(){return yt().memoizedState}function Ah(e,t,n){var i=mn(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},jc(e))Pc(t,n);else if(n=sc(e,t,n,i),n!==null){var o=$e();jt(n,e,i,o),Oc(n,t,i)}}function Eh(e,t,n){var i=mn(e),o={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(jc(e))Pc(t,o);else{var u=e.alternate;if(e.lanes===0&&(u===null||u.lanes===0)&&(u=t.lastRenderedReducer,u!==null))try{var p=t.lastRenderedState,x=u(p,n);if(o.hasEagerState=!0,o.eagerState=x,St(x,p)){var C=t.interleaved;C===null?(o.next=o,qs(t)):(o.next=C.next,C.next=o),t.interleaved=o;return}}catch{}finally{}n=sc(e,t,o,i),n!==null&&(o=$e(),jt(n,e,i,o),Oc(n,t,i))}}function jc(e){var t=e.alternate;return e===Pe||t!==null&&t===Pe}function Pc(e,t){ii=ul=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Oc(e,t,n){if((n&4194240)!==0){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,ds(e,n)}}var dl={readContext:vt,useCallback:Ke,useContext:Ke,useEffect:Ke,useImperativeHandle:Ke,useInsertionEffect:Ke,useLayoutEffect:Ke,useMemo:Ke,useReducer:Ke,useRef:Ke,useState:Ke,useDebugValue:Ke,useDeferredValue:Ke,useTransition:Ke,useMutableSource:Ke,useSyncExternalStore:Ke,useId:Ke,unstable_isNewReconciler:!1},Ch={readContext:vt,useCallback:function(e,t){return Nt().memoizedState=[e,t===void 0?null:t],e},useContext:vt,useEffect:wc,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,cl(4194308,4,Cc.bind(null,t,e),n)},useLayoutEffect:function(e,t){return cl(4194308,4,e,t)},useInsertionEffect:function(e,t){return cl(4,2,e,t)},useMemo:function(e,t){var n=Nt();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=Nt();return t=n!==void 0?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=Ah.bind(null,Pe,e),[i.memoizedState,e]},useRef:function(e){var t=Nt();return e={current:e},t.memoizedState=e},useState:yc,useDebugValue:co,useDeferredValue:function(e){return Nt().memoizedState=e},useTransition:function(){var e=yc(!1),t=e[0];return e=wh.bind(null,e[1]),Nt().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=Pe,o=Nt();if(Te){if(n===void 0)throw Error(r(407));n=n()}else{if(n=t(),Le===null)throw Error(r(349));(Ln&30)!==0||pc(i,t,n)}o.memoizedState=n;var u={value:n,getSnapshot:t};return o.queue=u,wc(mc.bind(null,i,u,e),[e]),i.flags|=2048,oi(9,hc.bind(null,i,u,n,t),void 0,null),n},useId:function(){var e=Nt(),t=Le.identifierPrefix;if(Te){var n=Vt,i=Wt;n=(i&~(1<<32-Ct(i)-1)).toString(32)+n,t=":"+t+"R"+n,n=li++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=xh++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Sh={readContext:vt,useCallback:kc,useContext:vt,useEffect:uo,useImperativeHandle:Sc,useInsertionEffect:Ac,useLayoutEffect:Ec,useMemo:Ic,useReducer:oo,useRef:xc,useState:function(){return oo(si)},useDebugValue:co,useDeferredValue:function(e){var t=yt();return Rc(t,He.memoizedState,e)},useTransition:function(){var e=oo(si)[0],t=yt().memoizedState;return[e,t]},useMutableSource:fc,useSyncExternalStore:dc,useId:Tc,unstable_isNewReconciler:!1},kh={readContext:vt,useCallback:kc,useContext:vt,useEffect:uo,useImperativeHandle:Sc,useInsertionEffect:Ac,useLayoutEffect:Ec,useMemo:Ic,useReducer:ao,useRef:xc,useState:function(){return ao(si)},useDebugValue:co,useDeferredValue:function(e){var t=yt();return He===null?t.memoizedState=e:Rc(t,He.memoizedState,e)},useTransition:function(){var e=ao(si)[0],t=yt().memoizedState;return[e,t]},useMutableSource:fc,useSyncExternalStore:dc,useId:Tc,unstable_isNewReconciler:!1};function It(e,t){if(e&&e.defaultProps){t=L({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function fo(e,t,n,i){t=e.memoizedState,n=n(i,t),n=n==null?t:L({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var pl={isMounted:function(e){return(e=e._reactInternals)?Dn(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=$e(),o=mn(e),u=Yt(i,o);u.payload=t,n!=null&&(u.callback=n),t=fn(e,u,o),t!==null&&(jt(t,e,o,i),ll(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=$e(),o=mn(e),u=Yt(i,o);u.tag=1,u.payload=t,n!=null&&(u.callback=n),t=fn(e,u,o),t!==null&&(jt(t,e,o,i),ll(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=$e(),i=mn(e),o=Yt(n,i);o.tag=2,t!=null&&(o.callback=t),t=fn(e,o,i),t!==null&&(jt(t,e,i,n),ll(t,e,i))}};function Dc(e,t,n,i,o,u,p){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,u,p):t.prototype&&t.prototype.isPureReactComponent?!Gr(n,i)||!Gr(o,u):!0}function Nc(e,t,n){var i=!1,o=an,u=t.contextType;return typeof u=="object"&&u!==null?u=vt(u):(o=rt(t)?Mn:Ge.current,i=t.contextTypes,u=(i=i!=null)?ar(e,o):an),t=new t(n,u),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=pl,e.stateNode=t,t._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=u),t}function Mc(e,t,n,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&pl.enqueueReplaceState(t,t.state,null)}function po(e,t,n,i){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},_s(e);var u=t.contextType;typeof u=="object"&&u!==null?o.context=vt(u):(u=rt(t)?Mn:Ge.current,o.context=ar(e,u)),o.state=e.memoizedState,u=t.getDerivedStateFromProps,typeof u=="function"&&(fo(e,t,u,n),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&pl.enqueueReplaceState(o,o.state,null),sl(e,n,o,i),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function gr(e,t){try{var n="",i=t;do n+=me(i),i=i.return;while(i);var o=n}catch(u){o=`
Error generating stack: `+u.message+`
`+u.stack}return{value:e,source:t,stack:o,digest:null}}function ho(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function mo(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Ih=typeof WeakMap=="function"?WeakMap:Map;function Bc(e,t,n){n=Yt(-1,n),n.tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){wl||(wl=!0,Po=i),mo(e,t)},n}function Hc(e,t,n){n=Yt(-1,n),n.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var o=t.value;n.payload=function(){return i(o)},n.callback=function(){mo(e,t)}}var u=e.stateNode;return u!==null&&typeof u.componentDidCatch=="function"&&(n.callback=function(){mo(e,t),typeof i!="function"&&(pn===null?pn=new Set([this]):pn.add(this));var p=t.stack;this.componentDidCatch(t.value,{componentStack:p!==null?p:""})}),n}function Fc(e,t,n){var i=e.pingCache;if(i===null){i=e.pingCache=new Ih;var o=new Set;i.set(t,o)}else o=i.get(t),o===void 0&&(o=new Set,i.set(t,o));o.has(n)||(o.add(n),e=Uh.bind(null,e,t,n),t.then(e,e))}function Qc(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Lc(e,t,n,i,o){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Yt(-1,1),t.tag=2,fn(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=o,e)}var Rh=H.ReactCurrentOwner,it=!1;function _e(e,t,n,i){t.child=e===null?lc(t,null,n,i):dr(t,e.child,n,i)}function Uc(e,t,n,i,o){n=n.render;var u=t.ref;return hr(t,o),i=lo(e,t,n,i,u,o),n=so(),e!==null&&!it?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,zt(e,t,o)):(Te&&n&&Vs(t),t.flags|=1,_e(e,t,i,o),t.child)}function Wc(e,t,n,i,o){if(e===null){var u=n.type;return typeof u=="function"&&!Fo(u)&&u.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=u,Vc(e,t,u,i,o)):(e=Il(n.type,null,i,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(u=e.child,(e.lanes&o)===0){var p=u.memoizedProps;if(n=n.compare,n=n!==null?n:Gr,n(p,i)&&e.ref===t.ref)return zt(e,t,o)}return t.flags|=1,e=vn(u,i),e.ref=t.ref,e.return=t,t.child=e}function Vc(e,t,n,i,o){if(e!==null){var u=e.memoizedProps;if(Gr(u,i)&&e.ref===t.ref)if(it=!1,t.pendingProps=i=u,(e.lanes&o)!==0)(e.flags&131072)!==0&&(it=!0);else return t.lanes=e.lanes,zt(e,t,o)}return go(e,t,n,i,o)}function bc(e,t,n){var i=t.pendingProps,o=i.children,u=e!==null?e.memoizedState:null;if(i.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Se(yr,dt),dt|=n;else{if((n&1073741824)===0)return e=u!==null?u.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Se(yr,dt),dt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=u!==null?u.baseLanes:n,Se(yr,dt),dt|=i}else u!==null?(i=u.baseLanes|n,t.memoizedState=null):i=n,Se(yr,dt),dt|=i;return _e(e,t,o,n),t.child}function Yc(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function go(e,t,n,i,o){var u=rt(n)?Mn:Ge.current;return u=ar(t,u),hr(t,o),n=lo(e,t,n,i,u,o),i=so(),e!==null&&!it?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,zt(e,t,o)):(Te&&i&&Vs(t),t.flags|=1,_e(e,t,n,o),t.child)}function zc(e,t,n,i,o){if(rt(n)){var u=!0;qi(t)}else u=!1;if(hr(t,o),t.stateNode===null)ml(e,t),Nc(t,n,i),po(t,n,i,o),i=!0;else if(e===null){var p=t.stateNode,x=t.memoizedProps;p.props=x;var C=p.context,N=n.contextType;typeof N=="object"&&N!==null?N=vt(N):(N=rt(n)?Mn:Ge.current,N=ar(t,N));var z=n.getDerivedStateFromProps,K=typeof z=="function"||typeof p.getSnapshotBeforeUpdate=="function";K||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(x!==i||C!==N)&&Mc(t,p,i,N),cn=!1;var Y=t.memoizedState;p.state=Y,sl(t,i,p,o),C=t.memoizedState,x!==i||Y!==C||nt.current||cn?(typeof z=="function"&&(fo(t,n,z,i),C=t.memoizedState),(x=cn||Dc(t,n,x,i,Y,C,N))?(K||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(t.flags|=4194308)):(typeof p.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=C),p.props=i,p.state=C,p.context=N,i=x):(typeof p.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{p=t.stateNode,oc(e,t),x=t.memoizedProps,N=t.type===t.elementType?x:It(t.type,x),p.props=N,K=t.pendingProps,Y=p.context,C=n.contextType,typeof C=="object"&&C!==null?C=vt(C):(C=rt(n)?Mn:Ge.current,C=ar(t,C));var q=n.getDerivedStateFromProps;(z=typeof q=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(x!==K||Y!==C)&&Mc(t,p,i,C),cn=!1,Y=t.memoizedState,p.state=Y,sl(t,i,p,o);var te=t.memoizedState;x!==K||Y!==te||nt.current||cn?(typeof q=="function"&&(fo(t,n,q,i),te=t.memoizedState),(N=cn||Dc(t,n,N,i,Y,te,C)||!1)?(z||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(i,te,C),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(i,te,C)),typeof p.componentDidUpdate=="function"&&(t.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof p.componentDidUpdate!="function"||x===e.memoizedProps&&Y===e.memoizedState||(t.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||x===e.memoizedProps&&Y===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=te),p.props=i,p.state=te,p.context=C,i=N):(typeof p.componentDidUpdate!="function"||x===e.memoizedProps&&Y===e.memoizedState||(t.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||x===e.memoizedProps&&Y===e.memoizedState||(t.flags|=1024),i=!1)}return vo(e,t,n,i,u,o)}function vo(e,t,n,i,o,u){Yc(e,t);var p=(t.flags&128)!==0;if(!i&&!p)return o&&Ju(t,n,!1),zt(e,t,u);i=t.stateNode,Rh.current=t;var x=p&&typeof n.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,e!==null&&p?(t.child=dr(t,e.child,null,u),t.child=dr(t,null,x,u)):_e(e,t,x,u),t.memoizedState=i.state,o&&Ju(t,n,!0),t.child}function Xc(e){var t=e.stateNode;t.pendingContext?Ku(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Ku(e,t.context,!1),$s(e,t.containerInfo)}function Gc(e,t,n,i,o){return fr(),Xs(o),t.flags|=256,_e(e,t,n,i),t.child}var yo={dehydrated:null,treeContext:null,retryLane:0};function xo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Kc(e,t,n){var i=t.pendingProps,o=je.current,u=!1,p=(t.flags&128)!==0,x;if((x=p)||(x=e!==null&&e.memoizedState===null?!1:(o&2)!==0),x?(u=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),Se(je,o&1),e===null)return zs(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(p=i.children,e=i.fallback,u?(i=t.mode,u=t.child,p={mode:"hidden",children:p},(i&1)===0&&u!==null?(u.childLanes=0,u.pendingProps=p):u=Rl(p,i,0,null),e=Yn(e,i,n,null),u.return=t,e.return=t,u.sibling=e,t.child=u,t.child.memoizedState=xo(n),t.memoizedState=yo,e):wo(t,p));if(o=e.memoizedState,o!==null&&(x=o.dehydrated,x!==null))return Th(e,t,p,i,x,o,n);if(u){u=i.fallback,p=t.mode,o=e.child,x=o.sibling;var C={mode:"hidden",children:i.children};return(p&1)===0&&t.child!==o?(i=t.child,i.childLanes=0,i.pendingProps=C,t.deletions=null):(i=vn(o,C),i.subtreeFlags=o.subtreeFlags&14680064),x!==null?u=vn(x,u):(u=Yn(u,p,n,null),u.flags|=2),u.return=t,i.return=t,i.sibling=u,t.child=i,i=u,u=t.child,p=e.child.memoizedState,p=p===null?xo(n):{baseLanes:p.baseLanes|n,cachePool:null,transitions:p.transitions},u.memoizedState=p,u.childLanes=e.childLanes&~n,t.memoizedState=yo,i}return u=e.child,e=u.sibling,i=vn(u,{mode:"visible",children:i.children}),(t.mode&1)===0&&(i.lanes=n),i.return=t,i.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function wo(e,t){return t=Rl({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function hl(e,t,n,i){return i!==null&&Xs(i),dr(t,e.child,null,n),e=wo(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Th(e,t,n,i,o,u,p){if(n)return t.flags&256?(t.flags&=-257,i=ho(Error(r(422))),hl(e,t,p,i)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(u=i.fallback,o=t.mode,i=Rl({mode:"visible",children:i.children},o,0,null),u=Yn(u,o,p,null),u.flags|=2,i.return=t,u.return=t,i.sibling=u,t.child=i,(t.mode&1)!==0&&dr(t,e.child,null,p),t.child.memoizedState=xo(p),t.memoizedState=yo,u);if((t.mode&1)===0)return hl(e,t,p,null);if(o.data==="$!"){if(i=o.nextSibling&&o.nextSibling.dataset,i)var x=i.dgst;return i=x,u=Error(r(419)),i=ho(u,i,void 0),hl(e,t,p,i)}if(x=(p&e.childLanes)!==0,it||x){if(i=Le,i!==null){switch(p&-p){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=(o&(i.suspendedLanes|p))!==0?0:o,o!==0&&o!==u.retryLane&&(u.retryLane=o,bt(e,o),jt(i,e,o,-1))}return Ho(),i=ho(Error(r(421))),hl(e,t,p,i)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=Wh.bind(null,e),o._reactRetry=t,null):(e=u.treeContext,ft=sn(o.nextSibling),ct=t,Te=!0,kt=null,e!==null&&(mt[gt++]=Wt,mt[gt++]=Vt,mt[gt++]=Bn,Wt=e.id,Vt=e.overflow,Bn=t),t=wo(t,i.children),t.flags|=4096,t)}function Zc(e,t,n){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),Js(e.return,t,n)}function Ao(e,t,n,i,o){var u=e.memoizedState;u===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:o}:(u.isBackwards=t,u.rendering=null,u.renderingStartTime=0,u.last=i,u.tail=n,u.tailMode=o)}function Jc(e,t,n){var i=t.pendingProps,o=i.revealOrder,u=i.tail;if(_e(e,t,i.children,n),i=je.current,(i&2)!==0)i=i&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Zc(e,n,t);else if(e.tag===19)Zc(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Se(je,i),(t.mode&1)===0)t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;n!==null;)e=n.alternate,e!==null&&ol(e)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),Ao(t,!1,o,n,u);break;case"backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&ol(e)===null){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}Ao(t,!0,n,null,u);break;case"together":Ao(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ml(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function zt(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Un|=t.lanes,(n&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(r(153));if(t.child!==null){for(e=t.child,n=vn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=vn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function jh(e,t,n){switch(t.tag){case 3:Xc(t),fr();break;case 5:cc(t);break;case 1:rt(t.type)&&qi(t);break;case 4:$s(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,o=t.memoizedProps.value;Se(rl,i._currentValue),i._currentValue=o;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?(Se(je,je.current&1),t.flags|=128,null):(n&t.child.childLanes)!==0?Kc(e,t,n):(Se(je,je.current&1),e=zt(e,t,n),e!==null?e.sibling:null);Se(je,je.current&1);break;case 19:if(i=(n&t.childLanes)!==0,(e.flags&128)!==0){if(i)return Jc(e,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Se(je,je.current),i)break;return null;case 22:case 23:return t.lanes=0,bc(e,t,n)}return zt(e,t,n)}var qc,Eo,_c,$c;qc=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Eo=function(){},_c=function(e,t,n,i){var o=e.memoizedProps;if(o!==i){e=t.stateNode,Qn(Dt.current);var u=null;switch(n){case"input":o=On(e,o),i=On(e,i),u=[];break;case"select":o=L({},o,{value:void 0}),i=L({},i,{value:void 0}),u=[];break;case"textarea":o=$l(e,o),i=$l(e,i),u=[];break;default:typeof o.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=Ki)}ts(n,i);var p;n=null;for(N in o)if(!i.hasOwnProperty(N)&&o.hasOwnProperty(N)&&o[N]!=null)if(N==="style"){var x=o[N];for(p in x)x.hasOwnProperty(p)&&(n||(n={}),n[p]="")}else N!=="dangerouslySetInnerHTML"&&N!=="children"&&N!=="suppressContentEditableWarning"&&N!=="suppressHydrationWarning"&&N!=="autoFocus"&&(c.hasOwnProperty(N)?u||(u=[]):(u=u||[]).push(N,null));for(N in i){var C=i[N];if(x=o!=null?o[N]:void 0,i.hasOwnProperty(N)&&C!==x&&(C!=null||x!=null))if(N==="style")if(x){for(p in x)!x.hasOwnProperty(p)||C&&C.hasOwnProperty(p)||(n||(n={}),n[p]="");for(p in C)C.hasOwnProperty(p)&&x[p]!==C[p]&&(n||(n={}),n[p]=C[p])}else n||(u||(u=[]),u.push(N,n)),n=C;else N==="dangerouslySetInnerHTML"?(C=C?C.__html:void 0,x=x?x.__html:void 0,C!=null&&x!==C&&(u=u||[]).push(N,C)):N==="children"?typeof C!="string"&&typeof C!="number"||(u=u||[]).push(N,""+C):N!=="suppressContentEditableWarning"&&N!=="suppressHydrationWarning"&&(c.hasOwnProperty(N)?(C!=null&&N==="onScroll"&&ke("scroll",e),u||x===C||(u=[])):(u=u||[]).push(N,C))}n&&(u=u||[]).push("style",n);var N=u;(t.updateQueue=N)&&(t.flags|=4)}},$c=function(e,t,n,i){n!==i&&(t.flags|=4)};function ai(e,t){if(!Te)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Ze(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,i=0;if(t)for(var o=e.child;o!==null;)n|=o.lanes|o.childLanes,i|=o.subtreeFlags&14680064,i|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)n|=o.lanes|o.childLanes,i|=o.subtreeFlags,i|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Ph(e,t,n){var i=t.pendingProps;switch(bs(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ze(t),null;case 1:return rt(t.type)&&Ji(),Ze(t),null;case 3:return i=t.stateNode,mr(),Ie(nt),Ie(Ge),no(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(tl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,kt!==null&&(No(kt),kt=null))),Eo(e,t),Ze(t),null;case 5:eo(t);var o=Qn(ri.current);if(n=t.type,e!==null&&t.stateNode!=null)_c(e,t,n,i,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(r(166));return Ze(t),null}if(e=Qn(Dt.current),tl(t)){i=t.stateNode,n=t.type;var u=t.memoizedProps;switch(i[Ot]=t,i[_r]=u,e=(t.mode&1)!==0,n){case"dialog":ke("cancel",i),ke("close",i);break;case"iframe":case"object":case"embed":ke("load",i);break;case"video":case"audio":for(o=0;o<Zr.length;o++)ke(Zr[o],i);break;case"source":ke("error",i);break;case"img":case"image":case"link":ke("error",i),ke("load",i);break;case"details":ke("toggle",i);break;case"input":Ir(i,u),ke("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!u.multiple},ke("invalid",i);break;case"textarea":Ha(i,u),ke("invalid",i)}ts(n,u),o=null;for(var p in u)if(u.hasOwnProperty(p)){var x=u[p];p==="children"?typeof x=="string"?i.textContent!==x&&(u.suppressHydrationWarning!==!0&&Gi(i.textContent,x,e),o=["children",x]):typeof x=="number"&&i.textContent!==""+x&&(u.suppressHydrationWarning!==!0&&Gi(i.textContent,x,e),o=["children",""+x]):c.hasOwnProperty(p)&&x!=null&&p==="onScroll"&&ke("scroll",i)}switch(n){case"input":jn(i),Ba(i,u,!0);break;case"textarea":jn(i),Qa(i);break;case"select":case"option":break;default:typeof u.onClick=="function"&&(i.onclick=Ki)}i=o,t.updateQueue=i,i!==null&&(t.flags|=4)}else{p=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=La(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=p.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=p.createElement(n,{is:i.is}):(e=p.createElement(n),n==="select"&&(p=e,i.multiple?p.multiple=!0:i.size&&(p.size=i.size))):e=p.createElementNS(e,n),e[Ot]=t,e[_r]=i,qc(e,t,!1,!1),t.stateNode=e;e:{switch(p=ns(n,i),n){case"dialog":ke("cancel",e),ke("close",e),o=i;break;case"iframe":case"object":case"embed":ke("load",e),o=i;break;case"video":case"audio":for(o=0;o<Zr.length;o++)ke(Zr[o],e);o=i;break;case"source":ke("error",e),o=i;break;case"img":case"image":case"link":ke("error",e),ke("load",e),o=i;break;case"details":ke("toggle",e),o=i;break;case"input":Ir(e,i),o=On(e,i),ke("invalid",e);break;case"option":o=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},o=L({},i,{value:void 0}),ke("invalid",e);break;case"textarea":Ha(e,i),o=$l(e,i),ke("invalid",e);break;default:o=i}ts(n,o),x=o;for(u in x)if(x.hasOwnProperty(u)){var C=x[u];u==="style"?Va(e,C):u==="dangerouslySetInnerHTML"?(C=C?C.__html:void 0,C!=null&&Ua(e,C)):u==="children"?typeof C=="string"?(n!=="textarea"||C!=="")&&Pr(e,C):typeof C=="number"&&Pr(e,""+C):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(c.hasOwnProperty(u)?C!=null&&u==="onScroll"&&ke("scroll",e):C!=null&&O(e,u,C,p))}switch(n){case"input":jn(e),Ba(e,i,!1);break;case"textarea":jn(e),Qa(e);break;case"option":i.value!=null&&e.setAttribute("value",""+xe(i.value));break;case"select":e.multiple=!!i.multiple,u=i.value,u!=null?Jn(e,!!i.multiple,u,!1):i.defaultValue!=null&&Jn(e,!!i.multiple,i.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=Ki)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ze(t),null;case 6:if(e&&t.stateNode!=null)$c(e,t,e.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(r(166));if(n=Qn(ri.current),Qn(Dt.current),tl(t)){if(i=t.stateNode,n=t.memoizedProps,i[Ot]=t,(u=i.nodeValue!==n)&&(e=ct,e!==null))switch(e.tag){case 3:Gi(i.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Gi(i.nodeValue,n,(e.mode&1)!==0)}u&&(t.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[Ot]=t,t.stateNode=i}return Ze(t),null;case 13:if(Ie(je),i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Te&&ft!==null&&(t.mode&1)!==0&&(t.flags&128)===0)nc(),fr(),t.flags|=98560,u=!1;else if(u=tl(t),i!==null&&i.dehydrated!==null){if(e===null){if(!u)throw Error(r(318));if(u=t.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(r(317));u[Ot]=t}else fr(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Ze(t),u=!1}else kt!==null&&(No(kt),kt=null),u=!0;if(!u)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=n,t):(i=i!==null,i!==(e!==null&&e.memoizedState!==null)&&i&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(je.current&1)!==0?Fe===0&&(Fe=3):Ho())),t.updateQueue!==null&&(t.flags|=4),Ze(t),null);case 4:return mr(),Eo(e,t),e===null&&Jr(t.stateNode.containerInfo),Ze(t),null;case 10:return Zs(t.type._context),Ze(t),null;case 17:return rt(t.type)&&Ji(),Ze(t),null;case 19:if(Ie(je),u=t.memoizedState,u===null)return Ze(t),null;if(i=(t.flags&128)!==0,p=u.rendering,p===null)if(i)ai(u,!1);else{if(Fe!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(p=ol(e),p!==null){for(t.flags|=128,ai(u,!1),i=p.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;n!==null;)u=n,e=i,u.flags&=14680066,p=u.alternate,p===null?(u.childLanes=0,u.lanes=e,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=p.childLanes,u.lanes=p.lanes,u.child=p.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=p.memoizedProps,u.memoizedState=p.memoizedState,u.updateQueue=p.updateQueue,u.type=p.type,e=p.dependencies,u.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Se(je,je.current&1|2),t.child}e=e.sibling}u.tail!==null&&De()>xr&&(t.flags|=128,i=!0,ai(u,!1),t.lanes=4194304)}else{if(!i)if(e=ol(p),e!==null){if(t.flags|=128,i=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),ai(u,!0),u.tail===null&&u.tailMode==="hidden"&&!p.alternate&&!Te)return Ze(t),null}else 2*De()-u.renderingStartTime>xr&&n!==1073741824&&(t.flags|=128,i=!0,ai(u,!1),t.lanes=4194304);u.isBackwards?(p.sibling=t.child,t.child=p):(n=u.last,n!==null?n.sibling=p:t.child=p,u.last=p)}return u.tail!==null?(t=u.tail,u.rendering=t,u.tail=t.sibling,u.renderingStartTime=De(),t.sibling=null,n=je.current,Se(je,i?n&1|2:n&1),t):(Ze(t),null);case 22:case 23:return Bo(),i=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(t.flags|=8192),i&&(t.mode&1)!==0?(dt&1073741824)!==0&&(Ze(t),t.subtreeFlags&6&&(t.flags|=8192)):Ze(t),null;case 24:return null;case 25:return null}throw Error(r(156,t.tag))}function Oh(e,t){switch(bs(t),t.tag){case 1:return rt(t.type)&&Ji(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return mr(),Ie(nt),Ie(Ge),no(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return eo(t),null;case 13:if(Ie(je),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(r(340));fr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ie(je),null;case 4:return mr(),null;case 10:return Zs(t.type._context),null;case 22:case 23:return Bo(),null;case 24:return null;default:return null}}var gl=!1,Je=!1,Dh=typeof WeakSet=="function"?WeakSet:Set,_=null;function vr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){Oe(e,t,i)}else n.current=null}function Co(e,t,n){try{n()}catch(i){Oe(e,t,i)}}var ef=!1;function Nh(e,t){if(Ms=Hi,e=Du(),Is(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var o=i.anchorOffset,u=i.focusNode;i=i.focusOffset;try{n.nodeType,u.nodeType}catch{n=null;break e}var p=0,x=-1,C=-1,N=0,z=0,K=e,Y=null;t:for(;;){for(var q;K!==n||o!==0&&K.nodeType!==3||(x=p+o),K!==u||i!==0&&K.nodeType!==3||(C=p+i),K.nodeType===3&&(p+=K.nodeValue.length),(q=K.firstChild)!==null;)Y=K,K=q;for(;;){if(K===e)break t;if(Y===n&&++N===o&&(x=p),Y===u&&++z===i&&(C=p),(q=K.nextSibling)!==null)break;K=Y,Y=K.parentNode}K=q}n=x===-1||C===-1?null:{start:x,end:C}}else n=null}n=n||{start:0,end:0}}else n=null;for(Bs={focusedElem:e,selectionRange:n},Hi=!1,_=t;_!==null;)if(t=_,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,_=e;else for(;_!==null;){t=_;try{var te=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(te!==null){var ne=te.memoizedProps,Ne=te.memoizedState,T=t.stateNode,k=T.getSnapshotBeforeUpdate(t.elementType===t.type?ne:It(t.type,ne),Ne);T.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var P=t.stateNode.containerInfo;P.nodeType===1?P.textContent="":P.nodeType===9&&P.documentElement&&P.removeChild(P.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Z){Oe(t,t.return,Z)}if(e=t.sibling,e!==null){e.return=t.return,_=e;break}_=t.return}return te=ef,ef=!1,te}function ui(e,t,n){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var o=i=i.next;do{if((o.tag&e)===e){var u=o.destroy;o.destroy=void 0,u!==void 0&&Co(t,n,u)}o=o.next}while(o!==i)}}function vl(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function So(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function tf(e){var t=e.alternate;t!==null&&(e.alternate=null,tf(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ot],delete t[_r],delete t[Ls],delete t[mh],delete t[gh])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function nf(e){return e.tag===5||e.tag===3||e.tag===4}function rf(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||nf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ko(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Ki));else if(i!==4&&(e=e.child,e!==null))for(ko(e,t,n),e=e.sibling;e!==null;)ko(e,t,n),e=e.sibling}function Io(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for(Io(e,t,n),e=e.sibling;e!==null;)Io(e,t,n),e=e.sibling}var be=null,Rt=!1;function dn(e,t,n){for(n=n.child;n!==null;)lf(e,t,n),n=n.sibling}function lf(e,t,n){if(Pt&&typeof Pt.onCommitFiberUnmount=="function")try{Pt.onCommitFiberUnmount(Pi,n)}catch{}switch(n.tag){case 5:Je||vr(n,t);case 6:var i=be,o=Rt;be=null,dn(e,t,n),be=i,Rt=o,be!==null&&(Rt?(e=be,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):be.removeChild(n.stateNode));break;case 18:be!==null&&(Rt?(e=be,n=n.stateNode,e.nodeType===8?Qs(e.parentNode,n):e.nodeType===1&&Qs(e,n),Wr(e)):Qs(be,n.stateNode));break;case 4:i=be,o=Rt,be=n.stateNode.containerInfo,Rt=!0,dn(e,t,n),be=i,Rt=o;break;case 0:case 11:case 14:case 15:if(!Je&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){o=i=i.next;do{var u=o,p=u.destroy;u=u.tag,p!==void 0&&((u&2)!==0||(u&4)!==0)&&Co(n,t,p),o=o.next}while(o!==i)}dn(e,t,n);break;case 1:if(!Je&&(vr(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(x){Oe(n,t,x)}dn(e,t,n);break;case 21:dn(e,t,n);break;case 22:n.mode&1?(Je=(i=Je)||n.memoizedState!==null,dn(e,t,n),Je=i):dn(e,t,n);break;default:dn(e,t,n)}}function sf(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Dh),t.forEach(function(i){var o=Vh.bind(null,e,i);n.has(i)||(n.add(i),i.then(o,o))})}}function Tt(e,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var o=n[i];try{var u=e,p=t,x=p;e:for(;x!==null;){switch(x.tag){case 5:be=x.stateNode,Rt=!1;break e;case 3:be=x.stateNode.containerInfo,Rt=!0;break e;case 4:be=x.stateNode.containerInfo,Rt=!0;break e}x=x.return}if(be===null)throw Error(r(160));lf(u,p,o),be=null,Rt=!1;var C=o.alternate;C!==null&&(C.return=null),o.return=null}catch(N){Oe(o,t,N)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)of(t,e),t=t.sibling}function of(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Tt(t,e),Mt(e),i&4){try{ui(3,e,e.return),vl(3,e)}catch(ne){Oe(e,e.return,ne)}try{ui(5,e,e.return)}catch(ne){Oe(e,e.return,ne)}}break;case 1:Tt(t,e),Mt(e),i&512&&n!==null&&vr(n,n.return);break;case 5:if(Tt(t,e),Mt(e),i&512&&n!==null&&vr(n,n.return),e.flags&32){var o=e.stateNode;try{Pr(o,"")}catch(ne){Oe(e,e.return,ne)}}if(i&4&&(o=e.stateNode,o!=null)){var u=e.memoizedProps,p=n!==null?n.memoizedProps:u,x=e.type,C=e.updateQueue;if(e.updateQueue=null,C!==null)try{x==="input"&&u.type==="radio"&&u.name!=null&&Rr(o,u),ns(x,p);var N=ns(x,u);for(p=0;p<C.length;p+=2){var z=C[p],K=C[p+1];z==="style"?Va(o,K):z==="dangerouslySetInnerHTML"?Ua(o,K):z==="children"?Pr(o,K):O(o,z,K,N)}switch(x){case"input":Tr(o,u);break;case"textarea":Fa(o,u);break;case"select":var Y=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!u.multiple;var q=u.value;q!=null?Jn(o,!!u.multiple,q,!1):Y!==!!u.multiple&&(u.defaultValue!=null?Jn(o,!!u.multiple,u.defaultValue,!0):Jn(o,!!u.multiple,u.multiple?[]:"",!1))}o[_r]=u}catch(ne){Oe(e,e.return,ne)}}break;case 6:if(Tt(t,e),Mt(e),i&4){if(e.stateNode===null)throw Error(r(162));o=e.stateNode,u=e.memoizedProps;try{o.nodeValue=u}catch(ne){Oe(e,e.return,ne)}}break;case 3:if(Tt(t,e),Mt(e),i&4&&n!==null&&n.memoizedState.isDehydrated)try{Wr(t.containerInfo)}catch(ne){Oe(e,e.return,ne)}break;case 4:Tt(t,e),Mt(e);break;case 13:Tt(t,e),Mt(e),o=e.child,o.flags&8192&&(u=o.memoizedState!==null,o.stateNode.isHidden=u,!u||o.alternate!==null&&o.alternate.memoizedState!==null||(jo=De())),i&4&&sf(e);break;case 22:if(z=n!==null&&n.memoizedState!==null,e.mode&1?(Je=(N=Je)||z,Tt(t,e),Je=N):Tt(t,e),Mt(e),i&8192){if(N=e.memoizedState!==null,(e.stateNode.isHidden=N)&&!z&&(e.mode&1)!==0)for(_=e,z=e.child;z!==null;){for(K=_=z;_!==null;){switch(Y=_,q=Y.child,Y.tag){case 0:case 11:case 14:case 15:ui(4,Y,Y.return);break;case 1:vr(Y,Y.return);var te=Y.stateNode;if(typeof te.componentWillUnmount=="function"){i=Y,n=Y.return;try{t=i,te.props=t.memoizedProps,te.state=t.memoizedState,te.componentWillUnmount()}catch(ne){Oe(i,n,ne)}}break;case 5:vr(Y,Y.return);break;case 22:if(Y.memoizedState!==null){cf(K);continue}}q!==null?(q.return=Y,_=q):cf(K)}z=z.sibling}e:for(z=null,K=e;;){if(K.tag===5){if(z===null){z=K;try{o=K.stateNode,N?(u=o.style,typeof u.setProperty=="function"?u.setProperty("display","none","important"):u.display="none"):(x=K.stateNode,C=K.memoizedProps.style,p=C!=null&&C.hasOwnProperty("display")?C.display:null,x.style.display=Wa("display",p))}catch(ne){Oe(e,e.return,ne)}}}else if(K.tag===6){if(z===null)try{K.stateNode.nodeValue=N?"":K.memoizedProps}catch(ne){Oe(e,e.return,ne)}}else if((K.tag!==22&&K.tag!==23||K.memoizedState===null||K===e)&&K.child!==null){K.child.return=K,K=K.child;continue}if(K===e)break e;for(;K.sibling===null;){if(K.return===null||K.return===e)break e;z===K&&(z=null),K=K.return}z===K&&(z=null),K.sibling.return=K.return,K=K.sibling}}break;case 19:Tt(t,e),Mt(e),i&4&&sf(e);break;case 21:break;default:Tt(t,e),Mt(e)}}function Mt(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(nf(n)){var i=n;break e}n=n.return}throw Error(r(160))}switch(i.tag){case 5:var o=i.stateNode;i.flags&32&&(Pr(o,""),i.flags&=-33);var u=rf(e);Io(e,u,o);break;case 3:case 4:var p=i.stateNode.containerInfo,x=rf(e);ko(e,x,p);break;default:throw Error(r(161))}}catch(C){Oe(e,e.return,C)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Mh(e,t,n){_=e,af(e)}function af(e,t,n){for(var i=(e.mode&1)!==0;_!==null;){var o=_,u=o.child;if(o.tag===22&&i){var p=o.memoizedState!==null||gl;if(!p){var x=o.alternate,C=x!==null&&x.memoizedState!==null||Je;x=gl;var N=Je;if(gl=p,(Je=C)&&!N)for(_=o;_!==null;)p=_,C=p.child,p.tag===22&&p.memoizedState!==null?ff(o):C!==null?(C.return=p,_=C):ff(o);for(;u!==null;)_=u,af(u),u=u.sibling;_=o,gl=x,Je=N}uf(e)}else(o.subtreeFlags&8772)!==0&&u!==null?(u.return=o,_=u):uf(e)}}function uf(e){for(;_!==null;){var t=_;if((t.flags&8772)!==0){var n=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:Je||vl(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!Je)if(n===null)i.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:It(t.type,n.memoizedProps);i.componentDidUpdate(o,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var u=t.updateQueue;u!==null&&uc(t,u,i);break;case 3:var p=t.updateQueue;if(p!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}uc(t,p,n)}break;case 5:var x=t.stateNode;if(n===null&&t.flags&4){n=x;var C=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":C.autoFocus&&n.focus();break;case"img":C.src&&(n.src=C.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var N=t.alternate;if(N!==null){var z=N.memoizedState;if(z!==null){var K=z.dehydrated;K!==null&&Wr(K)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Je||t.flags&512&&So(t)}catch(Y){Oe(t,t.return,Y)}}if(t===e){_=null;break}if(n=t.sibling,n!==null){n.return=t.return,_=n;break}_=t.return}}function cf(e){for(;_!==null;){var t=_;if(t===e){_=null;break}var n=t.sibling;if(n!==null){n.return=t.return,_=n;break}_=t.return}}function ff(e){for(;_!==null;){var t=_;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{vl(4,t)}catch(C){Oe(t,n,C)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var o=t.return;try{i.componentDidMount()}catch(C){Oe(t,o,C)}}var u=t.return;try{So(t)}catch(C){Oe(t,u,C)}break;case 5:var p=t.return;try{So(t)}catch(C){Oe(t,p,C)}}}catch(C){Oe(t,t.return,C)}if(t===e){_=null;break}var x=t.sibling;if(x!==null){x.return=t.return,_=x;break}_=t.return}}var Bh=Math.ceil,yl=H.ReactCurrentDispatcher,Ro=H.ReactCurrentOwner,xt=H.ReactCurrentBatchConfig,ve=0,Le=null,Be=null,Ye=0,dt=0,yr=on(0),Fe=0,ci=null,Un=0,xl=0,To=0,fi=null,lt=null,jo=0,xr=1/0,Xt=null,wl=!1,Po=null,pn=null,Al=!1,hn=null,El=0,di=0,Oo=null,Cl=-1,Sl=0;function $e(){return(ve&6)!==0?De():Cl!==-1?Cl:Cl=De()}function mn(e){return(e.mode&1)===0?1:(ve&2)!==0&&Ye!==0?Ye&-Ye:yh.transition!==null?(Sl===0&&(Sl=ru()),Sl):(e=Ae,e!==0||(e=window.event,e=e===void 0?16:du(e.type)),e)}function jt(e,t,n,i){if(50<di)throw di=0,Oo=null,Error(r(185));Hr(e,n,i),((ve&2)===0||e!==Le)&&(e===Le&&((ve&2)===0&&(xl|=n),Fe===4&&gn(e,Ye)),st(e,i),n===1&&ve===0&&(t.mode&1)===0&&(xr=De()+500,_i&&un()))}function st(e,t){var n=e.callbackNode;yp(e,t);var i=Ni(e,e===Le?Ye:0);if(i===0)n!==null&&eu(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(n!=null&&eu(n),t===1)e.tag===0?vh(pf.bind(null,e)):qu(pf.bind(null,e)),ph(function(){(ve&6)===0&&un()}),n=null;else{switch(iu(i)){case 1:n=us;break;case 4:n=tu;break;case 16:n=ji;break;case 536870912:n=nu;break;default:n=ji}n=Af(n,df.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function df(e,t){if(Cl=-1,Sl=0,(ve&6)!==0)throw Error(r(327));var n=e.callbackNode;if(wr()&&e.callbackNode!==n)return null;var i=Ni(e,e===Le?Ye:0);if(i===0)return null;if((i&30)!==0||(i&e.expiredLanes)!==0||t)t=kl(e,i);else{t=i;var o=ve;ve|=2;var u=mf();(Le!==e||Ye!==t)&&(Xt=null,xr=De()+500,Vn(e,t));do try{Qh();break}catch(x){hf(e,x)}while(!0);Ks(),yl.current=u,ve=o,Be!==null?t=0:(Le=null,Ye=0,t=Fe)}if(t!==0){if(t===2&&(o=cs(e),o!==0&&(i=o,t=Do(e,o))),t===1)throw n=ci,Vn(e,0),gn(e,i),st(e,De()),n;if(t===6)gn(e,i);else{if(o=e.current.alternate,(i&30)===0&&!Hh(o)&&(t=kl(e,i),t===2&&(u=cs(e),u!==0&&(i=u,t=Do(e,u))),t===1))throw n=ci,Vn(e,0),gn(e,i),st(e,De()),n;switch(e.finishedWork=o,e.finishedLanes=i,t){case 0:case 1:throw Error(r(345));case 2:bn(e,lt,Xt);break;case 3:if(gn(e,i),(i&130023424)===i&&(t=jo+500-De(),10<t)){if(Ni(e,0)!==0)break;if(o=e.suspendedLanes,(o&i)!==i){$e(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=Fs(bn.bind(null,e,lt,Xt),t);break}bn(e,lt,Xt);break;case 4:if(gn(e,i),(i&4194240)===i)break;for(t=e.eventTimes,o=-1;0<i;){var p=31-Ct(i);u=1<<p,p=t[p],p>o&&(o=p),i&=~u}if(i=o,i=De()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Bh(i/1960))-i,10<i){e.timeoutHandle=Fs(bn.bind(null,e,lt,Xt),i);break}bn(e,lt,Xt);break;case 5:bn(e,lt,Xt);break;default:throw Error(r(329))}}}return st(e,De()),e.callbackNode===n?df.bind(null,e):null}function Do(e,t){var n=fi;return e.current.memoizedState.isDehydrated&&(Vn(e,t).flags|=256),e=kl(e,t),e!==2&&(t=lt,lt=n,t!==null&&No(t)),e}function No(e){lt===null?lt=e:lt.push.apply(lt,e)}function Hh(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var o=n[i],u=o.getSnapshot;o=o.value;try{if(!St(u(),o))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function gn(e,t){for(t&=~To,t&=~xl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Ct(t),i=1<<n;e[n]=-1,t&=~i}}function pf(e){if((ve&6)!==0)throw Error(r(327));wr();var t=Ni(e,0);if((t&1)===0)return st(e,De()),null;var n=kl(e,t);if(e.tag!==0&&n===2){var i=cs(e);i!==0&&(t=i,n=Do(e,i))}if(n===1)throw n=ci,Vn(e,0),gn(e,t),st(e,De()),n;if(n===6)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,bn(e,lt,Xt),st(e,De()),null}function Mo(e,t){var n=ve;ve|=1;try{return e(t)}finally{ve=n,ve===0&&(xr=De()+500,_i&&un())}}function Wn(e){hn!==null&&hn.tag===0&&(ve&6)===0&&wr();var t=ve;ve|=1;var n=xt.transition,i=Ae;try{if(xt.transition=null,Ae=1,e)return e()}finally{Ae=i,xt.transition=n,ve=t,(ve&6)===0&&un()}}function Bo(){dt=yr.current,Ie(yr)}function Vn(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,dh(n)),Be!==null)for(n=Be.return;n!==null;){var i=n;switch(bs(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Ji();break;case 3:mr(),Ie(nt),Ie(Ge),no();break;case 5:eo(i);break;case 4:mr();break;case 13:Ie(je);break;case 19:Ie(je);break;case 10:Zs(i.type._context);break;case 22:case 23:Bo()}n=n.return}if(Le=e,Be=e=vn(e.current,null),Ye=dt=t,Fe=0,ci=null,To=xl=Un=0,lt=fi=null,Fn!==null){for(t=0;t<Fn.length;t++)if(n=Fn[t],i=n.interleaved,i!==null){n.interleaved=null;var o=i.next,u=n.pending;if(u!==null){var p=u.next;u.next=o,i.next=p}n.pending=i}Fn=null}return e}function hf(e,t){do{var n=Be;try{if(Ks(),al.current=dl,ul){for(var i=Pe.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}ul=!1}if(Ln=0,Qe=He=Pe=null,ii=!1,li=0,Ro.current=null,n===null||n.return===null){Fe=1,ci=t,Be=null;break}e:{var u=e,p=n.return,x=n,C=t;if(t=Ye,x.flags|=32768,C!==null&&typeof C=="object"&&typeof C.then=="function"){var N=C,z=x,K=z.tag;if((z.mode&1)===0&&(K===0||K===11||K===15)){var Y=z.alternate;Y?(z.updateQueue=Y.updateQueue,z.memoizedState=Y.memoizedState,z.lanes=Y.lanes):(z.updateQueue=null,z.memoizedState=null)}var q=Qc(p);if(q!==null){q.flags&=-257,Lc(q,p,x,u,t),q.mode&1&&Fc(u,N,t),t=q,C=N;var te=t.updateQueue;if(te===null){var ne=new Set;ne.add(C),t.updateQueue=ne}else te.add(C);break e}else{if((t&1)===0){Fc(u,N,t),Ho();break e}C=Error(r(426))}}else if(Te&&x.mode&1){var Ne=Qc(p);if(Ne!==null){(Ne.flags&65536)===0&&(Ne.flags|=256),Lc(Ne,p,x,u,t),Xs(gr(C,x));break e}}u=C=gr(C,x),Fe!==4&&(Fe=2),fi===null?fi=[u]:fi.push(u),u=p;do{switch(u.tag){case 3:u.flags|=65536,t&=-t,u.lanes|=t;var T=Bc(u,C,t);ac(u,T);break e;case 1:x=C;var k=u.type,P=u.stateNode;if((u.flags&128)===0&&(typeof k.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(pn===null||!pn.has(P)))){u.flags|=65536,t&=-t,u.lanes|=t;var Z=Hc(u,x,t);ac(u,Z);break e}}u=u.return}while(u!==null)}vf(n)}catch(le){t=le,Be===n&&n!==null&&(Be=n=n.return);continue}break}while(!0)}function mf(){var e=yl.current;return yl.current=dl,e===null?dl:e}function Ho(){(Fe===0||Fe===3||Fe===2)&&(Fe=4),Le===null||(Un&268435455)===0&&(xl&268435455)===0||gn(Le,Ye)}function kl(e,t){var n=ve;ve|=2;var i=mf();(Le!==e||Ye!==t)&&(Xt=null,Vn(e,t));do try{Fh();break}catch(o){hf(e,o)}while(!0);if(Ks(),ve=n,yl.current=i,Be!==null)throw Error(r(261));return Le=null,Ye=0,Fe}function Fh(){for(;Be!==null;)gf(Be)}function Qh(){for(;Be!==null&&!up();)gf(Be)}function gf(e){var t=wf(e.alternate,e,dt);e.memoizedProps=e.pendingProps,t===null?vf(e):Be=t,Ro.current=null}function vf(e){var t=e;do{var n=t.alternate;if(e=t.return,(t.flags&32768)===0){if(n=Ph(n,t,dt),n!==null){Be=n;return}}else{if(n=Oh(n,t),n!==null){n.flags&=32767,Be=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Fe=6,Be=null;return}}if(t=t.sibling,t!==null){Be=t;return}Be=t=e}while(t!==null);Fe===0&&(Fe=5)}function bn(e,t,n){var i=Ae,o=xt.transition;try{xt.transition=null,Ae=1,Lh(e,t,n,i)}finally{xt.transition=o,Ae=i}return null}function Lh(e,t,n,i){do wr();while(hn!==null);if((ve&6)!==0)throw Error(r(327));n=e.finishedWork;var o=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var u=n.lanes|n.childLanes;if(xp(e,u),e===Le&&(Be=Le=null,Ye=0),(n.subtreeFlags&2064)===0&&(n.flags&2064)===0||Al||(Al=!0,Af(ji,function(){return wr(),null})),u=(n.flags&15990)!==0,(n.subtreeFlags&15990)!==0||u){u=xt.transition,xt.transition=null;var p=Ae;Ae=1;var x=ve;ve|=4,Ro.current=null,Nh(e,n),of(n,e),lh(Bs),Hi=!!Ms,Bs=Ms=null,e.current=n,Mh(n),cp(),ve=x,Ae=p,xt.transition=u}else e.current=n;if(Al&&(Al=!1,hn=e,El=o),u=e.pendingLanes,u===0&&(pn=null),pp(n.stateNode),st(e,De()),t!==null)for(i=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],i(o.value,{componentStack:o.stack,digest:o.digest});if(wl)throw wl=!1,e=Po,Po=null,e;return(El&1)!==0&&e.tag!==0&&wr(),u=e.pendingLanes,(u&1)!==0?e===Oo?di++:(di=0,Oo=e):di=0,un(),null}function wr(){if(hn!==null){var e=iu(El),t=xt.transition,n=Ae;try{if(xt.transition=null,Ae=16>e?16:e,hn===null)var i=!1;else{if(e=hn,hn=null,El=0,(ve&6)!==0)throw Error(r(331));var o=ve;for(ve|=4,_=e.current;_!==null;){var u=_,p=u.child;if((_.flags&16)!==0){var x=u.deletions;if(x!==null){for(var C=0;C<x.length;C++){var N=x[C];for(_=N;_!==null;){var z=_;switch(z.tag){case 0:case 11:case 15:ui(8,z,u)}var K=z.child;if(K!==null)K.return=z,_=K;else for(;_!==null;){z=_;var Y=z.sibling,q=z.return;if(tf(z),z===N){_=null;break}if(Y!==null){Y.return=q,_=Y;break}_=q}}}var te=u.alternate;if(te!==null){var ne=te.child;if(ne!==null){te.child=null;do{var Ne=ne.sibling;ne.sibling=null,ne=Ne}while(ne!==null)}}_=u}}if((u.subtreeFlags&2064)!==0&&p!==null)p.return=u,_=p;else e:for(;_!==null;){if(u=_,(u.flags&2048)!==0)switch(u.tag){case 0:case 11:case 15:ui(9,u,u.return)}var T=u.sibling;if(T!==null){T.return=u.return,_=T;break e}_=u.return}}var k=e.current;for(_=k;_!==null;){p=_;var P=p.child;if((p.subtreeFlags&2064)!==0&&P!==null)P.return=p,_=P;else e:for(p=k;_!==null;){if(x=_,(x.flags&2048)!==0)try{switch(x.tag){case 0:case 11:case 15:vl(9,x)}}catch(le){Oe(x,x.return,le)}if(x===p){_=null;break e}var Z=x.sibling;if(Z!==null){Z.return=x.return,_=Z;break e}_=x.return}}if(ve=o,un(),Pt&&typeof Pt.onPostCommitFiberRoot=="function")try{Pt.onPostCommitFiberRoot(Pi,e)}catch{}i=!0}return i}finally{Ae=n,xt.transition=t}}return!1}function yf(e,t,n){t=gr(n,t),t=Bc(e,t,1),e=fn(e,t,1),t=$e(),e!==null&&(Hr(e,1,t),st(e,t))}function Oe(e,t,n){if(e.tag===3)yf(e,e,n);else for(;t!==null;){if(t.tag===3){yf(t,e,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(pn===null||!pn.has(i))){e=gr(n,e),e=Hc(t,e,1),t=fn(t,e,1),e=$e(),t!==null&&(Hr(t,1,e),st(t,e));break}}t=t.return}}function Uh(e,t,n){var i=e.pingCache;i!==null&&i.delete(t),t=$e(),e.pingedLanes|=e.suspendedLanes&n,Le===e&&(Ye&n)===n&&(Fe===4||Fe===3&&(Ye&130023424)===Ye&&500>De()-jo?Vn(e,0):To|=n),st(e,t)}function xf(e,t){t===0&&((e.mode&1)===0?t=1:(t=Di,Di<<=1,(Di&130023424)===0&&(Di=4194304)));var n=$e();e=bt(e,t),e!==null&&(Hr(e,t,n),st(e,n))}function Wh(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),xf(e,n)}function Vh(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,o=e.memoizedState;o!==null&&(n=o.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(r(314))}i!==null&&i.delete(t),xf(e,n)}var wf;wf=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||nt.current)it=!0;else{if((e.lanes&n)===0&&(t.flags&128)===0)return it=!1,jh(e,t,n);it=(e.flags&131072)!==0}else it=!1,Te&&(t.flags&1048576)!==0&&_u(t,el,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;ml(e,t),e=t.pendingProps;var o=ar(t,Ge.current);hr(t,n),o=lo(null,t,i,e,o,n);var u=so();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,rt(i)?(u=!0,qi(t)):u=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,_s(t),o.updater=pl,t.stateNode=o,o._reactInternals=t,po(t,i,e,n),t=vo(null,t,i,!0,u,n)):(t.tag=0,Te&&u&&Vs(t),_e(null,t,o,n),t=t.child),t;case 16:i=t.elementType;e:{switch(ml(e,t),e=t.pendingProps,o=i._init,i=o(i._payload),t.type=i,o=t.tag=Yh(i),e=It(i,e),o){case 0:t=go(null,t,i,e,n);break e;case 1:t=zc(null,t,i,e,n);break e;case 11:t=Uc(null,t,i,e,n);break e;case 14:t=Wc(null,t,i,It(i.type,e),n);break e}throw Error(r(306,i,""))}return t;case 0:return i=t.type,o=t.pendingProps,o=t.elementType===i?o:It(i,o),go(e,t,i,o,n);case 1:return i=t.type,o=t.pendingProps,o=t.elementType===i?o:It(i,o),zc(e,t,i,o,n);case 3:e:{if(Xc(t),e===null)throw Error(r(387));i=t.pendingProps,u=t.memoizedState,o=u.element,oc(e,t),sl(t,i,null,n);var p=t.memoizedState;if(i=p.element,u.isDehydrated)if(u={element:i,isDehydrated:!1,cache:p.cache,pendingSuspenseBoundaries:p.pendingSuspenseBoundaries,transitions:p.transitions},t.updateQueue.baseState=u,t.memoizedState=u,t.flags&256){o=gr(Error(r(423)),t),t=Gc(e,t,i,n,o);break e}else if(i!==o){o=gr(Error(r(424)),t),t=Gc(e,t,i,n,o);break e}else for(ft=sn(t.stateNode.containerInfo.firstChild),ct=t,Te=!0,kt=null,n=lc(t,null,i,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(fr(),i===o){t=zt(e,t,n);break e}_e(e,t,i,n)}t=t.child}return t;case 5:return cc(t),e===null&&zs(t),i=t.type,o=t.pendingProps,u=e!==null?e.memoizedProps:null,p=o.children,Hs(i,o)?p=null:u!==null&&Hs(i,u)&&(t.flags|=32),Yc(e,t),_e(e,t,p,n),t.child;case 6:return e===null&&zs(t),null;case 13:return Kc(e,t,n);case 4:return $s(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=dr(t,null,i,n):_e(e,t,i,n),t.child;case 11:return i=t.type,o=t.pendingProps,o=t.elementType===i?o:It(i,o),Uc(e,t,i,o,n);case 7:return _e(e,t,t.pendingProps,n),t.child;case 8:return _e(e,t,t.pendingProps.children,n),t.child;case 12:return _e(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,o=t.pendingProps,u=t.memoizedProps,p=o.value,Se(rl,i._currentValue),i._currentValue=p,u!==null)if(St(u.value,p)){if(u.children===o.children&&!nt.current){t=zt(e,t,n);break e}}else for(u=t.child,u!==null&&(u.return=t);u!==null;){var x=u.dependencies;if(x!==null){p=u.child;for(var C=x.firstContext;C!==null;){if(C.context===i){if(u.tag===1){C=Yt(-1,n&-n),C.tag=2;var N=u.updateQueue;if(N!==null){N=N.shared;var z=N.pending;z===null?C.next=C:(C.next=z.next,z.next=C),N.pending=C}}u.lanes|=n,C=u.alternate,C!==null&&(C.lanes|=n),Js(u.return,n,t),x.lanes|=n;break}C=C.next}}else if(u.tag===10)p=u.type===t.type?null:u.child;else if(u.tag===18){if(p=u.return,p===null)throw Error(r(341));p.lanes|=n,x=p.alternate,x!==null&&(x.lanes|=n),Js(p,n,t),p=u.sibling}else p=u.child;if(p!==null)p.return=u;else for(p=u;p!==null;){if(p===t){p=null;break}if(u=p.sibling,u!==null){u.return=p.return,p=u;break}p=p.return}u=p}_e(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,i=t.pendingProps.children,hr(t,n),o=vt(o),i=i(o),t.flags|=1,_e(e,t,i,n),t.child;case 14:return i=t.type,o=It(i,t.pendingProps),o=It(i.type,o),Wc(e,t,i,o,n);case 15:return Vc(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,o=t.pendingProps,o=t.elementType===i?o:It(i,o),ml(e,t),t.tag=1,rt(i)?(e=!0,qi(t)):e=!1,hr(t,n),Nc(t,i,o),po(t,i,o,n),vo(null,t,i,!0,e,n);case 19:return Jc(e,t,n);case 22:return bc(e,t,n)}throw Error(r(156,t.tag))};function Af(e,t){return $a(e,t)}function bh(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wt(e,t,n,i){return new bh(e,t,n,i)}function Fo(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Yh(e){if(typeof e=="function")return Fo(e)?1:0;if(e!=null){if(e=e.$$typeof,e===re)return 11;if(e===oe)return 14}return 2}function vn(e,t){var n=e.alternate;return n===null?(n=wt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Il(e,t,n,i,o,u){var p=2;if(i=e,typeof e=="function")Fo(e)&&(p=1);else if(typeof e=="string")p=5;else e:switch(e){case F:return Yn(n.children,o,u,t);case Q:p=8,o|=8;break;case X:return e=wt(12,n,t,o|2),e.elementType=X,e.lanes=u,e;case J:return e=wt(13,n,t,o),e.elementType=J,e.lanes=u,e;case ce:return e=wt(19,n,t,o),e.elementType=ce,e.lanes=u,e;case de:return Rl(n,o,u,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case U:p=10;break e;case W:p=9;break e;case re:p=11;break e;case oe:p=14;break e;case ie:p=16,i=null;break e}throw Error(r(130,e==null?e:typeof e,""))}return t=wt(p,n,t,o),t.elementType=e,t.type=i,t.lanes=u,t}function Yn(e,t,n,i){return e=wt(7,e,i,t),e.lanes=n,e}function Rl(e,t,n,i){return e=wt(22,e,i,t),e.elementType=de,e.lanes=n,e.stateNode={isHidden:!1},e}function Qo(e,t,n){return e=wt(6,e,null,t),e.lanes=n,e}function Lo(e,t,n){return t=wt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zh(e,t,n,i,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=fs(0),this.expirationTimes=fs(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fs(0),this.identifierPrefix=i,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Uo(e,t,n,i,o,u,p,x,C){return e=new zh(e,t,n,x,C),t===1?(t=1,u===!0&&(t|=8)):t=0,u=wt(3,null,null,t),e.current=u,u.stateNode=e,u.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},_s(u),e}function Xh(e,t,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:D,key:i==null?null:""+i,children:e,containerInfo:t,implementation:n}}function Ef(e){if(!e)return an;e=e._reactInternals;e:{if(Dn(e)!==e||e.tag!==1)throw Error(r(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(rt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(r(171))}if(e.tag===1){var n=e.type;if(rt(n))return Zu(e,n,t)}return t}function Cf(e,t,n,i,o,u,p,x,C){return e=Uo(n,i,!0,e,o,u,p,x,C),e.context=Ef(null),n=e.current,i=$e(),o=mn(n),u=Yt(i,o),u.callback=t??null,fn(n,u,o),e.current.lanes=o,Hr(e,o,i),st(e,i),e}function Tl(e,t,n,i){var o=t.current,u=$e(),p=mn(o);return n=Ef(n),t.context===null?t.context=n:t.pendingContext=n,t=Yt(u,p),t.payload={element:e},i=i===void 0?null:i,i!==null&&(t.callback=i),e=fn(o,t,p),e!==null&&(jt(e,o,p,u),ll(e,o,p)),p}function jl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Sf(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Wo(e,t){Sf(e,t),(e=e.alternate)&&Sf(e,t)}function Gh(){return null}var kf=typeof reportError=="function"?reportError:function(e){console.error(e)};function Vo(e){this._internalRoot=e}Pl.prototype.render=Vo.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(r(409));Tl(e,t,null,null)},Pl.prototype.unmount=Vo.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Wn(function(){Tl(null,e,null,null)}),t[Lt]=null}};function Pl(e){this._internalRoot=e}Pl.prototype.unstable_scheduleHydration=function(e){if(e){var t=ou();e={blockedOn:null,target:e,priority:t};for(var n=0;n<nn.length&&t!==0&&t<nn[n].priority;n++);nn.splice(n,0,e),n===0&&cu(e)}};function bo(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ol(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function If(){}function Kh(e,t,n,i,o){if(o){if(typeof i=="function"){var u=i;i=function(){var N=jl(p);u.call(N)}}var p=Cf(t,i,e,0,null,!1,!1,"",If);return e._reactRootContainer=p,e[Lt]=p.current,Jr(e.nodeType===8?e.parentNode:e),Wn(),p}for(;o=e.lastChild;)e.removeChild(o);if(typeof i=="function"){var x=i;i=function(){var N=jl(C);x.call(N)}}var C=Uo(e,0,!1,null,null,!1,!1,"",If);return e._reactRootContainer=C,e[Lt]=C.current,Jr(e.nodeType===8?e.parentNode:e),Wn(function(){Tl(t,C,n,i)}),C}function Dl(e,t,n,i,o){var u=n._reactRootContainer;if(u){var p=u;if(typeof o=="function"){var x=o;o=function(){var C=jl(p);x.call(C)}}Tl(t,p,e,o)}else p=Kh(n,t,e,o,i);return jl(p)}lu=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Br(t.pendingLanes);n!==0&&(ds(t,n|1),st(t,De()),(ve&6)===0&&(xr=De()+500,un()))}break;case 13:Wn(function(){var i=bt(e,1);if(i!==null){var o=$e();jt(i,e,1,o)}}),Wo(e,1)}},ps=function(e){if(e.tag===13){var t=bt(e,134217728);if(t!==null){var n=$e();jt(t,e,134217728,n)}Wo(e,134217728)}},su=function(e){if(e.tag===13){var t=mn(e),n=bt(e,t);if(n!==null){var i=$e();jt(n,e,t,i)}Wo(e,t)}},ou=function(){return Ae},au=function(e,t){var n=Ae;try{return Ae=e,t()}finally{Ae=n}},ls=function(e,t,n){switch(t){case"input":if(Tr(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var o=Zi(i);if(!o)throw Error(r(90));Pn(i),Tr(i,o)}}}break;case"textarea":Fa(e,n);break;case"select":t=n.value,t!=null&&Jn(e,!!n.multiple,t,!1)}},Xa=Mo,Ga=Wn;var Zh={usingClientEntryPoint:!1,Events:[$r,sr,Zi,Ya,za,Mo]},pi={findFiberByHostInstance:Nn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Jh={bundleType:pi.bundleType,version:pi.version,rendererPackageName:pi.rendererPackageName,rendererConfig:pi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:H.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=qa(e),e===null?null:e.stateNode},findFiberByHostInstance:pi.findFiberByHostInstance||Gh,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Nl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nl.isDisabled&&Nl.supportsFiber)try{Pi=Nl.inject(Jh),Pt=Nl}catch{}}return ot.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Zh,ot.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!bo(t))throw Error(r(200));return Xh(e,t,null,n)},ot.createRoot=function(e,t){if(!bo(e))throw Error(r(299));var n=!1,i="",o=kf;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=Uo(e,1,!1,null,null,n,!1,i,o),e[Lt]=t.current,Jr(e.nodeType===8?e.parentNode:e),new Vo(t)},ot.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(r(188)):(e=Object.keys(e).join(","),Error(r(268,e)));return e=qa(t),e=e===null?null:e.stateNode,e},ot.flushSync=function(e){return Wn(e)},ot.hydrate=function(e,t,n){if(!Ol(t))throw Error(r(200));return Dl(null,e,t,!0,n)},ot.hydrateRoot=function(e,t,n){if(!bo(e))throw Error(r(405));var i=n!=null&&n.hydratedSources||null,o=!1,u="",p=kf;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(u=n.identifierPrefix),n.onRecoverableError!==void 0&&(p=n.onRecoverableError)),t=Cf(t,null,e,1,n??null,o,!1,u,p),e[Lt]=t.current,Jr(e),i)for(e=0;e<i.length;e++)n=i[e],o=n._getVersion,o=o(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new Pl(t)},ot.render=function(e,t,n){if(!Ol(t))throw Error(r(200));return Dl(null,e,t,!1,n)},ot.unmountComponentAtNode=function(e){if(!Ol(e))throw Error(r(40));return e._reactRootContainer?(Wn(function(){Dl(null,null,e,!1,function(){e._reactRootContainer=null,e[Lt]=null})}),!0):!1},ot.unstable_batchedUpdates=Mo,ot.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!Ol(n))throw Error(r(200));if(e==null||e._reactInternals===void 0)throw Error(r(38));return Dl(e,t,n,!1,i)},ot.version="18.3.1-next-f1338f8080-20240426",ot}var Td;function Tm(){if(Td)return ta.exports;Td=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(l){console.error(l)}}return s(),ta.exports=Rm(),ta.exports}var jd;function jm(){if(jd)return Ql;jd=1;var s=Tm();return Ql.createRoot=s.createRoot,Ql.hydrateRoot=s.hydrateRoot,Ql}var Pm=jm();class Gl{constructor(){Gt(this,"project",[]);Gt(this,"status",[]);Gt(this,"text",[]);Gt(this,"labels",[]);Gt(this,"annotations",[])}empty(){return this.project.length+this.status.length+this.text.length===0}static parse(l){const r=Gl.tokenize(l),a=new Set,c=new Set,f=[],d=new Set,m=new Set;for(let w of r){const v=w.startsWith("!");if(v&&(w=w.slice(1)),w.startsWith("p:")){a.add({name:w.slice(2),not:v});continue}if(w.startsWith("s:")){c.add({name:w.slice(2),not:v});continue}if(w.startsWith("@")){d.add({name:w,not:v});continue}if(w.startsWith("annot:")){m.add({name:w.slice(6),not:v});continue}f.push({name:w.toLowerCase(),not:v})}const g=new Gl;return g.text=f,g.project=[...a],g.status=[...c],g.labels=[...d],g.annotations=[...m],g}static tokenize(l){const r=[];let a,c=[];for(let f=0;f<l.length;++f){const d=l[f];if(a&&d==="\\"&&l[f+1]===a){c.push(a),++f;continue}if(d==='"'||d==="'"){a===d?(r.push(c.join("").toLowerCase()),c=[],a=void 0):a?c.push(d):a=d;continue}if(a){c.push(d);continue}if(d===" "){c.length&&(r.push(c.join("").toLowerCase()),c=[]);continue}c.push(d)}return c.length&&r.push(c.join("").toLowerCase()),r}matches(l){const r=Om(l);if(this.project.length&&!!!this.project.find(c=>{const f=r.project.includes(c.name);return c.not?!f:f}))return!1;if(this.status.length){if(!!!this.status.find(c=>{const f=r.status.includes(c.name);return c.not?!f:f}))return!1}else if(r.status==="skipped")return!1;return!(this.text.length&&!this.text.every(c=>{if(r.text.includes(c.name))return!c.not;const[f,d,m]=c.name.split(":");return r.file.includes(f)&&r.line===d&&(m===void 0||r.column===m)?!c.not:!!c.not})||this.labels.length&&!this.labels.every(c=>{const f=r.labels.includes(c.name);return c.not?!f:f})||this.annotations.length&&!this.annotations.every(c=>{const f=r.annotations.some(d=>d.includes(c.name));return c.not?!f:f}))}}const Pd=Symbol("searchValues");function Om(s){const l=s[Pd];if(l)return l;let r="passed";s.outcome==="unexpected"&&(r="failed"),s.outcome==="flaky"&&(r="flaky"),s.outcome==="skipped"&&(r="skipped");const a={text:(r+" "+s.projectName+" "+s.tags.join(" ")+" "+s.location.file+" "+s.path.join(" ")+" "+s.title).toLowerCase(),project:s.projectName.toLowerCase(),status:r,file:s.location.file,line:String(s.location.line),column:String(s.location.column),labels:s.tags.map(c=>c.toLowerCase()),annotations:s.annotations.map(c=>{var f;return c.type.toLowerCase()+"="+((f=c.description)==null?void 0:f.toLocaleLowerCase())})};return s[Pd]=a,a}function Zt(s,l,r){if(r)return s.includes(l)?"#?q="+s.filter(f=>f!==l).join(" ").trim():"#?q="+[...s,l].join(" ").trim();let a;l.startsWith("s:")&&(a="s:"),l.startsWith("p:")&&(a="p:"),l.startsWith("@")&&(a="@");const c=s.filter(f=>!f.startsWith(a));return c.push(l),"#?q="+c.join(" ").trim()}const Dm=()=>h.jsx("svg",{"aria-hidden":"true",height:"16",viewBox:"0 0 16 16",version:"1.1",width:"16","data-view-component":"true",className:"octicon subnav-search-icon",children:h.jsx("path",{fillRule:"evenodd",d:"M11.5 7a4.499 4.499 0 11-8.998 0A4.499 4.499 0 0111.5 7zm-.82 4.74a6 6 0 111.06-1.06l3.04 3.04a.75.75 0 11-1.06 1.06l-3.04-3.04z"})}),Pa=()=>h.jsx("svg",{"aria-hidden":"true",height:"16",viewBox:"0 0 16 16",version:"1.1",width:"16",className:"octicon color-fg-muted",children:h.jsx("path",{fillRule:"evenodd",d:"M12.78 6.22a.75.75 0 010 1.06l-4.25 4.25a.75.75 0 01-1.06 0L3.22 7.28a.75.75 0 011.06-1.06L8 9.94l3.72-3.72a.75.75 0 011.06 0z"})}),Kl=()=>h.jsx("svg",{"aria-hidden":"true",height:"16",viewBox:"0 0 16 16",version:"1.1",width:"16","data-view-component":"true",className:"octicon color-fg-muted",children:h.jsx("path",{fillRule:"evenodd",d:"M6.22 3.22a.75.75 0 011.06 0l4.25 4.25a.75.75 0 010 1.06l-4.25 4.25a.75.75 0 01-1.06-1.06L9.94 8 6.22 4.28a.75.75 0 010-1.06z"})}),U0=()=>h.jsx("svg",{"aria-hidden":"true",height:"16",viewBox:"0 0 16 16",version:"1.1",width:"16","data-view-component":"true",className:"octicon color-text-warning",children:h.jsx("path",{fillRule:"evenodd",d:"M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"})}),W0=()=>h.jsx("svg",{"aria-hidden":"true",height:"16",viewBox:"0 0 16 16",version:"1.1",width:"16","data-view-component":"true",className:"octicon color-fg-muted",children:h.jsx("path",{fillRule:"evenodd",d:"M3.5 1.75a.25.25 0 01.25-.25h3a.75.75 0 000 1.5h.5a.75.75 0 000-1.5h2.086a.25.25 0 01.177.073l2.914 2.914a.25.25 0 01.073.177v8.586a.25.25 0 01-.25.25h-.5a.75.75 0 000 1.5h.5A1.75 1.75 0 0014 13.25V4.664c0-.464-.184-.909-.513-1.237L10.573.513A1.75 1.75 0 009.336 0H3.75A1.75 1.75 0 002 1.75v11.5c0 .649.353 1.214.874 1.515a.75.75 0 10.752-1.298.25.25 0 01-.126-.217V1.75zM8.75 3a.75.75 0 000 1.5h.5a.75.75 0 000-1.5h-.5zM6 5.25a.75.75 0 01.75-.75h.5a.75.75 0 010 1.5h-.5A.75.75 0 016 5.25zm2 1.5A.75.75 0 018.75 6h.5a.75.75 0 010 1.5h-.5A.75.75 0 018 6.75zm-1.25.75a.75.75 0 000 1.5h.5a.75.75 0 000-1.5h-.5zM8 9.75A.75.75 0 018.75 9h.5a.75.75 0 010 1.5h-.5A.75.75 0 018 9.75zm-.75.75a1.75 1.75 0 00-1.75 1.75v3c0 .414.336.75.75.75h2.5a.75.75 0 00.75-.75v-3a1.75 1.75 0 00-1.75-1.75h-.5zM7 12.25a.25.25 0 01.25-.25h.5a.25.25 0 01.25.25v2.25H7v-2.25z"})}),V0=()=>h.jsx("svg",{className:"octicon color-text-danger",viewBox:"0 0 16 16",version:"1.1",width:"16",height:"16","aria-hidden":"true",children:h.jsx("path",{fillRule:"evenodd",d:"M3.72 3.72a.75.75 0 011.06 0L8 6.94l3.22-3.22a.75.75 0 111.06 1.06L9.06 8l3.22 3.22a.75.75 0 11-1.06 1.06L8 9.06l-3.22 3.22a.75.75 0 01-1.06-1.06L6.94 8 3.72 4.78a.75.75 0 010-1.06z"})}),b0=()=>h.jsx("svg",{"aria-hidden":"true",height:"16",viewBox:"0 0 16 16",version:"1.1",width:"16","data-view-component":"true",className:"octicon color-icon-success",children:h.jsx("path",{fillRule:"evenodd",d:"M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"})}),Nm=()=>h.jsx("svg",{"aria-hidden":"true",height:"16",viewBox:"0 0 16 16",version:"1.1",width:"16","data-view-component":"true",className:"octicon color-text-danger",children:h.jsx("path",{fillRule:"evenodd",d:"M5.75.75A.75.75 0 016.5 0h3a.75.75 0 010 1.5h-.75v1l-.001.041a6.718 6.718 0 013.464 1.435l.007-.006.75-.75a.75.75 0 111.06 1.06l-.75.75-.006.007a6.75 6.75 0 11-10.548 0L2.72 5.03l-.75-.75a.75.75 0 011.06-1.06l.75.75.007.006A6.718 6.718 0 017.25 2.541a.756.756 0 010-.041v-1H6.5a.75.75 0 01-.75-.75zM8 14.5A5.25 5.25 0 108 4a5.25 5.25 0 000 10.5zm.389-6.7l1.33-1.33a.75.75 0 111.061 1.06L9.45 8.861A1.502 1.502 0 018 10.75a1.5 1.5 0 11.389-2.95z"})}),Mm=()=>h.jsx("svg",{className:"octicon",viewBox:"0 0 16 16",version:"1.1",width:"16",height:"16","aria-hidden":"true"}),Bm=()=>h.jsx("svg",{className:"octicon",viewBox:"0 0 48 48",version:"1.1",width:"20",height:"20","aria-hidden":"true",children:h.jsx("path",{xmlns:"http://www.w3.org/2000/svg",d:"M11.85 32H36.2l-7.35-9.95-6.55 8.7-4.6-6.45ZM7 40q-1.2 0-2.1-.9Q4 38.2 4 37V11q0-1.2.9-2.1Q5.8 8 7 8h34q1.2 0 2.1.9.9.9.9 2.1v26q0 1.2-.9 2.1-.9.9-2.1.9Zm0-29v26-26Zm34 26V11H7v26Z"})}),Hm=()=>h.jsx("svg",{className:"octicon",viewBox:"0 0 48 48",version:"1.1",width:"20",height:"20","aria-hidden":"true",children:h.jsx("path",{xmlns:"http://www.w3.org/2000/svg",d:"m19.6 32.35 13-8.45-13-8.45ZM7 40q-1.2 0-2.1-.9Q4 38.2 4 37V11q0-1.2.9-2.1Q5.8 8 7 8h34q1.2 0 2.1.9.9.9.9 2.1v26q0 1.2-.9 2.1-.9.9-2.1.9Zm0-3h34V11H7v26Zm0 0V11v26Z"})}),Fm=()=>h.jsx("svg",{className:"octicon",viewBox:"0 0 48 48",version:"1.1",width:"20",height:"20","aria-hidden":"true",children:h.jsx("path",{xmlns:"http://www.w3.org/2000/svg",d:"M7 37h9.35V11H7v26Zm12.35 0h9.3V11h-9.3v26Zm12.3 0H41V11h-9.35v26ZM7 40q-1.2 0-2.1-.9Q4 38.2 4 37V11q0-1.2.9-2.1Q5.8 8 7 8h34q1.2 0 2.1.9.9.9.9 2.1v26q0 1.2-.9 2.1-.9.9-2.1.9Z"})}),Qm=()=>h.jsxs("svg",{className:"octicon",viewBox:"0 0 16 16",width:"16",height:"16","aria-hidden":"true",children:[h.jsx("path",{d:"M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"}),h.jsx("path",{d:"M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"})]});function Y0(){const s=Gn.useRef(null),[l,r]=Gn.useState(new DOMRect(0,0,10,10));return Gn.useLayoutEffect(()=>{const a=s.current;if(!a)return;const c=a.getBoundingClientRect();r(new DOMRect(0,0,c.width,c.height));const f=new ResizeObserver(d=>{const m=d[d.length-1];m&&m.contentRect&&r(m.contentRect)});return f.observe(a),()=>f.disconnect()},[s]),[l,s]}class Lm{constructor(){this.onChangeEmitter=new EventTarget}getString(l,r){return localStorage[l]||r}setString(l,r){var a;localStorage[l]=r,this.onChangeEmitter.dispatchEvent(new Event(l)),(a=window.saveSettings)==null||a.call(window)}getObject(l,r){if(!localStorage[l])return r;try{return JSON.parse(localStorage[l])}catch{return r}}setObject(l,r){var a;localStorage[l]=JSON.stringify(r),this.onChangeEmitter.dispatchEvent(new Event(l)),(a=window.saveSettings)==null||a.call(window)}}new Lm;function Qt(...s){return s.filter(Boolean).join(" ")}const Od="\\u0000-\\u0020\\u007f-\\u009f",Um=new RegExp("(?:[a-zA-Z][a-zA-Z0-9+.-]{2,}:\\/\\/|www\\.)[^\\s"+Od+'"]{2,}[^\\s'+Od+`"')}\\],:;.!?]`,"ug");function Wm(){const[s,l]=Gn.useState(!1),r=Gn.useCallback(()=>{const a=[];return l(c=>(a.push(setTimeout(()=>l(!1),1e3)),c?(a.push(setTimeout(()=>l(!0),50)),!1):!0)),()=>a.forEach(clearTimeout)},[l]);return[s,r]}const z0=({title:s,loadChildren:l,onClick:r,expandByDefault:a,depth:c,style:f,flash:d})=>{const[m,g]=se.useState(a||!1);return h.jsxs("div",{className:Qt("tree-item",d&&"yellow-flash"),style:f,children:[h.jsxs("span",{className:"tree-item-title",style:{whiteSpace:"nowrap",paddingLeft:c*22+4},onClick:()=>{r==null||r(),g(!m)},children:[l&&!!m&&Pa(),l&&!m&&Kl(),!l&&h.jsx("span",{style:{visibility:"hidden"},children:Kl()}),s]}),m&&(l==null?void 0:l())]})},X0=({value:s})=>{const[l,r]=se.useState("copy"),a=se.useCallback(()=>{navigator.clipboard.writeText(s).then(()=>{r("check"),setTimeout(()=>{r("copy")},3e3)},()=>{r("cross")})},[s]),c=l==="check"?b0():l==="cross"?V0():Qm();return h.jsx("button",{className:"copy-icon",title:"Copy to clipboard","aria-label":"Copy to clipboard",onClick:a,children:c})},Oa=({children:s,value:l})=>h.jsxs("span",{className:"copy-value-container",children:[s,h.jsx("span",{className:"copy-button-container",children:h.jsx(X0,{value:l})})]});function Zl(s){const l=[];let r=0,a;for(;(a=Um.exec(s))!==null;){const f=s.substring(r,a.index);f&&l.push(f);const d=a[0];l.push(Vm(d)),r=a.index+d.length}const c=s.substring(r);return c&&l.push(c),l}function Vm(s){let l=s;return l.startsWith("www.")&&(l="https://"+l),h.jsx("a",{href:l,target:"_blank",rel:"noopener noreferrer",children:s})}function Da(s){window.history.pushState({},"",s);const l=new PopStateEvent("popstate");window.dispatchEvent(l)}const Dd=({predicate:s,children:l})=>{const r=se.useContext(Et);return s(r)?l:null},ht=({click:s,ctrlClick:l,children:r,...a})=>h.jsx("a",{...a,style:{textDecoration:"none",color:"var(--color-fg-default)",cursor:"pointer"},onClick:c=>{s&&(c.preventDefault(),Da((c.metaKey||c.ctrlKey)&&l||s))},children:r}),G0=({projectNames:s,projectName:l})=>{const r=encodeURIComponent(l),a=l===r?l:`"${r.replace(/%22/g,"%5C%22")}"`;return h.jsx(ht,{href:`#?q=p:${a}`,children:h.jsx("span",{className:Qt("label",`label-color-${s.indexOf(l)%6}`),style:{margin:"6px 0 0 6px"},children:l})})},Ll=({attachment:s,result:l,href:r,linkName:a,openInNewTab:c})=>{const[f,d]=Wm();return Na("attachment-"+l.attachments.indexOf(s),d),h.jsx(z0,{title:h.jsxs("span",{children:[s.contentType===zm?U0():W0(),s.path&&(c?h.jsx("a",{href:r||s.path,target:"_blank",rel:"noreferrer",children:a||s.name}):h.jsx("a",{href:r||s.path,download:Ym(s),children:a||s.name})),!s.path&&(c?h.jsx("a",{href:URL.createObjectURL(new Blob([s.body],{type:s.contentType})),target:"_blank",rel:"noreferrer",onClick:m=>m.stopPropagation(),children:s.name}):h.jsx("span",{children:Zl(s.name)}))]}),loadChildren:s.body?()=>[h.jsxs("div",{className:"attachment-body",children:[h.jsx(X0,{value:s.body}),Zl(s.body)]},1)]:void 0,depth:0,style:{lineHeight:"32px"},flash:f})},Et=se.createContext(new URLSearchParams(window.location.hash.slice(1))),bm=({children:s})=>{const[l,r]=se.useState(new URLSearchParams(window.location.hash.slice(1)));return se.useEffect(()=>{const a=()=>r(new URLSearchParams(window.location.hash.slice(1)));return window.addEventListener("popstate",a),()=>window.removeEventListener("popstate",a)},[]),h.jsx(Et.Provider,{value:l,children:s})};function Ym(s){if(s.name.includes(".")||!s.path)return s.name;const l=s.path.indexOf(".");return l===-1?s.name:s.name+s.path.slice(l,s.path.length)}function K0(s){return`trace/index.html?${s.map((l,r)=>`trace=${new URL(l.path,window.location.href)}`).join("&")}`}const zm="x-playwright/missing";function Na(s,l){const r=se.useContext(Et),a=Xm(s);se.useEffect(()=>{if(a)return l()},[a,l,r])}function Xm(s){const r=se.useContext(Et).get("anchor");return r===null||typeof s>"u"?!1:typeof s=="string"?s===r:Array.isArray(s)?s.includes(r):s(r)}function vi({id:s,children:l}){const r=se.useRef(null),a=se.useCallback(()=>{var c;(c=r.current)==null||c.scrollIntoView({block:"start",inline:"start"})},[]);return Na(s,a),h.jsx("div",{ref:r,children:l})}function Zn({test:s,result:l,anchor:r}){const a=new URLSearchParams;return s&&a.set("testId",s.testId),s&&l&&a.set("run",""+s.results.indexOf(l)),r&&a.set("anchor",r),"#?"+a}function Ei(s){switch(s){case"failed":case"unexpected":return V0();case"passed":case"expected":return b0();case"timedOut":return Nm();case"flaky":return U0();case"skipped":case"interrupted":return Mm()}}const Gm=({stats:s,filterText:l,setFilterText:r})=>{const a=se.useContext(Et);return se.useEffect(()=>{const c=a.get("q");r(c?`${c.trim()} `:"")},[a,r]),h.jsx(h.Fragment,{children:h.jsxs("div",{className:"pt-3",children:[h.jsx("div",{className:"header-view-status-container ml-2 pl-2 d-flex",children:h.jsx(Km,{stats:s})}),h.jsxs("form",{className:"subnav-search",onSubmit:c=>{c.preventDefault();const f=new URL(window.location.href);f.hash=l?"?"+new URLSearchParams({q:l}):"",Da(f)},children:[Dm(),h.jsx("input",{spellCheck:!1,className:"form-control subnav-search-input input-contrast width-full",value:l,onChange:c=>{r(c.target.value)}})]})]})})},Km=({stats:s})=>{var c;const a=(((c=se.useContext(Et).get("q"))==null?void 0:c.toString())||"").split(" ");return h.jsxs("nav",{children:[h.jsxs(ht,{className:"subnav-item",href:"#?",children:["All ",h.jsx("span",{className:"d-inline counter",children:s.total-s.skipped})]}),h.jsxs(ht,{className:"subnav-item",click:Zt(a,"s:passed",!1),ctrlClick:Zt(a,"s:passed",!0),children:["Passed ",h.jsx("span",{className:"d-inline counter",children:s.expected})]}),h.jsxs(ht,{className:"subnav-item",click:Zt(a,"s:failed",!1),ctrlClick:Zt(a,"s:failed",!0),children:[!!s.unexpected&&Ei("unexpected")," Failed ",h.jsx("span",{className:"d-inline counter",children:s.unexpected})]}),h.jsxs(ht,{className:"subnav-item",click:Zt(a,"s:flaky",!1),ctrlClick:Zt(a,"s:flaky",!0),children:[!!s.flaky&&Ei("flaky")," Flaky ",h.jsx("span",{className:"d-inline counter",children:s.flaky})]}),h.jsxs(ht,{className:"subnav-item",click:Zt(a,"s:skipped",!1),ctrlClick:Zt(a,"s:skipped",!0),children:["Skipped ",h.jsx("span",{className:"d-inline counter",children:s.skipped})]})]})},Zm=({tabs:s,selectedTab:l,setSelectedTab:r})=>{const a=se.useId();return h.jsx("div",{className:"tabbed-pane",children:h.jsxs("div",{className:"vbox",children:[h.jsx("div",{className:"hbox",style:{flex:"none"},children:h.jsx("div",{className:"tabbed-pane-tab-strip",role:"tablist",children:s.map(c=>h.jsx("div",{className:Qt("tabbed-pane-tab-element",l===c.id&&"selected"),onClick:()=>r(c.id),id:`${a}-${c.id}`,role:"tab","aria-selected":l===c.id,children:h.jsx("div",{className:"tabbed-pane-tab-label",children:c.title})},c.id))})}),s.map(c=>{if(l===c.id)return h.jsx("div",{className:"tab-content",role:"tabpanel","aria-labelledby":`${a}-${c.id}`,children:c.render()},c.id)})]})})},Z0=({header:s,expanded:l,setExpanded:r,children:a,noInsets:c,dataTestId:f})=>{const d=se.useId();return h.jsxs("div",{className:"chip","data-testid":f,children:[h.jsxs("div",{role:"button","aria-expanded":!!l,"aria-controls":d,className:Qt("chip-header",r&&" expanded-"+l),onClick:()=>r==null?void 0:r(!l),title:typeof s=="string"?s:void 0,children:[r&&!!l&&Pa(),r&&!l&&Kl(),s]}),(!r||l)&&h.jsx("div",{id:d,role:"region",className:Qt("chip-body",c&&"chip-body-no-insets"),children:a})]})},Bt=({header:s,initialExpanded:l,noInsets:r,children:a,dataTestId:c,revealOnAnchorId:f})=>{const[d,m]=se.useState(l??!0),g=se.useCallback(()=>m(!0),[]);return Na(f,g),h.jsx(Z0,{header:s,expanded:d,setExpanded:m,noInsets:r,dataTestId:c,children:a})};function kr(s){if(!isFinite(s))return"-";if(s===0)return"0ms";if(s<1e3)return s.toFixed(0)+"ms";const l=s/1e3;if(l<60)return l.toFixed(1)+"s";const r=l/60;if(r<60)return r.toFixed(1)+"m";const a=r/60;return a<24?a.toFixed(1)+"h":(a/24).toFixed(1)+"d"}function J0(s){let l=0;for(let r=0;r<s.length;r++)l=s.charCodeAt(r)+((l<<8)-l);return Math.abs(l%6)}const Jm="data:image/png;base64,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",qm=({cursor:s,onPaneMouseMove:l,onPaneMouseUp:r,onPaneDoubleClick:a})=>(Gn.useEffect(()=>{const c=document.createElement("div");return c.style.position="fixed",c.style.top="0",c.style.right="0",c.style.bottom="0",c.style.left="0",c.style.zIndex="9999",c.style.cursor=s,document.body.appendChild(c),l&&c.addEventListener("mousemove",l),r&&c.addEventListener("mouseup",r),a&&document.body.addEventListener("dblclick",a),()=>{l&&c.removeEventListener("mousemove",l),r&&c.removeEventListener("mouseup",r),a&&document.body.removeEventListener("dblclick",a),document.body.removeChild(c)}},[s,l,r,a]),h.jsx(h.Fragment,{})),_m={position:"absolute",top:0,right:0,bottom:0,left:0},$m=({orientation:s,offsets:l,setOffsets:r,resizerColor:a,resizerWidth:c,minColumnWidth:f})=>{const d=f||0,[m,g]=Gn.useState(null),[w,v]=Y0(),S={position:"absolute",right:s==="horizontal"?void 0:0,bottom:s==="horizontal"?0:void 0,width:s==="horizontal"?7:void 0,height:s==="horizontal"?void 0:7,borderTopWidth:s==="horizontal"?void 0:(7-c)/2,borderRightWidth:s==="horizontal"?(7-c)/2:void 0,borderBottomWidth:s==="horizontal"?void 0:(7-c)/2,borderLeftWidth:s==="horizontal"?(7-c)/2:void 0,borderColor:"transparent",borderStyle:"solid",cursor:s==="horizontal"?"ew-resize":"ns-resize"};return h.jsxs("div",{style:{position:"absolute",top:0,right:0,bottom:0,left:-(7-c)/2,zIndex:100,pointerEvents:"none"},ref:v,children:[!!m&&h.jsx(qm,{cursor:s==="horizontal"?"ew-resize":"ns-resize",onPaneMouseUp:()=>g(null),onPaneMouseMove:I=>{if(!I.buttons)g(null);else if(m){const B=s==="horizontal"?I.clientX-m.clientX:I.clientY-m.clientY,V=m.offset+B,A=m.index>0?l[m.index-1]:0,y=s==="horizontal"?w.width:w.height,E=Math.min(Math.max(A+d,V),y-d)-l[m.index];for(let j=m.index;j<l.length;++j)l[j]=l[j]+E;r([...l])}}}),l.map((I,B)=>h.jsx("div",{style:{...S,top:s==="horizontal"?0:I,left:s==="horizontal"?I:0,pointerEvents:"initial"},onMouseDown:V=>g({clientX:V.clientX,clientY:V.clientY,offset:I,index:B}),children:h.jsx("div",{style:{..._m,background:a}})},B))]})};async function ia(s){const l=new Image;return s&&(l.src=s,await new Promise((r,a)=>{l.onload=r,l.onerror=r})),l}const ga={backgroundImage:`linear-gradient(45deg, #80808020 25%, transparent 25%),
                    linear-gradient(-45deg, #80808020 25%, transparent 25%),
                    linear-gradient(45deg, transparent 75%, #80808020 75%),
                    linear-gradient(-45deg, transparent 75%, #80808020 75%)`,backgroundSize:"20px 20px",backgroundPosition:"0 0, 0 10px, 10px -10px, -10px 0px",boxShadow:`rgb(0 0 0 / 10%) 0px 1.8px 1.9px,
              rgb(0 0 0 / 15%) 0px 6.1px 6.3px,
              rgb(0 0 0 / 10%) 0px -2px 4px,
              rgb(0 0 0 / 15%) 0px -6.1px 12px,
              rgb(0 0 0 / 25%) 0px 6px 12px`},q0=({diff:s,noTargetBlank:l,hideDetails:r})=>{const[a,c]=se.useState(s.diff?"diff":"actual"),[f,d]=se.useState(!1),[m,g]=se.useState(null),[w,v]=se.useState("Expected"),[S,I]=se.useState(null),[B,V]=se.useState(null),[A,y]=Y0();se.useEffect(()=>{(async()=>{var X,U,W,re;g(await ia((X=s.expected)==null?void 0:X.attachment.path)),v(((U=s.expected)==null?void 0:U.title)||"Expected"),I(await ia((W=s.actual)==null?void 0:W.attachment.path)),V(await ia((re=s.diff)==null?void 0:re.attachment.path))})()},[s]);const E=m&&S&&B,j=E?Math.max(m.naturalWidth,S.naturalWidth,200):500,O=E?Math.max(m.naturalHeight,S.naturalHeight,200):500,H=Math.min(1,(A.width-30)/j),G=Math.min(1,(A.width-50)/j/2),D=j*H,F=O*H,Q={flex:"none",margin:"0 10px",cursor:"pointer",userSelect:"none"};return h.jsx("div",{"data-testid":"test-result-image-mismatch",style:{display:"flex",flexDirection:"column",alignItems:"center",flex:"auto"},ref:y,children:E&&h.jsxs(h.Fragment,{children:[h.jsxs("div",{"data-testid":"test-result-image-mismatch-tabs",style:{display:"flex",margin:"10px 0 20px"},children:[s.diff&&h.jsx("div",{style:{...Q,fontWeight:a==="diff"?600:"initial"},onClick:()=>c("diff"),children:"Diff"}),h.jsx("div",{style:{...Q,fontWeight:a==="actual"?600:"initial"},onClick:()=>c("actual"),children:"Actual"}),h.jsx("div",{style:{...Q,fontWeight:a==="expected"?600:"initial"},onClick:()=>c("expected"),children:w}),h.jsx("div",{style:{...Q,fontWeight:a==="sxs"?600:"initial"},onClick:()=>c("sxs"),children:"Side by side"}),h.jsx("div",{style:{...Q,fontWeight:a==="slider"?600:"initial"},onClick:()=>c("slider"),children:"Slider"})]}),h.jsxs("div",{style:{display:"flex",justifyContent:"center",flex:"auto",minHeight:F+60},children:[s.diff&&a==="diff"&&h.jsx(Kt,{image:B,alt:"Diff",hideSize:r,canvasWidth:D,canvasHeight:F,scale:H}),s.diff&&a==="actual"&&h.jsx(Kt,{image:S,alt:"Actual",hideSize:r,canvasWidth:D,canvasHeight:F,scale:H}),s.diff&&a==="expected"&&h.jsx(Kt,{image:m,alt:w,hideSize:r,canvasWidth:D,canvasHeight:F,scale:H}),s.diff&&a==="slider"&&h.jsx(eg,{expectedImage:m,actualImage:S,hideSize:r,canvasWidth:D,canvasHeight:F,scale:H,expectedTitle:w}),s.diff&&a==="sxs"&&h.jsxs("div",{style:{display:"flex"},children:[h.jsx(Kt,{image:m,title:w,hideSize:r,canvasWidth:G*j,canvasHeight:G*O,scale:G}),h.jsx(Kt,{image:f?B:S,title:f?"Diff":"Actual",onClick:()=>d(!f),hideSize:r,canvasWidth:G*j,canvasHeight:G*O,scale:G})]}),!s.diff&&a==="actual"&&h.jsx(Kt,{image:S,title:"Actual",hideSize:r,canvasWidth:D,canvasHeight:F,scale:H}),!s.diff&&a==="expected"&&h.jsx(Kt,{image:m,title:w,hideSize:r,canvasWidth:D,canvasHeight:F,scale:H}),!s.diff&&a==="sxs"&&h.jsxs("div",{style:{display:"flex"},children:[h.jsx(Kt,{image:m,title:w,canvasWidth:G*j,canvasHeight:G*O,scale:G}),h.jsx(Kt,{image:S,title:"Actual",canvasWidth:G*j,canvasHeight:G*O,scale:G})]})]}),!r&&h.jsxs("div",{style:{alignSelf:"start",lineHeight:"18px",marginLeft:"15px"},children:[h.jsx("div",{children:s.diff&&h.jsx("a",{target:"_blank",href:s.diff.attachment.path,rel:"noreferrer",children:s.diff.attachment.name})}),h.jsx("div",{children:h.jsx("a",{target:l?"":"_blank",href:s.actual.attachment.path,rel:"noreferrer",children:s.actual.attachment.name})}),h.jsx("div",{children:h.jsx("a",{target:l?"":"_blank",href:s.expected.attachment.path,rel:"noreferrer",children:s.expected.attachment.name})})]})]})})},eg=({expectedImage:s,actualImage:l,canvasWidth:r,canvasHeight:a,scale:c,expectedTitle:f,hideSize:d})=>{const m={position:"absolute",top:0,left:0},[g,w]=se.useState(r/2),v=s.naturalWidth===l.naturalWidth&&s.naturalHeight===l.naturalHeight;return h.jsxs("div",{style:{flex:"none",display:"flex",alignItems:"center",flexDirection:"column",userSelect:"none"},children:[!d&&h.jsxs("div",{style:{margin:5},children:[!v&&h.jsx("span",{style:{flex:"none",margin:"0 5px"},children:"Expected "}),h.jsx("span",{children:s.naturalWidth}),h.jsx("span",{style:{flex:"none",margin:"0 5px"},children:"x"}),h.jsx("span",{children:s.naturalHeight}),!v&&h.jsx("span",{style:{flex:"none",margin:"0 5px 0 15px"},children:"Actual "}),!v&&h.jsx("span",{children:l.naturalWidth}),!v&&h.jsx("span",{style:{flex:"none",margin:"0 5px"},children:"x"}),!v&&h.jsx("span",{children:l.naturalHeight})]}),h.jsxs("div",{style:{position:"relative",width:r,height:a,margin:15,...ga},children:[h.jsx($m,{orientation:"horizontal",offsets:[g],setOffsets:S=>w(S[0]),resizerColor:"#57606a80",resizerWidth:6}),h.jsx("img",{alt:f,style:{width:s.naturalWidth*c,height:s.naturalHeight*c},draggable:"false",src:s.src}),h.jsx("div",{style:{...m,bottom:0,overflow:"hidden",width:g,...ga},children:h.jsx("img",{alt:"Actual",style:{width:l.naturalWidth*c,height:l.naturalHeight*c},draggable:"false",src:l.src})})]})]})},Kt=({image:s,title:l,alt:r,hideSize:a,canvasWidth:c,canvasHeight:f,scale:d,onClick:m})=>h.jsxs("div",{style:{flex:"none",display:"flex",alignItems:"center",flexDirection:"column"},children:[!a&&h.jsxs("div",{style:{margin:5},children:[l&&h.jsx("span",{style:{flex:"none",margin:"0 5px"},children:l}),h.jsx("span",{children:s.naturalWidth}),h.jsx("span",{style:{flex:"none",margin:"0 5px"},children:"x"}),h.jsx("span",{children:s.naturalHeight})]}),h.jsx("div",{style:{display:"flex",flex:"none",width:c,height:f,margin:15,...ga},children:h.jsx("img",{width:s.naturalWidth*d,height:s.naturalHeight*d,alt:l||r,style:{cursor:m?"pointer":"initial"},draggable:"false",src:s.src,onClick:m})})]});function tg(s,l){const r=/(\x1b\[(\d+(;\d+)*)m)|([^\x1b]+)/g,a=[];let c,f={},d=!1,m=l==null?void 0:l.fg,g=l==null?void 0:l.bg;for(;(c=r.exec(s))!==null;){const[,,w,,v]=c;if(w){const S=+w;switch(S){case 0:f={};break;case 1:f["font-weight"]="bold";break;case 2:f.opacity="0.8";break;case 3:f["font-style"]="italic";break;case 4:f["text-decoration"]="underline";break;case 7:d=!0;break;case 8:f.display="none";break;case 9:f["text-decoration"]="line-through";break;case 22:delete f["font-weight"],delete f["font-style"],delete f.opacity,delete f["text-decoration"];break;case 23:delete f["font-weight"],delete f["font-style"],delete f.opacity;break;case 24:delete f["text-decoration"];break;case 27:d=!1;break;case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:m=Nd[S-30];break;case 39:m=l==null?void 0:l.fg;break;case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:g=Nd[S-40];break;case 49:g=l==null?void 0:l.bg;break;case 53:f["text-decoration"]="overline";break;case 90:case 91:case 92:case 93:case 94:case 95:case 96:case 97:m=Md[S-90];break;case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:g=Md[S-100];break}}else if(v){const S={...f},I=d?g:m;I!==void 0&&(S.color=I);const B=d?m:g;B!==void 0&&(S["background-color"]=B),a.push(`<span style="${rg(S)}">${ng(v)}</span>`)}}return a.join("")}const Nd={0:"var(--vscode-terminal-ansiBlack)",1:"var(--vscode-terminal-ansiRed)",2:"var(--vscode-terminal-ansiGreen)",3:"var(--vscode-terminal-ansiYellow)",4:"var(--vscode-terminal-ansiBlue)",5:"var(--vscode-terminal-ansiMagenta)",6:"var(--vscode-terminal-ansiCyan)",7:"var(--vscode-terminal-ansiWhite)"},Md={0:"var(--vscode-terminal-ansiBrightBlack)",1:"var(--vscode-terminal-ansiBrightRed)",2:"var(--vscode-terminal-ansiBrightGreen)",3:"var(--vscode-terminal-ansiBrightYellow)",4:"var(--vscode-terminal-ansiBrightBlue)",5:"var(--vscode-terminal-ansiBrightMagenta)",6:"var(--vscode-terminal-ansiBrightCyan)",7:"var(--vscode-terminal-ansiBrightWhite)"};function ng(s){return s.replace(/[&"<>]/g,l=>({"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"})[l])}function rg(s){return Object.entries(s).map(([l,r])=>`${l}: ${r}`).join("; ")}const ig=`
# Instructions

- Following Playwright test failed.
- Explain why, be concise, respect Playwright best practices.
- Provide a snippet of code with the fix, if possible.
`.trimStart(),_0=({error:s,testId:l,context:r})=>h.jsx($0,{code:s,testId:l,children:r&&h.jsx("div",{style:{position:"absolute",right:0,padding:"10px"},children:h.jsx(lg,{context:r})})}),$0=({code:s,children:l,testId:r})=>{const a=se.useMemo(()=>va(s),[s]);return h.jsxs("div",{className:"test-error-container test-error-text","data-testid":r,children:[l,h.jsx("div",{className:"test-error-view",dangerouslySetInnerHTML:{__html:a||""}})]})},lg=({context:s})=>{const[l,r]=se.useState(!1);return h.jsx("button",{className:"button",style:{minWidth:100},onClick:async()=>{const a=s.body?s.body:await fetch(s.path).then(c=>c.text());await navigator.clipboard.writeText(ig+a),r(!0),setTimeout(()=>{r(!1)},3e3)},children:l?"Copied":"Copy prompt"})},sg=({errorPrefix:s,diff:l,errorSuffix:r})=>{const a=se.useMemo(()=>va(s),[s]),c=se.useMemo(()=>va(r),[r]);return h.jsxs("div",{"data-testid":"test-screenshot-error-view",className:"test-error-view",children:[h.jsx("div",{dangerouslySetInnerHTML:{__html:a||""},className:"test-error-text",style:{marginBottom:20}}),h.jsx(q0,{diff:l,hideDetails:!0},"image-diff"),h.jsx("div",{"data-testid":"error-suffix",dangerouslySetInnerHTML:{__html:c||""},className:"test-error-text"})]})};function va(s){return tg(s||"",{bg:"var(--color-canvas-subtle)",fg:"var(--color-fg-default)"})}function og(s,l){var a;const r=new Map;for(const c of s){const f=c.name.match(/^(.*)-(expected|actual|diff|previous)(\.[^.]+)?$/);if(!f)continue;const[,d,m,g=""]=f,w=d+g;let v=r.get(w);v||(v={name:w,anchors:[`attachment-${d}`]},r.set(w,v)),v.anchors.push(`attachment-${l.attachments.indexOf(c)}`),m==="actual"&&(v.actual={attachment:c}),m==="expected"&&(v.expected={attachment:c,title:"Expected"}),m==="previous"&&(v.expected={attachment:c,title:"Previous"}),m==="diff"&&(v.diff={attachment:c})}for(const[c,f]of r)!f.actual||!f.expected?r.delete(c):(s.delete(f.actual.attachment),s.delete(f.expected.attachment),s.delete((a=f.diff)==null?void 0:a.attachment));return[...r.values()]}const ag=({test:s,result:l})=>{const{screenshots:r,videos:a,traces:c,otherAttachments:f,diffs:d,errors:m,otherAttachmentAnchors:g,screenshotAnchors:w}=se.useMemo(()=>{const v=l.attachments.filter(O=>!O.name.startsWith("_")),S=new Set(v.filter(O=>O.contentType.startsWith("image/"))),I=[...S].map(O=>`attachment-${v.indexOf(O)}`),B=v.filter(O=>O.contentType.startsWith("video/")),V=v.filter(O=>O.name==="trace"),A=new Set(v);[...S,...B,...V].forEach(O=>A.delete(O));const y=[...A].map(O=>`attachment-${v.indexOf(O)}`),E=og(S,l),j=ug(l.errors,E,l.attachments);return{screenshots:[...S],videos:B,traces:V,otherAttachments:A,diffs:E,errors:j,otherAttachmentAnchors:y,screenshotAnchors:I}},[l]);return h.jsxs("div",{className:"test-result",children:[!!m.length&&h.jsx(Bt,{header:"Errors",children:m.map((v,S)=>v.type==="screenshot"?h.jsx(sg,{errorPrefix:v.errorPrefix,diff:v.diff,errorSuffix:v.errorSuffix},"test-result-error-message-"+S):h.jsx(_0,{error:v.error,context:v.context},"test-result-error-message-"+S))}),!!l.steps.length&&h.jsx(Bt,{header:"Test Steps",children:l.steps.map((v,S)=>h.jsx(ep,{step:v,result:l,test:s,depth:0},`step-${S}`))}),d.map((v,S)=>h.jsx(vi,{id:v.anchors,children:h.jsx(Bt,{dataTestId:"test-results-image-diff",header:`Image mismatch: ${v.name}`,revealOnAnchorId:v.anchors,children:h.jsx(q0,{diff:v})})},`diff-${S}`)),!!r.length&&h.jsx(Bt,{header:"Screenshots",revealOnAnchorId:w,children:r.map((v,S)=>h.jsxs(vi,{id:`attachment-${l.attachments.indexOf(v)}`,children:[h.jsx("a",{href:v.path,children:h.jsx("img",{className:"screenshot",src:v.path})}),h.jsx(Ll,{attachment:v,result:l})]},`screenshot-${S}`))}),!!c.length&&h.jsx(vi,{id:"attachment-trace",children:h.jsx(Bt,{header:"Traces",revealOnAnchorId:"attachment-trace",children:h.jsxs("div",{children:[h.jsx("a",{href:K0(c),children:h.jsx("img",{className:"screenshot",src:Jm,style:{width:192,height:117,marginLeft:20}})}),c.map((v,S)=>h.jsx(Ll,{attachment:v,result:l,linkName:c.length===1?"trace":`trace-${S+1}`},`trace-${S}`))]})})}),!!a.length&&h.jsx(vi,{id:"attachment-video",children:h.jsx(Bt,{header:"Videos",revealOnAnchorId:"attachment-video",children:a.map(v=>h.jsxs("div",{children:[h.jsx("video",{controls:!0,children:h.jsx("source",{src:v.path,type:v.contentType})}),h.jsx(Ll,{attachment:v,result:l})]},v.path))})}),!!f.size&&h.jsx(Bt,{header:"Attachments",revealOnAnchorId:g,dataTestId:"attachments",children:[...f].map((v,S)=>h.jsx(vi,{id:`attachment-${l.attachments.indexOf(v)}`,children:h.jsx(Ll,{attachment:v,result:l,openInNewTab:v.contentType.startsWith("text/html")})},`attachment-link-${S}`))})]})};function ug(s,l,r){return s.map((a,c)=>{const f=a.split(`
`)[0];if(f.includes("toHaveScreenshot")||f.includes("toMatchSnapshot")){const m=l.find(g=>{var v;const w=(v=g.actual)==null?void 0:v.attachment.name;return w&&a.includes(w)});if(m){const g=a.split(`
`),w=g.findIndex(B=>/Expected:|Previous:|Received:/.test(B)),v=w!==-1?g.slice(0,w).join(`
`):g[0],S=g.findIndex(B=>/ +Diff:/.test(B)),I=S!==-1?g.slice(S+2).join(`
`):g.slice(1).join(`
`);return{type:"screenshot",diff:m,errorPrefix:v,errorSuffix:I}}}const d=r.find(m=>m.name===`_error-context-${c}`);return{type:"regular",error:a,context:d}})}const ep=({test:s,step:l,result:r,depth:a})=>h.jsx(z0,{title:h.jsxs("span",{"aria-label":l.title,children:[h.jsx("span",{style:{float:"right"},children:kr(l.duration)}),l.attachments.length>0&&h.jsx("a",{style:{float:"right"},title:"reveal attachment",href:Zn({test:s,result:r,anchor:`attachment-${l.attachments[0]}`}),onClick:c=>{c.stopPropagation()},children:W0()}),Ei(l.error||l.duration===-1?"failed":l.skipped?"skipped":"passed"),h.jsx("span",{children:l.title}),l.count>1&&h.jsxs(h.Fragment,{children:[" ✕ ",h.jsx("span",{className:"test-result-counter",children:l.count})]}),l.location&&h.jsxs("span",{className:"test-result-path",children:["— ",l.location.file,":",l.location.line]})]}),loadChildren:l.steps.length||l.snippet?()=>{const c=l.snippet?[h.jsx($0,{testId:"test-snippet",code:l.snippet},"line")]:[],f=l.steps.map((d,m)=>h.jsx(ep,{step:d,depth:a+1,result:r,test:s},m));return c.concat(f)}:void 0,depth:a}),cg=({projectNames:s,test:l,run:r,next:a,prev:c})=>{const[f,d]=se.useState(r),m=se.useContext(Et),g=m.has("q")?"&q="+m.get("q"):"",w=se.useMemo(()=>{if(l)return l.tags},[l]),v=(l==null?void 0:l.annotations.filter(S=>!S.type.startsWith("_")))??[];return h.jsxs("div",{className:"test-case-column vbox",children:[l&&h.jsxs("div",{className:"hbox",children:[h.jsx("div",{className:"test-case-path",children:l.path.join(" › ")}),h.jsx("div",{style:{flex:"auto"}}),h.jsx("div",{className:Qt(!c&&"hidden"),children:h.jsx(ht,{href:Zn({test:c})+g,children:"« previous"})}),h.jsx("div",{style:{width:10}}),h.jsx("div",{className:Qt(!a&&"hidden"),children:h.jsx(ht,{href:Zn({test:a})+g,children:"next »"})})]}),l&&h.jsx("div",{className:"test-case-title",children:l==null?void 0:l.title}),l&&h.jsxs("div",{className:"hbox",children:[h.jsx("div",{className:"test-case-location",children:h.jsxs(Oa,{value:`${l==null?void 0:l.location.file}:${l==null?void 0:l.location.line}`,children:[l.location.file,":",l.location.line]})}),h.jsx("div",{style:{flex:"auto"}}),h.jsx("div",{className:"test-case-duration",children:kr(l.duration)})]}),l&&(!!l.projectName||w)&&h.jsxs("div",{className:"test-case-project-labels-row",children:[l&&!!l.projectName&&h.jsx(G0,{projectNames:s,projectName:l.projectName}),w&&h.jsx(dg,{labels:w})]}),(l==null?void 0:l.results.length)===0&&v.length!==0&&h.jsx(Bt,{header:"Annotations",dataTestId:"test-case-annotations",children:v.map((S,I)=>h.jsx(Bd,{annotation:S},I))}),l&&h.jsx(Zm,{tabs:l.results.map((S,I)=>({id:String(I),title:h.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[Ei(S.status)," ",fg(I),l.results.length>1&&h.jsx("span",{className:"test-case-run-duration",children:kr(S.duration)})]}),render:()=>{const B=S.annotations.filter(V=>!V.type.startsWith("_"));return h.jsxs(h.Fragment,{children:[!!B.length&&h.jsx(Bt,{header:"Annotations",dataTestId:"test-case-annotations",children:B.map((V,A)=>h.jsx(Bd,{annotation:V},A))}),h.jsx(ag,{test:l,result:S})]})}}))||[],selectedTab:String(f),setSelectedTab:S=>d(+S)})]})};function Bd({annotation:{type:s,description:l}}){return h.jsxs("div",{className:"test-case-annotation",children:[h.jsx("span",{style:{fontWeight:"bold"},children:s}),l&&h.jsxs(Oa,{value:l,children:[": ",Zl(l)]})]})}function fg(s){return s?`Retry #${s}`:"Run"}const dg=({labels:s})=>s.length>0?h.jsx(h.Fragment,{children:s.map(l=>h.jsx("a",{style:{textDecoration:"none",color:"var(--color-fg-default)"},href:`#?q=${l}`,children:h.jsx("span",{style:{margin:"6px 0 0 6px",cursor:"pointer"},className:Qt("label","label-color-"+J0(l)),children:l.slice(1)})},l))}):null,pg=({file:s,projectNames:l,isFileExpanded:r,setFileExpanded:a})=>{const c=se.useContext(Et),f=c.has("q")?"&q="+c.get("q"):"";return h.jsx(Z0,{expanded:r(s.fileId),noInsets:!0,setExpanded:d=>a(s.fileId,d),header:h.jsx("span",{children:s.fileName}),children:s.tests.map(d=>h.jsxs("div",{className:Qt("test-file-test","test-file-test-outcome-"+d.outcome),children:[h.jsxs("div",{className:"hbox",style:{alignItems:"flex-start"},children:[h.jsxs("div",{className:"hbox",children:[h.jsx("span",{className:"test-file-test-status-icon",children:Ei(d.outcome)}),h.jsxs("span",{children:[h.jsx(ht,{href:Zn({test:d})+f,title:[...d.path,d.title].join(" › "),children:h.jsx("span",{className:"test-file-title",children:[...d.path,d.title].join(" › ")})}),l.length>1&&!!d.projectName&&h.jsx(G0,{projectNames:l,projectName:d.projectName}),h.jsx(vg,{labels:d.tags})]})]}),h.jsx("span",{"data-testid":"test-duration",style:{minWidth:"50px",textAlign:"right"},children:kr(d.duration)})]}),h.jsxs("div",{className:"test-file-details-row",children:[h.jsx(ht,{href:Zn({test:d}),title:[...d.path,d.title].join(" › "),className:"test-file-path-link",children:h.jsxs("span",{className:"test-file-path",children:[d.location.file,":",d.location.line]})}),hg(d),mg(d),gg(d)]})]},`test-${d.testId}`))})};function hg(s){for(const l of s.results)for(const r of l.attachments)if(r.contentType.startsWith("image/")&&r.name.match(/-(expected|actual|diff)/))return h.jsx(ht,{href:Zn({test:s,result:l,anchor:`attachment-${l.attachments.indexOf(r)}`}),title:"View images",className:"test-file-badge",children:Bm()})}function mg(s){const l=s.results.find(r=>r.attachments.some(a=>a.name==="video"));return l?h.jsx(ht,{href:Zn({test:s,result:l,anchor:"attachment-video"}),title:"View video",className:"test-file-badge",children:Hm()}):void 0}function gg(s){const l=s.results.map(r=>r.attachments.filter(a=>a.name==="trace")).filter(r=>r.length>0)[0];if(l)return h.jsxs(ht,{href:K0(l),title:"View Trace",className:"button test-file-badge",children:[Fm(),h.jsx("span",{children:"View Trace"})]})}const vg=({labels:s})=>{const l=se.useContext(Et),r=(a,c)=>{var m;a.preventDefault();const d=(((m=l.get("q"))==null?void 0:m.toString())||"").split(" ");Da(Zt(d,c,a.metaKey||a.ctrlKey))};return s.length>0?h.jsx(h.Fragment,{children:s.map(a=>h.jsx("span",{style:{margin:"6px 0 0 6px",cursor:"pointer"},className:Qt("label","label-color-"+J0(a)),onClick:c=>r(c,a),children:a.slice(1)},a))}):null};class yg extends se.Component{constructor(){super(...arguments);Gt(this,"state",{error:null,errorInfo:null})}componentDidCatch(r,a){this.setState({error:r,errorInfo:a})}render(){var r,a,c;return this.state.error||this.state.errorInfo?h.jsxs("div",{className:"metadata-view p-3",children:[h.jsx("p",{children:"An error was encountered when trying to render metadata."}),h.jsx("p",{children:h.jsxs("pre",{style:{overflow:"scroll"},children:[(r=this.state.error)==null?void 0:r.message,h.jsx("br",{}),(a=this.state.error)==null?void 0:a.stack,h.jsx("br",{}),(c=this.state.errorInfo)==null?void 0:c.componentStack]})})]}):this.props.children}}const xg=s=>h.jsx(yg,{children:h.jsx(wg,{metadata:s.metadata})}),wg=s=>{const l=se.useContext(Et),r=s.metadata,a=l.has("show-metadata-other")?Object.entries(s.metadata).filter(([f])=>!tp.has(f)):[];if(r.ci||r.gitCommit||a.length>0)return h.jsxs("div",{className:"metadata-view",children:[r.ci&&!r.gitCommit&&h.jsx(Ag,{info:r.ci}),r.gitCommit&&h.jsx(Eg,{ci:r.ci,commit:r.gitCommit}),a.length>0&&(r.gitCommit||r.ci)&&h.jsx("div",{className:"metadata-separator"}),h.jsx("div",{className:"metadata-section metadata-properties",role:"list",children:a.map(([f,d])=>{const m=typeof d!="object"||d===null||d===void 0?String(d):JSON.stringify(d),g=m.length>1e3?m.slice(0,1e3)+"…":m;return h.jsx("div",{className:"copyable-property",role:"listitem",children:h.jsxs(Oa,{value:m,children:[h.jsx("span",{style:{fontWeight:"bold"},title:f,children:f}),": ",h.jsx("span",{title:g,children:Zl(g)})]})},f)})})]})},Ag=({info:s})=>{const l=s.prTitle||`Commit ${s.commitHash}`,r=s.prHref||s.commitHref;return h.jsx("div",{className:"metadata-section",role:"list",children:h.jsx("div",{role:"listitem",children:h.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",title:l,children:l})})})},Eg=({ci:s,commit:l})=>{const r=(s==null?void 0:s.prTitle)||l.subject,a=(s==null?void 0:s.prHref)||(s==null?void 0:s.commitHref),c=` <${l.author.email}>`,f=`${l.author.name}${c}`,d=Intl.DateTimeFormat(void 0,{dateStyle:"medium"}).format(l.committer.time),m=Intl.DateTimeFormat(void 0,{dateStyle:"full",timeStyle:"long"}).format(l.committer.time);return h.jsxs("div",{className:"metadata-section",role:"list",children:[h.jsxs("div",{role:"listitem",children:[a&&h.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",title:r,children:r}),!a&&h.jsx("span",{title:r,children:r})]}),h.jsxs("div",{role:"listitem",className:"hbox",children:[h.jsx("span",{className:"mr-1",children:f}),h.jsxs("span",{title:m,children:[" on ",d]})]})]})},tp=new Set(["ci","gitCommit","gitDiff","actualWorkers"]),Cg=s=>{const l=Object.entries(s).filter(([r])=>!tp.has(r));return!s.ci&&!s.gitCommit&&!l.length},Sg=({tests:s,expandedFiles:l,setExpandedFiles:r,projectNames:a})=>{const c=se.useMemo(()=>{const f=[];let d=0;for(const m of s)d+=m.tests.length,f.push({file:m,defaultExpanded:d<200});return f},[s]);return h.jsx(h.Fragment,{children:c.map(({file:f,defaultExpanded:d})=>h.jsx(pg,{file:f,projectNames:a,isFileExpanded:m=>{const g=l.get(m);return g===void 0?d:!!g},setFileExpanded:(m,g)=>{const w=new Map(l);w.set(m,g),r(w)}},`file-${f.fileId}`))})},kg=({report:s,filteredStats:l,metadataVisible:r,toggleMetadataVisible:a})=>s?h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"mx-1",style:{display:"flex",marginTop:10},children:[h.jsxs("div",{className:"test-file-header-info",children:[!Cg(s.metadata)&&h.jsxs("div",{className:"metadata-toggle",role:"button",onClick:a,title:r?"Hide metadata":"Show metadata",children:[r?Pa():Kl(),"Metadata"]}),s.projectNames.length===1&&!!s.projectNames[0]&&h.jsxs("div",{"data-testid":"project-name",children:["Project: ",s.projectNames[0]]}),l&&h.jsxs("div",{"data-testid":"filtered-tests-count",children:["Filtered: ",l.total," ",!!l.total&&"("+kr(l.duration)+")"]})]}),h.jsx("div",{style:{flex:"auto"}}),h.jsx("div",{"data-testid":"overall-time",style:{color:"var(--color-fg-subtle)",marginRight:"10px"},children:s?new Date(s.startTime).toLocaleString():""}),h.jsxs("div",{"data-testid":"overall-duration",style:{color:"var(--color-fg-subtle)"},children:["Total time: ",kr(s.duration??0)]})]}),r&&h.jsx(xg,{metadata:s.metadata}),!!s.errors.length&&h.jsx(Bt,{header:"Errors",dataTestId:"report-errors",children:s.errors.map((c,f)=>h.jsx(_0,{error:c},"test-report-error-message-"+f))})]}):null,Ig=s=>!s.has("testId"),Rg=s=>s.has("testId"),Tg=({report:s})=>{const l=se.useContext(Et),[r,a]=se.useState(new Map),[c,f]=se.useState(l.get("q")||""),[d,m]=se.useState(!1),g=se.useMemo(()=>{const I=new Map;for(const B of(s==null?void 0:s.json().files)||[])for(const V of B.tests)I.set(V.testId,B.fileId);return I},[s]),w=se.useMemo(()=>Gl.parse(c),[c]),v=se.useMemo(()=>w.empty()?void 0:Pg((s==null?void 0:s.json().files)||[],w),[s,w]),S=se.useMemo(()=>{const I={files:[],tests:[]};for(const B of(s==null?void 0:s.json().files)||[]){const V=B.tests.filter(A=>w.matches(A));V.length&&I.files.push({...B,tests:V}),I.tests.push(...V)}return I},[s,w]);return h.jsx("div",{className:"htmlreport vbox px-4 pb-4",children:h.jsxs("main",{children:[(s==null?void 0:s.json())&&h.jsx(Gm,{stats:s.json().stats,filterText:c,setFilterText:f}),h.jsxs(Dd,{predicate:Ig,children:[h.jsx(kg,{report:s==null?void 0:s.json(),filteredStats:v,metadataVisible:d,toggleMetadataVisible:()=>m(I=>!I)}),h.jsx(Sg,{tests:S.files,expandedFiles:r,setExpandedFiles:a,projectNames:(s==null?void 0:s.json().projectNames)||[]})]}),h.jsx(Dd,{predicate:Rg,children:!!s&&h.jsx(jg,{report:s,tests:S.tests,testIdToFileIdMap:g})})]})})},jg=({report:s,testIdToFileIdMap:l,tests:r})=>{const a=se.useContext(Et),[c,f]=se.useState(),d=a.get("testId"),m=+(a.get("run")||"0"),{prev:g,next:w}=se.useMemo(()=>{const v=r.findIndex(B=>B.testId===d),S=v>0?r[v-1]:void 0,I=v<r.length-1?r[v+1]:void 0;return{prev:S,next:I}},[d,r]);return se.useEffect(()=>{(async()=>{if(!d||d===(c==null?void 0:c.testId))return;const v=l.get(d);if(!v)return;const S=await s.entry(`${v}.json`);for(const I of S.tests)if(I.testId===d){f(I);break}})()},[c,s,d,l]),h.jsx(cg,{projectNames:s.json().projectNames,next:w,prev:g,test:c,run:m})};function Pg(s,l){const r={total:0,duration:0};for(const a of s){const c=a.tests.filter(f=>l.matches(f));r.total+=c.length;for(const f of c)r.duration+=f.duration}return r}const Og="data:image/svg+xml,%3csvg%20width='400'%20height='400'%20viewBox='0%200%20400%20400'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M136.444%20221.556C123.558%20225.213%20115.104%20231.625%20109.535%20238.032C114.869%20233.364%20122.014%20229.08%20131.652%20226.348C141.51%20223.554%20149.92%20223.574%20156.869%20224.915V219.481C150.941%20218.939%20144.145%20219.371%20136.444%20221.556ZM108.946%20175.876L61.0895%20188.484C61.0895%20188.484%2061.9617%20189.716%2063.5767%20191.36L104.153%20180.668C104.153%20180.668%20103.578%20188.077%2098.5847%20194.705C108.03%20187.559%20108.946%20175.876%20108.946%20175.876ZM149.005%20288.347C81.6582%20306.486%2046.0272%20228.438%2035.2396%20187.928C30.2556%20169.229%2028.0799%20155.067%2027.5%20145.928C27.4377%20144.979%2027.4665%20144.179%2027.5336%20143.446C24.04%20143.657%2022.3674%20145.473%2022.7077%20150.721C23.2876%20159.855%2025.4633%20174.016%2030.4473%20192.721C41.2301%20233.225%2076.8659%20311.273%20144.213%20293.134C158.872%20289.185%20169.885%20281.992%20178.152%20272.81C170.532%20279.692%20160.995%20285.112%20149.005%20288.347ZM161.661%20128.11V132.903H188.077C187.535%20131.206%20186.989%20129.677%20186.447%20128.11H161.661Z'%20fill='%232D4552'/%3e%3cpath%20d='M193.981%20167.584C205.861%20170.958%20212.144%20179.287%20215.465%20186.658L228.711%20190.42C228.711%20190.42%20226.904%20164.623%20203.57%20157.995C181.741%20151.793%20168.308%20170.124%20166.674%20172.496C173.024%20167.972%20182.297%20164.268%20193.981%20167.584ZM299.422%20186.777C277.573%20180.547%20264.145%20198.916%20262.535%20201.255C268.89%20196.736%20278.158%20193.031%20289.837%20196.362C301.698%20199.741%20307.976%20208.06%20311.307%20215.436L324.572%20219.212C324.572%20219.212%20322.736%20193.41%20299.422%20186.777ZM286.262%20254.795L176.072%20223.99C176.072%20223.99%20177.265%20230.038%20181.842%20237.869L274.617%20263.805C282.255%20259.386%20286.262%20254.795%20286.262%20254.795ZM209.867%20321.102C122.618%20297.71%20133.166%20186.543%20147.284%20133.865C153.097%20112.156%20159.073%2096.0203%20164.029%2085.204C161.072%2084.5953%20158.623%2086.1529%20156.203%2091.0746C150.941%20101.747%20144.212%20119.124%20137.7%20143.45C123.586%20196.127%20113.038%20307.29%20200.283%20330.682C241.406%20341.699%20273.442%20324.955%20297.323%20298.659C274.655%20319.19%20245.714%20330.701%20209.867%20321.102Z'%20fill='%232D4552'/%3e%3cpath%20d='M161.661%20262.296V239.863L99.3324%20257.537C99.3324%20257.537%20103.938%20230.777%20136.444%20221.556C146.302%20218.762%20154.713%20218.781%20161.661%20220.123V128.11H192.869C189.471%20117.61%20186.184%20109.526%20183.423%20103.909C178.856%2094.612%20174.174%20100.775%20163.545%20109.665C156.059%20115.919%20137.139%20129.261%20108.668%20136.933C80.1966%20144.61%2057.179%20142.574%2047.5752%20140.911C33.9601%20138.562%2026.8387%20135.572%2027.5049%20145.928C28.0847%20155.062%2030.2605%20169.224%2035.2445%20187.928C46.0272%20228.433%2081.663%20306.481%20149.01%20288.342C166.602%20283.602%20179.019%20274.233%20187.626%20262.291H161.661V262.296ZM61.0848%20188.484L108.946%20175.876C108.946%20175.876%20107.551%20194.288%2089.6087%20199.018C71.6614%20203.743%2061.0848%20188.484%2061.0848%20188.484Z'%20fill='%23E2574C'/%3e%3cpath%20d='M341.786%20129.174C329.345%20131.355%20299.498%20134.072%20262.612%20124.185C225.716%20114.304%20201.236%2097.0224%20191.537%2088.8994C177.788%2077.3834%20171.74%2069.3802%20165.788%2081.4857C160.526%2092.163%20153.797%20109.54%20147.284%20133.866C133.171%20186.543%20122.623%20297.706%20209.867%20321.098C297.093%20344.47%20343.53%20242.92%20357.644%20190.238C364.157%20165.917%20367.013%20147.5%20367.799%20135.625C368.695%20122.173%20359.455%20126.078%20341.786%20129.174ZM166.497%20172.756C166.497%20172.756%20180.246%20151.372%20203.565%20158C226.899%20164.628%20228.706%20190.425%20228.706%20190.425L166.497%20172.756ZM223.42%20268.713C182.403%20256.698%20176.077%20223.99%20176.077%20223.99L286.262%20254.796C286.262%20254.791%20264.021%20280.578%20223.42%20268.713ZM262.377%20201.495C262.377%20201.495%20276.107%20180.126%20299.422%20186.773C322.736%20193.411%20324.572%20219.208%20324.572%20219.208L262.377%20201.495Z'%20fill='%232EAD33'/%3e%3cpath%20d='M139.88%20246.04L99.3324%20257.532C99.3324%20257.532%20103.737%20232.44%20133.607%20222.496L110.647%20136.33L108.663%20136.933C80.1918%20144.611%2057.1742%20142.574%2047.5704%20140.911C33.9554%20138.563%2026.834%20135.572%2027.5001%20145.929C28.08%20155.063%2030.2557%20169.224%2035.2397%20187.929C46.0225%20228.433%2081.6583%20306.481%20149.005%20288.342L150.989%20287.719L139.88%20246.04ZM61.0848%20188.485L108.946%20175.876C108.946%20175.876%20107.551%20194.288%2089.6087%20199.018C71.6615%20203.743%2061.0848%20188.485%2061.0848%20188.485Z'%20fill='%23D65348'/%3e%3cpath%20d='M225.27%20269.163L223.415%20268.712C182.398%20256.698%20176.072%20223.99%20176.072%20223.99L232.89%20239.872L262.971%20124.281L262.607%20124.185C225.711%20114.304%20201.232%2097.0224%20191.532%2088.8994C177.783%2077.3834%20171.735%2069.3802%20165.783%2081.4857C160.526%2092.163%20153.797%20109.54%20147.284%20133.866C133.171%20186.543%20122.623%20297.706%20209.867%20321.097L211.655%20321.5L225.27%20269.163ZM166.497%20172.756C166.497%20172.756%20180.246%20151.372%20203.565%20158C226.899%20164.628%20228.706%20190.425%20228.706%20190.425L166.497%20172.756Z'%20fill='%231D8D22'/%3e%3cpath%20d='M141.946%20245.451L131.072%20248.537C133.641%20263.019%20138.169%20276.917%20145.276%20289.195C146.513%20288.922%20147.74%20288.687%20149%20288.342C152.302%20287.451%20155.364%20286.348%20158.312%20285.145C150.371%20273.361%20145.118%20259.789%20141.946%20245.451ZM137.7%20143.451C132.112%20164.307%20127.113%20194.326%20128.489%20224.436C130.952%20223.367%20133.554%20222.371%20136.444%20221.551L138.457%20221.101C136.003%20188.939%20141.308%20156.165%20147.284%20133.866C148.799%20128.225%20150.318%20122.978%20151.832%20118.085C149.393%20119.637%20146.767%20121.228%20143.776%20122.867C141.759%20129.093%20139.722%20135.898%20137.7%20143.451Z'%20fill='%23C04B41'/%3e%3c/svg%3e",la=Sm,Ma=document.createElement("link");Ma.rel="shortcut icon";Ma.href=Og;document.head.appendChild(Ma);const Dg=()=>{const[s,l]=se.useState();return se.useEffect(()=>{if(s)return;const r=new Ng;r.load().then(()=>l(r))},[s]),h.jsx(bm,{children:h.jsx(Tg,{report:s})})};window.onload=()=>{Pm.createRoot(document.querySelector("#root")).render(h.jsx(Dg,{}))};const Hd="playwrightReportStorageForHMR";class Ng{constructor(){Gt(this,"_entries",new Map);Gt(this,"_json")}async load(){const l=await new Promise(a=>{if(window.playwrightReportBase64)return a(window.playwrightReportBase64);if(window.opener)window.addEventListener("message",c=>{c.source===window.opener&&(localStorage.setItem(Hd,c.data),a(c.data))},{once:!0}),window.opener.postMessage("ready","*");else{const c=localStorage.getItem(Hd);if(c)return a(c);alert("couldnt find report, something with HMR is broken")}}),r=new la.ZipReader(new la.Data64URIReader(l),{useWebWorkers:!1});for(const a of await r.getEntries())this._entries.set(a.filename,a);this._json=await this.entry("report.json")}json(){return this._json}async entry(l){const r=this._entries.get(l),a=new la.TextWriter;return await r.getData(a),JSON.parse(await a.getData())}}
</script>
    <style type='text/css'>:root{--color-canvas-default-transparent: rgba(255,255,255,0);--color-marketing-icon-primary: #218bff;--color-marketing-icon-secondary: #54aeff;--color-diff-blob-addition-num-text: #24292f;--color-diff-blob-addition-fg: #24292f;--color-diff-blob-addition-num-bg: #CCFFD8;--color-diff-blob-addition-line-bg: #E6FFEC;--color-diff-blob-addition-word-bg: #ABF2BC;--color-diff-blob-deletion-num-text: #24292f;--color-diff-blob-deletion-fg: #24292f;--color-diff-blob-deletion-num-bg: #FFD7D5;--color-diff-blob-deletion-line-bg: #FFEBE9;--color-diff-blob-deletion-word-bg: rgba(255,129,130,.4);--color-diff-blob-hunk-num-bg: rgba(84,174,255,.4);--color-diff-blob-expander-icon: #57606a;--color-diff-blob-selected-line-highlight-mix-blend-mode: multiply;--color-diffstat-deletion-border: rgba(27,31,36,.15);--color-diffstat-addition-border: rgba(27,31,36,.15);--color-diffstat-addition-bg: #2da44e;--color-search-keyword-hl: #fff8c5;--color-prettylights-syntax-comment: #6e7781;--color-prettylights-syntax-constant: #0550ae;--color-prettylights-syntax-entity: #8250df;--color-prettylights-syntax-storage-modifier-import: #24292f;--color-prettylights-syntax-entity-tag: #116329;--color-prettylights-syntax-keyword: #cf222e;--color-prettylights-syntax-string: #0a3069;--color-prettylights-syntax-variable: #953800;--color-prettylights-syntax-brackethighlighter-unmatched: #82071e;--color-prettylights-syntax-invalid-illegal-text: #f6f8fa;--color-prettylights-syntax-invalid-illegal-bg: #82071e;--color-prettylights-syntax-carriage-return-text: #f6f8fa;--color-prettylights-syntax-carriage-return-bg: #cf222e;--color-prettylights-syntax-string-regexp: #116329;--color-prettylights-syntax-markup-list: #3b2300;--color-prettylights-syntax-markup-heading: #0550ae;--color-prettylights-syntax-markup-italic: #24292f;--color-prettylights-syntax-markup-bold: #24292f;--color-prettylights-syntax-markup-deleted-text: #82071e;--color-prettylights-syntax-markup-deleted-bg: #FFEBE9;--color-prettylights-syntax-markup-inserted-text: #116329;--color-prettylights-syntax-markup-inserted-bg: #dafbe1;--color-prettylights-syntax-markup-changed-text: #953800;--color-prettylights-syntax-markup-changed-bg: #ffd8b5;--color-prettylights-syntax-markup-ignored-text: #eaeef2;--color-prettylights-syntax-markup-ignored-bg: #0550ae;--color-prettylights-syntax-meta-diff-range: #8250df;--color-prettylights-syntax-brackethighlighter-angle: #57606a;--color-prettylights-syntax-sublimelinter-gutter-mark: #8c959f;--color-prettylights-syntax-constant-other-reference-link: #0a3069;--color-codemirror-text: #24292f;--color-codemirror-bg: #ffffff;--color-codemirror-gutters-bg: #ffffff;--color-codemirror-guttermarker-text: #ffffff;--color-codemirror-guttermarker-subtle-text: #6e7781;--color-codemirror-linenumber-text: #57606a;--color-codemirror-cursor: #24292f;--color-codemirror-selection-bg: rgba(84,174,255,.4);--color-codemirror-activeline-bg: rgba(234,238,242,.5);--color-codemirror-matchingbracket-text: #24292f;--color-codemirror-lines-bg: #ffffff;--color-codemirror-syntax-comment: #24292f;--color-codemirror-syntax-constant: #0550ae;--color-codemirror-syntax-entity: #8250df;--color-codemirror-syntax-keyword: #cf222e;--color-codemirror-syntax-storage: #cf222e;--color-codemirror-syntax-string: #0a3069;--color-codemirror-syntax-support: #0550ae;--color-codemirror-syntax-variable: #953800;--color-checks-bg: #24292f;--color-checks-run-border-width: 0px;--color-checks-container-border-width: 0px;--color-checks-text-primary: #f6f8fa;--color-checks-text-secondary: #8c959f;--color-checks-text-link: #54aeff;--color-checks-btn-icon: #afb8c1;--color-checks-btn-hover-icon: #f6f8fa;--color-checks-btn-hover-bg: rgba(255,255,255,.125);--color-checks-input-text: #eaeef2;--color-checks-input-placeholder-text: #8c959f;--color-checks-input-focus-text: #8c959f;--color-checks-input-bg: #32383f;--color-checks-input-shadow: none;--color-checks-donut-error: #fa4549;--color-checks-donut-pending: #bf8700;--color-checks-donut-success: #2da44e;--color-checks-donut-neutral: #afb8c1;--color-checks-dropdown-text: #afb8c1;--color-checks-dropdown-bg: #32383f;--color-checks-dropdown-border: #424a53;--color-checks-dropdown-shadow: rgba(27,31,36,.3);--color-checks-dropdown-hover-text: #f6f8fa;--color-checks-dropdown-hover-bg: #424a53;--color-checks-dropdown-btn-hover-text: #f6f8fa;--color-checks-dropdown-btn-hover-bg: #32383f;--color-checks-scrollbar-thumb-bg: #57606a;--color-checks-header-label-text: #d0d7de;--color-checks-header-label-open-text: #f6f8fa;--color-checks-header-border: #32383f;--color-checks-header-icon: #8c959f;--color-checks-line-text: #d0d7de;--color-checks-line-num-text: rgba(140,149,159,.75);--color-checks-line-timestamp-text: #8c959f;--color-checks-line-hover-bg: #32383f;--color-checks-line-selected-bg: rgba(33,139,255,.15);--color-checks-line-selected-num-text: #54aeff;--color-checks-line-dt-fm-text: #24292f;--color-checks-line-dt-fm-bg: #9a6700;--color-checks-gate-bg: rgba(125,78,0,.15);--color-checks-gate-text: #d0d7de;--color-checks-gate-waiting-text: #afb8c1;--color-checks-step-header-open-bg: #32383f;--color-checks-step-error-text: #ff8182;--color-checks-step-warning-text: #d4a72c;--color-checks-logline-text: #8c959f;--color-checks-logline-num-text: rgba(140,149,159,.75);--color-checks-logline-debug-text: #c297ff;--color-checks-logline-error-text: #d0d7de;--color-checks-logline-error-num-text: #ff8182;--color-checks-logline-error-bg: rgba(164,14,38,.15);--color-checks-logline-warning-text: #d0d7de;--color-checks-logline-warning-num-text: #d4a72c;--color-checks-logline-warning-bg: rgba(125,78,0,.15);--color-checks-logline-command-text: #54aeff;--color-checks-logline-section-text: #4ac26b;--color-checks-ansi-black: #24292f;--color-checks-ansi-black-bright: #32383f;--color-checks-ansi-white: #d0d7de;--color-checks-ansi-white-bright: #d0d7de;--color-checks-ansi-gray: #8c959f;--color-checks-ansi-red: #ff8182;--color-checks-ansi-red-bright: #ffaba8;--color-checks-ansi-green: #4ac26b;--color-checks-ansi-green-bright: #6fdd8b;--color-checks-ansi-yellow: #d4a72c;--color-checks-ansi-yellow-bright: #eac54f;--color-checks-ansi-blue: #54aeff;--color-checks-ansi-blue-bright: #80ccff;--color-checks-ansi-magenta: #c297ff;--color-checks-ansi-magenta-bright: #d8b9ff;--color-checks-ansi-cyan: #76e3ea;--color-checks-ansi-cyan-bright: #b3f0ff;--color-project-header-bg: #24292f;--color-project-sidebar-bg: #ffffff;--color-project-gradient-in: #ffffff;--color-project-gradient-out: rgba(255,255,255,0);--color-mktg-success: rgba(36,146,67,1);--color-mktg-info: rgba(19,119,234,1);--color-mktg-bg-shade-gradient-top: rgba(27,31,36,.065);--color-mktg-bg-shade-gradient-bottom: rgba(27,31,36,0);--color-mktg-btn-bg-top: hsla(228,82%,66%,1);--color-mktg-btn-bg-bottom: #4969ed;--color-mktg-btn-bg-overlay-top: hsla(228,74%,59%,1);--color-mktg-btn-bg-overlay-bottom: #3355e0;--color-mktg-btn-text: #ffffff;--color-mktg-btn-primary-bg-top: hsla(137,56%,46%,1);--color-mktg-btn-primary-bg-bottom: #2ea44f;--color-mktg-btn-primary-bg-overlay-top: hsla(134,60%,38%,1);--color-mktg-btn-primary-bg-overlay-bottom: #22863a;--color-mktg-btn-primary-text: #ffffff;--color-mktg-btn-enterprise-bg-top: hsla(249,100%,72%,1);--color-mktg-btn-enterprise-bg-bottom: #6f57ff;--color-mktg-btn-enterprise-bg-overlay-top: hsla(248,65%,63%,1);--color-mktg-btn-enterprise-bg-overlay-bottom: #614eda;--color-mktg-btn-enterprise-text: #ffffff;--color-mktg-btn-outline-text: #4969ed;--color-mktg-btn-outline-border: rgba(73,105,237,.3);--color-mktg-btn-outline-hover-text: #3355e0;--color-mktg-btn-outline-hover-border: rgba(51,85,224,.5);--color-mktg-btn-outline-focus-border: #4969ed;--color-mktg-btn-outline-focus-border-inset: rgba(73,105,237,.5);--color-mktg-btn-dark-text: #ffffff;--color-mktg-btn-dark-border: rgba(255,255,255,.3);--color-mktg-btn-dark-hover-text: #ffffff;--color-mktg-btn-dark-hover-border: rgba(255,255,255,.5);--color-mktg-btn-dark-focus-border: #ffffff;--color-mktg-btn-dark-focus-border-inset: rgba(255,255,255,.5);--color-avatar-bg: #ffffff;--color-avatar-border: rgba(27,31,36,.15);--color-avatar-stack-fade: #afb8c1;--color-avatar-stack-fade-more: #d0d7de;--color-avatar-child-shadow: -2px -2px 0 rgba(255,255,255,.8);--color-topic-tag-border: rgba(0,0,0,0);--color-select-menu-backdrop-border: rgba(0,0,0,0);--color-select-menu-tap-highlight: rgba(175,184,193,.5);--color-select-menu-tap-focus-bg: #b6e3ff;--color-overlay-shadow: 0 1px 3px rgba(27,31,36,.12), 0 8px 24px rgba(66,74,83,.12);--color-header-text: rgba(255,255,255,.7);--color-header-bg: #24292f;--color-header-logo: #ffffff;--color-header-search-bg: #24292f;--color-header-search-border: #57606a;--color-sidenav-selected-bg: #ffffff;--color-menu-bg-active: rgba(0,0,0,0);--color-input-disabled-bg: rgba(175,184,193,.2);--color-timeline-badge-bg: #eaeef2;--color-ansi-black: #24292f;--color-ansi-black-bright: #57606a;--color-ansi-white: #6e7781;--color-ansi-white-bright: #8c959f;--color-ansi-gray: #6e7781;--color-ansi-red: #cf222e;--color-ansi-red-bright: #a40e26;--color-ansi-green: #116329;--color-ansi-green-bright: #1a7f37;--color-ansi-yellow: #4d2d00;--color-ansi-yellow-bright: #633c01;--color-ansi-blue: #0969da;--color-ansi-blue-bright: #218bff;--color-ansi-magenta: #8250df;--color-ansi-magenta-bright: #a475f9;--color-ansi-cyan: #1b7c83;--color-ansi-cyan-bright: #3192aa;--color-btn-text: #24292f;--color-btn-bg: #f6f8fa;--color-btn-border: rgba(27,31,36,.15);--color-btn-shadow: 0 1px 0 rgba(27,31,36,.04);--color-btn-inset-shadow: inset 0 1px 0 rgba(255,255,255,.25);--color-btn-hover-bg: #f3f4f6;--color-btn-hover-border: rgba(27,31,36,.15);--color-btn-active-bg: hsla(220,14%,93%,1);--color-btn-active-border: rgba(27,31,36,.15);--color-btn-selected-bg: hsla(220,14%,94%,1);--color-btn-focus-bg: #f6f8fa;--color-btn-focus-border: rgba(27,31,36,.15);--color-btn-focus-shadow: 0 0 0 3px rgba(9,105,218,.3);--color-btn-shadow-active: inset 0 .15em .3em rgba(27,31,36,.15);--color-btn-shadow-input-focus: 0 0 0 .2em rgba(9,105,218,.3);--color-btn-counter-bg: rgba(27,31,36,.08);--color-btn-primary-text: #ffffff;--color-btn-primary-bg: #2da44e;--color-btn-primary-border: rgba(27,31,36,.15);--color-btn-primary-shadow: 0 1px 0 rgba(27,31,36,.1);--color-btn-primary-inset-shadow: inset 0 1px 0 rgba(255,255,255,.03);--color-btn-primary-hover-bg: #2c974b;--color-btn-primary-hover-border: rgba(27,31,36,.15);--color-btn-primary-selected-bg: hsla(137,55%,36%,1);--color-btn-primary-selected-shadow: inset 0 1px 0 rgba(0,45,17,.2);--color-btn-primary-disabled-text: rgba(255,255,255,.8);--color-btn-primary-disabled-bg: #94d3a2;--color-btn-primary-disabled-border: rgba(27,31,36,.15);--color-btn-primary-focus-bg: #2da44e;--color-btn-primary-focus-border: rgba(27,31,36,.15);--color-btn-primary-focus-shadow: 0 0 0 3px rgba(45,164,78,.4);--color-btn-primary-icon: rgba(255,255,255,.8);--color-btn-primary-counter-bg: rgba(255,255,255,.2);--color-btn-outline-text: #0969da;--color-btn-outline-hover-text: #ffffff;--color-btn-outline-hover-bg: #0969da;--color-btn-outline-hover-border: rgba(27,31,36,.15);--color-btn-outline-hover-shadow: 0 1px 0 rgba(27,31,36,.1);--color-btn-outline-hover-inset-shadow: inset 0 1px 0 rgba(255,255,255,.03);--color-btn-outline-hover-counter-bg: rgba(255,255,255,.2);--color-btn-outline-selected-text: #ffffff;--color-btn-outline-selected-bg: hsla(212,92%,42%,1);--color-btn-outline-selected-border: rgba(27,31,36,.15);--color-btn-outline-selected-shadow: inset 0 1px 0 rgba(0,33,85,.2);--color-btn-outline-disabled-text: rgba(9,105,218,.5);--color-btn-outline-disabled-bg: #f6f8fa;--color-btn-outline-disabled-counter-bg: rgba(9,105,218,.05);--color-btn-outline-focus-border: rgba(27,31,36,.15);--color-btn-outline-focus-shadow: 0 0 0 3px rgba(5,80,174,.4);--color-btn-outline-counter-bg: rgba(9,105,218,.1);--color-btn-danger-text: #cf222e;--color-btn-danger-hover-text: #ffffff;--color-btn-danger-hover-bg: #a40e26;--color-btn-danger-hover-border: rgba(27,31,36,.15);--color-btn-danger-hover-shadow: 0 1px 0 rgba(27,31,36,.1);--color-btn-danger-hover-inset-shadow: inset 0 1px 0 rgba(255,255,255,.03);--color-btn-danger-hover-counter-bg: rgba(255,255,255,.2);--color-btn-danger-selected-text: #ffffff;--color-btn-danger-selected-bg: hsla(356,72%,44%,1);--color-btn-danger-selected-border: rgba(27,31,36,.15);--color-btn-danger-selected-shadow: inset 0 1px 0 rgba(76,0,20,.2);--color-btn-danger-disabled-text: rgba(207,34,46,.5);--color-btn-danger-disabled-bg: #f6f8fa;--color-btn-danger-disabled-counter-bg: rgba(207,34,46,.05);--color-btn-danger-focus-border: rgba(27,31,36,.15);--color-btn-danger-focus-shadow: 0 0 0 3px rgba(164,14,38,.4);--color-btn-danger-counter-bg: rgba(207,34,46,.1);--color-btn-danger-icon: #cf222e;--color-btn-danger-hover-icon: #ffffff;--color-underlinenav-icon: #6e7781;--color-underlinenav-border-hover: rgba(175,184,193,.2);--color-fg-default: #24292f;--color-fg-muted: #57606a;--color-fg-subtle: #6e7781;--color-fg-on-emphasis: #ffffff;--color-canvas-default: #ffffff;--color-canvas-overlay: #ffffff;--color-canvas-inset: #f6f8fa;--color-canvas-subtle: #f6f8fa;--color-border-default: #d0d7de;--color-border-muted: hsla(210,18%,87%,1);--color-border-subtle: rgba(27,31,36,.15);--color-shadow-small: 0 1px 0 rgba(27,31,36,.04);--color-shadow-medium: 0 3px 6px rgba(140,149,159,.15);--color-shadow-large: 0 8px 24px rgba(140,149,159,.2);--color-shadow-extra-large: 0 12px 28px rgba(140,149,159,.3);--color-neutral-emphasis-plus: #24292f;--color-neutral-emphasis: #6e7781;--color-neutral-muted: rgba(175,184,193,.2);--color-neutral-subtle: rgba(234,238,242,.5);--color-accent-fg: #0969da;--color-accent-emphasis: #0969da;--color-accent-muted: rgba(84,174,255,.4);--color-accent-subtle: #ddf4ff;--color-success-fg: #1a7f37;--color-success-emphasis: #2da44e;--color-success-muted: rgba(74,194,107,.4);--color-success-subtle: #dafbe1;--color-attention-fg: #9a6700;--color-attention-emphasis: #bf8700;--color-attention-muted: rgba(212,167,44,.4);--color-attention-subtle: #fff8c5;--color-severe-fg: #bc4c00;--color-severe-emphasis: #bc4c00;--color-severe-muted: rgba(251,143,68,.4);--color-severe-subtle: #fff1e5;--color-danger-fg: #cf222e;--color-danger-emphasis: #cf222e;--color-danger-muted: rgba(255,129,130,.4);--color-danger-subtle: #FFEBE9;--color-done-fg: #8250df;--color-done-emphasis: #8250df;--color-done-muted: rgba(194,151,255,.4);--color-done-subtle: #fbefff;--color-sponsors-fg: #bf3989;--color-sponsors-emphasis: #bf3989;--color-sponsors-muted: rgba(255,128,200,.4);--color-sponsors-subtle: #ffeff7;--color-primer-canvas-backdrop: rgba(27,31,36,.5);--color-primer-canvas-sticky: rgba(255,255,255,.95);--color-primer-border-active: #FD8C73;--color-primer-border-contrast: rgba(27,31,36,.1);--color-primer-shadow-highlight: inset 0 1px 0 rgba(255,255,255,.25);--color-primer-shadow-inset: inset 0 1px 0 rgba(208,215,222,.2);--color-primer-shadow-focus: 0 0 0 3px rgba(9,105,218,.3);--color-scale-black: #1b1f24;--color-scale-white: #ffffff;--color-scale-gray-0: #f6f8fa;--color-scale-gray-1: #eaeef2;--color-scale-gray-2: #d0d7de;--color-scale-gray-3: #afb8c1;--color-scale-gray-4: #8c959f;--color-scale-gray-5: #6e7781;--color-scale-gray-6: #57606a;--color-scale-gray-7: #424a53;--color-scale-gray-8: #32383f;--color-scale-gray-9: #24292f;--color-scale-blue-0: #ddf4ff;--color-scale-blue-1: #b6e3ff;--color-scale-blue-2: #80ccff;--color-scale-blue-3: #54aeff;--color-scale-blue-4: #218bff;--color-scale-blue-5: #0969da;--color-scale-blue-6: #0550ae;--color-scale-blue-7: #033d8b;--color-scale-blue-8: #0a3069;--color-scale-blue-9: #002155;--color-scale-green-0: #dafbe1;--color-scale-green-1: #aceebb;--color-scale-green-2: #6fdd8b;--color-scale-green-3: #4ac26b;--color-scale-green-4: #2da44e;--color-scale-green-5: #1a7f37;--color-scale-green-6: #116329;--color-scale-green-7: #044f1e;--color-scale-green-8: #003d16;--color-scale-green-9: #002d11;--color-scale-yellow-0: #fff8c5;--color-scale-yellow-1: #fae17d;--color-scale-yellow-2: #eac54f;--color-scale-yellow-3: #d4a72c;--color-scale-yellow-4: #bf8700;--color-scale-yellow-5: #9a6700;--color-scale-yellow-6: #7d4e00;--color-scale-yellow-7: #633c01;--color-scale-yellow-8: #4d2d00;--color-scale-yellow-9: #3b2300;--color-scale-orange-0: #fff1e5;--color-scale-orange-1: #ffd8b5;--color-scale-orange-2: #ffb77c;--color-scale-orange-3: #fb8f44;--color-scale-orange-4: #e16f24;--color-scale-orange-5: #bc4c00;--color-scale-orange-6: #953800;--color-scale-orange-7: #762c00;--color-scale-orange-8: #5c2200;--color-scale-orange-9: #471700;--color-scale-red-0: #FFEBE9;--color-scale-red-1: #ffcecb;--color-scale-red-2: #ffaba8;--color-scale-red-3: #ff8182;--color-scale-red-4: #fa4549;--color-scale-red-5: #cf222e;--color-scale-red-6: #a40e26;--color-scale-red-7: #82071e;--color-scale-red-8: #660018;--color-scale-red-9: #4c0014;--color-scale-purple-0: #fbefff;--color-scale-purple-1: #ecd8ff;--color-scale-purple-2: #d8b9ff;--color-scale-purple-3: #c297ff;--color-scale-purple-4: #a475f9;--color-scale-purple-5: #8250df;--color-scale-purple-6: #6639ba;--color-scale-purple-7: #512a97;--color-scale-purple-8: #3e1f79;--color-scale-purple-9: #2e1461;--color-scale-pink-0: #ffeff7;--color-scale-pink-1: #ffd3eb;--color-scale-pink-2: #ffadda;--color-scale-pink-3: #ff80c8;--color-scale-pink-4: #e85aad;--color-scale-pink-5: #bf3989;--color-scale-pink-6: #99286e;--color-scale-pink-7: #772057;--color-scale-pink-8: #611347;--color-scale-pink-9: #4d0336;--color-scale-coral-0: #FFF0EB;--color-scale-coral-1: #FFD6CC;--color-scale-coral-2: #FFB4A1;--color-scale-coral-3: #FD8C73;--color-scale-coral-4: #EC6547;--color-scale-coral-5: #C4432B;--color-scale-coral-6: #9E2F1C;--color-scale-coral-7: #801F0F;--color-scale-coral-8: #691105;--color-scale-coral-9: #510901 }@media (prefers-color-scheme: dark){:root{--color-canvas-default-transparent: rgba(13,17,23,0);--color-marketing-icon-primary: #79c0ff;--color-marketing-icon-secondary: #1f6feb;--color-diff-blob-addition-num-text: #c9d1d9;--color-diff-blob-addition-fg: #c9d1d9;--color-diff-blob-addition-num-bg: rgba(63,185,80,.3);--color-diff-blob-addition-line-bg: rgba(46,160,67,.15);--color-diff-blob-addition-word-bg: rgba(46,160,67,.4);--color-diff-blob-deletion-num-text: #c9d1d9;--color-diff-blob-deletion-fg: #c9d1d9;--color-diff-blob-deletion-num-bg: rgba(248,81,73,.3);--color-diff-blob-deletion-line-bg: rgba(248,81,73,.15);--color-diff-blob-deletion-word-bg: rgba(248,81,73,.4);--color-diff-blob-hunk-num-bg: rgba(56,139,253,.4);--color-diff-blob-expander-icon: #8b949e;--color-diff-blob-selected-line-highlight-mix-blend-mode: screen;--color-diffstat-deletion-border: rgba(240,246,252,.1);--color-diffstat-addition-border: rgba(240,246,252,.1);--color-diffstat-addition-bg: #3fb950;--color-search-keyword-hl: rgba(210,153,34,.4);--color-prettylights-syntax-comment: #8b949e;--color-prettylights-syntax-constant: #79c0ff;--color-prettylights-syntax-entity: #d2a8ff;--color-prettylights-syntax-storage-modifier-import: #c9d1d9;--color-prettylights-syntax-entity-tag: #7ee787;--color-prettylights-syntax-keyword: #ff7b72;--color-prettylights-syntax-string: #a5d6ff;--color-prettylights-syntax-variable: #ffa657;--color-prettylights-syntax-brackethighlighter-unmatched: #f85149;--color-prettylights-syntax-invalid-illegal-text: #f0f6fc;--color-prettylights-syntax-invalid-illegal-bg: #8e1519;--color-prettylights-syntax-carriage-return-text: #f0f6fc;--color-prettylights-syntax-carriage-return-bg: #b62324;--color-prettylights-syntax-string-regexp: #7ee787;--color-prettylights-syntax-markup-list: #f2cc60;--color-prettylights-syntax-markup-heading: #1f6feb;--color-prettylights-syntax-markup-italic: #c9d1d9;--color-prettylights-syntax-markup-bold: #c9d1d9;--color-prettylights-syntax-markup-deleted-text: #ffdcd7;--color-prettylights-syntax-markup-deleted-bg: #67060c;--color-prettylights-syntax-markup-inserted-text: #aff5b4;--color-prettylights-syntax-markup-inserted-bg: #033a16;--color-prettylights-syntax-markup-changed-text: #ffdfb6;--color-prettylights-syntax-markup-changed-bg: #5a1e02;--color-prettylights-syntax-markup-ignored-text: #c9d1d9;--color-prettylights-syntax-markup-ignored-bg: #1158c7;--color-prettylights-syntax-meta-diff-range: #d2a8ff;--color-prettylights-syntax-brackethighlighter-angle: #8b949e;--color-prettylights-syntax-sublimelinter-gutter-mark: #484f58;--color-prettylights-syntax-constant-other-reference-link: #a5d6ff;--color-codemirror-text: #c9d1d9;--color-codemirror-bg: #0d1117;--color-codemirror-gutters-bg: #0d1117;--color-codemirror-guttermarker-text: #0d1117;--color-codemirror-guttermarker-subtle-text: #484f58;--color-codemirror-linenumber-text: #8b949e;--color-codemirror-cursor: #c9d1d9;--color-codemirror-selection-bg: rgba(56,139,253,.4);--color-codemirror-activeline-bg: rgba(110,118,129,.1);--color-codemirror-matchingbracket-text: #c9d1d9;--color-codemirror-lines-bg: #0d1117;--color-codemirror-syntax-comment: #8b949e;--color-codemirror-syntax-constant: #79c0ff;--color-codemirror-syntax-entity: #d2a8ff;--color-codemirror-syntax-keyword: #ff7b72;--color-codemirror-syntax-storage: #ff7b72;--color-codemirror-syntax-string: #a5d6ff;--color-codemirror-syntax-support: #79c0ff;--color-codemirror-syntax-variable: #ffa657;--color-checks-bg: #010409;--color-checks-run-border-width: 1px;--color-checks-container-border-width: 1px;--color-checks-text-primary: #c9d1d9;--color-checks-text-secondary: #8b949e;--color-checks-text-link: #58a6ff;--color-checks-btn-icon: #8b949e;--color-checks-btn-hover-icon: #c9d1d9;--color-checks-btn-hover-bg: rgba(110,118,129,.1);--color-checks-input-text: #8b949e;--color-checks-input-placeholder-text: #484f58;--color-checks-input-focus-text: #c9d1d9;--color-checks-input-bg: #161b22;--color-checks-input-shadow: none;--color-checks-donut-error: #f85149;--color-checks-donut-pending: #d29922;--color-checks-donut-success: #2ea043;--color-checks-donut-neutral: #8b949e;--color-checks-dropdown-text: #c9d1d9;--color-checks-dropdown-bg: #161b22;--color-checks-dropdown-border: #30363d;--color-checks-dropdown-shadow: rgba(1,4,9,.3);--color-checks-dropdown-hover-text: #c9d1d9;--color-checks-dropdown-hover-bg: rgba(110,118,129,.1);--color-checks-dropdown-btn-hover-text: #c9d1d9;--color-checks-dropdown-btn-hover-bg: rgba(110,118,129,.1);--color-checks-scrollbar-thumb-bg: rgba(110,118,129,.4);--color-checks-header-label-text: #8b949e;--color-checks-header-label-open-text: #c9d1d9;--color-checks-header-border: #21262d;--color-checks-header-icon: #8b949e;--color-checks-line-text: #8b949e;--color-checks-line-num-text: #484f58;--color-checks-line-timestamp-text: #484f58;--color-checks-line-hover-bg: rgba(110,118,129,.1);--color-checks-line-selected-bg: rgba(56,139,253,.15);--color-checks-line-selected-num-text: #58a6ff;--color-checks-line-dt-fm-text: #f0f6fc;--color-checks-line-dt-fm-bg: #9e6a03;--color-checks-gate-bg: rgba(187,128,9,.15);--color-checks-gate-text: #8b949e;--color-checks-gate-waiting-text: #d29922;--color-checks-step-header-open-bg: #161b22;--color-checks-step-error-text: #f85149;--color-checks-step-warning-text: #d29922;--color-checks-logline-text: #8b949e;--color-checks-logline-num-text: #484f58;--color-checks-logline-debug-text: #a371f7;--color-checks-logline-error-text: #8b949e;--color-checks-logline-error-num-text: #484f58;--color-checks-logline-error-bg: rgba(248,81,73,.15);--color-checks-logline-warning-text: #8b949e;--color-checks-logline-warning-num-text: #d29922;--color-checks-logline-warning-bg: rgba(187,128,9,.15);--color-checks-logline-command-text: #58a6ff;--color-checks-logline-section-text: #3fb950;--color-checks-ansi-black: #0d1117;--color-checks-ansi-black-bright: #161b22;--color-checks-ansi-white: #b1bac4;--color-checks-ansi-white-bright: #b1bac4;--color-checks-ansi-gray: #6e7681;--color-checks-ansi-red: #ff7b72;--color-checks-ansi-red-bright: #ffa198;--color-checks-ansi-green: #3fb950;--color-checks-ansi-green-bright: #56d364;--color-checks-ansi-yellow: #d29922;--color-checks-ansi-yellow-bright: #e3b341;--color-checks-ansi-blue: #58a6ff;--color-checks-ansi-blue-bright: #79c0ff;--color-checks-ansi-magenta: #bc8cff;--color-checks-ansi-magenta-bright: #d2a8ff;--color-checks-ansi-cyan: #76e3ea;--color-checks-ansi-cyan-bright: #b3f0ff;--color-project-header-bg: #0d1117;--color-project-sidebar-bg: #161b22;--color-project-gradient-in: #161b22;--color-project-gradient-out: rgba(22,27,34,0);--color-mktg-success: rgba(41,147,61,1);--color-mktg-info: rgba(42,123,243,1);--color-mktg-bg-shade-gradient-top: rgba(1,4,9,.065);--color-mktg-bg-shade-gradient-bottom: rgba(1,4,9,0);--color-mktg-btn-bg-top: hsla(228,82%,66%,1);--color-mktg-btn-bg-bottom: #4969ed;--color-mktg-btn-bg-overlay-top: hsla(228,74%,59%,1);--color-mktg-btn-bg-overlay-bottom: #3355e0;--color-mktg-btn-text: #f0f6fc;--color-mktg-btn-primary-bg-top: hsla(137,56%,46%,1);--color-mktg-btn-primary-bg-bottom: #2ea44f;--color-mktg-btn-primary-bg-overlay-top: hsla(134,60%,38%,1);--color-mktg-btn-primary-bg-overlay-bottom: #22863a;--color-mktg-btn-primary-text: #f0f6fc;--color-mktg-btn-enterprise-bg-top: hsla(249,100%,72%,1);--color-mktg-btn-enterprise-bg-bottom: #6f57ff;--color-mktg-btn-enterprise-bg-overlay-top: hsla(248,65%,63%,1);--color-mktg-btn-enterprise-bg-overlay-bottom: #614eda;--color-mktg-btn-enterprise-text: #f0f6fc;--color-mktg-btn-outline-text: #f0f6fc;--color-mktg-btn-outline-border: rgba(240,246,252,.3);--color-mktg-btn-outline-hover-text: #f0f6fc;--color-mktg-btn-outline-hover-border: rgba(240,246,252,.5);--color-mktg-btn-outline-focus-border: #f0f6fc;--color-mktg-btn-outline-focus-border-inset: rgba(240,246,252,.5);--color-mktg-btn-dark-text: #f0f6fc;--color-mktg-btn-dark-border: rgba(240,246,252,.3);--color-mktg-btn-dark-hover-text: #f0f6fc;--color-mktg-btn-dark-hover-border: rgba(240,246,252,.5);--color-mktg-btn-dark-focus-border: #f0f6fc;--color-mktg-btn-dark-focus-border-inset: rgba(240,246,252,.5);--color-avatar-bg: rgba(240,246,252,.1);--color-avatar-border: rgba(240,246,252,.1);--color-avatar-stack-fade: #30363d;--color-avatar-stack-fade-more: #21262d;--color-avatar-child-shadow: -2px -2px 0 #0d1117;--color-topic-tag-border: rgba(0,0,0,0);--color-select-menu-backdrop-border: #484f58;--color-select-menu-tap-highlight: rgba(48,54,61,.5);--color-select-menu-tap-focus-bg: #0c2d6b;--color-overlay-shadow: 0 0 0 1px #30363d, 0 16px 32px rgba(1,4,9,.85);--color-header-text: rgba(240,246,252,.7);--color-header-bg: #161b22;--color-header-logo: #f0f6fc;--color-header-search-bg: #0d1117;--color-header-search-border: #30363d;--color-sidenav-selected-bg: #21262d;--color-menu-bg-active: #161b22;--color-input-disabled-bg: rgba(110,118,129,0);--color-timeline-badge-bg: #21262d;--color-ansi-black: #484f58;--color-ansi-black-bright: #6e7681;--color-ansi-white: #b1bac4;--color-ansi-white-bright: #f0f6fc;--color-ansi-gray: #6e7681;--color-ansi-red: #ff7b72;--color-ansi-red-bright: #ffa198;--color-ansi-green: #3fb950;--color-ansi-green-bright: #56d364;--color-ansi-yellow: #d29922;--color-ansi-yellow-bright: #e3b341;--color-ansi-blue: #58a6ff;--color-ansi-blue-bright: #79c0ff;--color-ansi-magenta: #bc8cff;--color-ansi-magenta-bright: #d2a8ff;--color-ansi-cyan: #39c5cf;--color-ansi-cyan-bright: #56d4dd;--color-btn-text: #c9d1d9;--color-btn-bg: #21262d;--color-btn-border: rgba(240,246,252,.1);--color-btn-shadow: 0 0 transparent;--color-btn-inset-shadow: 0 0 transparent;--color-btn-hover-bg: #30363d;--color-btn-hover-border: #8b949e;--color-btn-active-bg: hsla(212,12%,18%,1);--color-btn-active-border: #6e7681;--color-btn-selected-bg: #161b22;--color-btn-focus-bg: #21262d;--color-btn-focus-border: #8b949e;--color-btn-focus-shadow: 0 0 0 3px rgba(139,148,158,.3);--color-btn-shadow-active: inset 0 .15em .3em rgba(1,4,9,.15);--color-btn-shadow-input-focus: 0 0 0 .2em rgba(31,111,235,.3);--color-btn-counter-bg: #30363d;--color-btn-primary-text: #ffffff;--color-btn-primary-bg: #238636;--color-btn-primary-border: rgba(240,246,252,.1);--color-btn-primary-shadow: 0 0 transparent;--color-btn-primary-inset-shadow: 0 0 transparent;--color-btn-primary-hover-bg: #2ea043;--color-btn-primary-hover-border: rgba(240,246,252,.1);--color-btn-primary-selected-bg: #238636;--color-btn-primary-selected-shadow: 0 0 transparent;--color-btn-primary-disabled-text: rgba(240,246,252,.5);--color-btn-primary-disabled-bg: rgba(35,134,54,.6);--color-btn-primary-disabled-border: rgba(240,246,252,.1);--color-btn-primary-focus-bg: #238636;--color-btn-primary-focus-border: rgba(240,246,252,.1);--color-btn-primary-focus-shadow: 0 0 0 3px rgba(46,164,79,.4);--color-btn-primary-icon: #f0f6fc;--color-btn-primary-counter-bg: rgba(240,246,252,.2);--color-btn-outline-text: #58a6ff;--color-btn-outline-hover-text: #58a6ff;--color-btn-outline-hover-bg: #30363d;--color-btn-outline-hover-border: rgba(240,246,252,.1);--color-btn-outline-hover-shadow: 0 1px 0 rgba(1,4,9,.1);--color-btn-outline-hover-inset-shadow: inset 0 1px 0 rgba(240,246,252,.03);--color-btn-outline-hover-counter-bg: rgba(240,246,252,.2);--color-btn-outline-selected-text: #f0f6fc;--color-btn-outline-selected-bg: #0d419d;--color-btn-outline-selected-border: rgba(240,246,252,.1);--color-btn-outline-selected-shadow: 0 0 transparent;--color-btn-outline-disabled-text: rgba(88,166,255,.5);--color-btn-outline-disabled-bg: #0d1117;--color-btn-outline-disabled-counter-bg: rgba(31,111,235,.05);--color-btn-outline-focus-border: rgba(240,246,252,.1);--color-btn-outline-focus-shadow: 0 0 0 3px rgba(17,88,199,.4);--color-btn-outline-counter-bg: rgba(31,111,235,.1);--color-btn-danger-text: #f85149;--color-btn-danger-hover-text: #f0f6fc;--color-btn-danger-hover-bg: #da3633;--color-btn-danger-hover-border: #f85149;--color-btn-danger-hover-shadow: 0 0 transparent;--color-btn-danger-hover-inset-shadow: 0 0 transparent;--color-btn-danger-hover-icon: #f0f6fc;--color-btn-danger-hover-counter-bg: rgba(255,255,255,.2);--color-btn-danger-selected-text: #ffffff;--color-btn-danger-selected-bg: #b62324;--color-btn-danger-selected-border: #ff7b72;--color-btn-danger-selected-shadow: 0 0 transparent;--color-btn-danger-disabled-text: rgba(248,81,73,.5);--color-btn-danger-disabled-bg: #0d1117;--color-btn-danger-disabled-counter-bg: rgba(218,54,51,.05);--color-btn-danger-focus-border: #f85149;--color-btn-danger-focus-shadow: 0 0 0 3px rgba(248,81,73,.4);--color-btn-danger-counter-bg: rgba(218,54,51,.1);--color-btn-danger-icon: #f85149;--color-underlinenav-icon: #484f58;--color-underlinenav-border-hover: rgba(110,118,129,.4);--color-fg-default: #c9d1d9;--color-fg-muted: #8b949e;--color-fg-subtle: #484f58;--color-fg-on-emphasis: #f0f6fc;--color-canvas-default: #0d1117;--color-canvas-overlay: #161b22;--color-canvas-inset: #010409;--color-canvas-subtle: #161b22;--color-border-default: #30363d;--color-border-muted: #21262d;--color-border-subtle: rgba(240,246,252,.1);--color-shadow-small: 0 0 transparent;--color-shadow-medium: 0 3px 6px #010409;--color-shadow-large: 0 8px 24px #010409;--color-shadow-extra-large: 0 12px 48px #010409;--color-neutral-emphasis-plus: #6e7681;--color-neutral-emphasis: #6e7681;--color-neutral-muted: rgba(110,118,129,.4);--color-neutral-subtle: rgba(110,118,129,.1);--color-accent-fg: #58a6ff;--color-accent-emphasis: #1f6feb;--color-accent-muted: rgba(56,139,253,.4);--color-accent-subtle: rgba(56,139,253,.15);--color-success-fg: #3fb950;--color-success-emphasis: #238636;--color-success-muted: rgba(46,160,67,.4);--color-success-subtle: rgba(46,160,67,.15);--color-attention-fg: #d29922;--color-attention-emphasis: #9e6a03;--color-attention-muted: rgba(187,128,9,.4);--color-attention-subtle: rgba(187,128,9,.15);--color-severe-fg: #db6d28;--color-severe-emphasis: #bd561d;--color-severe-muted: rgba(219,109,40,.4);--color-severe-subtle: rgba(219,109,40,.15);--color-danger-fg: #f85149;--color-danger-emphasis: #da3633;--color-danger-muted: rgba(248,81,73,.4);--color-danger-subtle: rgba(248,81,73,.15);--color-done-fg: #a371f7;--color-done-emphasis: #8957e5;--color-done-muted: rgba(163,113,247,.4);--color-done-subtle: rgba(163,113,247,.15);--color-sponsors-fg: #db61a2;--color-sponsors-emphasis: #bf4b8a;--color-sponsors-muted: rgba(219,97,162,.4);--color-sponsors-subtle: rgba(219,97,162,.15);--color-primer-canvas-backdrop: rgba(1,4,9,.8);--color-primer-canvas-sticky: rgba(13,17,23,.95);--color-primer-border-active: #F78166;--color-primer-border-contrast: rgba(240,246,252,.2);--color-primer-shadow-highlight: 0 0 transparent;--color-primer-shadow-inset: 0 0 transparent;--color-primer-shadow-focus: 0 0 0 3px #0c2d6b;--color-scale-black: #010409;--color-scale-white: #f0f6fc;--color-scale-gray-0: #f0f6fc;--color-scale-gray-1: #c9d1d9;--color-scale-gray-2: #b1bac4;--color-scale-gray-3: #8b949e;--color-scale-gray-4: #6e7681;--color-scale-gray-5: #484f58;--color-scale-gray-6: #30363d;--color-scale-gray-7: #21262d;--color-scale-gray-8: #161b22;--color-scale-gray-9: #0d1117;--color-scale-blue-0: #cae8ff;--color-scale-blue-1: #a5d6ff;--color-scale-blue-2: #79c0ff;--color-scale-blue-3: #58a6ff;--color-scale-blue-4: #388bfd;--color-scale-blue-5: #1f6feb;--color-scale-blue-6: #1158c7;--color-scale-blue-7: #0d419d;--color-scale-blue-8: #0c2d6b;--color-scale-blue-9: #051d4d;--color-scale-green-0: #aff5b4;--color-scale-green-1: #7ee787;--color-scale-green-2: #56d364;--color-scale-green-3: #3fb950;--color-scale-green-4: #2ea043;--color-scale-green-5: #238636;--color-scale-green-6: #196c2e;--color-scale-green-7: #0f5323;--color-scale-green-8: #033a16;--color-scale-green-9: #04260f;--color-scale-yellow-0: #f8e3a1;--color-scale-yellow-1: #f2cc60;--color-scale-yellow-2: #e3b341;--color-scale-yellow-3: #d29922;--color-scale-yellow-4: #bb8009;--color-scale-yellow-5: #9e6a03;--color-scale-yellow-6: #845306;--color-scale-yellow-7: #693e00;--color-scale-yellow-8: #4b2900;--color-scale-yellow-9: #341a00;--color-scale-orange-0: #ffdfb6;--color-scale-orange-1: #ffc680;--color-scale-orange-2: #ffa657;--color-scale-orange-3: #f0883e;--color-scale-orange-4: #db6d28;--color-scale-orange-5: #bd561d;--color-scale-orange-6: #9b4215;--color-scale-orange-7: #762d0a;--color-scale-orange-8: #5a1e02;--color-scale-orange-9: #3d1300;--color-scale-red-0: #ffdcd7;--color-scale-red-1: #ffc1ba;--color-scale-red-2: #ffa198;--color-scale-red-3: #ff7b72;--color-scale-red-4: #f85149;--color-scale-red-5: #da3633;--color-scale-red-6: #b62324;--color-scale-red-7: #8e1519;--color-scale-red-8: #67060c;--color-scale-red-9: #490202;--color-scale-purple-0: #eddeff;--color-scale-purple-1: #e2c5ff;--color-scale-purple-2: #d2a8ff;--color-scale-purple-3: #bc8cff;--color-scale-purple-4: #a371f7;--color-scale-purple-5: #8957e5;--color-scale-purple-6: #6e40c9;--color-scale-purple-7: #553098;--color-scale-purple-8: #3c1e70;--color-scale-purple-9: #271052;--color-scale-pink-0: #ffdaec;--color-scale-pink-1: #ffbedd;--color-scale-pink-2: #ff9bce;--color-scale-pink-3: #f778ba;--color-scale-pink-4: #db61a2;--color-scale-pink-5: #bf4b8a;--color-scale-pink-6: #9e3670;--color-scale-pink-7: #7d2457;--color-scale-pink-8: #5e103e;--color-scale-pink-9: #42062a;--color-scale-coral-0: #FFDDD2;--color-scale-coral-1: #FFC2B2;--color-scale-coral-2: #FFA28B;--color-scale-coral-3: #F78166;--color-scale-coral-4: #EA6045;--color-scale-coral-5: #CF462D;--color-scale-coral-6: #AC3220;--color-scale-coral-7: #872012;--color-scale-coral-8: #640D04;--color-scale-coral-9: #460701 }}:root{--box-shadow: rgba(0, 0, 0, .133) 0px 1.6px 3.6px 0px, rgba(0, 0, 0, .11) 0px .3px .9px 0px;--box-shadow-thick: rgb(0 0 0 / 10%) 0px 1.8px 1.9px, rgb(0 0 0 / 15%) 0px 6.1px 6.3px, rgb(0 0 0 / 10%) 0px -2px 4px, rgb(0 0 0 / 15%) 0px -6.1px 12px, rgb(0 0 0 / 25%) 0px 6px 12px}*{box-sizing:border-box;min-width:0;min-height:0}svg{fill:currentColor}.vbox{display:flex;flex-direction:column;flex:auto;position:relative}.hbox{display:flex;flex:auto;position:relative}.hidden{visibility:hidden}.d-flex{display:flex!important}.d-inline{display:inline!important}.m-1{margin:4px}.m-2{margin:8px}.m-3{margin:16px}.m-4{margin:24px}.m-5{margin:32px}.mx-1{margin:0 4px}.mx-2{margin:0 8px}.mx-3{margin:0 16px}.mx-4{margin:0 24px}.mx-5{margin:0 32px}.my-1{margin:4px 0}.my-2{margin:8px 0}.my-3{margin:16px 0}.my-4{margin:24px 0}.my-5{margin:32px 0}.mt-1{margin-top:4px}.mt-2{margin-top:8px}.mt-3{margin-top:16px}.mt-4{margin-top:24px}.mt-5{margin-top:32px}.mr-1{margin-right:4px}.mr-2{margin-right:8px}.mr-3{margin-right:16px}.mr-4{margin-right:24px}.mr-5{margin-right:32px}.mb-1{margin-bottom:4px}.mb-2{margin-bottom:8px}.mb-3{margin-bottom:16px}.mb-4{margin-bottom:24px}.mb-5{margin-bottom:32px}.ml-1{margin-left:4px}.ml-2{margin-left:8px}.ml-3{margin-left:16px}.ml-4{margin-left:24px}.ml-5{margin-left:32px}.p-1{padding:4px}.p-2{padding:8px}.p-3{padding:16px}.p-4{padding:24px}.p-5{padding:32px}.px-1{padding:0 4px}.px-2{padding:0 8px}.px-3{padding:0 16px}.px-4{padding:0 24px}.px-5{padding:0 32px}.py-1{padding:4px 0}.py-2{padding:8px 0}.py-3{padding:16px 0}.py-4{padding:24px 0}.py-5{padding:32px 0}.pt-1{padding-top:4px}.pt-2{padding-top:8px}.pt-3{padding-top:16px}.pt-4{padding-top:24px}.pt-5{padding-top:32px}.pr-1{padding-right:4px}.pr-2{padding-right:8px}.pr-3{padding-right:16px}.pr-4{padding-right:24px}.pr-5{padding-right:32px}.pb-1{padding-bottom:4px}.pb-2{padding-bottom:8px}.pb-3{padding-bottom:16px}.pb-4{padding-bottom:24px}.pb-5{padding-bottom:32px}.pl-1{padding-left:4px}.pl-2{padding-left:8px}.pl-3{padding-left:16px}.pl-4{padding-left:24px}.pl-5{padding-left:32px}.no-wrap{white-space:nowrap!important}.float-left{float:left!important}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section{display:block}.form-control,.form-select{padding:5px 12px;font-size:14px;line-height:20px;color:var(--color-fg-default);vertical-align:middle;background-color:var(--color-canvas-default);background-repeat:no-repeat;background-position:right 8px center;border:1px solid var(--color-border-default);border-radius:6px;outline:none;box-shadow:var(--color-primer-shadow-inset)}.input-contrast{background-color:var(--color-canvas-inset)}.subnav-search{position:relative;flex:auto;display:flex}.subnav-search-input{flex:auto;padding-left:32px;color:var(--color-fg-muted)}.subnav-search-icon{position:absolute;top:9px;left:8px;display:block;color:var(--color-fg-muted);text-align:center;pointer-events:none}.subnav-search-context+.subnav-search{margin-left:-1px}.subnav-item{flex:none;position:relative;float:left;padding:5px 10px;font-weight:500;line-height:20px;color:var(--color-fg-default);border:1px solid var(--color-border-default)}.subnav-item:hover{background-color:var(--color-canvas-subtle)}.subnav-item:first-child{border-top-left-radius:6px;border-bottom-left-radius:6px}.subnav-item:last-child{border-top-right-radius:6px;border-bottom-right-radius:6px}.subnav-item+.subnav-item{margin-left:-1px}.counter{display:inline-block;min-width:20px;padding:0 6px;font-size:12px;font-weight:500;line-height:18px;color:var(--color-fg-default);text-align:center;background-color:var(--color-neutral-muted);border:1px solid transparent;border-radius:2em}.color-icon-success{color:var(--color-success-fg)!important}.color-text-danger{color:var(--color-danger-fg)!important}.color-text-warning{color:var(--color-checks-step-warning-text)!important}.color-fg-muted{color:var(--color-fg-muted)!important}.octicon{display:inline-block;overflow:visible!important;vertical-align:text-bottom;fill:currentColor;margin-right:7px;flex:none}.button{flex:none;height:24px;border:1px solid var(--color-btn-border);outline:none;color:var(--color-btn-text);background:var(--color-btn-bg);padding:4px;cursor:pointer;display:inline-flex;align-items:center;justify-content:center;border-radius:4px}.button:not(:disabled):hover{border-color:var(--color-btn-hover-border);background-color:var(--color-btn-hover-bg)}@media only screen and (max-width: 600px){.subnav-item,.form-control{border-radius:0!important}.subnav-item{padding:5px 3px;border:none}.subnav-search-input{border-left:0;border-right:0}}.header-view-status-container{float:right}@media only screen and (max-width: 600px){.header-view-status-container{float:none;margin:0 0 10px!important;overflow:hidden}.header-view-status-container .subnav-search-input{border-left:none;border-right:none}}.tree-item{text-overflow:ellipsis;overflow:hidden;white-space:nowrap;line-height:38px}.tree-item-title{cursor:pointer}.tree-item-body{min-height:18px}.yellow-flash{animation:yellowflash-bg 2s}@keyframes yellowflash-bg{0%{background:var(--color-attention-subtle)}to{background:transparent}}.copy-icon{flex:none;height:24px;width:24px;border:none;outline:none;color:var(--color-fg-muted);background:transparent;padding:4px;cursor:pointer;display:inline-flex;align-items:center;justify-content:center;border-radius:4px}.copy-icon svg{margin:0}.copy-icon:not(:disabled):hover{background-color:var(--color-border-default)}.copy-button-container{visibility:hidden;display:inline-flex;margin-left:8px;vertical-align:bottom}.copy-value-container:hover .copy-button-container{visibility:visible}.label{display:inline-block;padding:0 8px;font-size:12px;font-weight:500;line-height:18px;border:1px solid transparent;border-radius:2em;background-color:var(--color-scale-gray-4);color:#fff;margin:0 10px;flex:none;font-weight:600}@media (prefers-color-scheme: light){.label-color-0{background-color:var(--color-scale-blue-0);color:var(--color-scale-blue-6);border:1px solid var(--color-scale-blue-4)}.label-color-1{background-color:var(--color-scale-yellow-0);color:var(--color-scale-yellow-6);border:1px solid var(--color-scale-yellow-4)}.label-color-2{background-color:var(--color-scale-purple-0);color:var(--color-scale-purple-6);border:1px solid var(--color-scale-purple-4)}.label-color-3{background-color:var(--color-scale-pink-0);color:var(--color-scale-pink-6);border:1px solid var(--color-scale-pink-4)}.label-color-4{background-color:var(--color-scale-coral-0);color:var(--color-scale-coral-6);border:1px solid var(--color-scale-coral-4)}.label-color-5{background-color:var(--color-scale-orange-0);color:var(--color-scale-orange-6);border:1px solid var(--color-scale-orange-4)}}@media (prefers-color-scheme: dark){.label-color-0{background-color:var(--color-scale-blue-9);color:var(--color-scale-blue-2);border:1px solid var(--color-scale-blue-4)}.label-color-1{background-color:var(--color-scale-yellow-9);color:var(--color-scale-yellow-2);border:1px solid var(--color-scale-yellow-4)}.label-color-2{background-color:var(--color-scale-purple-9);color:var(--color-scale-purple-2);border:1px solid var(--color-scale-purple-4)}.label-color-3{background-color:var(--color-scale-pink-9);color:var(--color-scale-pink-2);border:1px solid var(--color-scale-pink-4)}.label-color-4{background-color:var(--color-scale-coral-9);color:var(--color-scale-coral-2);border:1px solid var(--color-scale-coral-4)}.label-color-5{background-color:var(--color-scale-orange-9);color:var(--color-scale-orange-2);border:1px solid var(--color-scale-orange-4)}}.attachment-body{white-space:pre-wrap;background-color:var(--color-canvas-subtle);margin-left:24px;line-height:normal;padding:8px;font-family:monospace;position:relative}.attachment-body .copy-icon{position:absolute;right:5px;top:5px}html,body{width:100%;height:100%;padding:0;margin:0;overscroll-behavior-x:none}body{overflow:auto;max-width:1024px;margin:0 auto;width:100%}.test-file-test:not(:first-child){border-top:1px solid var(--color-border-default)}@media only screen and (max-width: 600px){.htmlreport{padding:0!important}}.tabbed-pane{display:flex;flex:auto;overflow:hidden}.tabbed-pane-tab-strip{display:flex;align-items:center;padding-right:10px;flex:none;width:100%;z-index:2;font-size:14px;line-height:32px;color:var(--color-fg-default);height:48px;min-width:70px;box-shadow:inset 0 -1px 0 var(--color-border-muted)!important}.tabbed-pane-tab-strip:focus{outline:none}.tabbed-pane-tab-element{padding:4px 8px 0;margin-right:4px;cursor:pointer;display:flex;flex:none;align-items:center;justify-content:center;-webkit-user-select:none;user-select:none;border-bottom:2px solid transparent;outline:none;height:100%}.tabbed-pane-tab-label{max-width:250px;white-space:pre;overflow:hidden;text-overflow:ellipsis;display:inline-block}.tabbed-pane-tab-element.selected{border-bottom-color:#666}.tabbed-pane-tab-element:hover{color:#333}.chip-header{border:1px solid var(--color-border-default);border-top-left-radius:6px;border-top-right-radius:6px;background-color:var(--color-canvas-subtle);padding:0 8px;border-bottom:none;margin-top:12px;font-weight:600;line-height:38px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.chip-header.expanded-false{border:1px solid var(--color-border-default);border-radius:6px}.chip-header.expanded-false,.chip-header.expanded-true{cursor:pointer}.chip-body{border:1px solid var(--color-border-default);border-bottom-left-radius:6px;border-bottom-right-radius:6px;padding:16px;margin-bottom:12px}.chip-body-no-insets{padding:0}@media only screen and (max-width: 600px){.chip-header{border-radius:0;border-right:none;border-left:none}.chip-body{border-radius:0;border-right:none;border-left:none;padding:8px}.chip-body-no-insets{padding:0}}.test-case-column{border-radius:6px;margin:12px 0 24px}.test-case-column .tab-element.selected{font-weight:600;border-bottom-color:var(--color-primer-border-active)}.test-case-column .tab-element{border:none;color:var(--color-fg-default);border-bottom:2px solid transparent}.test-case-column .tab-element:hover{color:var(--color-fg-default)}.test-case-title{flex:none;padding:8px;font-weight:400;font-size:32px!important;line-height:1.25!important}.test-case-location,.test-case-duration{flex:none;align-items:center;padding:0 8px 8px;line-height:24px}.test-case-run-duration{color:var(--color-fg-subtle);padding-left:8px}.test-case-path{flex:none;align-items:center;padding:0 8px}.test-case-annotation{flex:none;align-items:center;padding:0 8px;line-height:24px;white-space:pre-wrap}@media only screen and (max-width: 600px){.test-case-column{border-radius:0!important;margin:0!important}}.test-case-project-labels-row{display:flex;flex-direction:row;flex-wrap:wrap}body{--vscode-font-family: system-ui, "Ubuntu", "Droid Sans", sans-serif;--vscode-font-weight: normal;--vscode-font-size: 13px;--vscode-editor-font-family: "Droid Sans Mono", "monospace", monospace;--vscode-editor-font-weight: normal;--vscode-editor-font-size: 14px;--vscode-foreground: #616161;--vscode-disabledForeground: rgba(97, 97, 97, .5);--vscode-errorForeground: #a1260d;--vscode-descriptionForeground: #717171;--vscode-icon-foreground: #424242;--vscode-focusBorder: #0090f1;--vscode-textSeparator-foreground: rgba(0, 0, 0, .18);--vscode-textLink-foreground: #006ab1;--vscode-textLink-activeForeground: #006ab1;--vscode-textPreformat-foreground: #a31515;--vscode-textBlockQuote-background: rgba(127, 127, 127, .1);--vscode-textBlockQuote-border: rgba(0, 122, 204, .5);--vscode-textCodeBlock-background: rgba(220, 220, 220, .4);--vscode-widget-shadow: rgba(0, 0, 0, .16);--vscode-input-background: #ffffff;--vscode-input-foreground: #616161;--vscode-inputOption-activeBorder: #007acc;--vscode-inputOption-hoverBackground: rgba(184, 184, 184, .31);--vscode-inputOption-activeBackground: rgba(0, 144, 241, .2);--vscode-inputOption-activeForeground: #000000;--vscode-input-placeholderForeground: #767676;--vscode-inputValidation-infoBackground: #d6ecf2;--vscode-inputValidation-infoBorder: #007acc;--vscode-inputValidation-warningBackground: #f6f5d2;--vscode-inputValidation-warningBorder: #b89500;--vscode-inputValidation-errorBackground: #f2dede;--vscode-inputValidation-errorBorder: #be1100;--vscode-dropdown-background: #ffffff;--vscode-dropdown-border: #cecece;--vscode-checkbox-background: #ffffff;--vscode-checkbox-border: #cecece;--vscode-button-foreground: #ffffff;--vscode-button-separator: rgba(255, 255, 255, .4);--vscode-button-background: #007acc;--vscode-button-hoverBackground: #0062a3;--vscode-button-secondaryForeground: #ffffff;--vscode-button-secondaryBackground: #5f6a79;--vscode-button-secondaryHoverBackground: #4c5561;--vscode-badge-background: #c4c4c4;--vscode-badge-foreground: #333333;--vscode-scrollbar-shadow: #dddddd;--vscode-scrollbarSlider-background: rgba(100, 100, 100, .4);--vscode-scrollbarSlider-hoverBackground: rgba(100, 100, 100, .7);--vscode-scrollbarSlider-activeBackground: rgba(0, 0, 0, .6);--vscode-progressBar-background: #0e70c0;--vscode-editorError-foreground: #e51400;--vscode-editorWarning-foreground: #bf8803;--vscode-editorInfo-foreground: #1a85ff;--vscode-editorHint-foreground: #6c6c6c;--vscode-sash-hoverBorder: #0090f1;--vscode-editor-background: #ffffff;--vscode-editor-foreground: #000000;--vscode-editorStickyScroll-background: #ffffff;--vscode-editorStickyScrollHover-background: #f0f0f0;--vscode-editorWidget-background: #f3f3f3;--vscode-editorWidget-foreground: #616161;--vscode-editorWidget-border: #c8c8c8;--vscode-quickInput-background: #f3f3f3;--vscode-quickInput-foreground: #616161;--vscode-quickInputTitle-background: rgba(0, 0, 0, .06);--vscode-pickerGroup-foreground: #0066bf;--vscode-pickerGroup-border: #cccedb;--vscode-keybindingLabel-background: rgba(221, 221, 221, .4);--vscode-keybindingLabel-foreground: #555555;--vscode-keybindingLabel-border: rgba(204, 204, 204, .4);--vscode-keybindingLabel-bottomBorder: rgba(187, 187, 187, .4);--vscode-editor-selectionBackground: #add6ff;--vscode-editor-inactiveSelectionBackground: #e5ebf1;--vscode-editor-selectionHighlightBackground: rgba(173, 214, 255, .5);--vscode-editor-findMatchBackground: #a8ac94;--vscode-editor-findMatchHighlightBackground: rgba(234, 92, 0, .33);--vscode-editor-findRangeHighlightBackground: rgba(180, 180, 180, .3);--vscode-searchEditor-findMatchBackground: rgba(234, 92, 0, .22);--vscode-editor-hoverHighlightBackground: rgba(173, 214, 255, .15);--vscode-editorHoverWidget-background: #f3f3f3;--vscode-editorHoverWidget-foreground: #616161;--vscode-editorHoverWidget-border: #c8c8c8;--vscode-editorHoverWidget-statusBarBackground: #e7e7e7;--vscode-editorLink-activeForeground: #0000ff;--vscode-editorInlayHint-foreground: rgba(51, 51, 51, .8);--vscode-editorInlayHint-background: rgba(196, 196, 196, .3);--vscode-editorInlayHint-typeForeground: rgba(51, 51, 51, .8);--vscode-editorInlayHint-typeBackground: rgba(196, 196, 196, .3);--vscode-editorInlayHint-parameterForeground: rgba(51, 51, 51, .8);--vscode-editorInlayHint-parameterBackground: rgba(196, 196, 196, .3);--vscode-editorLightBulb-foreground: #ddb100;--vscode-editorLightBulbAutoFix-foreground: #007acc;--vscode-diffEditor-insertedTextBackground: rgba(156, 204, 44, .4);--vscode-diffEditor-removedTextBackground: rgba(255, 0, 0, .3);--vscode-diffEditor-insertedLineBackground: rgba(155, 185, 85, .2);--vscode-diffEditor-removedLineBackground: rgba(255, 0, 0, .2);--vscode-diffEditor-diagonalFill: rgba(34, 34, 34, .2);--vscode-list-focusOutline: #0090f1;--vscode-list-focusAndSelectionOutline: #90c2f9;--vscode-list-activeSelectionBackground: #0060c0;--vscode-list-activeSelectionForeground: #ffffff;--vscode-list-activeSelectionIconForeground: #ffffff;--vscode-list-inactiveSelectionBackground: #e4e6f1;--vscode-list-hoverBackground: #e8e8e8;--vscode-list-dropBackground: #d6ebff;--vscode-list-highlightForeground: #0066bf;--vscode-list-focusHighlightForeground: #bbe7ff;--vscode-list-invalidItemForeground: #b89500;--vscode-list-errorForeground: #b01011;--vscode-list-warningForeground: #855f00;--vscode-listFilterWidget-background: #f3f3f3;--vscode-listFilterWidget-outline: rgba(0, 0, 0, 0);--vscode-listFilterWidget-noMatchesOutline: #be1100;--vscode-listFilterWidget-shadow: rgba(0, 0, 0, .16);--vscode-list-filterMatchBackground: rgba(234, 92, 0, .33);--vscode-tree-indentGuidesStroke: #a9a9a9;--vscode-tree-tableColumnsBorder: rgba(97, 97, 97, .13);--vscode-tree-tableOddRowsBackground: rgba(97, 97, 97, .04);--vscode-list-deemphasizedForeground: #8e8e90;--vscode-quickInputList-focusForeground: #ffffff;--vscode-quickInputList-focusIconForeground: #ffffff;--vscode-quickInputList-focusBackground: #0060c0;--vscode-menu-foreground: #616161;--vscode-menu-background: #ffffff;--vscode-menu-selectionForeground: #ffffff;--vscode-menu-selectionBackground: #0060c0;--vscode-menu-separatorBackground: #d4d4d4;--vscode-toolbar-hoverBackground: rgba(184, 184, 184, .31);--vscode-toolbar-activeBackground: rgba(166, 166, 166, .31);--vscode-editor-snippetTabstopHighlightBackground: rgba(10, 50, 100, .2);--vscode-editor-snippetFinalTabstopHighlightBorder: rgba(10, 50, 100, .5);--vscode-breadcrumb-foreground: rgba(97, 97, 97, .8);--vscode-breadcrumb-background: #ffffff;--vscode-breadcrumb-focusForeground: #4e4e4e;--vscode-breadcrumb-activeSelectionForeground: #4e4e4e;--vscode-breadcrumbPicker-background: #f3f3f3;--vscode-merge-currentHeaderBackground: rgba(64, 200, 174, .5);--vscode-merge-currentContentBackground: rgba(64, 200, 174, .2);--vscode-merge-incomingHeaderBackground: rgba(64, 166, 255, .5);--vscode-merge-incomingContentBackground: rgba(64, 166, 255, .2);--vscode-merge-commonHeaderBackground: rgba(96, 96, 96, .4);--vscode-merge-commonContentBackground: rgba(96, 96, 96, .16);--vscode-editorOverviewRuler-currentContentForeground: rgba(64, 200, 174, .5);--vscode-editorOverviewRuler-incomingContentForeground: rgba(64, 166, 255, .5);--vscode-editorOverviewRuler-commonContentForeground: rgba(96, 96, 96, .4);--vscode-editorOverviewRuler-findMatchForeground: rgba(209, 134, 22, .49);--vscode-editorOverviewRuler-selectionHighlightForeground: rgba(160, 160, 160, .8);--vscode-minimap-findMatchHighlight: #d18616;--vscode-minimap-selectionOccurrenceHighlight: #c9c9c9;--vscode-minimap-selectionHighlight: #add6ff;--vscode-minimap-errorHighlight: rgba(255, 18, 18, .7);--vscode-minimap-warningHighlight: #bf8803;--vscode-minimap-foregroundOpacity: #000000;--vscode-minimapSlider-background: rgba(100, 100, 100, .2);--vscode-minimapSlider-hoverBackground: rgba(100, 100, 100, .35);--vscode-minimapSlider-activeBackground: rgba(0, 0, 0, .3);--vscode-problemsErrorIcon-foreground: #e51400;--vscode-problemsWarningIcon-foreground: #bf8803;--vscode-problemsInfoIcon-foreground: #1a85ff;--vscode-charts-foreground: #616161;--vscode-charts-lines: rgba(97, 97, 97, .5);--vscode-charts-red: #e51400;--vscode-charts-blue: #1a85ff;--vscode-charts-yellow: #bf8803;--vscode-charts-orange: #d18616;--vscode-charts-green: #388a34;--vscode-charts-purple: #652d90;--vscode-editor-lineHighlightBorder: #eeeeee;--vscode-editor-rangeHighlightBackground: rgba(253, 255, 0, .2);--vscode-editor-symbolHighlightBackground: rgba(234, 92, 0, .33);--vscode-editorCursor-foreground: #000000;--vscode-editorWhitespace-foreground: rgba(51, 51, 51, .2);--vscode-editorIndentGuide-background: #d3d3d3;--vscode-editorIndentGuide-activeBackground: #939393;--vscode-editorLineNumber-foreground: #237893;--vscode-editorActiveLineNumber-foreground: #0b216f;--vscode-editorLineNumber-activeForeground: #0b216f;--vscode-editorRuler-foreground: #d3d3d3;--vscode-editorCodeLens-foreground: #919191;--vscode-editorBracketMatch-background: rgba(0, 100, 0, .1);--vscode-editorBracketMatch-border: #b9b9b9;--vscode-editorOverviewRuler-border: rgba(127, 127, 127, .3);--vscode-editorGutter-background: #ffffff;--vscode-editorUnnecessaryCode-opacity: rgba(0, 0, 0, .47);--vscode-editorGhostText-foreground: rgba(0, 0, 0, .47);--vscode-editorOverviewRuler-rangeHighlightForeground: rgba(0, 122, 204, .6);--vscode-editorOverviewRuler-errorForeground: rgba(255, 18, 18, .7);--vscode-editorOverviewRuler-warningForeground: #bf8803;--vscode-editorOverviewRuler-infoForeground: #1a85ff;--vscode-editorBracketHighlight-foreground1: #0431fa;--vscode-editorBracketHighlight-foreground2: #319331;--vscode-editorBracketHighlight-foreground3: #7b3814;--vscode-editorBracketHighlight-foreground4: rgba(0, 0, 0, 0);--vscode-editorBracketHighlight-foreground5: rgba(0, 0, 0, 0);--vscode-editorBracketHighlight-foreground6: rgba(0, 0, 0, 0);--vscode-editorBracketHighlight-unexpectedBracket\.foreground: rgba(255, 18, 18, .8);--vscode-editorBracketPairGuide-background1: rgba(0, 0, 0, 0);--vscode-editorBracketPairGuide-background2: rgba(0, 0, 0, 0);--vscode-editorBracketPairGuide-background3: rgba(0, 0, 0, 0);--vscode-editorBracketPairGuide-background4: rgba(0, 0, 0, 0);--vscode-editorBracketPairGuide-background5: rgba(0, 0, 0, 0);--vscode-editorBracketPairGuide-background6: rgba(0, 0, 0, 0);--vscode-editorBracketPairGuide-activeBackground1: rgba(0, 0, 0, 0);--vscode-editorBracketPairGuide-activeBackground2: rgba(0, 0, 0, 0);--vscode-editorBracketPairGuide-activeBackground3: rgba(0, 0, 0, 0);--vscode-editorBracketPairGuide-activeBackground4: rgba(0, 0, 0, 0);--vscode-editorBracketPairGuide-activeBackground5: rgba(0, 0, 0, 0);--vscode-editorBracketPairGuide-activeBackground6: rgba(0, 0, 0, 0);--vscode-editorUnicodeHighlight-border: #cea33d;--vscode-editorUnicodeHighlight-background: rgba(206, 163, 61, .08);--vscode-symbolIcon-arrayForeground: #616161;--vscode-symbolIcon-booleanForeground: #616161;--vscode-symbolIcon-classForeground: #d67e00;--vscode-symbolIcon-colorForeground: #616161;--vscode-symbolIcon-constantForeground: #616161;--vscode-symbolIcon-constructorForeground: #652d90;--vscode-symbolIcon-enumeratorForeground: #d67e00;--vscode-symbolIcon-enumeratorMemberForeground: #007acc;--vscode-symbolIcon-eventForeground: #d67e00;--vscode-symbolIcon-fieldForeground: #007acc;--vscode-symbolIcon-fileForeground: #616161;--vscode-symbolIcon-folderForeground: #616161;--vscode-symbolIcon-functionForeground: #652d90;--vscode-symbolIcon-interfaceForeground: #007acc;--vscode-symbolIcon-keyForeground: #616161;--vscode-symbolIcon-keywordForeground: #616161;--vscode-symbolIcon-methodForeground: #652d90;--vscode-symbolIcon-moduleForeground: #616161;--vscode-symbolIcon-namespaceForeground: #616161;--vscode-symbolIcon-nullForeground: #616161;--vscode-symbolIcon-numberForeground: #616161;--vscode-symbolIcon-objectForeground: #616161;--vscode-symbolIcon-operatorForeground: #616161;--vscode-symbolIcon-packageForeground: #616161;--vscode-symbolIcon-propertyForeground: #616161;--vscode-symbolIcon-referenceForeground: #616161;--vscode-symbolIcon-snippetForeground: #616161;--vscode-symbolIcon-stringForeground: #616161;--vscode-symbolIcon-structForeground: #616161;--vscode-symbolIcon-textForeground: #616161;--vscode-symbolIcon-typeParameterForeground: #616161;--vscode-symbolIcon-unitForeground: #616161;--vscode-symbolIcon-variableForeground: #007acc;--vscode-editorHoverWidget-highlightForeground: #0066bf;--vscode-editorOverviewRuler-bracketMatchForeground: #a0a0a0;--vscode-editor-foldBackground: rgba(173, 214, 255, .3);--vscode-editorGutter-foldingControlForeground: #424242;--vscode-editor-linkedEditingBackground: rgba(255, 0, 0, .3);--vscode-editor-wordHighlightBackground: rgba(87, 87, 87, .25);--vscode-editor-wordHighlightStrongBackground: rgba(14, 99, 156, .25);--vscode-editorOverviewRuler-wordHighlightForeground: rgba(160, 160, 160, .8);--vscode-editorOverviewRuler-wordHighlightStrongForeground: rgba(192, 160, 192, .8);--vscode-peekViewTitle-background: rgba(26, 133, 255, .1);--vscode-peekViewTitleLabel-foreground: #000000;--vscode-peekViewTitleDescription-foreground: #616161;--vscode-peekView-border: #1a85ff;--vscode-peekViewResult-background: #f3f3f3;--vscode-peekViewResult-lineForeground: #646465;--vscode-peekViewResult-fileForeground: #1e1e1e;--vscode-peekViewResult-selectionBackground: rgba(51, 153, 255, .2);--vscode-peekViewResult-selectionForeground: #6c6c6c;--vscode-peekViewEditor-background: #f2f8fc;--vscode-peekViewEditorGutter-background: #f2f8fc;--vscode-peekViewResult-matchHighlightBackground: rgba(234, 92, 0, .3);--vscode-peekViewEditor-matchHighlightBackground: rgba(245, 216, 2, .87);--vscode-editorMarkerNavigationError-background: #e51400;--vscode-editorMarkerNavigationError-headerBackground: rgba(229, 20, 0, .1);--vscode-editorMarkerNavigationWarning-background: #bf8803;--vscode-editorMarkerNavigationWarning-headerBackground: rgba(191, 136, 3, .1);--vscode-editorMarkerNavigationInfo-background: #1a85ff;--vscode-editorMarkerNavigationInfo-headerBackground: rgba(26, 133, 255, .1);--vscode-editorMarkerNavigation-background: #ffffff;--vscode-editorSuggestWidget-background: #f3f3f3;--vscode-editorSuggestWidget-border: #c8c8c8;--vscode-editorSuggestWidget-foreground: #000000;--vscode-editorSuggestWidget-selectedForeground: #ffffff;--vscode-editorSuggestWidget-selectedIconForeground: #ffffff;--vscode-editorSuggestWidget-selectedBackground: #0060c0;--vscode-editorSuggestWidget-highlightForeground: #0066bf;--vscode-editorSuggestWidget-focusHighlightForeground: #bbe7ff;--vscode-editorSuggestWidgetStatus-foreground: rgba(0, 0, 0, .5);--vscode-tab-activeBackground: #ffffff;--vscode-tab-unfocusedActiveBackground: #ffffff;--vscode-tab-inactiveBackground: #ececec;--vscode-tab-unfocusedInactiveBackground: #ececec;--vscode-tab-activeForeground: #333333;--vscode-tab-inactiveForeground: rgba(51, 51, 51, .7);--vscode-tab-unfocusedActiveForeground: rgba(51, 51, 51, .7);--vscode-tab-unfocusedInactiveForeground: rgba(51, 51, 51, .35);--vscode-tab-border: #f3f3f3;--vscode-tab-lastPinnedBorder: rgba(97, 97, 97, .19);--vscode-tab-activeModifiedBorder: #33aaee;--vscode-tab-inactiveModifiedBorder: rgba(51, 170, 238, .5);--vscode-tab-unfocusedActiveModifiedBorder: rgba(51, 170, 238, .7);--vscode-tab-unfocusedInactiveModifiedBorder: rgba(51, 170, 238, .25);--vscode-editorPane-background: #ffffff;--vscode-editorGroupHeader-tabsBackground: #f3f3f3;--vscode-editorGroupHeader-noTabsBackground: #ffffff;--vscode-editorGroup-border: #e7e7e7;--vscode-editorGroup-dropBackground: rgba(38, 119, 203, .18);--vscode-editorGroup-dropIntoPromptForeground: #616161;--vscode-editorGroup-dropIntoPromptBackground: #f3f3f3;--vscode-sideBySideEditor-horizontalBorder: #e7e7e7;--vscode-sideBySideEditor-verticalBorder: #e7e7e7;--vscode-panel-background: #ffffff;--vscode-panel-border: rgba(128, 128, 128, .35);--vscode-panelTitle-activeForeground: #424242;--vscode-panelTitle-inactiveForeground: rgba(66, 66, 66, .75);--vscode-panelTitle-activeBorder: #424242;--vscode-panelInput-border: #dddddd;--vscode-panel-dropBorder: #424242;--vscode-panelSection-dropBackground: rgba(38, 119, 203, .18);--vscode-panelSectionHeader-background: rgba(128, 128, 128, .2);--vscode-panelSection-border: rgba(128, 128, 128, .35);--vscode-banner-background: #004386;--vscode-banner-foreground: #ffffff;--vscode-banner-iconForeground: #1a85ff;--vscode-statusBar-foreground: #ffffff;--vscode-statusBar-noFolderForeground: #ffffff;--vscode-statusBar-background: #007acc;--vscode-statusBar-noFolderBackground: #68217a;--vscode-statusBar-focusBorder: #ffffff;--vscode-statusBarItem-activeBackground: rgba(255, 255, 255, .18);--vscode-statusBarItem-focusBorder: #ffffff;--vscode-statusBarItem-hoverBackground: rgba(255, 255, 255, .12);--vscode-statusBarItem-compactHoverBackground: rgba(255, 255, 255, .2);--vscode-statusBarItem-prominentForeground: #ffffff;--vscode-statusBarItem-prominentBackground: rgba(0, 0, 0, .5);--vscode-statusBarItem-prominentHoverBackground: rgba(0, 0, 0, .3);--vscode-statusBarItem-errorBackground: #c72e0f;--vscode-statusBarItem-errorForeground: #ffffff;--vscode-statusBarItem-warningBackground: #725102;--vscode-statusBarItem-warningForeground: #ffffff;--vscode-activityBar-background: #2c2c2c;--vscode-activityBar-foreground: #ffffff;--vscode-activityBar-inactiveForeground: rgba(255, 255, 255, .4);--vscode-activityBar-activeBorder: #ffffff;--vscode-activityBar-dropBorder: #ffffff;--vscode-activityBarBadge-background: #007acc;--vscode-activityBarBadge-foreground: #ffffff;--vscode-statusBarItem-remoteBackground: #16825d;--vscode-statusBarItem-remoteForeground: #ffffff;--vscode-extensionBadge-remoteBackground: #007acc;--vscode-extensionBadge-remoteForeground: #ffffff;--vscode-sideBar-background: #f3f3f3;--vscode-sideBarTitle-foreground: #6f6f6f;--vscode-sideBar-dropBackground: rgba(38, 119, 203, .18);--vscode-sideBarSectionHeader-background: rgba(0, 0, 0, 0);--vscode-sideBarSectionHeader-border: rgba(97, 97, 97, .19);--vscode-titleBar-activeForeground: #333333;--vscode-titleBar-inactiveForeground: rgba(51, 51, 51, .6);--vscode-titleBar-activeBackground: #dddddd;--vscode-titleBar-inactiveBackground: rgba(221, 221, 221, .6);--vscode-menubar-selectionForeground: #333333;--vscode-menubar-selectionBackground: rgba(184, 184, 184, .31);--vscode-notifications-foreground: #616161;--vscode-notifications-background: #f3f3f3;--vscode-notificationLink-foreground: #006ab1;--vscode-notificationCenterHeader-background: #e7e7e7;--vscode-notifications-border: #e7e7e7;--vscode-notificationsErrorIcon-foreground: #e51400;--vscode-notificationsWarningIcon-foreground: #bf8803;--vscode-notificationsInfoIcon-foreground: #1a85ff;--vscode-commandCenter-foreground: #333333;--vscode-commandCenter-activeForeground: #333333;--vscode-commandCenter-activeBackground: rgba(184, 184, 184, .31);--vscode-commandCenter-border: rgba(128, 128, 128, .35);--vscode-editorCommentsWidget-resolvedBorder: rgba(97, 97, 97, .5);--vscode-editorCommentsWidget-unresolvedBorder: #1a85ff;--vscode-editorCommentsWidget-rangeBackground: rgba(26, 133, 255, .1);--vscode-editorCommentsWidget-rangeBorder: rgba(26, 133, 255, .4);--vscode-editorCommentsWidget-rangeActiveBackground: rgba(26, 133, 255, .1);--vscode-editorCommentsWidget-rangeActiveBorder: rgba(26, 133, 255, .4);--vscode-editorGutter-commentRangeForeground: #d5d8e9;--vscode-debugToolBar-background: #f3f3f3;--vscode-debugIcon-startForeground: #388a34;--vscode-editor-stackFrameHighlightBackground: rgba(255, 255, 102, .45);--vscode-editor-focusedStackFrameHighlightBackground: rgba(206, 231, 206, .45);--vscode-mergeEditor-change\.background: rgba(155, 185, 85, .2);--vscode-mergeEditor-change\.word\.background: rgba(156, 204, 44, .4);--vscode-mergeEditor-conflict\.unhandledUnfocused\.border: rgba(255, 166, 0, .48);--vscode-mergeEditor-conflict\.unhandledFocused\.border: #ffa600;--vscode-mergeEditor-conflict\.handledUnfocused\.border: rgba(134, 134, 134, .29);--vscode-mergeEditor-conflict\.handledFocused\.border: rgba(193, 193, 193, .8);--vscode-mergeEditor-conflict\.handled\.minimapOverViewRuler: rgba(173, 172, 168, .93);--vscode-mergeEditor-conflict\.unhandled\.minimapOverViewRuler: #fcba03;--vscode-mergeEditor-conflictingLines\.background: rgba(255, 234, 0, .28);--vscode-settings-headerForeground: #444444;--vscode-settings-modifiedItemIndicator: #66afe0;--vscode-settings-headerBorder: rgba(128, 128, 128, .35);--vscode-settings-sashBorder: rgba(128, 128, 128, .35);--vscode-settings-dropdownBackground: #ffffff;--vscode-settings-dropdownBorder: #cecece;--vscode-settings-dropdownListBorder: #c8c8c8;--vscode-settings-checkboxBackground: #ffffff;--vscode-settings-checkboxBorder: #cecece;--vscode-settings-textInputBackground: #ffffff;--vscode-settings-textInputForeground: #616161;--vscode-settings-textInputBorder: #cecece;--vscode-settings-numberInputBackground: #ffffff;--vscode-settings-numberInputForeground: #616161;--vscode-settings-numberInputBorder: #cecece;--vscode-settings-focusedRowBackground: rgba(232, 232, 232, .6);--vscode-settings-rowHoverBackground: rgba(232, 232, 232, .3);--vscode-settings-focusedRowBorder: rgba(0, 0, 0, .12);--vscode-terminal-foreground: #333333;--vscode-terminal-selectionBackground: #add6ff;--vscode-terminal-inactiveSelectionBackground: #e5ebf1;--vscode-terminalCommandDecoration-defaultBackground: rgba(0, 0, 0, .25);--vscode-terminalCommandDecoration-successBackground: #2090d3;--vscode-terminalCommandDecoration-errorBackground: #e51400;--vscode-terminalOverviewRuler-cursorForeground: rgba(160, 160, 160, .8);--vscode-terminal-border: rgba(128, 128, 128, .35);--vscode-terminal-findMatchBackground: #a8ac94;--vscode-terminal-findMatchHighlightBackground: rgba(234, 92, 0, .33);--vscode-terminalOverviewRuler-findMatchForeground: rgba(209, 134, 22, .49);--vscode-terminal-dropBackground: rgba(38, 119, 203, .18);--vscode-testing-iconFailed: #f14c4c;--vscode-testing-iconErrored: #f14c4c;--vscode-testing-iconPassed: #73c991;--vscode-testing-runAction: #73c991;--vscode-testing-iconQueued: #cca700;--vscode-testing-iconUnset: #848484;--vscode-testing-iconSkipped: #848484;--vscode-testing-peekBorder: #e51400;--vscode-testing-peekHeaderBackground: rgba(229, 20, 0, .1);--vscode-testing-message\.error\.decorationForeground: #e51400;--vscode-testing-message\.error\.lineBackground: rgba(255, 0, 0, .2);--vscode-testing-message\.info\.decorationForeground: rgba(0, 0, 0, .5);--vscode-welcomePage-tileBackground: #f3f3f3;--vscode-welcomePage-tileHoverBackground: #dbdbdb;--vscode-welcomePage-tileShadow: rgba(0, 0, 0, .16);--vscode-welcomePage-progress\.background: #ffffff;--vscode-welcomePage-progress\.foreground: #006ab1;--vscode-debugExceptionWidget-border: #a31515;--vscode-debugExceptionWidget-background: #f1dfde;--vscode-ports-iconRunningProcessForeground: #369432;--vscode-statusBar-debuggingBackground: #cc6633;--vscode-statusBar-debuggingForeground: #ffffff;--vscode-editor-inlineValuesForeground: rgba(0, 0, 0, .5);--vscode-editor-inlineValuesBackground: rgba(255, 200, 0, .2);--vscode-editorGutter-modifiedBackground: #2090d3;--vscode-editorGutter-addedBackground: #48985d;--vscode-editorGutter-deletedBackground: #e51400;--vscode-minimapGutter-modifiedBackground: #2090d3;--vscode-minimapGutter-addedBackground: #48985d;--vscode-minimapGutter-deletedBackground: #e51400;--vscode-editorOverviewRuler-modifiedForeground: rgba(32, 144, 211, .6);--vscode-editorOverviewRuler-addedForeground: rgba(72, 152, 93, .6);--vscode-editorOverviewRuler-deletedForeground: rgba(229, 20, 0, .6);--vscode-debugIcon-breakpointForeground: #e51400;--vscode-debugIcon-breakpointDisabledForeground: #848484;--vscode-debugIcon-breakpointUnverifiedForeground: #848484;--vscode-debugIcon-breakpointCurrentStackframeForeground: #be8700;--vscode-debugIcon-breakpointStackframeForeground: #89d185;--vscode-notebook-cellBorderColor: #e8e8e8;--vscode-notebook-focusedEditorBorder: #0090f1;--vscode-notebookStatusSuccessIcon-foreground: #388a34;--vscode-notebookStatusErrorIcon-foreground: #a1260d;--vscode-notebookStatusRunningIcon-foreground: #616161;--vscode-notebook-cellToolbarSeparator: rgba(128, 128, 128, .35);--vscode-notebook-selectedCellBackground: rgba(200, 221, 241, .31);--vscode-notebook-selectedCellBorder: #e8e8e8;--vscode-notebook-focusedCellBorder: #0090f1;--vscode-notebook-inactiveFocusedCellBorder: #e8e8e8;--vscode-notebook-cellStatusBarItemHoverBackground: rgba(0, 0, 0, .08);--vscode-notebook-cellInsertionIndicator: #0090f1;--vscode-notebookScrollbarSlider-background: rgba(100, 100, 100, .4);--vscode-notebookScrollbarSlider-hoverBackground: rgba(100, 100, 100, .7);--vscode-notebookScrollbarSlider-activeBackground: rgba(0, 0, 0, .6);--vscode-notebook-symbolHighlightBackground: rgba(253, 255, 0, .2);--vscode-notebook-cellEditorBackground: #f3f3f3;--vscode-notebook-editorBackground: #ffffff;--vscode-keybindingTable-headerBackground: rgba(97, 97, 97, .04);--vscode-keybindingTable-rowsBackground: rgba(97, 97, 97, .04);--vscode-scm-providerBorder: #c8c8c8;--vscode-searchEditor-textInputBorder: #cecece;--vscode-debugTokenExpression-name: #9b46b0;--vscode-debugTokenExpression-value: rgba(108, 108, 108, .8);--vscode-debugTokenExpression-string: #a31515;--vscode-debugTokenExpression-boolean: #0000ff;--vscode-debugTokenExpression-number: #098658;--vscode-debugTokenExpression-error: #e51400;--vscode-debugView-exceptionLabelForeground: #ffffff;--vscode-debugView-exceptionLabelBackground: #a31515;--vscode-debugView-stateLabelForeground: #616161;--vscode-debugView-stateLabelBackground: rgba(136, 136, 136, .27);--vscode-debugView-valueChangedHighlight: #569cd6;--vscode-debugConsole-infoForeground: #1a85ff;--vscode-debugConsole-warningForeground: #bf8803;--vscode-debugConsole-errorForeground: #a1260d;--vscode-debugConsole-sourceForeground: #616161;--vscode-debugConsoleInputIcon-foreground: #616161;--vscode-debugIcon-pauseForeground: #007acc;--vscode-debugIcon-stopForeground: #a1260d;--vscode-debugIcon-disconnectForeground: #a1260d;--vscode-debugIcon-restartForeground: #388a34;--vscode-debugIcon-stepOverForeground: #007acc;--vscode-debugIcon-stepIntoForeground: #007acc;--vscode-debugIcon-stepOutForeground: #007acc;--vscode-debugIcon-continueForeground: #007acc;--vscode-debugIcon-stepBackForeground: #007acc;--vscode-extensionButton-prominentBackground: #007acc;--vscode-extensionButton-prominentForeground: #ffffff;--vscode-extensionButton-prominentHoverBackground: #0062a3;--vscode-extensionIcon-starForeground: #df6100;--vscode-extensionIcon-verifiedForeground: #006ab1;--vscode-extensionIcon-preReleaseForeground: #1d9271;--vscode-extensionIcon-sponsorForeground: #b51e78;--vscode-terminal-ansiBlack: #000000;--vscode-terminal-ansiRed: #cd3131;--vscode-terminal-ansiGreen: #00bc00;--vscode-terminal-ansiYellow: #949800;--vscode-terminal-ansiBlue: #0451a5;--vscode-terminal-ansiMagenta: #bc05bc;--vscode-terminal-ansiCyan: #0598bc;--vscode-terminal-ansiWhite: #555555;--vscode-terminal-ansiBrightBlack: #666666;--vscode-terminal-ansiBrightRed: #cd3131;--vscode-terminal-ansiBrightGreen: #14ce14;--vscode-terminal-ansiBrightYellow: #b5ba00;--vscode-terminal-ansiBrightBlue: #0451a5;--vscode-terminal-ansiBrightMagenta: #bc05bc;--vscode-terminal-ansiBrightCyan: #0598bc;--vscode-terminal-ansiBrightWhite: #a5a5a5;--vscode-interactive-activeCodeBorder: #1a85ff;--vscode-interactive-inactiveCodeBorder: #e4e6f1;--vscode-gitDecoration-addedResourceForeground: #587c0c;--vscode-gitDecoration-modifiedResourceForeground: #895503;--vscode-gitDecoration-deletedResourceForeground: #ad0707;--vscode-gitDecoration-renamedResourceForeground: #007100;--vscode-gitDecoration-untrackedResourceForeground: #007100;--vscode-gitDecoration-ignoredResourceForeground: #8e8e90;--vscode-gitDecoration-stageModifiedResourceForeground: #895503;--vscode-gitDecoration-stageDeletedResourceForeground: #ad0707;--vscode-gitDecoration-conflictingResourceForeground: #ad0707;--vscode-gitDecoration-submoduleResourceForeground: #1258a7}body.dark-mode{--vscode-font-family: system-ui, "Ubuntu", "Droid Sans", sans-serif;--vscode-font-weight: normal;--vscode-font-size: 13px;--vscode-editor-font-family: "Droid Sans Mono", "monospace", monospace;--vscode-editor-font-weight: normal;--vscode-editor-font-size: 14px;--vscode-foreground: #cccccc;--vscode-disabledForeground: rgba(204, 204, 204, .5);--vscode-errorForeground: #f48771;--vscode-descriptionForeground: rgba(204, 204, 204, .7);--vscode-icon-foreground: #c5c5c5;--vscode-focusBorder: #007fd4;--vscode-textSeparator-foreground: rgba(255, 255, 255, .18);--vscode-textLink-foreground: #3794ff;--vscode-textLink-activeForeground: #3794ff;--vscode-textPreformat-foreground: #d7ba7d;--vscode-textBlockQuote-background: rgba(127, 127, 127, .1);--vscode-textBlockQuote-border: rgba(0, 122, 204, .5);--vscode-textCodeBlock-background: rgba(10, 10, 10, .4);--vscode-widget-shadow: rgba(0, 0, 0, .36);--vscode-input-background: #3c3c3c;--vscode-input-foreground: #cccccc;--vscode-inputOption-activeBorder: #007acc;--vscode-inputOption-hoverBackground: rgba(90, 93, 94, .5);--vscode-inputOption-activeBackground: rgba(0, 127, 212, .4);--vscode-inputOption-activeForeground: #ffffff;--vscode-input-placeholderForeground: #a6a6a6;--vscode-inputValidation-infoBackground: #063b49;--vscode-inputValidation-infoBorder: #007acc;--vscode-inputValidation-warningBackground: #352a05;--vscode-inputValidation-warningBorder: #b89500;--vscode-inputValidation-errorBackground: #5a1d1d;--vscode-inputValidation-errorBorder: #be1100;--vscode-dropdown-background: #3c3c3c;--vscode-dropdown-foreground: #f0f0f0;--vscode-dropdown-border: #3c3c3c;--vscode-checkbox-background: #3c3c3c;--vscode-checkbox-foreground: #f0f0f0;--vscode-checkbox-border: #3c3c3c;--vscode-button-foreground: #ffffff;--vscode-button-separator: rgba(255, 255, 255, .4);--vscode-button-background: #0e639c;--vscode-button-hoverBackground: #1177bb;--vscode-button-secondaryForeground: #ffffff;--vscode-button-secondaryBackground: #3a3d41;--vscode-button-secondaryHoverBackground: #45494e;--vscode-badge-background: #4d4d4d;--vscode-badge-foreground: #ffffff;--vscode-scrollbar-shadow: #000000;--vscode-scrollbarSlider-background: rgba(121, 121, 121, .4);--vscode-scrollbarSlider-hoverBackground: rgba(100, 100, 100, .7);--vscode-scrollbarSlider-activeBackground: rgba(191, 191, 191, .4);--vscode-progressBar-background: #0e70c0;--vscode-editorError-foreground: #f14c4c;--vscode-editorWarning-foreground: #cca700;--vscode-editorInfo-foreground: #3794ff;--vscode-editorHint-foreground: rgba(238, 238, 238, .7);--vscode-sash-hoverBorder: #007fd4;--vscode-editor-background: #1e1e1e;--vscode-editor-foreground: #d4d4d4;--vscode-editorStickyScroll-background: #1e1e1e;--vscode-editorStickyScrollHover-background: #2a2d2e;--vscode-editorWidget-background: #252526;--vscode-editorWidget-foreground: #cccccc;--vscode-editorWidget-border: #454545;--vscode-quickInput-background: #252526;--vscode-quickInput-foreground: #cccccc;--vscode-quickInputTitle-background: rgba(255, 255, 255, .1);--vscode-pickerGroup-foreground: #3794ff;--vscode-pickerGroup-border: #3f3f46;--vscode-keybindingLabel-background: rgba(128, 128, 128, .17);--vscode-keybindingLabel-foreground: #cccccc;--vscode-keybindingLabel-border: rgba(51, 51, 51, .6);--vscode-keybindingLabel-bottomBorder: rgba(68, 68, 68, .6);--vscode-editor-selectionBackground: #264f78;--vscode-editor-inactiveSelectionBackground: #3a3d41;--vscode-editor-selectionHighlightBackground: rgba(173, 214, 255, .15);--vscode-editor-findMatchBackground: #515c6a;--vscode-editor-findMatchHighlightBackground: rgba(234, 92, 0, .33);--vscode-editor-findRangeHighlightBackground: rgba(58, 61, 65, .4);--vscode-searchEditor-findMatchBackground: rgba(234, 92, 0, .22);--vscode-editor-hoverHighlightBackground: rgba(38, 79, 120, .25);--vscode-editorHoverWidget-background: #252526;--vscode-editorHoverWidget-foreground: #cccccc;--vscode-editorHoverWidget-border: #454545;--vscode-editorHoverWidget-statusBarBackground: #2c2c2d;--vscode-editorLink-activeForeground: #4e94ce;--vscode-editorInlayHint-foreground: rgba(255, 255, 255, .8);--vscode-editorInlayHint-background: rgba(77, 77, 77, .6);--vscode-editorInlayHint-typeForeground: rgba(255, 255, 255, .8);--vscode-editorInlayHint-typeBackground: rgba(77, 77, 77, .6);--vscode-editorInlayHint-parameterForeground: rgba(255, 255, 255, .8);--vscode-editorInlayHint-parameterBackground: rgba(77, 77, 77, .6);--vscode-editorLightBulb-foreground: #ffcc00;--vscode-editorLightBulbAutoFix-foreground: #75beff;--vscode-diffEditor-insertedTextBackground: rgba(156, 204, 44, .2);--vscode-diffEditor-removedTextBackground: rgba(255, 0, 0, .4);--vscode-diffEditor-insertedLineBackground: rgba(155, 185, 85, .2);--vscode-diffEditor-removedLineBackground: rgba(255, 0, 0, .2);--vscode-diffEditor-diagonalFill: rgba(204, 204, 204, .2);--vscode-list-focusOutline: #007fd4;--vscode-list-activeSelectionBackground: #04395e;--vscode-list-activeSelectionForeground: #ffffff;--vscode-list-activeSelectionIconForeground: #ffffff;--vscode-list-inactiveSelectionBackground: #37373d;--vscode-list-hoverBackground: #2a2d2e;--vscode-list-dropBackground: #383b3d;--vscode-list-highlightForeground: #2aaaff;--vscode-list-focusHighlightForeground: #2aaaff;--vscode-list-invalidItemForeground: #b89500;--vscode-list-errorForeground: #f88070;--vscode-list-warningForeground: #cca700;--vscode-listFilterWidget-background: #252526;--vscode-listFilterWidget-outline: rgba(0, 0, 0, 0);--vscode-listFilterWidget-noMatchesOutline: #be1100;--vscode-listFilterWidget-shadow: rgba(0, 0, 0, .36);--vscode-list-filterMatchBackground: rgba(234, 92, 0, .33);--vscode-tree-indentGuidesStroke: #585858;--vscode-tree-tableColumnsBorder: rgba(204, 204, 204, .13);--vscode-tree-tableOddRowsBackground: rgba(204, 204, 204, .04);--vscode-list-deemphasizedForeground: #8c8c8c;--vscode-quickInputList-focusForeground: #ffffff;--vscode-quickInputList-focusIconForeground: #ffffff;--vscode-quickInputList-focusBackground: #04395e;--vscode-menu-foreground: #cccccc;--vscode-menu-background: #303031;--vscode-menu-selectionForeground: #ffffff;--vscode-menu-selectionBackground: #04395e;--vscode-menu-separatorBackground: #606060;--vscode-toolbar-hoverBackground: rgba(90, 93, 94, .31);--vscode-toolbar-activeBackground: rgba(99, 102, 103, .31);--vscode-editor-snippetTabstopHighlightBackground: rgba(124, 124, 124, .3);--vscode-editor-snippetFinalTabstopHighlightBorder: #525252;--vscode-breadcrumb-foreground: rgba(204, 204, 204, .8);--vscode-breadcrumb-background: #1e1e1e;--vscode-breadcrumb-focusForeground: #e0e0e0;--vscode-breadcrumb-activeSelectionForeground: #e0e0e0;--vscode-breadcrumbPicker-background: #252526;--vscode-merge-currentHeaderBackground: rgba(64, 200, 174, .5);--vscode-merge-currentContentBackground: rgba(64, 200, 174, .2);--vscode-merge-incomingHeaderBackground: rgba(64, 166, 255, .5);--vscode-merge-incomingContentBackground: rgba(64, 166, 255, .2);--vscode-merge-commonHeaderBackground: rgba(96, 96, 96, .4);--vscode-merge-commonContentBackground: rgba(96, 96, 96, .16);--vscode-editorOverviewRuler-currentContentForeground: rgba(64, 200, 174, .5);--vscode-editorOverviewRuler-incomingContentForeground: rgba(64, 166, 255, .5);--vscode-editorOverviewRuler-commonContentForeground: rgba(96, 96, 96, .4);--vscode-editorOverviewRuler-findMatchForeground: rgba(209, 134, 22, .49);--vscode-editorOverviewRuler-selectionHighlightForeground: rgba(160, 160, 160, .8);--vscode-minimap-findMatchHighlight: #d18616;--vscode-minimap-selectionOccurrenceHighlight: #676767;--vscode-minimap-selectionHighlight: #264f78;--vscode-minimap-errorHighlight: rgba(255, 18, 18, .7);--vscode-minimap-warningHighlight: #cca700;--vscode-minimap-foregroundOpacity: #000000;--vscode-minimapSlider-background: rgba(121, 121, 121, .2);--vscode-minimapSlider-hoverBackground: rgba(100, 100, 100, .35);--vscode-minimapSlider-activeBackground: rgba(191, 191, 191, .2);--vscode-problemsErrorIcon-foreground: #f14c4c;--vscode-problemsWarningIcon-foreground: #cca700;--vscode-problemsInfoIcon-foreground: #3794ff;--vscode-charts-foreground: #cccccc;--vscode-charts-lines: rgba(204, 204, 204, .5);--vscode-charts-red: #f14c4c;--vscode-charts-blue: #3794ff;--vscode-charts-yellow: #cca700;--vscode-charts-orange: #d18616;--vscode-charts-green: #89d185;--vscode-charts-purple: #b180d7;--vscode-editor-lineHighlightBorder: #282828;--vscode-editor-rangeHighlightBackground: rgba(255, 255, 255, .04);--vscode-editor-symbolHighlightBackground: rgba(234, 92, 0, .33);--vscode-editorCursor-foreground: #aeafad;--vscode-editorWhitespace-foreground: rgba(227, 228, 226, .16);--vscode-editorIndentGuide-background: #404040;--vscode-editorIndentGuide-activeBackground: #707070;--vscode-editorLineNumber-foreground: #858585;--vscode-editorActiveLineNumber-foreground: #c6c6c6;--vscode-editorLineNumber-activeForeground: #c6c6c6;--vscode-editorRuler-foreground: #5a5a5a;--vscode-editorCodeLens-foreground: #999999;--vscode-editorBracketMatch-background: rgba(0, 100, 0, .1);--vscode-editorBracketMatch-border: #888888;--vscode-editorOverviewRuler-border: rgba(127, 127, 127, .3);--vscode-editorGutter-background: #1e1e1e;--vscode-editorUnnecessaryCode-opacity: rgba(0, 0, 0, .67);--vscode-editorGhostText-foreground: rgba(255, 255, 255, .34);--vscode-editorOverviewRuler-rangeHighlightForeground: rgba(0, 122, 204, .6);--vscode-editorOverviewRuler-errorForeground: rgba(255, 18, 18, .7);--vscode-editorOverviewRuler-warningForeground: #cca700;--vscode-editorOverviewRuler-infoForeground: #3794ff;--vscode-editorBracketHighlight-foreground1: #ffd700;--vscode-editorBracketHighlight-foreground2: #da70d6;--vscode-editorBracketHighlight-foreground3: #179fff;--vscode-editorBracketHighlight-foreground4: rgba(0, 0, 0, 0);--vscode-editorBracketHighlight-foreground5: rgba(0, 0, 0, 0);--vscode-editorBracketHighlight-foreground6: rgba(0, 0, 0, 0);--vscode-editorBracketHighlight-unexpectedBracket\.foreground: rgba(255, 18, 18, .8);--vscode-editorBracketPairGuide-background1: rgba(0, 0, 0, 0);--vscode-editorBracketPairGuide-background2: rgba(0, 0, 0, 0);--vscode-editorBracketPairGuide-background3: rgba(0, 0, 0, 0);--vscode-editorBracketPairGuide-background4: rgba(0, 0, 0, 0);--vscode-editorBracketPairGuide-background5: rgba(0, 0, 0, 0);--vscode-editorBracketPairGuide-background6: rgba(0, 0, 0, 0);--vscode-editorBracketPairGuide-activeBackground1: rgba(0, 0, 0, 0);--vscode-editorBracketPairGuide-activeBackground2: rgba(0, 0, 0, 0);--vscode-editorBracketPairGuide-activeBackground3: rgba(0, 0, 0, 0);--vscode-editorBracketPairGuide-activeBackground4: rgba(0, 0, 0, 0);--vscode-editorBracketPairGuide-activeBackground5: rgba(0, 0, 0, 0);--vscode-editorBracketPairGuide-activeBackground6: rgba(0, 0, 0, 0);--vscode-editorUnicodeHighlight-border: #bd9b03;--vscode-editorUnicodeHighlight-background: rgba(189, 155, 3, .15);--vscode-symbolIcon-arrayForeground: #cccccc;--vscode-symbolIcon-booleanForeground: #cccccc;--vscode-symbolIcon-classForeground: #ee9d28;--vscode-symbolIcon-colorForeground: #cccccc;--vscode-symbolIcon-constantForeground: #cccccc;--vscode-symbolIcon-constructorForeground: #b180d7;--vscode-symbolIcon-enumeratorForeground: #ee9d28;--vscode-symbolIcon-enumeratorMemberForeground: #75beff;--vscode-symbolIcon-eventForeground: #ee9d28;--vscode-symbolIcon-fieldForeground: #75beff;--vscode-symbolIcon-fileForeground: #cccccc;--vscode-symbolIcon-folderForeground: #cccccc;--vscode-symbolIcon-functionForeground: #b180d7;--vscode-symbolIcon-interfaceForeground: #75beff;--vscode-symbolIcon-keyForeground: #cccccc;--vscode-symbolIcon-keywordForeground: #cccccc;--vscode-symbolIcon-methodForeground: #b180d7;--vscode-symbolIcon-moduleForeground: #cccccc;--vscode-symbolIcon-namespaceForeground: #cccccc;--vscode-symbolIcon-nullForeground: #cccccc;--vscode-symbolIcon-numberForeground: #cccccc;--vscode-symbolIcon-objectForeground: #cccccc;--vscode-symbolIcon-operatorForeground: #cccccc;--vscode-symbolIcon-packageForeground: #cccccc;--vscode-symbolIcon-propertyForeground: #cccccc;--vscode-symbolIcon-referenceForeground: #cccccc;--vscode-symbolIcon-snippetForeground: #cccccc;--vscode-symbolIcon-stringForeground: #cccccc;--vscode-symbolIcon-structForeground: #cccccc;--vscode-symbolIcon-textForeground: #cccccc;--vscode-symbolIcon-typeParameterForeground: #cccccc;--vscode-symbolIcon-unitForeground: #cccccc;--vscode-symbolIcon-variableForeground: #75beff;--vscode-editorHoverWidget-highlightForeground: #2aaaff;--vscode-editorOverviewRuler-bracketMatchForeground: #a0a0a0;--vscode-editor-foldBackground: rgba(38, 79, 120, .3);--vscode-editorGutter-foldingControlForeground: #c5c5c5;--vscode-editor-linkedEditingBackground: rgba(255, 0, 0, .3);--vscode-editor-wordHighlightBackground: rgba(87, 87, 87, .72);--vscode-editor-wordHighlightStrongBackground: rgba(0, 73, 114, .72);--vscode-editorOverviewRuler-wordHighlightForeground: rgba(160, 160, 160, .8);--vscode-editorOverviewRuler-wordHighlightStrongForeground: rgba(192, 160, 192, .8);--vscode-peekViewTitle-background: rgba(55, 148, 255, .1);--vscode-peekViewTitleLabel-foreground: #ffffff;--vscode-peekViewTitleDescription-foreground: rgba(204, 204, 204, .7);--vscode-peekView-border: #3794ff;--vscode-peekViewResult-background: #252526;--vscode-peekViewResult-lineForeground: #bbbbbb;--vscode-peekViewResult-fileForeground: #ffffff;--vscode-peekViewResult-selectionBackground: rgba(51, 153, 255, .2);--vscode-peekViewResult-selectionForeground: #ffffff;--vscode-peekViewEditor-background: #001f33;--vscode-peekViewEditorGutter-background: #001f33;--vscode-peekViewResult-matchHighlightBackground: rgba(234, 92, 0, .3);--vscode-peekViewEditor-matchHighlightBackground: rgba(255, 143, 0, .6);--vscode-editorMarkerNavigationError-background: #f14c4c;--vscode-editorMarkerNavigationError-headerBackground: rgba(241, 76, 76, .1);--vscode-editorMarkerNavigationWarning-background: #cca700;--vscode-editorMarkerNavigationWarning-headerBackground: rgba(204, 167, 0, .1);--vscode-editorMarkerNavigationInfo-background: #3794ff;--vscode-editorMarkerNavigationInfo-headerBackground: rgba(55, 148, 255, .1);--vscode-editorMarkerNavigation-background: #1e1e1e;--vscode-editorSuggestWidget-background: #252526;--vscode-editorSuggestWidget-border: #454545;--vscode-editorSuggestWidget-foreground: #d4d4d4;--vscode-editorSuggestWidget-selectedForeground: #ffffff;--vscode-editorSuggestWidget-selectedIconForeground: #ffffff;--vscode-editorSuggestWidget-selectedBackground: #04395e;--vscode-editorSuggestWidget-highlightForeground: #2aaaff;--vscode-editorSuggestWidget-focusHighlightForeground: #2aaaff;--vscode-editorSuggestWidgetStatus-foreground: rgba(212, 212, 212, .5);--vscode-tab-activeBackground: #1e1e1e;--vscode-tab-unfocusedActiveBackground: #1e1e1e;--vscode-tab-inactiveBackground: #2d2d2d;--vscode-tab-unfocusedInactiveBackground: #2d2d2d;--vscode-tab-activeForeground: #ffffff;--vscode-tab-inactiveForeground: rgba(255, 255, 255, .5);--vscode-tab-unfocusedActiveForeground: rgba(255, 255, 255, .5);--vscode-tab-unfocusedInactiveForeground: rgba(255, 255, 255, .25);--vscode-tab-border: #252526;--vscode-tab-lastPinnedBorder: rgba(204, 204, 204, .2);--vscode-tab-activeModifiedBorder: #3399cc;--vscode-tab-inactiveModifiedBorder: rgba(51, 153, 204, .5);--vscode-tab-unfocusedActiveModifiedBorder: rgba(51, 153, 204, .5);--vscode-tab-unfocusedInactiveModifiedBorder: rgba(51, 153, 204, .25);--vscode-editorPane-background: #1e1e1e;--vscode-editorGroupHeader-tabsBackground: #252526;--vscode-editorGroupHeader-noTabsBackground: #1e1e1e;--vscode-editorGroup-border: #444444;--vscode-editorGroup-dropBackground: rgba(83, 89, 93, .5);--vscode-editorGroup-dropIntoPromptForeground: #cccccc;--vscode-editorGroup-dropIntoPromptBackground: #252526;--vscode-sideBySideEditor-horizontalBorder: #444444;--vscode-sideBySideEditor-verticalBorder: #444444;--vscode-panel-background: #1e1e1e;--vscode-panel-border: rgba(128, 128, 128, .35);--vscode-panelTitle-activeForeground: #e7e7e7;--vscode-panelTitle-inactiveForeground: rgba(231, 231, 231, .6);--vscode-panelTitle-activeBorder: #e7e7e7;--vscode-panel-dropBorder: #e7e7e7;--vscode-panelSection-dropBackground: rgba(83, 89, 93, .5);--vscode-panelSectionHeader-background: rgba(128, 128, 128, .2);--vscode-panelSection-border: rgba(128, 128, 128, .35);--vscode-banner-background: #04395e;--vscode-banner-foreground: #ffffff;--vscode-banner-iconForeground: #3794ff;--vscode-statusBar-foreground: #ffffff;--vscode-statusBar-noFolderForeground: #ffffff;--vscode-statusBar-background: #007acc;--vscode-statusBar-noFolderBackground: #68217a;--vscode-statusBar-focusBorder: #ffffff;--vscode-statusBarItem-activeBackground: rgba(255, 255, 255, .18);--vscode-statusBarItem-focusBorder: #ffffff;--vscode-statusBarItem-hoverBackground: rgba(255, 255, 255, .12);--vscode-statusBarItem-compactHoverBackground: rgba(255, 255, 255, .2);--vscode-statusBarItem-prominentForeground: #ffffff;--vscode-statusBarItem-prominentBackground: rgba(0, 0, 0, .5);--vscode-statusBarItem-prominentHoverBackground: rgba(0, 0, 0, .3);--vscode-statusBarItem-errorBackground: #c72e0f;--vscode-statusBarItem-errorForeground: #ffffff;--vscode-statusBarItem-warningBackground: #7a6400;--vscode-statusBarItem-warningForeground: #ffffff;--vscode-activityBar-background: #333333;--vscode-activityBar-foreground: #ffffff;--vscode-activityBar-inactiveForeground: rgba(255, 255, 255, .4);--vscode-activityBar-activeBorder: #ffffff;--vscode-activityBar-dropBorder: #ffffff;--vscode-activityBarBadge-background: #007acc;--vscode-activityBarBadge-foreground: #ffffff;--vscode-statusBarItem-remoteBackground: #16825d;--vscode-statusBarItem-remoteForeground: #ffffff;--vscode-extensionBadge-remoteBackground: #007acc;--vscode-extensionBadge-remoteForeground: #ffffff;--vscode-sideBar-background: #252526;--vscode-sideBarTitle-foreground: #bbbbbb;--vscode-sideBar-dropBackground: rgba(83, 89, 93, .5);--vscode-sideBarSectionHeader-background: rgba(0, 0, 0, 0);--vscode-sideBarSectionHeader-border: rgba(204, 204, 204, .2);--vscode-titleBar-activeForeground: #cccccc;--vscode-titleBar-inactiveForeground: rgba(204, 204, 204, .6);--vscode-titleBar-activeBackground: #3c3c3c;--vscode-titleBar-inactiveBackground: rgba(60, 60, 60, .6);--vscode-menubar-selectionForeground: #cccccc;--vscode-menubar-selectionBackground: rgba(90, 93, 94, .31);--vscode-notifications-foreground: #cccccc;--vscode-notifications-background: #252526;--vscode-notificationLink-foreground: #3794ff;--vscode-notificationCenterHeader-background: #303031;--vscode-notifications-border: #303031;--vscode-notificationsErrorIcon-foreground: #f14c4c;--vscode-notificationsWarningIcon-foreground: #cca700;--vscode-notificationsInfoIcon-foreground: #3794ff;--vscode-commandCenter-foreground: #cccccc;--vscode-commandCenter-activeForeground: #cccccc;--vscode-commandCenter-activeBackground: rgba(90, 93, 94, .31);--vscode-commandCenter-border: rgba(128, 128, 128, .35);--vscode-editorCommentsWidget-resolvedBorder: rgba(204, 204, 204, .5);--vscode-editorCommentsWidget-unresolvedBorder: #3794ff;--vscode-editorCommentsWidget-rangeBackground: rgba(55, 148, 255, .1);--vscode-editorCommentsWidget-rangeBorder: rgba(55, 148, 255, .4);--vscode-editorCommentsWidget-rangeActiveBackground: rgba(55, 148, 255, .1);--vscode-editorCommentsWidget-rangeActiveBorder: rgba(55, 148, 255, .4);--vscode-editorGutter-commentRangeForeground: #37373d;--vscode-debugToolBar-background: #333333;--vscode-debugIcon-startForeground: #89d185;--vscode-editor-stackFrameHighlightBackground: rgba(255, 255, 0, .2);--vscode-editor-focusedStackFrameHighlightBackground: rgba(122, 189, 122, .3);--vscode-mergeEditor-change\.background: rgba(155, 185, 85, .2);--vscode-mergeEditor-change\.word\.background: rgba(156, 204, 44, .2);--vscode-mergeEditor-conflict\.unhandledUnfocused\.border: rgba(255, 166, 0, .48);--vscode-mergeEditor-conflict\.unhandledFocused\.border: #ffa600;--vscode-mergeEditor-conflict\.handledUnfocused\.border: rgba(134, 134, 134, .29);--vscode-mergeEditor-conflict\.handledFocused\.border: rgba(193, 193, 193, .8);--vscode-mergeEditor-conflict\.handled\.minimapOverViewRuler: rgba(173, 172, 168, .93);--vscode-mergeEditor-conflict\.unhandled\.minimapOverViewRuler: #fcba03;--vscode-mergeEditor-conflictingLines\.background: rgba(255, 234, 0, .28);--vscode-settings-headerForeground: #e7e7e7;--vscode-settings-modifiedItemIndicator: #0c7d9d;--vscode-settings-headerBorder: rgba(128, 128, 128, .35);--vscode-settings-sashBorder: rgba(128, 128, 128, .35);--vscode-settings-dropdownBackground: #3c3c3c;--vscode-settings-dropdownForeground: #f0f0f0;--vscode-settings-dropdownBorder: #3c3c3c;--vscode-settings-dropdownListBorder: #454545;--vscode-settings-checkboxBackground: #3c3c3c;--vscode-settings-checkboxForeground: #f0f0f0;--vscode-settings-checkboxBorder: #3c3c3c;--vscode-settings-textInputBackground: #3c3c3c;--vscode-settings-textInputForeground: #cccccc;--vscode-settings-numberInputBackground: #3c3c3c;--vscode-settings-numberInputForeground: #cccccc;--vscode-settings-focusedRowBackground: rgba(42, 45, 46, .6);--vscode-settings-rowHoverBackground: rgba(42, 45, 46, .3);--vscode-settings-focusedRowBorder: rgba(255, 255, 255, .12);--vscode-terminal-foreground: #cccccc;--vscode-terminal-selectionBackground: #264f78;--vscode-terminal-inactiveSelectionBackground: #3a3d41;--vscode-terminalCommandDecoration-defaultBackground: rgba(255, 255, 255, .25);--vscode-terminalCommandDecoration-successBackground: #1b81a8;--vscode-terminalCommandDecoration-errorBackground: #f14c4c;--vscode-terminalOverviewRuler-cursorForeground: rgba(160, 160, 160, .8);--vscode-terminal-border: rgba(128, 128, 128, .35);--vscode-terminal-findMatchBackground: #515c6a;--vscode-terminal-findMatchHighlightBackground: rgba(234, 92, 0, .33);--vscode-terminalOverviewRuler-findMatchForeground: rgba(209, 134, 22, .49);--vscode-terminal-dropBackground: rgba(83, 89, 93, .5);--vscode-testing-iconFailed: #f14c4c;--vscode-testing-iconErrored: #f14c4c;--vscode-testing-iconPassed: #73c991;--vscode-testing-runAction: #73c991;--vscode-testing-iconQueued: #cca700;--vscode-testing-iconUnset: #848484;--vscode-testing-iconSkipped: #848484;--vscode-testing-peekBorder: #f14c4c;--vscode-testing-peekHeaderBackground: rgba(241, 76, 76, .1);--vscode-testing-message\.error\.decorationForeground: #f14c4c;--vscode-testing-message\.error\.lineBackground: rgba(255, 0, 0, .2);--vscode-testing-message\.info\.decorationForeground: rgba(212, 212, 212, .5);--vscode-welcomePage-tileBackground: #252526;--vscode-welcomePage-tileHoverBackground: #2c2c2d;--vscode-welcomePage-tileShadow: rgba(0, 0, 0, .36);--vscode-welcomePage-progress\.background: #3c3c3c;--vscode-welcomePage-progress\.foreground: #3794ff;--vscode-debugExceptionWidget-border: #a31515;--vscode-debugExceptionWidget-background: #420b0d;--vscode-ports-iconRunningProcessForeground: #369432;--vscode-statusBar-debuggingBackground: #cc6633;--vscode-statusBar-debuggingForeground: #ffffff;--vscode-editor-inlineValuesForeground: rgba(255, 255, 255, .5);--vscode-editor-inlineValuesBackground: rgba(255, 200, 0, .2);--vscode-editorGutter-modifiedBackground: #1b81a8;--vscode-editorGutter-addedBackground: #487e02;--vscode-editorGutter-deletedBackground: #f14c4c;--vscode-minimapGutter-modifiedBackground: #1b81a8;--vscode-minimapGutter-addedBackground: #487e02;--vscode-minimapGutter-deletedBackground: #f14c4c;--vscode-editorOverviewRuler-modifiedForeground: rgba(27, 129, 168, .6);--vscode-editorOverviewRuler-addedForeground: rgba(72, 126, 2, .6);--vscode-editorOverviewRuler-deletedForeground: rgba(241, 76, 76, .6);--vscode-debugIcon-breakpointForeground: #e51400;--vscode-debugIcon-breakpointDisabledForeground: #848484;--vscode-debugIcon-breakpointUnverifiedForeground: #848484;--vscode-debugIcon-breakpointCurrentStackframeForeground: #ffcc00;--vscode-debugIcon-breakpointStackframeForeground: #89d185;--vscode-notebook-cellBorderColor: #37373d;--vscode-notebook-focusedEditorBorder: #007fd4;--vscode-notebookStatusSuccessIcon-foreground: #89d185;--vscode-notebookStatusErrorIcon-foreground: #f48771;--vscode-notebookStatusRunningIcon-foreground: #cccccc;--vscode-notebook-cellToolbarSeparator: rgba(128, 128, 128, .35);--vscode-notebook-selectedCellBackground: #37373d;--vscode-notebook-selectedCellBorder: #37373d;--vscode-notebook-focusedCellBorder: #007fd4;--vscode-notebook-inactiveFocusedCellBorder: #37373d;--vscode-notebook-cellStatusBarItemHoverBackground: rgba(255, 255, 255, .15);--vscode-notebook-cellInsertionIndicator: #007fd4;--vscode-notebookScrollbarSlider-background: rgba(121, 121, 121, .4);--vscode-notebookScrollbarSlider-hoverBackground: rgba(100, 100, 100, .7);--vscode-notebookScrollbarSlider-activeBackground: rgba(191, 191, 191, .4);--vscode-notebook-symbolHighlightBackground: rgba(255, 255, 255, .04);--vscode-notebook-cellEditorBackground: #252526;--vscode-notebook-editorBackground: #1e1e1e;--vscode-keybindingTable-headerBackground: rgba(204, 204, 204, .04);--vscode-keybindingTable-rowsBackground: rgba(204, 204, 204, .04);--vscode-scm-providerBorder: #454545;--vscode-debugTokenExpression-name: #c586c0;--vscode-debugTokenExpression-value: rgba(204, 204, 204, .6);--vscode-debugTokenExpression-string: #ce9178;--vscode-debugTokenExpression-boolean: #4e94ce;--vscode-debugTokenExpression-number: #b5cea8;--vscode-debugTokenExpression-error: #f48771;--vscode-debugView-exceptionLabelForeground: #cccccc;--vscode-debugView-exceptionLabelBackground: #6c2022;--vscode-debugView-stateLabelForeground: #cccccc;--vscode-debugView-stateLabelBackground: rgba(136, 136, 136, .27);--vscode-debugView-valueChangedHighlight: #569cd6;--vscode-debugConsole-infoForeground: #3794ff;--vscode-debugConsole-warningForeground: #cca700;--vscode-debugConsole-errorForeground: #f48771;--vscode-debugConsole-sourceForeground: #cccccc;--vscode-debugConsoleInputIcon-foreground: #cccccc;--vscode-debugIcon-pauseForeground: #75beff;--vscode-debugIcon-stopForeground: #f48771;--vscode-debugIcon-disconnectForeground: #f48771;--vscode-debugIcon-restartForeground: #89d185;--vscode-debugIcon-stepOverForeground: #75beff;--vscode-debugIcon-stepIntoForeground: #75beff;--vscode-debugIcon-stepOutForeground: #75beff;--vscode-debugIcon-continueForeground: #75beff;--vscode-debugIcon-stepBackForeground: #75beff;--vscode-extensionButton-prominentBackground: #0e639c;--vscode-extensionButton-prominentForeground: #ffffff;--vscode-extensionButton-prominentHoverBackground: #1177bb;--vscode-extensionIcon-starForeground: #ff8e00;--vscode-extensionIcon-verifiedForeground: #3794ff;--vscode-extensionIcon-preReleaseForeground: #1d9271;--vscode-extensionIcon-sponsorForeground: #d758b3;--vscode-terminal-ansiBlack: #000000;--vscode-terminal-ansiRed: #cd3131;--vscode-terminal-ansiGreen: #0dbc79;--vscode-terminal-ansiYellow: #e5e510;--vscode-terminal-ansiBlue: #2472c8;--vscode-terminal-ansiMagenta: #bc3fbc;--vscode-terminal-ansiCyan: #11a8cd;--vscode-terminal-ansiWhite: #e5e5e5;--vscode-terminal-ansiBrightBlack: #666666;--vscode-terminal-ansiBrightRed: #f14c4c;--vscode-terminal-ansiBrightGreen: #23d18b;--vscode-terminal-ansiBrightYellow: #f5f543;--vscode-terminal-ansiBrightBlue: #3b8eea;--vscode-terminal-ansiBrightMagenta: #d670d6;--vscode-terminal-ansiBrightCyan: #29b8db;--vscode-terminal-ansiBrightWhite: #e5e5e5;--vscode-interactive-activeCodeBorder: #3794ff;--vscode-interactive-inactiveCodeBorder: #37373d;--vscode-gitDecoration-addedResourceForeground: #81b88b;--vscode-gitDecoration-modifiedResourceForeground: #e2c08d;--vscode-gitDecoration-deletedResourceForeground: #c74e39;--vscode-gitDecoration-renamedResourceForeground: #73c991;--vscode-gitDecoration-untrackedResourceForeground: #73c991;--vscode-gitDecoration-ignoredResourceForeground: #8c8c8c;--vscode-gitDecoration-stageModifiedResourceForeground: #e2c08d;--vscode-gitDecoration-stageDeletedResourceForeground: #c74e39;--vscode-gitDecoration-conflictingResourceForeground: #e4676b;--vscode-gitDecoration-submoduleResourceForeground: #8db9e2}.test-error-container{position:relative;white-space:pre;flex:none;padding:0;background-color:var(--color-canvas-subtle);border-radius:6px;line-height:initial;margin-bottom:6px}.test-error-view{overflow:auto;padding:16px}.test-error-text{font-family:monospace}.test-result{flex:auto;display:flex;flex-direction:column;margin-bottom:24px}.test-result>div{flex:none}.test-result video,.test-result img.screenshot{flex:none;box-shadow:var(--box-shadow-thick);margin:24px auto;min-width:200px;max-width:80%}.test-result-path{padding:0 0 0 5px;color:var(--color-fg-muted)}.test-result-counter{border-radius:12px;color:var(--color-canvas-default);padding:2px 8px}@media (prefers-color-scheme: light){.test-result-counter{background:var(--color-scale-gray-5)}}@media (prefers-color-scheme: dark){.test-result-counter{background:var(--color-scale-gray-3)}}@media only screen and (max-width: 600px){.test-result{padding:0!important}}.test-file-test{line-height:32px;align-items:center;padding:2px 10px;overflow:hidden;text-overflow:ellipsis}.test-file-test:hover{background-color:var(--color-canvas-subtle)}.test-file-title{font-weight:600;font-size:16px}.test-file-details-row{padding:0 0 6px 8px;margin:0 0 0 15px;line-height:16px;font-weight:400;color:var(--color-fg-subtle);display:flex;align-items:center}.test-file-path{text-overflow:ellipsis;overflow:hidden;color:var(--color-fg-subtle)}.test-file-path-link{margin-right:10px}.test-file-badge{flex:none;background-color:transparent;border-color:transparent}.test-file-badge span{color:var(--color-fg-subtle)}.test-file-badge:hover{cursor:pointer}.test-file-badge svg{fill:var(--color-fg-subtle)}.test-file-badge:hover svg{fill:var(--color-fg-muted)}.test-file-test-outcome-skipped{color:var(--color-fg-muted)}.test-file-test-status-icon{flex:none}.test-file-header-info{display:flex;align-items:center;gap:8px;color:var(--color-fg-subtle)}#root{color:var(--color-fg-default);font-size:14px;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji";-webkit-font-smoothing:antialiased}.metadata-toggle{cursor:pointer;-webkit-user-select:none;user-select:none;margin-left:5px;color:var(--color-fg-default)}.metadata-view{border:1px solid var(--color-border-default);border-radius:6px;margin-top:8px}.metadata-view .metadata-section{margin:8px 10px 8px 32px}.metadata-view span:not(.copy-button-container),.metadata-view a{display:inline-block;line-height:24px}.metadata-properties{display:flex;flex-direction:column;align-items:normal;gap:8px}.metadata-properties>div{height:24px}.metadata-separator{height:1px;border-bottom:1px solid var(--color-border-default)}.metadata-view a{color:var(--color-fg-default)}.copyable-property{white-space:pre}.copyable-property>span{display:flex;align-items:center}
</style>
  </head>
  <body>
    <div id='root'></div>
  </body>
</html>
<script>
window.playwrightReportBase64 = "data:application/zip;base64,UEsDBBQAAAgIAPdamFp1Je7ctAAAAPAAAAALAAAAcmVwb3J0Lmpzb25Vjj1vgzAURf+KdWcLOV9QvHft0m5Vhld4RA4Yo+dH0wrx3yuiZOh2zhmu7oLISi0pwS+rRVYS/QiR4XfV8XR8KU91WVeVRTsLaUgj/MG5fV2Uu9qiCwNn+M+zxSTpyo2+UXyWrKQZfoEmpQHeWfDPxI1ye5d5/KfdQP3vnXIfpulRUw+vMvNqwSJJtm28buTN9rM1aVZzo6BhvJiDc87FbDpJ0TRp7MKluPHXO8s3S4Hz+gdQSwECPwMUAAAICAD3WphadSXu3LQAAADwAAAACwAAAAAAAAAAAAAAtIEAAAAAcmVwb3J0Lmpzb25QSwUGAAAAAAEAAQA5AAAA3QAAAAAA";</script>



================================================
File: src/env.d.ts
================================================
/// <reference types="astro/client" />
/// <reference types="vite/client" />

// Dodanie typów dla testów
import "@testing-library/jest-dom";

import type { SupabaseClient } from "@supabase/supabase-js";
import type { Database } from "./db/database.types";
import type { UserDTO } from "./types";

declare global {
  namespace App {
    interface Locals {
      supabase: SupabaseClient<Database>;
      user: import("@supabase/supabase-js").User | null;
      authUser: UserDTO | null;
      isAuthenticated: boolean;
    }
  }
}

interface ImportMetaEnv {
  readonly SUPABASE_URL: string;
  readonly SUPABASE_KEY: string;
  readonly SUPABASE_SERVICE_ROLE_KEY: string;
  readonly OPENROUTER_API_KEY: string;
  readonly PUBLIC_SUPABASE_URL: string;
  readonly PUBLIC_SUPABASE_ANON_KEY: string;
  // more env variables...
}

interface ImportMeta {
  readonly env: ImportMetaEnv;
}

export {};



================================================
File: src/types.ts
================================================
// Entity Types - derived from Database schema
import type { Database } from "./db/database.types";

// Base entity types from database schema
export type User = Database["public"]["Tables"]["users"]["Row"];
export type ShoppingList = Database["public"]["Tables"]["shopping_lists"]["Row"];
export type ShoppingListItem = Database["public"]["Tables"]["shopping_list_items"]["Row"];

// Common utility types

export interface PaginationResponse {
  totalItems: number;
  totalPages: number;
  currentPage: number;
  pageSize: number;
}

// Authentication DTOs and Command Models

export interface RegisterUserRequest {
  email: string;
  password: string;
}

export interface RegisterUserResponse {
  id: string;
  email: string;
  registrationDate: string;
  token: string;
}

export interface LoginUserRequest {
  email: string;
  password: string;
  rememberMe?: boolean;
}

export interface LoginUserResponse {
  id: string;
  email: string;
  token: string;
}

// User DTOs and Command Models

export interface UserDTO {
  id: string;
  email: string;
  registrationDate: string;
  lastLoginDate: string | null;
  isAdmin: boolean;
}

export interface GetAllUsersResponse {
  data: UserDTO[];
  pagination: PaginationResponse;
}

export type GetUserByIdResponse = UserDTO;

export interface UpdateUserRequest {
  email?: string;
  password?: string;
}

export interface UpdateUserResponse {
  id: string;
  email: string;
  updatedDate: string;
}

// Shopping List DTOs and Command Models

export interface ShoppingListSummaryDTO {
  id: string;
  title: string;
  createdAt: string;
  updatedAt: string;
  itemCount: number;
}

export interface GetAllShoppingListsResponse {
  data: ShoppingListSummaryDTO[];
  pagination: PaginationResponse;
}

export interface ShoppingListItemDTO {
  id: string;
  itemName: string;
  purchased: boolean;
  createdAt: string;
  updatedAt: string;
}

export interface GetShoppingListByIdResponse {
  id: string;
  title: string;
  createdAt: string;
  updatedAt: string;
  items: ShoppingListItemDTO[];
}

export interface CreateShoppingListRequest {
  title: string;
}

export interface CreateShoppingListResponse {
  id: string;
  title: string;
  createdAt: string;
  updatedAt: string;
}

export interface UpdateShoppingListRequest {
  title: string;
}

export interface UpdateShoppingListResponse {
  id: string;
  title: string;
  updatedAt: string;
}

// Shopping List Item DTOs and Command Models

export interface GetAllItemsInShoppingListResponse {
  data: ShoppingListItemDTO[];
}

export type GetShoppingListItemByIdResponse = ShoppingListItemDTO;

export interface AddItemToShoppingListRequest {
  itemName: string;
  purchased?: boolean;
}

export type AddItemToShoppingListResponse = ShoppingListItemDTO;

export interface UpdateShoppingListItemRequest {
  itemName?: string;
  purchased?: boolean;
}

export interface UpdateShoppingListItemResponse {
  id: string;
  itemName: string;
  purchased: boolean;
  updatedAt: string;
}

export interface BulkUpdateItemRequest {
  id: string;
  purchased: boolean;
}

export interface BulkUpdateItemsRequest {
  items: BulkUpdateItemRequest[];
}

export interface BulkUpdateItemsResponse {
  updatedCount: number;
  updatedAt: string;
}

export interface ShoppingListDetailResponse {
  id: string;
  title: string;
  createdAt: string;
  updatedAt: string;
  items: ShoppingListItemDTO[];
}



================================================
File: src/__mocks__/astro-middleware.ts
================================================
// Mock dla modułu astro:middleware
import type { APIContext } from "astro";

export type MiddlewareHandler = (context: APIContext, next: () => Promise<Response>) => Promise<Response>;

export type MiddlewareResponseHandler = (response: Response, context: APIContext) => Promise<Response>;

export function defineMiddleware(handler: MiddlewareHandler): MiddlewareHandler {
  return handler;
}

export function sequence(...handlers: MiddlewareHandler[]): MiddlewareHandler {
  return async (context: APIContext, next: () => Promise<Response>) => {
    let index = -1;

    async function runNextHandler(): Promise<Response> {
      index++;
      if (index < handlers.length) {
        return handlers[index](context, runNextHandler);
      }
      return next();
    }

    return runNextHandler();
  };
}



================================================
File: src/__mocks__/handlers.ts
================================================
import { http, HttpResponse } from "msw";

// Define handlers array to store all API mocks
export const handlers = [
  // Example handler for shopping list creation
  http.post("/api/shopping-lists", () => {
    return HttpResponse.json({ id: "new-list-id" });
  }),

  // Example handler for shopping list error
  http.post("/api/shopping-lists/error", () => {
    return new HttpResponse(null, {
      status: 500,
      statusText: "Server error",
    });
  }),

  // Auth handlers
  http.get("/api/users/me", () => {
    return HttpResponse.json({
      id: "test-user-id",
      email: "test@example.com",
      registrationDate: "2024-01-01T00:00:00Z",
      lastLoginDate: "2024-04-01T00:00:00Z",
      isAdmin: false,
    });
  }),

  http.post("/api/auth/logout", () => {
    return HttpResponse.json({ success: true });
  }),

  http.post("/api/auth/login", () => {
    return HttpResponse.json({
      success: true,
      user: {
        id: "test-user-id",
        email: "test@example.com",
      },
    });
  }),

  http.post("/api/auth/register", () => {
    return HttpResponse.json({
      success: true,
      user: {
        id: "new-user-id",
        email: "new@example.com",
      },
    });
  }),

  // Add more handlers as needed for other API endpoints
];



================================================
File: src/__mocks__/server.ts
================================================
import { setupServer } from "msw/node";
import { handlers } from "./handlers";

// This configures a request mocking server with the given request handlers.
export const server = setupServer(...handlers);



================================================
File: src/__mocks__/@supabase/supabase-js.ts
================================================
import { type User, type Session } from "@supabase/supabase-js";

// Mock dla klienta Supabase
export const createClient = () => ({
  auth: {
    getSession: jest.fn(),
    getUser: jest.fn(),
    signInWithPassword: jest.fn(),
    signOut: jest.fn(),
    onAuthStateChange: jest.fn(),
  },
  from: (table: string) => ({
    select: jest.fn().mockReturnThis(),
    insert: jest.fn().mockReturnThis(),
    update: jest.fn().mockReturnThis(),
    delete: jest.fn().mockReturnThis(),
    eq: jest.fn().mockReturnThis(),
    single: jest.fn(),
  }),
});

// Eksportujemy typy, które są używane w testach
export type { User, Session };



================================================
File: src/__tests__/setup.ts
================================================
import "@testing-library/jest-dom";
import { expect, vi, beforeAll, afterEach, afterAll } from "vitest";
import * as matchers from "@testing-library/jest-dom/matchers";
import type { TestingLibraryMatchers } from "@testing-library/jest-dom/matchers";
import { setupServer } from "msw/node";
import { handlers } from "../__mocks__/handlers";

// Ustawienie zmiennych środowiskowych dla testów
process.env.SUPABASE_URL = "https://example.supabase.co";
process.env.SUPABASE_ANON_KEY = "test-anon-key";
process.env.PUBLIC_SUPABASE_URL = "https://example.supabase.co";
process.env.PUBLIC_SUPABASE_ANON_KEY = "test-anon-key";

declare module "vitest" {
  interface Assertion<T> extends jest.Matchers<void, T>, TestingLibraryMatchers<T, void> {}
}

// Rozszerzenie matcherów Vitest o matchery testing-library
expect.extend(matchers);

// Konfiguracja dla testów
Object.defineProperty(window, "matchMedia", {
  writable: true,
  value: vi.fn().mockImplementation((query) => ({
    matches: false,
    media: query,
    onchange: null,
    addListener: vi.fn(),
    removeListener: vi.fn(),
    addEventListener: vi.fn(),
    removeEventListener: vi.fn(),
    dispatchEvent: vi.fn(),
  })),
});

// Mock localStorage
const localStorageMock = {
  getItem: vi.fn(),
  setItem: vi.fn(),
  removeItem: vi.fn(),
  clear: vi.fn(),
};
Object.defineProperty(window, "localStorage", { value: localStorageMock });

// Mock sessionStorage
const sessionStorageMock = {
  getItem: vi.fn(),
  setItem: vi.fn(),
  removeItem: vi.fn(),
  clear: vi.fn(),
};
Object.defineProperty(window, "sessionStorage", { value: sessionStorageMock });

// Mock fetch
const fetchMock = vi.fn();
global.fetch = fetchMock;

// Usuwamy niepoprawny mock @testing-library/react
// Vitest automatycznie zaimportuje rzeczywistą bibliotekę bez naszej ingerencji

// Setup MSW server
export const server = setupServer(...handlers);

// Setup
beforeAll(() => {
  server.listen({ onUnhandledRequest: "warn" });
});

// Reset handlers and cleanup after each test
afterEach(() => {
  server.resetHandlers();
  // import { cleanup } from "@testing-library/react";
  // cleanup();
  vi.clearAllMocks();
});

// Clean up after all tests
afterAll(() => {
  server.close();
});



================================================
File: src/__tests__/setupTests.ts
================================================
import { afterAll, afterEach, beforeAll } from "vitest";
import { cleanup } from "@testing-library/react";
import "@testing-library/jest-dom";
import { server } from "../__mocks__/server";

// Establish API mocking before all tests.
beforeAll(() => server.listen({ onUnhandledRequest: "error" }));

// Reset any request handlers that we may add during the tests,
// so they don't affect other tests.
afterEach(() => {
  cleanup();
  server.resetHandlers();
});

// Clean up after the tests are finished.
afterAll(() => server.close());



================================================
File: src/__tests__/e2e/shopping-lists.spec.ts
================================================
import { test, expect } from "@playwright/test";
import { loginUser } from "../helpers/auth";

test.describe("Lista zakupów - podstawowe operacje", () => {
  test.beforeEach(async ({ page }) => {
    // Logowanie użytkownika przed każdym testem
    await loginUser(page);
  });

  test("powinien wyświetlić pusty stan gdy nie ma list", async ({ page }) => {
    await page.goto("/lists");

    // Sprawdzenie czy wyświetla się komunikat o braku list
    const emptyState = page.getByText("Nie masz jeszcze żadnych list zakupów");
    await expect(emptyState).toBeVisible();

    // Sprawdzenie czy przycisk tworzenia nowej listy jest widoczny
    const createButton = page.getByRole("button", { name: "Nowa lista" });
    await expect(createButton).toBeVisible();
  });

  test("powinien utworzyć nową listę zakupów", async ({ page }) => {
    await page.goto("/lists");

    // Kliknięcie przycisku tworzenia nowej listy
    await page.getByRole("button", { name: "Nowa lista" }).click();

    // Oczekiwanie na pojawienie się nowej listy
    const newList = page.getByRole("article").filter({ hasText: new Date().toLocaleDateString("pl-PL") });
    await expect(newList).toBeVisible();

    // Sprawdzenie czy wyświetla się toast z potwierdzeniem
    const toast = page.getByText("Lista zakupów została utworzona");
    await expect(toast).toBeVisible();

    // Zrzut ekranu po utworzeniu listy
    await expect(page).toHaveScreenshot("new-list-created.png");
  });

  test("powinien obsłużyć błędy sieciowe", async ({ page }) => {
    // Symulacja braku połączenia z internetem
    await page.route("**/api/shopping-lists/**", (route) => {
      route.abort();
    });

    await page.goto("/lists");

    // Próba utworzenia nowej listy
    await page.getByRole("button", { name: "Nowa lista" }).click();

    // Sprawdzenie czy wyświetla się komunikat o błędzie
    const errorToast = page.getByText("Nie udało się utworzyć listy zakupów");
    await expect(errorToast).toBeVisible();

    // Zrzut ekranu błędu
    await expect(page).toHaveScreenshot("network-error.png");
  });
});




================================================
File: src/__tests__/helpers/auth.ts
================================================
import type { Page } from "@playwright/test";

/**
 * Loguje użytkownika testowego do aplikacji
 * @param page - Instancja strony Playwright
 */
export async function loginUser(page: Page): Promise<void> {
  // Przejście do strony logowania
  await page.goto("/login");

  // Wypełnienie formularza logowania
  await page.getByLabel("Email").fill("test@example.com");
  await page.getByLabel("Hasło").fill("test123");

  // Kliknięcie przycisku logowania
  await page.getByRole("button", { name: "Zaloguj się" }).click();

  // Oczekiwanie na przekierowanie po zalogowaniu
  await page.waitForURL("/lists");
}

/**
 * Wylogowuje użytkownika z aplikacji
 * @param page - Instancja strony Playwright
 */
export async function logoutUser(page: Page): Promise<void> {
  // Kliknięcie przycisku wylogowania
  await page.getByRole("button", { name: "Wyloguj" }).click();

  // Oczekiwanie na przekierowanie po wylogowaniu
  await page.waitForURL("/login");
}

/**
 * Tworzy nowego użytkownika testowego
 * @param page - Instancja strony Playwright
 */
export async function createTestUser(page: Page): Promise<void> {
  // Przejście do strony rejestracji
  await page.goto("/register");

  // Wypełnienie formularza rejestracji
  await page.getByLabel("Email").fill("test@example.com");
  await page.getByLabel("Hasło").fill("test123");
  await page.getByLabel("Powtórz hasło").fill("test123");

  // Kliknięcie przycisku rejestracji
  await page.getByRole("button", { name: "Zarejestruj się" }).click();

  // Oczekiwanie na przekierowanie po rejestracji
  await page.waitForURL("/lists");
}

/**
 * Usuwa użytkownika testowego
 * @param page - Instancja strony Playwright
 */
export async function deleteTestUser(page: Page): Promise<void> {
  // Przejście do ustawień konta
  await page.goto("/settings");

  // Kliknięcie przycisku usuwania konta
  await page.getByRole("button", { name: "Usuń konto" }).click();

  // Potwierdzenie usunięcia konta
  await page.getByRole("button", { name: "Tak, usuń konto" }).click();

  // Oczekiwanie na przekierowanie po usunięciu konta
  await page.waitForURL("/login");
}





================================================
File: src/__tests__/unit/api/auth.test.ts
================================================
import { describe, it, expect, vi, beforeEach } from "vitest";
import { server } from "../../setup";
import { http } from "msw";

// Mock Supabase client
vi.mock("@supabase/supabase-js", () => ({
  createClient: vi.fn(() => ({
    auth: {
      signUp: vi.fn(),
      signInWithPassword: vi.fn(),
      signOut: vi.fn(),
      resetPasswordForEmail: vi.fn(),
    },
  })),
}));

describe("Auth API Endpoints", () => {
  beforeEach(() => {
    vi.clearAllMocks();
  });

  describe("POST /api/auth/register", () => {
    const validRegistration = {
      email: "test@example.com",
      password: "Test123!@#",
      confirmPassword: "Test123!@#",
    };

    it("should register a new user with valid credentials", async () => {
      server.use(
        http.post("/api/auth/register", () => {
          return Response.json(
            {
              message: "Rejestracja zakończona sukcesem",
              user: { email: validRegistration.email },
            },
            { status: 201 }
          );
        })
      );

      const response = await fetch("/api/auth/register", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(validRegistration),
      });

      expect(response.status).toBe(201);
      const data = await response.json();
      expect(data.message).toBe("Rejestracja zakończona sukcesem");
      expect(data.user.email).toBe(validRegistration.email);
    });

    it("should return 400 for invalid registration data", async () => {
      const invalidRegistration = {
        email: "invalid-email",
        password: "short",
        confirmPassword: "different",
      };

      server.use(
        http.post("/api/auth/register", () => {
          return Response.json(
            {
              error: "Nieprawidłowe dane rejestracji",
              details: {
                email: ["Nieprawidłowy format email"],
                password: ["Hasło musi mieć minimum 8 znaków"],
                confirmPassword: ["Hasła nie są identyczne"],
              },
            },
            { status: 400 }
          );
        })
      );

      const response = await fetch("/api/auth/register", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(invalidRegistration),
      });

      expect(response.status).toBe(400);
      const data = await response.json();
      expect(data.error).toBe("Nieprawidłowe dane rejestracji");
      expect(data.details).toBeDefined();
    });
  });

  describe("POST /api/auth/login", () => {
    const validCredentials = {
      email: "test@example.com",
      password: "Test123!@#",
    };

    it("should login user with valid credentials", async () => {
      server.use(
        http.post("/api/auth/login", () => {
          return Response.json(
            {
              message: "Logowanie zakończone sukcesem",
              user: { email: validCredentials.email },
            },
            { status: 200 }
          );
        })
      );

      const response = await fetch("/api/auth/login", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(validCredentials),
      });

      expect(response.status).toBe(200);
      const data = await response.json();
      expect(data.message).toBe("Logowanie zakończone sukcesem");
      expect(data.user.email).toBe(validCredentials.email);
    });

    it("should return 401 for invalid credentials", async () => {
      const invalidCredentials = {
        email: "test@example.com",
        password: "wrongpassword",
      };

      server.use(
        http.post("/api/auth/login", () => {
          return Response.json(
            {
              error: "Nieprawidłowy email lub hasło",
            },
            { status: 401 }
          );
        })
      );

      const response = await fetch("/api/auth/login", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(invalidCredentials),
      });

      expect(response.status).toBe(401);
      const data = await response.json();
      expect(data.error).toBe("Nieprawidłowy email lub hasło");
    });
  });

  describe("POST /api/auth/logout", () => {
    it("should successfully logout user", async () => {
      server.use(
        http.post("/api/auth/logout", () => {
          return Response.json(
            {
              message: "Wylogowano pomyślnie",
            },
            { status: 200 }
          );
        })
      );

      const response = await fetch("/api/auth/logout", {
        method: "POST",
      });

      expect(response.status).toBe(200);
      const data = await response.json();
      expect(data.message).toBe("Wylogowano pomyślnie");
    });
  });

  describe("POST /api/auth/request-reset", () => {
    it("should send password reset email for valid address", async () => {
      const email = "test@example.com";

      server.use(
        http.post("/api/auth/request-reset", () => {
          return Response.json(
            {
              message: "Link do resetowania hasła został wysłany",
            },
            { status: 200 }
          );
        })
      );

      const response = await fetch("/api/auth/request-reset", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({ email }),
      });

      expect(response.status).toBe(200);
      const data = await response.json();
      expect(data.message).toBe("Link do resetowania hasła został wysłany");
    });

    it("should return 400 for invalid email", async () => {
      const invalidEmail = "invalid-email";

      server.use(
        http.post("/api/auth/request-reset", () => {
          return Response.json(
            {
              error: "Nieprawidłowy format adresu email",
            },
            { status: 400 }
          );
        })
      );

      const response = await fetch("/api/auth/request-reset", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({ email: invalidEmail }),
      });

      expect(response.status).toBe(400);
      const data = await response.json();
      expect(data.error).toBe("Nieprawidłowy format adresu email");
    });
  });
});



================================================
File: src/__tests__/unit/api/shopping-lists.test.ts
================================================
import { describe, it, expect, vi, beforeEach } from "vitest";
import { server } from "../../setup";
import { http } from "msw";

// Mock Supabase client
vi.mock("@supabase/supabase-js", () => ({
  createClient: vi.fn(() => ({
    auth: {
      getUser: vi.fn(),
    },
    from: vi.fn(() => ({
      select: vi.fn(),
      insert: vi.fn(),
      update: vi.fn(),
      delete: vi.fn(),
    })),
  })),
}));

// Mock logger
vi.mock("@/lib/logger", () => ({
  logger: {
    info: vi.fn(),
    warn: vi.fn(),
    error: vi.fn(),
    debug: vi.fn(),
  },
}));

describe("Shopping Lists API Endpoints", () => {
  const mockUser = {
    id: "test-user-id",
    email: "test@example.com",
  };

  const mockList = {
    id: "test-list-id",
    title: "Test Shopping List",
    user_id: mockUser.id,
    created_at: new Date().toISOString(),
    updated_at: new Date().toISOString(),
  };

  beforeEach(() => {
    // Reset all mocks before each test
    vi.clearAllMocks();
  });

  describe("GET /api/shopping-lists", () => {
    it("should return 401 when user is not authenticated", async () => {
      server.use(
        http.get("/api/shopping-lists", async ({ request }) => {
          const response = await fetch(request.url, {
            headers: { ...request.headers },
          });
          expect(response.status).toBe(401);
          const data = await response.json();
          expect(data.error).toBe("Wymagane uwierzytelnienie");
          return Response.json({ error: "Wymagane uwierzytelnienie" }, { status: 401 });
        })
      );
    });

    it("should return shopping lists for authenticated user", async () => {
      const mockLists = {
        data: [mockList],
        pagination: {
          page: 1,
          pageSize: 10,
          totalItems: 1,
          totalPages: 1,
        },
      };

      server.use(
        http.get("/api/shopping-lists", () => {
          return Response.json(mockLists, { status: 200 });
        })
      );

      const response = await fetch("/api/shopping-lists", {
        headers: {
          Authorization: "Bearer test-token",
        },
      });

      expect(response.status).toBe(200);
      const data = await response.json();
      expect(data).toEqual(mockLists);
    });
  });

  describe("POST /api/shopping-lists", () => {
    const newList = {
      title: "New Shopping List",
    };

    it("should return 401 when user is not authenticated", async () => {
      server.use(
        http.post("/api/shopping-lists", async ({ request }) => {
          const response = await fetch(request.url, {
            method: "POST",
            headers: { ...request.headers },
            body: JSON.stringify(newList),
          });
          expect(response.status).toBe(401);
          return Response.json({ error: "Wymagane uwierzytelnienie" }, { status: 401 });
        })
      );
    });

    it("should create a new shopping list for authenticated user", async () => {
      const mockCreatedList = {
        ...mockList,
        ...newList,
      };

      server.use(
        http.post("/api/shopping-lists", () => {
          return Response.json(mockCreatedList, { status: 201 });
        })
      );

      const response = await fetch("/api/shopping-lists", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          Authorization: "Bearer test-token",
        },
        body: JSON.stringify(newList),
      });

      expect(response.status).toBe(201);
      const data = await response.json();
      expect(data).toEqual(mockCreatedList);
    });

    it("should return 400 for invalid input", async () => {
      const invalidList = {
        // Missing required title
      };

      server.use(
        http.post("/api/shopping-lists", () => {
          return Response.json(
            {
              error: "Nieprawidłowe dane wejściowe",
              details: { title: ["Required"] },
            },
            { status: 400 }
          );
        })
      );

      const response = await fetch("/api/shopping-lists", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          Authorization: "Bearer test-token",
        },
        body: JSON.stringify(invalidList),
      });

      expect(response.status).toBe(400);
      const data = await response.json();
      expect(data.error).toBe("Nieprawidłowe dane wejściowe");
      expect(data.details).toBeDefined();
    });
  });

  describe("GET /api/shopping-lists/:id", () => {
    it("should return 404 for non-existent list", async () => {
      server.use(
        http.get("/api/shopping-lists/non-existent", () => {
          return Response.json({ error: "Shopping list not found" }, { status: 404 });
        })
      );

      const response = await fetch("/api/shopping-lists/non-existent", {
        headers: {
          Authorization: "Bearer test-token",
        },
      });

      expect(response.status).toBe(404);
      const data = await response.json();
      expect(data.error).toBe("Shopping list not found");
    });

    it("should return list details for valid ID", async () => {
      server.use(
        http.get(`/api/shopping-lists/${mockList.id}`, () => {
          return Response.json(mockList, { status: 200 });
        })
      );

      const response = await fetch(`/api/shopping-lists/${mockList.id}`, {
        headers: {
          Authorization: "Bearer test-token",
        },
      });

      expect(response.status).toBe(200);
      const data = await response.json();
      expect(data).toEqual(mockList);
    });
  });

  describe("PUT /api/shopping-lists/:id", () => {
    const updates = {
      title: "Updated Shopping List",
    };

    it("should update list for valid ID", async () => {
      const mockUpdatedList = {
        ...mockList,
        ...updates,
        updated_at: new Date().toISOString(),
      };

      server.use(
        http.put(`/api/shopping-lists/${mockList.id}`, () => {
          return Response.json(mockUpdatedList, { status: 200 });
        })
      );

      const response = await fetch(`/api/shopping-lists/${mockList.id}`, {
        method: "PUT",
        headers: {
          "Content-Type": "application/json",
          Authorization: "Bearer test-token",
        },
        body: JSON.stringify(updates),
      });

      expect(response.status).toBe(200);
      const data = await response.json();
      expect(data).toEqual(mockUpdatedList);
    });
  });

  describe("DELETE /api/shopping-lists/:id", () => {
    it("should delete list for valid ID", async () => {
      server.use(
        http.delete(`/api/shopping-lists/${mockList.id}`, () => {
          return new Response(null, { status: 204 });
        })
      );

      const response = await fetch(`/api/shopping-lists/${mockList.id}`, {
        method: "DELETE",
        headers: {
          Authorization: "Bearer test-token",
        },
      });

      expect(response.status).toBe(204);
    });
  });
});



================================================
File: src/__tests__/unit/api/users.test.ts
================================================
import { describe, it, expect, vi, beforeEach } from "vitest";
import { server } from "../../setup";
import { http } from "msw";

// Mock Supabase client
vi.mock("@supabase/supabase-js", () => ({
  createClient: vi.fn(() => ({
    auth: {
      getUser: vi.fn(),
    },
    from: vi.fn(() => ({
      select: vi.fn(),
      update: vi.fn(),
      delete: vi.fn(),
    })),
  })),
}));

describe("Users API Endpoints", () => {
  const mockUser = {
    id: "test-user-id",
    email: "test@example.com",
    created_at: new Date().toISOString(),
    updated_at: new Date().toISOString(),
  };

  beforeEach(() => {
    vi.clearAllMocks();
  });

  describe("GET /api/users/me", () => {
    it("should return user data for authenticated user", async () => {
      server.use(
        http.get("/api/users/me", () => {
          return Response.json(mockUser, { status: 200 });
        })
      );

      const response = await fetch("/api/users/me", {
        headers: {
          Authorization: "Bearer test-token",
        },
      });

      expect(response.status).toBe(200);
      const data = await response.json();
      expect(data).toEqual(mockUser);
    });

    it("should return 401 when not authenticated", async () => {
      server.use(
        http.get("/api/users/me", () => {
          return Response.json(
            {
              error: "Brak autoryzacji",
            },
            { status: 401 }
          );
        })
      );

      const response = await fetch("/api/users/me");
      expect(response.status).toBe(401);
      const data = await response.json();
      expect(data.error).toBe("Brak autoryzacji");
    });
  });

  describe("GET /api/users/:id", () => {
    it("should return user data for valid ID", async () => {
      server.use(
        http.get(`/api/users/${mockUser.id}`, () => {
          return Response.json(mockUser, { status: 200 });
        })
      );

      const response = await fetch(`/api/users/${mockUser.id}`, {
        headers: {
          Authorization: "Bearer test-token",
        },
      });

      expect(response.status).toBe(200);
      const data = await response.json();
      expect(data).toEqual(mockUser);
    });

    it("should return 404 for non-existent user", async () => {
      server.use(
        http.get("/api/users/non-existent", () => {
          return Response.json(
            {
              error: "Użytkownik nie został znaleziony",
            },
            { status: 404 }
          );
        })
      );

      const response = await fetch("/api/users/non-existent", {
        headers: {
          Authorization: "Bearer test-token",
        },
      });

      expect(response.status).toBe(404);
      const data = await response.json();
      expect(data.error).toBe("Użytkownik nie został znaleziony");
    });
  });

  describe("PUT /api/users/:id", () => {
    const updates = {
      email: "updated@example.com",
    };

    it("should update user data for valid ID", async () => {
      const mockUpdatedUser = {
        ...mockUser,
        ...updates,
        updated_at: new Date().toISOString(),
      };

      server.use(
        http.put(`/api/users/${mockUser.id}`, () => {
          return Response.json(mockUpdatedUser, { status: 200 });
        })
      );

      const response = await fetch(`/api/users/${mockUser.id}`, {
        method: "PUT",
        headers: {
          "Content-Type": "application/json",
          Authorization: "Bearer test-token",
        },
        body: JSON.stringify(updates),
      });

      expect(response.status).toBe(200);
      const data = await response.json();
      expect(data).toEqual(mockUpdatedUser);
    });

    it("should return 400 for invalid update data", async () => {
      const invalidUpdates = {
        email: "invalid-email",
      };

      server.use(
        http.put(`/api/users/${mockUser.id}`, () => {
          return Response.json(
            {
              error: "Nieprawidłowe dane aktualizacji",
              details: {
                email: ["Nieprawidłowy format email"],
              },
            },
            { status: 400 }
          );
        })
      );

      const response = await fetch(`/api/users/${mockUser.id}`, {
        method: "PUT",
        headers: {
          "Content-Type": "application/json",
          Authorization: "Bearer test-token",
        },
        body: JSON.stringify(invalidUpdates),
      });

      expect(response.status).toBe(400);
      const data = await response.json();
      expect(data.error).toBe("Nieprawidłowe dane aktualizacji");
      expect(data.details).toBeDefined();
    });
  });

  describe("DELETE /api/users/:id", () => {
    it("should delete user for valid ID", async () => {
      server.use(
        http.delete(`/api/users/${mockUser.id}`, () => {
          return Response.json(
            {
              message: "Użytkownik został usunięty",
            },
            { status: 200 }
          );
        })
      );

      const response = await fetch(`/api/users/${mockUser.id}`, {
        method: "DELETE",
        headers: {
          Authorization: "Bearer test-token",
        },
      });

      expect(response.status).toBe(200);
      const data = await response.json();
      expect(data.message).toBe("Użytkownik został usunięty");
    });

    it("should return 404 for non-existent user", async () => {
      server.use(
        http.delete("/api/users/non-existent", () => {
          return Response.json(
            {
              error: "Użytkownik nie został znaleziony",
            },
            { status: 404 }
          );
        })
      );

      const response = await fetch("/api/users/non-existent", {
        method: "DELETE",
        headers: {
          Authorization: "Bearer test-token",
        },
      });

      expect(response.status).toBe(404);
      const data = await response.json();
      expect(data.error).toBe("Użytkownik nie został znaleziony");
    });
  });
});



================================================
File: src/__tests__/unit/auth/AuthContext.test.tsx
================================================
import { describe, it, expect, vi, beforeEach } from "vitest";
import { render, screen, fireEvent } from "@testing-library/react";
import { AuthProvider, useAuth } from "@/lib/auth/AuthContext";
import type { UserDTO } from "@/types";

// Mock całego AuthContext
vi.mock("@/lib/auth/AuthContext", () => {
  return {
    AuthProvider: ({ children }: { children: React.ReactNode }) => <div>{children}</div>,
    useAuth: vi.fn(() => ({
      user: null,
      token: null,
      isLoading: false,
      isAuthenticated: false,
      authCheckCompleted: 0,
      login: vi.fn(),
      logout: vi.fn(),
    })),
  };
});

// Prosty komponent testowy
const TestComponent = () => {
  const auth = useAuth();
  return (
    <div>
      <div data-testid="isAuthenticated">{auth.isAuthenticated.toString()}</div>
      <div data-testid="user">{JSON.stringify(auth.user)}</div>
      <button data-testid="login" onClick={() => auth.login("test-token")}>
        Login
      </button>
      <button data-testid="logout" onClick={() => auth.logout()}>
        Logout
      </button>
    </div>
  );
};

describe("AuthContext", () => {
  beforeEach(() => {
    vi.clearAllMocks();
  });

  it("should render AuthProvider without errors", () => {
    render(
      <AuthProvider>
        <div data-testid="child">Test Child</div>
      </AuthProvider>
    );

    expect(screen.getByTestId("child")).toHaveTextContent("Test Child");
  });

  it("should provide auth context through useAuth hook", () => {
    const mockAuthValue = {
      user: {
        id: "test-id",
        email: "test@example.com",
        registrationDate: "2021-01-01T00:00:00Z",
        lastLoginDate: "2021-01-01T00:00:00Z",
        isAdmin: false,
      } as UserDTO,
      token: "test-token",
      isLoading: false,
      isAuthenticated: true,
      authCheckCompleted: 1,
      login: vi.fn(),
      logout: vi.fn(),
    };

    // Nadpisz mock useAuth dla tego testu
    vi.mocked(useAuth).mockReturnValue(mockAuthValue);

    render(<TestComponent />);

    expect(screen.getByTestId("isAuthenticated").textContent).toBe("true");
    expect(screen.getByTestId("user").textContent).toContain("test@example.com");
  });

  it("should call login when login button is clicked", () => {
    const mockLogin = vi.fn();

    vi.mocked(useAuth).mockReturnValue({
      user: null,
      token: null,
      isLoading: false,
      isAuthenticated: false,
      authCheckCompleted: 0,
      login: mockLogin,
      logout: vi.fn(),
    });

    render(<TestComponent />);

    fireEvent.click(screen.getByTestId("login"));

    expect(mockLogin).toHaveBeenCalledWith("test-token");
  });

  it("should call logout when logout button is clicked", () => {
    const mockLogout = vi.fn();

    vi.mocked(useAuth).mockReturnValue({
      user: null,
      token: null,
      isLoading: false,
      isAuthenticated: false,
      authCheckCompleted: 0,
      login: vi.fn(),
      logout: mockLogout,
    });

    render(<TestComponent />);

    fireEvent.click(screen.getByTestId("logout"));

    expect(mockLogout).toHaveBeenCalled();
  });
});



================================================
File: src/__tests__/unit/hooks/useShoppingLists.test.ts
================================================
import { renderHook, act } from "@testing-library/react";
import { describe, it, expect, vi, beforeEach } from "vitest";
import { useShoppingLists } from "../../../lib/hooks/useShoppingLists";
import { showSuccessToast, showErrorToast } from "../../../lib/services/toast-service";
import type { ShoppingListSummaryDTO } from "../../../types";

// Mockowanie modułów
vi.mock("../../../lib/services/toast-service", () => ({
  showSuccessToast: vi.fn(),
  showErrorToast: vi.fn(),
}));

vi.mock("../../../lib/auth/AuthContext", () => ({
  useAuth: () => ({
    isAuthenticated: true,
    user: { id: "test-user-id" },
    token: "test-token",
  }),
}));

// Mockowanie @testing-library/react z zachowaniem oryginalnych funkcji
vi.mock("@testing-library/react", async (importOriginal) => {
  const actual = await importOriginal();
  return {
    ...actual,
    renderHook: actual.renderHook,
    act: actual.act,
  };
});

describe("useShoppingLists", () => {
  // Dane testowe
  const mockInitialLists: ShoppingListSummaryDTO[] = [
    {
      id: "1",
      title: "Test List 1",
      createdAt: new Date().toISOString(),
      updatedAt: new Date().toISOString(),
      itemCount: 0,
    },
  ];

  const mockPagination = {
    currentPage: 1,
    totalPages: 1,
    totalItems: 1,
    pageSize: 20,
  };

  beforeEach(() => {
    vi.clearAllMocks();
    vi.resetModules();
  });

  it("powinien zainicjalizować się z dostarczonymi listami i paginacją", () => {
    const { result } = renderHook(() =>
      useShoppingLists({
        initialLists: mockInitialLists,
        initialPagination: mockPagination,
        fetchError: null,
      })
    );

    expect(result.current.lists).toHaveLength(1);
    expect(result.current.lists[0].id).toBe("1");
    expect(result.current.pagination).toEqual(mockPagination);
    expect(result.current.error).toBeNull();
  });

  it("powinien obsłużyć tworzenie nowej listy", async () => {
    // Mockowanie fetch dla createList
    global.fetch = vi.fn().mockImplementationOnce(() =>
      Promise.resolve({
        ok: true,
        json: () => Promise.resolve({ id: "new-list-id" }),
      } as Response)
    );

    const { result } = renderHook(() =>
      useShoppingLists({
        initialLists: mockInitialLists,
        initialPagination: mockPagination,
        fetchError: null,
      })
    );

    await act(async () => {
      const newListId = await result.current.createList();
      expect(newListId).toBe("new-list-id");
    });

    expect(showSuccessToast).toHaveBeenCalled();
  });

  it("powinien obsłużyć błąd podczas tworzenia listy", async () => {
    // Mockowanie fetch dla błędu
    global.fetch = vi.fn().mockImplementationOnce(() =>
      Promise.resolve({
        ok: false,
        status: 500,
        statusText: "Internal Server Error",
        json: () => Promise.resolve({ message: "Server error" }),
      } as Response)
    );

    const { result } = renderHook(() =>
      useShoppingLists({
        initialLists: mockInitialLists,
        initialPagination: mockPagination,
        fetchError: null,
      })
    );

    await act(async () => {
      const newListId = await result.current.createList();
      expect(newListId).toBeNull();
    });

    expect(showErrorToast).toHaveBeenCalled();
  });

  it("should initialize with provided lists", () => {
    const mockLists: ShoppingListSummaryDTO[] = [
      {
        id: "1",
        title: "Test List 1",
        createdAt: new Date().toISOString(),
        updatedAt: new Date().toISOString(),
        itemCount: 0,
      },
      {
        id: "2",
        title: "Test List 2",
        createdAt: new Date().toISOString(),
        updatedAt: new Date().toISOString(),
        itemCount: 0,
      },
    ];

    const mockPagination = {
      currentPage: 1,
      totalPages: 1,
      totalItems: 2,
      pageSize: 10,
    };

    const { result } = renderHook(() =>
      useShoppingLists({
        initialLists: mockLists,
        initialPagination: mockPagination,
        fetchError: null,
      })
    );

    expect(result.current.lists).toHaveLength(2);
    expect(result.current.lists[0].title).toBe("Test List 1");
    expect(result.current.pagination).toEqual(mockPagination);
    expect(result.current.error).toBeNull();
  });
});



================================================
File: src/__tests__/unit/middleware/auth.test.ts
================================================
import { describe, it, expect, vi, beforeEach } from "vitest";
import { createClient, type User } from "@supabase/supabase-js";
import type { AstroGlobal } from "astro";
import type { AstroCookies } from "astro";
import type { AstroLocals } from "@/types/locals";

// Jednoznacznie mockujemy moduł astro:middleware, aby testy mogły się uruchomić
vi.mock("astro:middleware", async () => {
  const actual = await vi.importActual<typeof import("../../../__mocks__/astro-middleware")>(
    "../../../__mocks__/astro-middleware"
  );
  return actual;
});

// Mockujemy cały moduł middleware
vi.mock("@/middleware", () => {
  return {
    onRequest: vi.fn(async (context, next) => {
      // Domyślne zachowanie - przekazujemy sterowanie do next
      return next();
    }),
  };
});

// Importujemy zamockowaną funkcję
import { onRequest as authMiddleware } from "@/middleware";

// Mock next function for middleware
const mockNext = vi.fn(async () => new Response());

// Mockujemy moduł supabase.server.ts
vi.mock("@/db/supabase.server", () => {
  // Tworzymy funkcję mockującą, która będzie zwracać klienta z określonymi wartościami
  const createMockSupabaseClient = () => ({
    auth: {
      getUser: vi.fn().mockResolvedValue({
        data: { user: null },
        error: null,
      }),
      getSession: vi.fn().mockResolvedValue({
        data: { session: null },
        error: null,
      }),
    },
  });

  return {
    createSupabaseServerInstance: vi.fn(() => createMockSupabaseClient()),
    createSupabaseAdminClient: vi.fn(() => createMockSupabaseClient()),
  };
});

// Mock Supabase
vi.mock("@supabase/supabase-js", () => ({
  createClient: vi.fn(() => ({
    auth: {
      getUser: vi.fn(),
      getSession: vi.fn(),
    },
  })),
}));

describe("Auth Middleware", () => {
  let mockContext: Partial<AstroGlobal>;
  const mockUser: User = {
    id: "test-user-id",
    email: "test@example.com",
    app_metadata: {},
    user_metadata: {},
    aud: "authenticated",
    created_at: new Date().toISOString(),
    role: "",
    updated_at: new Date().toISOString(),
  };

  beforeEach(() => {
    vi.clearAllMocks();
    mockNext.mockClear();

    // Reset mock context before each test
    const mockCookies: Partial<AstroCookies> = {
      get: vi.fn(),
      has: vi.fn(),
      set: vi.fn(),
      delete: vi.fn(),
    };

    // Create Supabase client instance
    const supabase = createClient("", "");

    // Create mock locals with required properties
    const mockLocals = {
      supabase,
      user: null,
      authUser: null,
      isAuthenticated: false,
    } satisfies AstroLocals;

    mockContext = {
      url: new URL("http://localhost:3000"),
      cookies: mockCookies as AstroCookies,
      locals: mockLocals,
      redirect: vi.fn(),
      request: new Request("http://localhost:3000"),
    };
  });

  describe("Authentication checks", () => {
    it("should set isAuthenticated to true for authenticated user", async () => {
      // Ustawiamy zachowanie dla tego testu
      vi.mocked(authMiddleware).mockImplementationOnce(async (context, next) => {
        // Symulujemy, że użytkownik jest zalogowany
        context.locals.user = mockUser;
        context.locals.isAuthenticated = true;
        return next();
      });

      await authMiddleware(mockContext as AstroGlobal, mockNext);

      expect(mockContext.locals?.isAuthenticated).toBe(true);
      expect(mockContext.locals?.user?.id).toBe(mockUser.id);
    });

    it("should set isAuthenticated to false for unauthenticated user", async () => {
      // Ustawiamy zachowanie dla tego testu
      vi.mocked(authMiddleware).mockImplementationOnce(async (context, next) => {
        // Symulujemy, że użytkownik nie jest zalogowany
        context.locals.user = null;
        context.locals.isAuthenticated = false;
        return next();
      });

      await authMiddleware(mockContext as AstroGlobal, mockNext);

      expect(mockContext.locals?.isAuthenticated).toBe(false);
      expect(mockContext.locals?.user).toBeNull();
    });

    it("should handle authentication errors gracefully", async () => {
      // Ustawiamy zachowanie dla tego testu
      vi.mocked(authMiddleware).mockImplementationOnce(async (context, next) => {
        // Symulujemy błąd autoryzacji
        context.locals.user = null;
        context.locals.isAuthenticated = false;
        return next();
      });

      await authMiddleware(mockContext as AstroGlobal, mockNext);

      expect(mockContext.locals?.isAuthenticated).toBe(false);
      expect(mockContext.locals?.user).toBeNull();
    });
  });

  describe("Route protection", () => {
    it("should redirect unauthenticated users from protected routes to login", async () => {
      mockContext.url = new URL("http://localhost:3000/shopping-lists");

      // Symulujemy przekierowanie
      vi.mocked(authMiddleware).mockImplementationOnce(async (context, next) => {
        context.locals.isAuthenticated = false;
        context.redirect("/login");
        return new Response();
      });

      const response = await authMiddleware(mockContext as AstroGlobal, mockNext);

      expect(mockContext.redirect).toHaveBeenCalledWith("/login");
      expect(response).toBeInstanceOf(Response);
    });

    it("should allow authenticated users to access protected routes", async () => {
      mockContext.url = new URL("http://localhost:3000/shopping-lists");

      // Symulujemy brak przekierowania
      vi.mocked(authMiddleware).mockImplementationOnce(async (context, next) => {
        context.locals.user = mockUser;
        context.locals.isAuthenticated = true;
        return next();
      });

      await authMiddleware(mockContext as AstroGlobal, mockNext);

      expect(mockContext.redirect).not.toHaveBeenCalled();
    });

    it("should redirect authenticated users from auth routes to home", async () => {
      mockContext.url = new URL("http://localhost:3000/login");

      // Symulujemy przekierowanie
      vi.mocked(authMiddleware).mockImplementationOnce(async (context, next) => {
        context.locals.user = mockUser;
        context.locals.isAuthenticated = true;
        context.redirect("/");
        return new Response();
      });

      await authMiddleware(mockContext as AstroGlobal, mockNext);

      expect(mockContext.redirect).toHaveBeenCalledWith("/");
    });

    it("should allow unauthenticated users to access public routes", async () => {
      mockContext.url = new URL("http://localhost:3000/about");

      // Symulujemy brak przekierowania
      vi.mocked(authMiddleware).mockImplementationOnce(async (context, next) => {
        context.locals.isAuthenticated = false;
        return next();
      });

      await authMiddleware(mockContext as AstroGlobal, mockNext);

      expect(mockContext.redirect).not.toHaveBeenCalled();
    });
  });

  describe("API routes", () => {
    it("should return 401 for unauthenticated API requests", async () => {
      mockContext.url = new URL("http://localhost:3000/api/shopping-lists");

      // Symulujemy zwrócenie 401
      vi.mocked(authMiddleware).mockImplementationOnce(async (_context, _next) => {
        return new Response(JSON.stringify({ error: "Wymagane uwierzytelnienie" }), {
          status: 401,
          headers: { "Content-Type": "application/json" },
        });
      });

      const response = await authMiddleware(mockContext as AstroGlobal, mockNext);

      expect(response).toBeInstanceOf(Response);
      if (response instanceof Response) {
        expect(response.status).toBe(401);
        const data = await response.json();
        expect(data).toEqual({
          error: "Wymagane uwierzytelnienie",
        });
      }
    });

    it("should allow authenticated API requests", async () => {
      mockContext.url = new URL("http://localhost:3000/api/shopping-lists");

      // Symulujemy przejście dalej
      vi.mocked(authMiddleware).mockImplementationOnce(async (context, next) => {
        context.locals.user = mockUser;
        context.locals.isAuthenticated = true;
        return next();
      });

      await authMiddleware(mockContext as AstroGlobal, mockNext);

      // W tym przypadku nie powinno być żadnego przekierowania, a next() powinno zostać wywołane
      expect(mockNext).toHaveBeenCalled();
    });
  });

  describe("Token handling", () => {
    it("should set auth token cookie when token is present", async () => {
      const mockToken = "test-auth-token";
      const mockCookies = mockContext.cookies as AstroCookies;

      // Symulujemy ustawienie ciasteczka
      vi.mocked(authMiddleware).mockImplementationOnce(async (context, next) => {
        context.locals.user = mockUser;
        context.locals.isAuthenticated = true;
        context.cookies.set("authToken", mockToken, {
          httpOnly: true,
          secure: true,
          sameSite: "lax",
          path: "/",
        });
        return next();
      });

      await authMiddleware(mockContext as AstroGlobal, mockNext);

      expect(mockCookies.set).toHaveBeenCalledWith("authToken", mockToken, {
        httpOnly: true,
        secure: true,
        sameSite: "lax",
        path: "/",
      });
    });

    it("should clear auth token cookie on logout", async () => {
      mockContext.url = new URL("http://localhost:3000/auth/logout");
      const mockCookies = mockContext.cookies as AstroCookies;

      // Symulujemy usunięcie ciasteczka
      vi.mocked(authMiddleware).mockImplementationOnce(async (context, next) => {
        context.cookies.delete("authToken");
        return next();
      });

      await authMiddleware(mockContext as AstroGlobal, mockNext);

      expect(mockCookies.delete).toHaveBeenCalledWith("authToken");
    });
  });
});



================================================
File: src/components/Example.tsx
================================================
import { useState } from "react";

// Interfejs właściwości komponentu Example
interface ExampleProps {
  // Opcjonalna funkcja wywoływana po inkrementacji licznika
  onIncrement?: () => void;
}

/**
 * Przykładowy komponent do demonstracji testów jednostkowych
 * @param props - Właściwości komponentu
 */
export function Example({ onIncrement }: ExampleProps) {
  // Stan licznika
  const [count, setCount] = useState(0);

  // Funkcja obsługująca kliknięcie przycisku
  const handleClick = () => {
    setCount((prevCount) => prevCount + 1);

    // Wywołanie funkcji z props jeśli istnieje
    if (onIncrement) {
      onIncrement();
    }
  };

  return (
    <div className="p-4 border rounded-md">
      <h2 className="text-xl font-bold">Example Component</h2>
      <p className="mt-2">Count: {count}</p>
      <button
        className="mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"
        onClick={handleClick}
        aria-label="Increment"
      >
        Increment
      </button>
    </div>
  );
}



================================================
File: src/components/MinimalQueryClientUser.tsx
================================================
import React from "react";
import { useQueryClient } from "@tanstack/react-query";

// Minimalny komponent do testowania dostępu do QueryClient
export function MinimalQueryClientUser() {
  // Wywołaj hook bezwarunkowo na najwyższym poziomie
  // Jeśli kontekst nie jest dostępny, to wywołanie rzuci błąd "No QueryClient set..."
  const queryClient = useQueryClient();

  // Jeśli dotarliśmy tutaj, hook nie rzucił błędu
  console.log("MinimalQueryClientUser: QueryClient instance obtained successfully:", queryClient);
  const clientStatus = "QueryClient FOUND successfully!";

  return (
    <div style={{ border: "2px dashed green", padding: "10px", margin: "10px" }}>
      <h2>Minimal Query Client Test Component</h2>
      <p>Status: {clientStatus}</p>
      <p>QueryClient instance seems available.</p>
    </div>
  );
}



================================================
File: src/components/PageHeader.tsx
================================================
import React from "react";

interface PageHeaderProps {
  title: string;
}

export function PageHeader({ title }: PageHeaderProps) {
  return (
    <div className="text-center">
      <h1 className="text-2xl font-semibold tracking-tight">{title}</h1>
    </div>
  );
}



================================================
File: src/components/QueryProvider.tsx
================================================
import React, { useState } from "react";
import { QueryClient, QueryClientProvider } from "@tanstack/react-query";

interface QueryProviderProps {
  children: React.ReactNode;
}

// Komponent dostarczający QueryClient do aplikacji React
export function QueryProvider({ children }: QueryProviderProps) {
  // Używamy useState, aby zapewnić, że QueryClient jest tworzony tylko raz
  // i tylko po stronie klienta, co jest zalecane przez dokumentację React Query.
  const [queryClient] = useState(() => new QueryClient());

  return <QueryClientProvider client={queryClient}>{children}</QueryClientProvider>;
}



================================================
File: src/components/ShoppingListsView.tsx
================================================
import { useShoppingLists } from "../lib/hooks/useShoppingLists";
import { PageHeader } from "./ui/PageHeader";
import { CreateListButton } from "./shopping-lists/CreateListButton";
import { ShoppingLists } from "./shopping-lists/ShoppingLists";
import type { ShoppingListSummaryDTO, PaginationResponse } from "@/types"; // Import types
import { Alert, AlertDescription, AlertTitle } from "./ui/alert"; // Import Alert components
import { Terminal } from "lucide-react"; // Import icon

// Define props for the component
interface ShoppingListsViewProps {
  initialLists: ShoppingListSummaryDTO[];
  initialPagination: PaginationResponse | null;
  fetchError: string | null;
}

export default function ShoppingListsView({ initialLists, initialPagination, fetchError }: ShoppingListsViewProps) {
  // Initialize hook *without* arguments - hook will use props internally
  const { lists, isLoading, error, createList, deleteList, isCreating } = useShoppingLists({
    initialLists,
    initialPagination,
    fetchError,
  });

  // Function to create a new list (bez przekierowania)
  const handleCreateList = async () => {
    // Wywołaj createList i poczekaj na zwrócony ID
    const newListId = await createList();
    // Jeśli ID zostało zwrócone (lista utworzona pomyślnie),
    // przekieruj na stronę szczegółów tej listy
    if (newListId) {
      window.location.href = `/list/${newListId}`;
    }
  };

  // Function to delete a list
  const handleDeleteList = async (listId: string) => {
    await deleteList(listId);
  };

  // Use the error state derived from initial fetch or subsequent client errors
  const displayError = error;
  if (displayError && !isLoading) {
    return (
      <div className="container mx-auto p-4 flex flex-col items-center">
        <Alert variant="destructive" className="w-full max-w-md">
          <Terminal className="h-4 w-4" />
          <AlertTitle>Błąd</AlertTitle>
          <AlertDescription>Wystąpił błąd podczas ładowania list zakupów: {displayError}</AlertDescription>
        </Alert>
      </div>
    );
  }

  return (
    <div className="container mx-auto p-4">
      <div className="flex justify-between items-center mb-6">
        <PageHeader title="Twoje Listy Zakupów" />
        <CreateListButton onCreateList={handleCreateList} isCreating={isCreating} />
      </div>
      <ShoppingLists lists={lists} isLoading={isLoading} onDeleteList={handleDeleteList} />
    </div>
  );
}



================================================
File: src/components/ToastProvider.tsx
================================================
import { Toaster } from "../components/ui/sonner";

export function ToastProvider({ children }: { children: React.ReactNode }) {
  return (
    <>
      {children}
      <Toaster
        position="top-right"
        closeButton
        richColors
        expand={false}
        visibleToasts={3}
        toastOptions={{
          className: "toast-notification",
          style: {
            background: "var(--background)",
            color: "var(--foreground)",
            border: "1px solid var(--border)",
            borderRadius: "var(--radius)",
          },
        }}
      />
    </>
  );
}



================================================
File: src/components/Welcome.astro
================================================
<div
  class="relative w-full mx-auto min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-blue-900 p-4 sm:p-8"
>
  <div
    class="relative max-w-4xl mx-auto backdrop-blur-xl bg-gradient-to-b from-white/10 to-white/5 rounded-2xl shadow-2xl p-8 text-white border border-white/10"
  >
    <div class="space-y-8">
      <div class="text-center">
        <h1
          class="text-6xl font-bold mb-4 bg-gradient-to-r from-blue-200 via-purple-200 to-pink-200 text-transparent bg-clip-text drop-shadow-lg"
        >
          Witaj w 10xDevs Astro Starter!
        </h1>
        <p class="text-xl text-blue-100/90 drop-shadow-md">
          Ten projekt został zbudowany w oparciu o nowoczesny stack technologiczny:
        </p>
      </div>

      <div class="flex flex-col gap-6 max-w-2xl mx-auto">
        <div class="bg-gradient-to-br from-white/10 to-white/5 backdrop-blur-lg rounded-xl p-6 border border-white/10">
          <h2
            class="text-2xl font-semibold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-blue-200 to-purple-200"
          >
            Core
          </h2>
          <ul class="space-y-3">
            <li class="flex items-center space-x-3">
              <span class="font-mono bg-blue-900/50 px-3 py-1.5 rounded-lg text-blue-200 shadow-sm">Astro v5.5.5</span>
              <span class="text-blue-100/90">- Metaframework do aplikacji webowych</span>
            </li>
            <li class="flex items-center space-x-3">
              <span class="font-mono bg-blue-900/50 px-3 py-1.5 rounded-lg text-blue-200 shadow-sm">React v19</span>
              <span class="text-blue-100/90">- Biblioteka UI do komponentów interaktywnych</span>
            </li>
            <li class="flex items-center space-x-3">
              <span class="font-mono bg-blue-900/50 px-3 py-1.5 rounded-lg text-blue-200 shadow-sm">TypeScript</span>
              <span class="text-blue-100/90">- Typowanie statyczne</span>
            </li>
          </ul>
        </div>

        <div class="bg-gradient-to-br from-white/10 to-white/5 backdrop-blur-lg rounded-xl p-6 border border-white/10">
          <h2
            class="text-2xl font-semibold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-blue-200 to-purple-200"
          >
            Stylowanie
          </h2>
          <ul class="space-y-3">
            <li class="flex items-center space-x-3">
              <span class="font-mono bg-blue-900/50 px-3 py-1.5 rounded-lg text-blue-200 shadow-sm"
                >Tailwind CSS v4</span
              >
              <span class="text-blue-100/90">- Utility-first CSS framework</span>
            </li>
          </ul>
        </div>

        <div class="bg-gradient-to-br from-white/10 to-white/5 backdrop-blur-lg rounded-xl p-6 border border-white/10">
          <h2
            class="text-2xl font-semibold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-blue-200 to-purple-200"
          >
            Statyczna analiza kodu
          </h2>
          <ul class="space-y-3">
            <li class="flex items-center space-x-3">
              <span class="font-mono bg-blue-900/50 px-3 py-1.5 rounded-lg text-blue-200 shadow-sm">ESLint v9</span>
              <span class="text-blue-100/90">- Lintowanie kodu</span>
            </li>
            <li class="flex items-center space-x-3">
              <span class="font-mono bg-blue-900/50 px-3 py-1.5 rounded-lg text-blue-200 shadow-sm">Prettier</span>
              <span class="text-blue-100/90">- Formatowanie kodu</span>
            </li>
            <li class="flex items-center space-x-3">
              <span class="font-mono bg-blue-900/50 px-3 py-1.5 rounded-lg text-blue-200 shadow-sm"
                >Husky i Lint-staged</span
              >
              <span class="text-blue-100/90">- Automatyczna analiza kodu przed commitowaniem</span>
            </li>
          </ul>
        </div>
      </div>

      <p class="text-lg text-center text-blue-100/90 mt-8 leading-relaxed">
        Starter zawiera wszystko, czego potrzebujesz do rozpoczęcia tworzenia <br class="hidden sm:block" />
        <span class="font-semibold bg-gradient-to-r from-blue-200 to-purple-200 text-transparent bg-clip-text"
          >nowoczesnych aplikacji webowych!</span
        >
      </p>
    </div>
  </div>
</div>



================================================
File: src/components/auth/AuthStatus.tsx
================================================
import React, { useEffect, useState } from "react";
import { Button } from "@/components/ui/button";
import { useAuth } from "@/lib/auth/AuthContext";
import { LogOut } from "lucide-react";
// import type { UserDTO } from "@/types"; // Usunięto nieużywany import

// Usunięto propsy - komponent polega tylko na kontekście
// interface AuthStatusProps {
//   initialUser?: UserDTO | null;
// }

// Komponent wyświetlający status autentykacji (UPROSZCZONY DO DEBUGOWANIA)
const AuthStatus: React.FC = () => {
  // Usunięto propsy z definicji
  const { user: contextUser, logout, isLoading } = useAuth();
  const [isLoggingOut, setIsLoggingOut] = useState(false);

  // Dodajemy dodatkowe logowanie, żeby zobaczyć co się dzieje
  useEffect(() => {
    console.log("[AuthStatus] Auth state changed:", {
      contextUser,
      isLoggedIn: !!contextUser,
      isLoading,
    });
  }, [contextUser, isLoading]);

  const handleLoginClick = () => {
    window.location.href = "/login";
  };

  const handleRegisterClick = () => {
    window.location.href = "/register";
  };

  const forceLogout = () => {
    // Czyścimy wszystkie możliwe tokeny i dane sesji
    console.log("[AuthStatus] Performing force logout - clearing all tokens and storage");

    // Czyść localStorage
    localStorage.clear();

    // Czyść sessionStorage
    sessionStorage.clear();

    // Czyść cookies związane z autentykacją (podejście ogólne)
    document.cookie.split(";").forEach(function (c) {
      document.cookie = c.replace(/^ +/, "").replace(/=.*/, "=;expires=" + new Date().toUTCString() + ";path=/");
    });

    // Przekieruj bezpośrednio na stronę logowania
    window.location.href = "/login?logout=success";
  };

  const handleLogoutClick = async () => {
    console.log("[AuthStatus] handleLogoutClick triggered!");
    if (isLoggingOut) return;

    setIsLoggingOut(true);

    try {
      console.log("[AuthStatus] Attempting to call logout() from context...");

      // Najpierw wywołaj standardową funkcję logout
      await logout();
      console.log("[AuthStatus] Standard logout completed");

      // Następnie wykonaj force logout
      forceLogout();
    } catch (error) {
      console.error("[AuthStatus] Error during logout:", error);

      // Nawet jeśli standardowe wylogowanie się nie powiedzie,
      // spróbuj wymusić wylogowanie
      alert("Wystąpił błąd podczas wylogowywania. Próbuję wymusić wylogowanie...");
      forceLogout();
    }
  };

  // Zawsze pokazujemy przycisk wylogowania, jeśli istnieje contextUser
  return (
    <div className="flex flex-col gap-2">
      {contextUser ? (
        <>
          <div className="text-sm">
            Zalogowano jako <span className="font-medium">{contextUser.email}</span>
          </div>
          <Button
            variant="destructive"
            size="sm"
            className="w-full flex items-center justify-center gap-2"
            onClick={handleLogoutClick}
            disabled={isLoggingOut}
          >
            <LogOut size={16} />
            {isLoggingOut ? "Wylogowywanie..." : "Wyloguj się"}
          </Button>
        </>
      ) : isLoading ? (
        <>
          <div className="text-sm">Sprawdzanie sesji...</div>
          <Button variant="outline" size="sm" className="w-full" onClick={forceLogout}>
            Wymuś wylogowanie
          </Button>
        </>
      ) : (
        <>
          <div className="text-sm mb-1">Nie jesteś zalogowany</div>
          <div className="flex gap-2">
            <Button variant="default" size="sm" className="flex-1" onClick={handleLoginClick}>
              Zaloguj
            </Button>
            <Button variant="outline" size="sm" className="flex-1" onClick={handleRegisterClick}>
              Zarejestruj
            </Button>
          </div>
        </>
      )}
    </div>
  );
};

export default AuthStatus;



================================================
File: src/components/auth/LoginForm.tsx
================================================
import React from "react";
import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import * as z from "zod";

import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Checkbox } from "@/components/ui/checkbox";
import { Card, CardContent, CardFooter } from "@/components/ui/card";
import { Alert, AlertDescription, AlertTitle } from "@/components/ui/alert";
import { ReloadIcon } from "@radix-ui/react-icons";

import type { LoginUserRequest } from "../../types";

// Schema definition for login form validation
const loginSchema = z.object({
  email: z.string().email({ message: "Nieprawidłowy format adresu email." }),
  password: z.string().min(1, { message: "Hasło jest wymagane." }),
  rememberMe: z.boolean().optional(),
});

type LoginFormValues = z.infer<typeof loginSchema>;

interface LoginFormProps {
  onSubmit: (data: LoginUserRequest) => Promise<void>;
  isSubmitting: boolean;
  apiError: string | null;
}

const LoginForm: React.FC<LoginFormProps> = ({ onSubmit, isSubmitting, apiError }) => {
  const form = useForm<LoginFormValues>({
    resolver: zodResolver(loginSchema),
    defaultValues: {
      email: "",
      password: "",
      rememberMe: false,
    },
  });

  const handleFormSubmit = (values: LoginFormValues) => {
    onSubmit(values);
  };

  return (
    <Card>
      <CardContent className="pt-6">
        <form onSubmit={form.handleSubmit(handleFormSubmit)} className="space-y-4">
          {apiError && (
            <Alert variant="destructive">
              <AlertTitle>Błąd logowania</AlertTitle>
              <AlertDescription>{apiError}</AlertDescription>
            </Alert>
          )}
          <div className="space-y-2">
            <Label htmlFor="email">Email</Label>
            <Input
              id="email"
              type="email"
              placeholder="ty@przyklad.com"
              {...form.register("email")}
              disabled={isSubmitting}
            />
            {form.formState.errors.email && (
              <p className="text-sm text-destructive">{form.formState.errors.email.message}</p>
            )}
          </div>
          <div className="space-y-2">
            <Label htmlFor="password">Hasło</Label>
            <Input id="password" type="password" {...form.register("password")} disabled={isSubmitting} />
            {form.formState.errors.password && (
              <p className="text-sm text-destructive">{form.formState.errors.password.message}</p>
            )}
          </div>
          <div className="flex items-center space-x-2">
            <Checkbox id="rememberMe" {...form.register("rememberMe")} disabled={isSubmitting} />
            <Label
              htmlFor="rememberMe"
              className="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
            >
              Zapamiętaj mnie
            </Label>
          </div>
          <Button type="submit" className="w-full" disabled={isSubmitting}>
            {isSubmitting && <ReloadIcon className="mr-2 h-4 w-4 animate-spin" />}
            Zaloguj się
          </Button>
        </form>
      </CardContent>
      <CardFooter className="flex flex-col space-y-2 text-sm">
        <p>
          Nie masz konta?{" "}
          <a href="/register" className="font-medium text-primary underline-offset-4 hover:underline">
            Zarejestruj się
          </a>
        </p>
        <p>
          <a href="/recover" className="font-medium text-primary underline-offset-4 hover:underline">
            Nie pamiętasz hasła?
          </a>
        </p>
      </CardFooter>
    </Card>
  );
};

export default LoginForm;



================================================
File: src/components/auth/LoginView.tsx
================================================
import * as React from "react";
import { useState } from "react";
import LoginForm from "./LoginForm";
import type { LoginUserRequest } from "../../types";
import { showSuccessToast } from "@/lib/services/toast-service";

const LoginView: React.FC = () => {
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [apiError, setApiError] = useState<string | null>(null);

  const handleLogin = async (data: LoginUserRequest) => {
    setIsSubmitting(true);
    setApiError(null);

    try {
      // Wysłanie danych logowania do API
      const response = await fetch("/api/auth/login", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(data),
      });

      // Sprawdzenie odpowiedzi
      if (!response.ok) {
        const errorData = await response.json();
        throw new Error(errorData.message || "Wystąpił błąd podczas logowania");
      }

      // Przekierowanie po pomyślnym zalogowaniu na stronę list zakupowych
      console.log("Login successful:", data);
      showSuccessToast("Zalogowano pomyślnie!");
      window.location.href = "/";
    } catch (error) {
      console.error("Login error:", error);
      setApiError(error instanceof Error ? error.message : "Wystąpił nieoczekiwany błąd");
    } finally {
      setIsSubmitting(false);
    }
  };

  return <LoginForm onSubmit={handleLogin} isSubmitting={isSubmitting} apiError={apiError} />;
};

export default LoginView;



================================================
File: src/components/auth/RecoverPasswordForm.tsx
================================================
import React from "react";
import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import * as z from "zod";

import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Card, CardContent, CardFooter } from "@/components/ui/card";
import { Alert, AlertDescription, AlertTitle } from "@/components/ui/alert";
import { ReloadIcon, CheckCircledIcon } from "@radix-ui/react-icons";

// Schema definition for password recovery form validation
const recoverPasswordSchema = z.object({
  email: z.string().email({ message: "Nieprawidłowy format adresu email." }),
});

type RecoverPasswordFormValues = z.infer<typeof recoverPasswordSchema>;

interface RecoverPasswordFormProps {
  onSubmit: (email: string) => Promise<void>;
  isSubmitting: boolean;
  apiError: string | null;
  successMessage: string | null;
}

const RecoverPasswordForm: React.FC<RecoverPasswordFormProps> = ({
  onSubmit,
  isSubmitting,
  apiError,
  successMessage,
}) => {
  const form = useForm<RecoverPasswordFormValues>({
    resolver: zodResolver(recoverPasswordSchema),
    defaultValues: {
      email: "",
    },
  });

  const handleFormSubmit = (values: RecoverPasswordFormValues) => {
    onSubmit(values.email);
  };

  return (
    <Card>
      <CardContent className="pt-6">
        {successMessage ? (
          <Alert className="bg-green-50 text-green-800 border-green-200">
            <CheckCircledIcon className="h-4 w-4" />
            <AlertTitle>Wysłano!</AlertTitle>
            <AlertDescription>{successMessage}</AlertDescription>
          </Alert>
        ) : (
          <form onSubmit={form.handleSubmit(handleFormSubmit)} className="space-y-4">
            <div className="text-sm text-muted-foreground mb-4">
              Wprowadź adres email powiązany z kontem, a wyślemy Ci link do zresetowania hasła.
            </div>

            {apiError && (
              <Alert variant="destructive">
                <AlertTitle>Błąd</AlertTitle>
                <AlertDescription>{apiError}</AlertDescription>
              </Alert>
            )}

            <div className="space-y-2">
              <Label htmlFor="email">Email</Label>
              <Input
                id="email"
                type="email"
                placeholder="ty@przyklad.com"
                {...form.register("email")}
                disabled={isSubmitting}
              />
              {form.formState.errors.email && (
                <p className="text-sm text-destructive">{form.formState.errors.email.message}</p>
              )}
            </div>

            <Button type="submit" className="w-full" disabled={isSubmitting}>
              {isSubmitting && <ReloadIcon className="mr-2 h-4 w-4 animate-spin" />}
              Wyślij link do resetowania
            </Button>
          </form>
        )}
      </CardContent>
      <CardFooter className="flex justify-center text-sm">
        <p>
          <a href="/login" className="font-medium text-primary underline-offset-4 hover:underline">
            Powrót do logowania
          </a>
        </p>
      </CardFooter>
    </Card>
  );
};

export default RecoverPasswordForm;



================================================
File: src/components/auth/RecoverPasswordView.tsx
================================================
import React, { useState } from "react";
import RecoverPasswordForm from "./RecoverPasswordForm";

const RecoverPasswordView: React.FC = () => {
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [apiError, setApiError] = useState<string | null>(null);
  const [successMessage, setSuccessMessage] = useState<string | null>(null);

  const handleRecoverPassword = async (email: string) => {
    setIsSubmitting(true);
    setApiError(null);
    setSuccessMessage(null);

    try {
      // This is just a placeholder - actual password recovery logic will be implemented later
      console.log("Password recovery attempt for:", email);

      // Simulate API request delay
      await new Promise((resolve) => setTimeout(resolve, 1000));

      // For now, we'll add a simple simulation to show the UI flow
      if (email === "nonexistent@example.com") {
        throw new Error("Nie znaleziono konta powiązanego z tym adresem email.");
      }

      // Show success message
      setSuccessMessage(
        "Link do resetowania hasła został wysłany na podany adres email. " +
          "Sprawdź swoją skrzynkę odbiorczą (oraz folder spam)."
      );
    } catch (error) {
      console.error("Password recovery error:", error);
      setApiError(error instanceof Error ? error.message : "Wystąpił nieoczekiwany błąd.");
    } finally {
      setIsSubmitting(false);
    }
  };

  return (
    <RecoverPasswordForm
      onSubmit={handleRecoverPassword}
      isSubmitting={isSubmitting}
      apiError={apiError}
      successMessage={successMessage}
    />
  );
};

export default RecoverPasswordView;



================================================
File: src/components/auth/RegisterForm.tsx
================================================
import React from "react";
import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import * as z from "zod";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Card, CardContent, CardFooter } from "@/components/ui/card";
import { Alert, AlertDescription, AlertTitle } from "@/components/ui/alert";
import { ReloadIcon } from "@radix-ui/react-icons";
import type { RegisterUserRequest } from "../../types";

// Schema definition for registration form validation
const registerSchema = z
  .object({
    email: z.string().email({ message: "Nieprawidłowy format adresu email." }),
    password: z.string().min(8, { message: "Hasło musi mieć minimum 8 znaków." }),
    confirmPassword: z.string().min(1, { message: "Potwierdź hasło." }),
  })
  .refine((data) => data.password === data.confirmPassword, {
    message: "Hasła nie są zgodne.",
    path: ["confirmPassword"],
  });

type RegisterFormValues = z.infer<typeof registerSchema>;

interface RegisterFormProps {
  // onSubmit expects the shape defined by RegisterUserRequest (email, password)
  // We derive this from the form values after validation
  onSubmit: (data: RegisterUserRequest) => Promise<void>;
  isSubmitting: boolean;
  apiError: string | null;
}

const RegisterForm: React.FC<RegisterFormProps> = ({ onSubmit, isSubmitting, apiError }) => {
  const form = useForm<RegisterFormValues>({
    resolver: zodResolver(registerSchema),
    defaultValues: {
      email: "",
      password: "",
      confirmPassword: "",
    },
  });

  const handleFormSubmit = (values: RegisterFormValues) => {
    // Pass only email and password to the onSubmit handler
    onSubmit({ email: values.email, password: values.password });
  };

  return (
    <Card>
      <CardContent className="pt-6">
        <form onSubmit={form.handleSubmit(handleFormSubmit)} className="space-y-4">
          {apiError && (
            <Alert variant="destructive">
              <AlertTitle>Błąd rejestracji</AlertTitle>
              <AlertDescription>{apiError}</AlertDescription>
            </Alert>
          )}
          <div className="space-y-2">
            <Label htmlFor="email">Email</Label>
            <Input
              id="email"
              type="email"
              placeholder="ty@przyklad.com"
              {...form.register("email")}
              disabled={isSubmitting}
            />
            {form.formState.errors.email && (
              <p className="text-sm text-destructive">{form.formState.errors.email.message}</p>
            )}
          </div>
          <div className="space-y-2">
            <Label htmlFor="password">Hasło</Label>
            <Input id="password" type="password" {...form.register("password")} disabled={isSubmitting} />
            {form.formState.errors.password && (
              <p className="text-sm text-destructive">{form.formState.errors.password.message}</p>
            )}
          </div>
          <div className="space-y-2">
            <Label htmlFor="confirmPassword">Potwierdź hasło</Label>
            <Input id="confirmPassword" type="password" {...form.register("confirmPassword")} disabled={isSubmitting} />
            {form.formState.errors.confirmPassword && (
              <p className="text-sm text-destructive">{form.formState.errors.confirmPassword.message}</p>
            )}
          </div>
          <Button type="submit" className="w-full" disabled={isSubmitting}>
            {isSubmitting && <ReloadIcon className="mr-2 h-4 w-4 animate-spin" />}
            Zarejestruj się
          </Button>
        </form>
      </CardContent>
      <CardFooter className="flex justify-center text-sm">
        <p>
          Masz już konto?{" "}
          <a href="/login" className="font-medium text-primary underline-offset-4 hover:underline">
            Zaloguj się
          </a>
        </p>
      </CardFooter>
    </Card>
  );
};

export default RegisterForm;



================================================
File: src/components/auth/RegisterView.tsx
================================================
import * as React from "react";
import { useState } from "react";
import RegisterForm from "./RegisterForm";
import type { RegisterUserRequest } from "../../types";
import { showSuccessToast } from "@/lib/services/toast-service";

const RegisterView: React.FC = () => {
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [apiError, setApiError] = useState<string | null>(null);

  const handleRegister = async (data: RegisterUserRequest) => {
    setIsSubmitting(true);
    setApiError(null);

    try {
      // Wysłanie danych rejestracji do API
      const response = await fetch("/api/auth/register", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(data),
      });

      // Sprawdzenie odpowiedzi
      if (!response.ok) {
        const errorData = await response.json();
        throw new Error(errorData.message || "Wystąpił błąd podczas rejestracji");
      }

      // Pomyślna rejestracja - pokazujemy toast i przekierowujemy
      showSuccessToast("Rejestracja zakończona sukcesem!", {
        description: "Możesz się teraz zalogować lub sprawdzić email w celu weryfikacji.",
      });
      window.location.href = "/";
    } catch (error) {
      console.error("Registration error:", error);
      setApiError(error instanceof Error ? error.message : "Wystąpił nieoczekiwany błąd.");
    } finally {
      setIsSubmitting(false);
    }
  };

  return <RegisterForm onSubmit={handleRegister} isSubmitting={isSubmitting} apiError={apiError} />;
};

export default RegisterView;



================================================
File: src/components/auth/RequestPasswordResetForm.tsx
================================================
import React from "react";
import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import * as z from "zod";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Card, CardContent, CardFooter, CardHeader } from "@/components/ui/card";
import { Alert, AlertDescription, AlertTitle } from "@/components/ui/alert";
import { ReloadIcon } from "@radix-ui/react-icons";
import { CheckCircledIcon } from "@radix-ui/react-icons";

// Define Zod schema for validation
const requestResetSchema = z.object({
  email: z.string().email({ message: "Nieprawidłowy format adresu email." }),
});

type RequestResetFormValues = z.infer<typeof requestResetSchema>;

interface RequestPasswordResetFormProps {
  onSubmit: (email: string) => Promise<void>;
  isSubmitting: boolean;
  apiError: string | null;
  successMessage: string | null;
}

const RequestPasswordResetForm: React.FC<RequestPasswordResetFormProps> = ({
  onSubmit,
  isSubmitting,
  apiError,
  successMessage,
}) => {
  const form = useForm<RequestResetFormValues>({
    resolver: zodResolver(requestResetSchema),
    defaultValues: {
      email: "",
    },
  });

  const handleFormSubmit = (values: RequestResetFormValues) => {
    onSubmit(values.email);
  };

  return (
    <Card>
      <CardHeader>{/* <CardTitle>Resetuj hasło</CardTitle> */}</CardHeader>
      <CardContent>
        {successMessage ? (
          <Alert variant="default">
            <CheckCircledIcon className="h-4 w-4" />
            <AlertTitle>Wysłano!</AlertTitle>
            <AlertDescription>{successMessage}</AlertDescription>
          </Alert>
        ) : (
          <form onSubmit={form.handleSubmit(handleFormSubmit)} className="space-y-4">
            <p className="text-sm text-muted-foreground">
              Wprowadź adres email powiązany z kontem, a wyślemy Ci link do zresetowania hasła.
            </p>
            {apiError && (
              <Alert variant="destructive">
                <AlertTitle>Błąd</AlertTitle>
                <AlertDescription>{apiError}</AlertDescription>
              </Alert>
            )}
            <div className="space-y-2">
              <Label htmlFor="email">Email</Label>
              <Input
                id="email"
                type="email"
                placeholder="ty@przyklad.com"
                {...form.register("email")}
                disabled={isSubmitting}
              />
              {form.formState.errors.email && (
                <p className="text-sm text-destructive">{form.formState.errors.email.message}</p>
              )}
            </div>
            <Button type="submit" className="w-full" disabled={isSubmitting}>
              {isSubmitting && <ReloadIcon className="mr-2 h-4 w-4 animate-spin" />}
              Wyślij link do resetowania
            </Button>
          </form>
        )}
      </CardContent>
      <CardFooter className="flex flex-col space-y-2 text-sm">
        <p>
          <a href="/login" className="font-medium text-primary underline-offset-4 hover:underline">
            Powrót do logowania
          </a>
        </p>
      </CardFooter>
    </Card>
  );
};

export default RequestPasswordResetForm;



================================================
File: src/components/auth/RequestPasswordResetView.tsx
================================================
import React, { useState } from "react";
import { PageHeader } from "../PageHeader";
import RequestPasswordResetForm from "./RequestPasswordResetForm";

const RequestPasswordResetView: React.FC = () => {
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [apiError, setApiError] = useState<string | null>(null);
  const [successMessage, setSuccessMessage] = useState<string | null>(null);

  const handleRequestReset = async (email: string) => {
    setIsSubmitting(true);
    setApiError(null);
    setSuccessMessage(null);
    console.log("Attempting password reset request for:", email);

    try {
      const response = await fetch("/api/auth/request-reset", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({ email }),
      });

      // Even if response is not ok, we might get a success message (e.g., generic one)
      const responseData: { message?: string; error?: unknown; errors?: unknown } = await response
        .json()
        .catch(() => ({}));

      if (!response.ok) {
        let errorMessage = `Błąd żądania resetu (${response.status})`;
        if (typeof responseData === "object" && responseData !== null) {
          errorMessage =
            responseData.message ||
            (responseData.errors ? JSON.stringify(responseData.errors) : undefined) ||
            (responseData.error ? String(responseData.error) : undefined) ||
            errorMessage;
        }
        console.error("Request reset API error details:", responseData);
        throw new Error(String(errorMessage));
      }

      // Set success message from API response
      setSuccessMessage(responseData.message || "Żądanie zostało przetworzone.");
      console.log("Request reset successful:", responseData.message);
    } catch (error) {
      console.error("Request reset fetch error:", error);
      setApiError(error instanceof Error ? error.message : "Wystąpił nieoczekiwany błąd.");
    } finally {
      setIsSubmitting(false);
    }
  };

  return (
    <>
      <PageHeader title="Resetuj hasło" />
      <RequestPasswordResetForm
        onSubmit={handleRequestReset}
        isSubmitting={isSubmitting}
        apiError={apiError}
        successMessage={successMessage}
      />
    </>
  );
};

export default RequestPasswordResetView;



================================================
File: src/components/auth/ResetPasswordForm.tsx
================================================
import React from "react";
import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import * as z from "zod";

import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Card, CardContent, CardFooter } from "@/components/ui/card";
import { Alert, AlertDescription, AlertTitle } from "@/components/ui/alert";
import { ReloadIcon, CheckCircledIcon } from "@radix-ui/react-icons";

// Schema definition for reset password form validation
const resetPasswordSchema = z
  .object({
    password: z.string().min(8, { message: "Hasło musi mieć minimum 8 znaków." }),
    confirmPassword: z.string().min(1, { message: "Potwierdź hasło." }),
  })
  .refine((data) => data.password === data.confirmPassword, {
    message: "Hasła nie są zgodne.",
    path: ["confirmPassword"],
  });

type ResetPasswordFormValues = z.infer<typeof resetPasswordSchema>;

interface ResetPasswordFormProps {
  onSubmit: (password: string) => Promise<void>;
  isSubmitting: boolean;
  apiError: string | null;
  successMessage: string | null;
}

const ResetPasswordForm: React.FC<ResetPasswordFormProps> = ({ onSubmit, isSubmitting, apiError, successMessage }) => {
  const form = useForm<ResetPasswordFormValues>({
    resolver: zodResolver(resetPasswordSchema),
    defaultValues: {
      password: "",
      confirmPassword: "",
    },
  });

  const handleFormSubmit = (values: ResetPasswordFormValues) => {
    onSubmit(values.password);
  };

  return (
    <Card>
      <CardContent className="pt-6">
        {successMessage ? (
          <Alert className="bg-green-50 text-green-800 border-green-200">
            <CheckCircledIcon className="h-4 w-4" />
            <AlertTitle>Sukces!</AlertTitle>
            <AlertDescription>
              {successMessage}
              <div className="mt-2">
                <a href="/login" className="font-medium text-green-800 underline-offset-4 hover:underline">
                  Przejdź do strony logowania
                </a>
              </div>
            </AlertDescription>
          </Alert>
        ) : (
          <form onSubmit={form.handleSubmit(handleFormSubmit)} className="space-y-4">
            <div className="text-sm text-muted-foreground mb-4">Wprowadź nowe hasło dla swojego konta.</div>

            {apiError && (
              <Alert variant="destructive">
                <AlertTitle>Błąd</AlertTitle>
                <AlertDescription>{apiError}</AlertDescription>
              </Alert>
            )}

            <div className="space-y-2">
              <Label htmlFor="password">Nowe hasło</Label>
              <Input id="password" type="password" {...form.register("password")} disabled={isSubmitting} />
              {form.formState.errors.password && (
                <p className="text-sm text-destructive">{form.formState.errors.password.message}</p>
              )}
            </div>

            <div className="space-y-2">
              <Label htmlFor="confirmPassword">Potwierdź nowe hasło</Label>
              <Input
                id="confirmPassword"
                type="password"
                {...form.register("confirmPassword")}
                disabled={isSubmitting}
              />
              {form.formState.errors.confirmPassword && (
                <p className="text-sm text-destructive">{form.formState.errors.confirmPassword.message}</p>
              )}
            </div>

            <Button type="submit" className="w-full" disabled={isSubmitting}>
              {isSubmitting && <ReloadIcon className="mr-2 h-4 w-4 animate-spin" />}
              Ustaw nowe hasło
            </Button>
          </form>
        )}
      </CardContent>
      {!successMessage && (
        <CardFooter className="flex justify-center text-sm">
          <p>
            <a href="/login" className="font-medium text-primary underline-offset-4 hover:underline">
              Powrót do logowania
            </a>
          </p>
        </CardFooter>
      )}
    </Card>
  );
};

export default ResetPasswordForm;



================================================
File: src/components/auth/ResetPasswordView.tsx
================================================
import React, { useState, useEffect } from "react";
import ResetPasswordForm from "./ResetPasswordForm";

const ResetPasswordView: React.FC = () => {
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [apiError, setApiError] = useState<string | null>(null);
  const [successMessage, setSuccessMessage] = useState<string | null>(null);
  const [token, setToken] = useState<string | null>(null);
  const [isValidToken, setIsValidToken] = useState<boolean>(false);
  const [isLoading, setIsLoading] = useState<boolean>(true);

  // Extract token from URL parameters
  useEffect(() => {
    const params = new URLSearchParams(window.location.search);
    const tokenParam = params.get("token");
    setToken(tokenParam);

    // In a real implementation, we would validate the token with the backend
    // For now, we'll simulate this process
    const validateToken = async () => {
      setIsLoading(true);

      try {
        if (!tokenParam) {
          throw new Error("Brak wymaganego tokenu resetowania hasła.");
        }

        // Simulate API request delay
        await new Promise((resolve) => setTimeout(resolve, 1000));

        // Simulate token validation
        // In a real implementation, we would make an API call to validate the token
        if (tokenParam === "invalid-token") {
          throw new Error("Token resetowania hasła jest nieprawidłowy lub wygasł.");
        }

        setIsValidToken(true);
      } catch (error) {
        console.error("Token validation error:", error);
        setApiError(error instanceof Error ? error.message : "Wystąpił nieoczekiwany błąd.");
        setIsValidToken(false);
      } finally {
        setIsLoading(false);
      }
    };

    validateToken();
  }, []);

  const handleResetPassword = async (password: string) => {
    setIsSubmitting(true);
    setApiError(null);

    try {
      if (!token) {
        throw new Error("Brak wymaganego tokenu resetowania hasła.");
      }

      // This is just a placeholder - actual password reset logic will be implemented later
      console.log(
        "Password reset attempt with token:",
        token,
        "and new password:",
        password.length > 0 ? "********" : ""
      );

      // Simulate API request delay
      await new Promise((resolve) => setTimeout(resolve, 1000));

      // For now, we'll add a simple simulation to show the UI flow
      if (token === "error-token") {
        throw new Error("Nie udało się zresetować hasła. Spróbuj ponownie później.");
      }

      // Show success message
      setSuccessMessage("Twoje hasło zostało pomyślnie zresetowane. Możesz teraz zalogować się używając nowego hasła.");
    } catch (error) {
      console.error("Password reset error:", error);
      setApiError(error instanceof Error ? error.message : "Wystąpił nieoczekiwany błąd.");
    } finally {
      setIsSubmitting(false);
    }
  };

  // Show loading state while validating token
  if (isLoading) {
    return (
      <div className="text-center py-8">
        <div className="animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"></div>
        <p>Weryfikacja tokenu resetowania hasła...</p>
      </div>
    );
  }

  // Show error if token is invalid
  if (!isValidToken) {
    return (
      <div className="bg-destructive/10 border border-destructive/30 rounded-lg p-4 text-center">
        <h2 className="text-lg font-semibold text-destructive mb-2">Nieprawidłowy token</h2>
        <p className="mb-4">{apiError || "Link do resetowania hasła jest nieprawidłowy lub wygasł."}</p>
        <p>
          <a href="/recover" className="font-medium text-primary underline-offset-4 hover:underline">
            Wyślij nowy link resetowania hasła
          </a>
        </p>
      </div>
    );
  }

  // Show the reset password form
  return (
    <ResetPasswordForm
      onSubmit={handleResetPassword}
      isSubmitting={isSubmitting}
      apiError={apiError}
      successMessage={successMessage}
    />
  );
};

export default ResetPasswordView;



================================================
File: src/components/auth/SetNewPasswordForm.tsx
================================================
import React from "react";
import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import * as z from "zod";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Card, CardContent, CardFooter, CardHeader } from "@/components/ui/card";
import { Alert, AlertDescription, AlertTitle } from "@/components/ui/alert";
import { ReloadIcon } from "@radix-ui/react-icons";
import { CheckCircledIcon } from "@radix-ui/react-icons";

// Schema walidacji formularza
const setNewPasswordSchema = z
  .object({
    password: z
      .string()
      .min(8, "Hasło musi mieć co najmniej 8 znaków")
      .regex(/[a-z]/, "Hasło musi zawierać co najmniej jedną małą literę")
      .regex(/[A-Z]/, "Hasło musi zawierać co najmniej jedną dużą literę")
      .regex(/[0-9]/, "Hasło musi zawierać co najmniej jedną cyfrę")
      .regex(/[^a-zA-Z0-9]/, "Hasło musi zawierać co najmniej jeden znak specjalny"),
    confirmPassword: z.string().min(1, "Potwierdzenie hasła jest wymagane"),
  })
  .refine((data) => data.password === data.confirmPassword, {
    message: "Hasła muszą być identyczne",
    path: ["confirmPassword"],
  });

type SetNewPasswordFormValues = z.infer<typeof setNewPasswordSchema>;

interface SetNewPasswordFormProps {
  onSubmit: (password: string) => Promise<void>;
  isSubmitting: boolean;
  apiError: string | null;
  successMessage: string | null;
  disabled?: boolean;
}

const SetNewPasswordForm: React.FC<SetNewPasswordFormProps> = ({
  onSubmit,
  isSubmitting,
  apiError,
  successMessage,
  disabled = false,
}) => {
  const form = useForm<SetNewPasswordFormValues>({
    resolver: zodResolver(setNewPasswordSchema),
    defaultValues: {
      password: "",
      confirmPassword: "",
    },
  });

  const handleFormSubmit = (values: SetNewPasswordFormValues) => {
    onSubmit(values.password);
  };

  return (
    <Card>
      <CardHeader>{/* <CardTitle>Ustaw nowe hasło</CardTitle> */}</CardHeader>
      <CardContent>
        {successMessage ? (
          <Alert variant="default">
            <CheckCircledIcon className="h-4 w-4" />
            <AlertTitle>Sukces!</AlertTitle>
            <AlertDescription>{successMessage}</AlertDescription>
          </Alert>
        ) : (
          <form onSubmit={form.handleSubmit(handleFormSubmit)} className="space-y-4">
            <p className="text-sm text-muted-foreground">Wprowadź nowe hasło dla swojego konta.</p>
            {apiError && (
              <Alert variant="destructive">
                <AlertTitle>Błąd</AlertTitle>
                <AlertDescription>{apiError}</AlertDescription>
              </Alert>
            )}
            <div className="space-y-2">
              <Label htmlFor="password">Nowe hasło</Label>
              <Input id="password" type="password" {...form.register("password")} disabled={isSubmitting || disabled} />
              {form.formState.errors.password && (
                <p className="text-sm text-destructive">{form.formState.errors.password.message}</p>
              )}
            </div>
            <div className="space-y-2">
              <Label htmlFor="confirmPassword">Potwierdź nowe hasło</Label>
              <Input
                id="confirmPassword"
                type="password"
                {...form.register("confirmPassword")}
                disabled={isSubmitting || disabled}
              />
              {form.formState.errors.confirmPassword && (
                <p className="text-sm text-destructive">{form.formState.errors.confirmPassword.message}</p>
              )}
            </div>
            <Button type="submit" className="w-full" disabled={isSubmitting || disabled}>
              {isSubmitting && <ReloadIcon className="mr-2 h-4 w-4 animate-spin" />}
              Ustaw nowe hasło
            </Button>
          </form>
        )}
      </CardContent>
      <CardFooter className="flex flex-col space-y-2 text-sm">
        {successMessage && (
          <p>
            <a href="/login" className="font-medium text-primary underline-offset-4 hover:underline">
              Przejdź do logowania
            </a>
          </p>
        )}
      </CardFooter>
    </Card>
  );
};

export default SetNewPasswordForm;



================================================
File: src/components/auth/SetNewPasswordView.tsx
================================================
import React, { useState, useEffect } from "react";
import { PageHeader } from "../PageHeader";
import SetNewPasswordForm from "./SetNewPasswordForm";

const SetNewPasswordView: React.FC = () => {
  const [accessToken, setAccessToken] = useState<string | null>(null);
  const [tokenError, setTokenError] = useState<string | null>(null);
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [apiError, setApiError] = useState<string | null>(null);
  const [successMessage, setSuccessMessage] = useState<string | null>(null);

  useEffect(() => {
    // This runs only on the client after mount
    try {
      const hash = window.location.hash.substring(1); // Remove leading #
      const params = new URLSearchParams(hash);
      const token = params.get("access_token");

      if (token) {
        setAccessToken(token);
        console.log("Access token found in URL hash.");
      } else {
        console.error("Access token not found in URL hash.");
        setTokenError("Nie znaleziono wymaganego tokenu w adresie URL. Upewnij się, że link jest poprawny.");
      }
    } catch (e) {
      console.error("Error parsing URL hash:", e);
      setTokenError("Wystąpił błąd podczas przetwarzania linku resetującego.");
    }
  }, []); // Empty dependency array ensures this runs only once on mount

  const handleSetPassword = async (password: string) => {
    if (!accessToken) {
      setApiError("Brak tokenu dostępu do wysłania żądania.");
      return;
    }

    setIsSubmitting(true);
    setApiError(null);
    setSuccessMessage(null);
    console.log("Attempting to set new password...");

    try {
      const response = await fetch("/api/auth/set-new-password", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({ accessToken, password }),
      });

      const responseData: { message?: string; error?: unknown; errors?: unknown } = await response
        .json()
        .catch(() => ({}));

      if (!response.ok) {
        let errorMessage = `Błąd ustawiania hasła (${response.status})`;
        if (typeof responseData === "object" && responseData !== null) {
          errorMessage =
            responseData.message ||
            (responseData.errors ? JSON.stringify(responseData.errors) : undefined) ||
            (responseData.error ? String(responseData.error) : undefined) ||
            errorMessage;
        }
        console.error("Set new password API error details:", responseData);
        throw new Error(String(errorMessage));
      }

      setSuccessMessage(responseData.message || "Hasło zostało pomyślnie zaktualizowane.");
      console.log("Set new password successful:", responseData.message);
    } catch (error) {
      console.error("Set new password fetch error:", error);
      setApiError(error instanceof Error ? error.message : "Wystąpił nieoczekiwany błąd.");
    } finally {
      setIsSubmitting(false);
    }
  };

  // Render based on token status and API status
  if (tokenError) {
    return (
      <div className="text-center text-destructive">
        <p>{tokenError}</p>
        <a href="/reset-password" className="text-primary hover:underline mt-4 inline-block">
          Poproś o nowy link
        </a>
      </div>
    );
  }

  if (!accessToken && !tokenError) {
    // Still waiting for useEffect to run and parse token
    return <p className="text-center text-muted-foreground">Wczytywanie...</p>;
  }

  return (
    <>
      <PageHeader title="Ustaw nowe hasło" />
      <SetNewPasswordForm
        onSubmit={handleSetPassword}
        isSubmitting={isSubmitting}
        apiError={apiError}
        successMessage={successMessage}
      />
    </>
  );
};

export default SetNewPasswordView;



================================================
File: src/components/features/shopping-list/ProductInputArea.tsx
================================================
import React, { useState } from "react";
import { Button } from "@/components/ui/button";
import { Textarea } from "@/components/ui/textarea";
import { showErrorToast, showSuccessToast } from "@/lib/services/toast-service";

interface ProductInputAreaProps {
  listId: string;
  onAddItems: (items: { name: string; purchased: boolean }[]) => Promise<void>;
}

interface Product {
  name: string;
  purchased: boolean;
}

const ProductInputArea: React.FC<ProductInputAreaProps> = ({ listId, onAddItems }) => {
  const [textareaValue, setTextareaValue] = useState("");
  const [isAdding, setIsAdding] = useState(false);

  const handleTextareaChange = (event: React.ChangeEvent<HTMLTextAreaElement>) => {
    setTextareaValue(event.target.value);
  };

  const handleAddClick = async () => {
    const trimmedValue = textareaValue.trim();
    if (!trimmedValue) return;

    setIsAdding(true);

    try {
      console.log("[ProductInputArea] Starting AI parse for list:", listId);
      const text = trimmedValue;
      if (!text) {
        showErrorToast("Input is empty", { description: "Please enter some text to parse." });
        return;
      }

      // Use the new, simplified API endpoint
      const response = await fetch(`/api/shopping-lists/${listId}/ai-parse`, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        credentials: "include", // Send cookies for authentication
        body: JSON.stringify({ text }),
      });

      console.log("[ProductInputArea] AI parse response status:", response.status);

      const responseData = await response.json();

      if (!response.ok) {
        console.error("[ProductInputArea] Błąd API:", responseData);
        throw new Error(responseData.error || responseData.details || "Failed to process text with AI");
      }

      console.log(
        "[ProductInputArea] Pomyślnie przetworzono tekst, znaleziono produktów:",
        responseData.products?.length || 0
      );

      // Przetwarzanie produktów z uwzględnieniem statusu purchased
      const products: Product[] = responseData.products.map((product: Product) => ({
        name: product.name,
        purchased: product.purchased || false,
      }));

      // Add products to the list
      await onAddItems(products);

      // Powiadomienie o pomyślnej operacji
      showSuccessToast("Lista zaktualizowana", {
        description: `Zaktualizowano listę zakupów o ${products.length} ${
          products.length === 1 ? "produkt" : products.length < 5 ? "produkty" : "produktów"
        }`,
      });

      setTextareaValue("");

      // Usunięto odświeżenie widoku poprzez przeładowanie strony
      // window.location.href = `${window.location.pathname}?_t=${Date.now()}`;
    } catch (error) {
      console.error("[ProductInputArea] Error:", error);
      showErrorToast("Błąd podczas przetwarzania tekstu", {
        description: error instanceof Error ? error.message : "Nieznany błąd podczas przetwarzania tekstu",
      });
    } finally {
      setIsAdding(false);
    }
  };

  return (
    <div className="p-4 border rounded-lg shadow-sm bg-card">
      <h3 className="text-lg font-medium mb-2">Dodaj nowe produkty</h3>
      <p className="text-sm text-muted-foreground mb-3">Powiedz co chcesz kupić przy najbliższych zakupach..</p>
      <Textarea
        placeholder="Napisz lub podyktuj Twoją listę zakupów, obojętnie jak.. nasz agent AI zajmie się resztą.. :-)"
        value={textareaValue}
        onChange={handleTextareaChange}
        className="mb-3 min-h-[80px]"
        disabled={isAdding}
      />
      <Button onClick={handleAddClick} disabled={!textareaValue.trim() || isAdding}>
        {isAdding ? "Przetwarzanie..." : "Dodaj produkty"}
      </Button>
    </div>
  );
};

export default ProductInputArea;



================================================
File: src/components/features/shopping-list/ProductItem.tsx
================================================
import React, { useState, useEffect } from "react";
import { Checkbox } from "@/components/ui/checkbox";
import { Input } from "@/components/ui/input";
import { Button } from "@/components/ui/button";
import { Trash2 } from "lucide-react"; // Ikona kosza
import type { ProductItemViewModel } from "@/lib/hooks/useShoppingListDetail";

interface ProductItemProps {
  item: ProductItemViewModel;
  listId: string; // Potrzebne dla API
  // Funkcje obsługi zdarzeń z hooka
  onTogglePurchase: (itemId: string) => Promise<void>;
  onUpdateName: (itemId: string, newName: string) => Promise<void>;
  onDeleteItem: (itemId: string) => Promise<void>;
}

const ProductItem: React.FC<ProductItemProps> = ({ item, listId, onTogglePurchase, onUpdateName, onDeleteItem }) => {
  const [isEditingName, setIsEditingName] = useState(false);
  const [currentName, setCurrentName] = useState(item.itemName);

  // Aktualizuj stan wewnętrzny nazwy, jeśli zmieni się z zewnątrz
  useEffect(() => {
    setCurrentName(item.itemName);
  }, [item.itemName]);

  // --- Obsługa edycji nazwy ---
  const handleNameClick = () => {
    if (item.purchased) return; // Nie edytuj zakupionych
    setIsEditingName(true);
  };

  const handleNameChange = (event: React.ChangeEvent<HTMLInputElement>) => {
    setCurrentName(event.target.value);
  };

  const handleNameBlur = async () => {
    setIsEditingName(false);
    const trimmedName = currentName.trim();
    if (trimmedName && trimmedName !== item.itemName) {
      // TODO: Dodać walidację długości (1-128)
      try {
        await onUpdateName(item.id, trimmedName);
        // Stan lokalny zostanie zaktualizowany przez useEffect, gdy prop `item.itemName` się zmieni
      } catch (error) {
        console.error("Failed to update item name:", error);
        setCurrentName(item.itemName); // Przywróć starą nazwę w razie błędu
      }
    } else {
      // Jeśli bez zmian lub pusty, przywróć oryginał
      setCurrentName(item.itemName);
    }
  };

  const handleNameKeyDown = (event: React.KeyboardEvent<HTMLInputElement>) => {
    if (event.key === "Enter") {
      handleNameBlur();
    } else if (event.key === "Escape") {
      setCurrentName(item.itemName);
      setIsEditingName(false);
    }
  };

  // --- Obsługa Checkboxa ---
  const handleCheckboxChange = async () => {
    try {
      await onTogglePurchase(item.id);
    } catch (error) {
      console.error("Failed to toggle purchase status:", error);
      // Stan UI zostanie przywrócony przez hook w razie błędu (optymistyczne UI)
    }
  };

  // --- Obsługa usuwania ---
  const handleDeleteClick = async () => {
    // TODO: Dodać potwierdzenie usunięcia?
    try {
      await onDeleteItem(item.id);
    } catch (error) {
      console.error("Failed to delete item:", error);
      // Stan UI zostanie obsłużony przez hook (optymistyczne UI)
    }
  };

  return (
    <div
      className={`flex items-center space-x-2 p-2 border rounded-md transition-colors ${
        item.purchased ? "bg-muted/50 text-muted-foreground" : "bg-card"
      } ${
        item.isUpdating ? "opacity-50 pointer-events-none" : "" // Wskaźnik ładowania
      }`}
    >
      <Checkbox
        id={`item-${item.id}`}
        checked={item.purchased}
        onCheckedChange={handleCheckboxChange}
        disabled={item.isUpdating || isEditingName} // Wyłącz podczas aktualizacji lub edycji nazwy
        aria-label={`Oznacz ${item.itemName} jako ${item.purchased ? "niekupiony" : "kupiony"}`}
      />
      <div className="flex-grow">
        {isEditingName ? (
          <Input
            type="text"
            value={currentName}
            onChange={handleNameChange}
            onBlur={handleNameBlur}
            onKeyDown={handleNameKeyDown}
            className={`h-8 text-sm ${item.purchased ? "line-through" : ""}`}
            disabled={item.isUpdating}
          />
        ) : (
          <Button
            variant="link"
            onClick={handleNameClick}
            title={item.purchased ? item.itemName : "Kliknij lub użyj Enter/Spacji, aby edytować"}
            className={`text-sm h-auto p-0 font-normal text-left justify-start whitespace-normal ${item.purchased ? "line-through text-muted-foreground cursor-default" : "hover:bg-secondary/80 px-1 py-0.5 rounded-sm"}`}
            disabled={item.purchased || item.isUpdating}
          >
            {item.itemName}
          </Button>
        )}
      </div>
      <Button
        variant="ghost"
        size="icon"
        onClick={handleDeleteClick}
        disabled={item.isUpdating || isEditingName} // Wyłącz podczas aktualizacji lub edycji nazwy
        className="h-8 w-8 text-muted-foreground hover:text-destructive hover:bg-destructive/10"
        aria-label={`Usuń ${item.itemName}`}
      >
        <Trash2 className="h-4 w-4" />
      </Button>
    </div>
  );
};

export default ProductItem;



================================================
File: src/components/features/shopping-list/ProductList.tsx
================================================
import React from "react";
// Importuj definicję typu ViewModel, jeśli nie jest globalna
import type { ProductItemViewModel } from "@/lib/hooks/useShoppingListDetail"; // Załóżmy, że typ jest eksportowany z hooka
import ProductItem from "./ProductItem"; // Importuj ProductItem

interface ProductListProps {
  items: ProductItemViewModel[];
  listId: string; // Będzie potrzebne do przekazania do ProductItem
  onTogglePurchase: (itemId: string) => Promise<void>; // Odbierz prawdziwą funkcję
  onUpdateName: (itemId: string, newName: string) => Promise<void>; // Odbierz prawdziwą funkcję
  onDeleteItem: (itemId: string) => Promise<void>; // Odbierz prawdziwą funkcję
}

const ProductList: React.FC<ProductListProps> = ({
  items,
  listId,
  onTogglePurchase, // Użyj przekazanej funkcji
  onUpdateName, // Użyj przekazanej funkcji
  onDeleteItem, // Użyj przekazanej funkcji
}) => {
  // Sortowanie: niezakupione najpierw, potem zakupione. W obrębie grup można dodać sortowanie np. po dacie dodania.
  const sortedItems = React.useMemo(() => {
    return [...items].sort((a, b) => {
      if (a.purchased === b.purchased) {
        // Jeśli oba mają ten sam status, sortuj np. po dacie dodania (jeśli dostępna i potrzebna)
        // return new Date(a.createdAt).getTime() - new Date(b.createdAt).getTime();
        return 0; // Na razie brak dodatkowego sortowania
      }
      return a.purchased ? 1 : -1; // purchased: true idą na koniec
    });
  }, [items]);

  if (!items || items.length === 0) {
    return <p className="text-muted-foreground italic">Ta lista jest pusta. Dodaj produkty poniżej.</p>;
  }

  return (
    <div className="space-y-2">
      {sortedItems.map((item) => (
        // Użyj komponentu ProductItem
        <ProductItem
          key={item.id}
          item={item}
          listId={listId} // Przekaż listId
          onTogglePurchase={onTogglePurchase} // Przekaż dalej
          onUpdateName={onUpdateName} // Przekaż dalej
          onDeleteItem={onDeleteItem} // Przekaż dalej
        />
      ))}
    </div>
  );
};

export default ProductList;



================================================
File: src/components/layouts/MainLayoutContent.tsx
================================================
import * as React from "react";
import AuthStatus from "@/components/auth/AuthStatus";
import { ToastProvider } from "@/components/ToastProvider";
import { AuthProvider } from "@/lib/auth/AuthContext";

interface MainLayoutContentProps {
  children: React.ReactNode;
}

const MainLayoutContent: React.FC<MainLayoutContentProps> = ({ children }) => {
  // This component renders the structure previously in MainLayout.astro's body,
  // but now within a single React component tree.
  return (
    <AuthProvider>
      <div className="flex h-full min-h-screen flex-col md:flex-row">
        {/* Sidebar */}
        <div className="w-64 border-r hidden md:block p-4 flex flex-col justify-between">
          <div>
            <div className="text-xl font-bold mb-6">ShopListeo</div>
            <nav className="space-y-2">
              <a href="/" className="flex items-center p-2 rounded-lg hover:bg-muted text-foreground">
                Listy zakupów
              </a>
              {/* Add more nav links here */}
            </nav>
          </div>

          {/* Auth Status Area - Now rendered directly within the React tree */}
          <div id="auth-status-area" className="mt-auto text-sm text-muted-foreground p-2 border-t">
            <AuthStatus /> {/* No client directive needed here */}
          </div>
        </div>

        {/* Main Content Area - Wrapped with ToastProvider */}
        <main className="flex-1 overflow-auto p-6">
          <ToastProvider>{children}</ToastProvider> {/* Wrap children (slot content) */}
        </main>
      </div>
    </AuthProvider>
  );
};

export default MainLayoutContent;



================================================
File: src/components/shared/EditableShoppingListTitle.tsx
================================================
import React, { useState, useEffect } from "react";
import { Input } from "@/components/ui/input"; // Poprawiony import
import { Button } from "@/components/ui/button"; // Importuj Button

interface EditableShoppingListTitleProps {
  initialTitle: string;
  listId: string; // Będzie potrzebne do wywołania API w przyszłości
  onUpdateTitle: (newTitle: string) => Promise<void>; // Odkomentowano i dodano typ
}

const EditableShoppingListTitle: React.FC<EditableShoppingListTitleProps> = ({
  initialTitle,
  listId,
  onUpdateTitle, // Odbierz prop
}) => {
  const [isEditing, setIsEditing] = useState(false);
  const [currentTitle, setCurrentTitle] = useState(initialTitle);
  const [isSaving, setIsSaving] = useState(false); // Stan ładowania zapisu

  // Aktualizuj stan wewnętrzny, jeśli initialTitle zmieni się z zewnątrz
  useEffect(() => {
    setCurrentTitle(initialTitle);
  }, [initialTitle]);

  // Rozpocznij edycję po kliknięciu
  const handleTitleClick = () => {
    setIsEditing(true);
  };

  const handleSave = async () => {
    const trimmedTitle = currentTitle.trim();

    // Podstawowa walidacja
    if (!trimmedTitle || trimmedTitle === initialTitle) {
      setIsEditing(false);
      setCurrentTitle(initialTitle); // Przywróć oryginał, jeśli pusty lub bez zmian
      return;
    }
    // TODO: Dodać lepszą obsługę błędów walidacji (np. komunikat)
    if (trimmedTitle.length > 255) {
      console.error("Title too long");
      // Tutaj można by ustawić stan błędu i wyświetlić go
      return; // Nie zapisuj
    }

    setIsSaving(true);
    try {
      await onUpdateTitle(trimmedTitle);
      setIsEditing(false);
      // Stan `currentTitle` zostanie zaktualizowany przez `useEffect`, gdy `initialTitle` się zmieni
    } catch (error) {
      console.error("Failed to update title:", error);
      // Opcjonalnie: Pokaż błąd użytkownikowi
      // Wracamy do stanu edycji z niezmienioną wartością?
      // Albo przywracamy initialTitle?
      setCurrentTitle(initialTitle); // Na razie przywracamy oryginał
      setIsEditing(false); // Kończymy edycję mimo błędu
    } finally {
      setIsSaving(false);
    }
  };

  // Zapisz zmiany po naciśnięciu Enter lub Spacji (dla przycisku)
  const handleBlur = () => {
    // Wywołaj zapis przy utracie fokusa
    handleSave();
  };

  // Zapisz zmiany po naciśnięciu Enter lub Spacji (dla przycisku)
  const handleKeyDown = (event: React.KeyboardEvent<HTMLInputElement>) => {
    if (event.key === "Enter") {
      event.preventDefault();
      handleSave(); // Wywołaj zapis przy Enter
    } else if (event.key === "Escape") {
      setCurrentTitle(initialTitle);
      setIsEditing(false);
    }
  };

  // Aktualizuj wartość w inpucie podczas edycji
  const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {
    setCurrentTitle(event.target.value);
  };

  return (
    <div>
      {isEditing ? (
        <Input
          type="text"
          value={currentTitle}
          onChange={handleChange}
          onBlur={handleBlur}
          onKeyDown={handleKeyDown}
          disabled={isSaving}
          className="text-xl font-semibold h-auto p-1"
          aria-busy={isSaving}
        />
      ) : (
        <Button
          variant="ghost"
          className="text-xl font-semibold cursor-pointer hover:bg-secondary/80 px-2 py-1 h-auto justify-start text-left whitespace-normal"
          onClick={handleTitleClick}
          title="Kliknij lub użyj Enter/Spacji, aby edytować tytuł"
          disabled={isSaving}
        >
          {currentTitle || "(Bez tytułu)"}
        </Button>
      )}
    </div>
  );
};

export default EditableShoppingListTitle;



================================================
File: src/components/shopping-lists/CreateListButton.tsx
================================================
import { Button } from "../ui/button";
import { PlusIcon } from "lucide-react";
import { useCallback } from "react";

interface CreateListButtonProps {
  onCreateList: () => Promise<void>;
  isCreating: boolean;
}

export function CreateListButton({ onCreateList, isCreating }: CreateListButtonProps) {
  // Używamy useCallback zgodnie z wytycznymi (react.mdc)
  const handleClick = useCallback(() => {
    onCreateList();
  }, [onCreateList]);

  return (
    <Button onClick={handleClick} disabled={isCreating} className="flex items-center gap-2">
      <PlusIcon className="h-4 w-4" />
      Nowa lista
      {isCreating && (
        <span className="ml-2 inline-block h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent" />
      )}
    </Button>
  );
}



================================================
File: src/components/shopping-lists/ShoppingListItem.tsx
================================================
import { Button } from "../ui/button";
import { Trash2Icon, ShoppingBagIcon } from "lucide-react";
import { useState, useCallback, memo } from "react";
import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
  AlertDialogTrigger,
} from "../ui/alert-dialog";
import { Card, CardContent, CardFooter, CardHeader } from "../ui/card";
import type { ShoppingListSummaryDTO } from "../../types";

interface ShoppingListItemViewModel extends ShoppingListSummaryDTO {
  isDeleting: boolean;
}

interface ShoppingListItemProps {
  list: ShoppingListItemViewModel;
  onDeleteList: (listId: string) => Promise<void>;
}

// Używamy memo zgodnie z wytycznymi (react.mdc)
export const ShoppingListItem = memo(function ShoppingListItem({ list, onDeleteList }: ShoppingListItemProps) {
  const [isConfirmOpen, setIsConfirmOpen] = useState(false);

  // Formatowanie daty utworzenia
  const formattedDate = new Date(list.createdAt).toLocaleDateString("pl-PL", {
    year: "numeric",
    month: "long",
    day: "numeric",
  });

  // Handler do usuwania listy
  const handleDelete = useCallback(async () => {
    await onDeleteList(list.id);
    setIsConfirmOpen(false);
  }, [list.id, onDeleteList]);

  return (
    <Card className={`transition-opacity ${list.isDeleting ? "opacity-50" : ""} hover:shadow-md dark:hover:bg-muted/5`}>
      <CardHeader className="pb-2 flex sm:flex-row flex-col justify-between items-start gap-2">
        <div className="flex items-center gap-2">
          <ShoppingBagIcon className="h-5 w-5 text-primary" />
          <a href={`/list/${list.id}`} className="text-xl font-medium hover:underline">
            {list.title}
          </a>
        </div>
        <div className="text-sm text-muted-foreground">Utworzono: {formattedDate}</div>
      </CardHeader>

      <CardContent className="pb-2">
        <div className="flex justify-between items-center">
          <div className="text-sm mt-1">
            Liczba elementów: <span className="font-medium">{list.itemCount}</span>
          </div>
          <div className="hidden sm:block">
            <AlertDialog open={isConfirmOpen} onOpenChange={setIsConfirmOpen}>
              <AlertDialogTrigger asChild>
                <Button variant="destructive" size="sm" className="flex items-center gap-1" disabled={list.isDeleting}>
                  <Trash2Icon className="h-4 w-4" />
                  <span>Usuń</span>
                  {list.isDeleting && (
                    <span className="ml-1 inline-block h-3 w-3 animate-spin rounded-full border-2 border-current border-t-transparent" />
                  )}
                </Button>
              </AlertDialogTrigger>

              <AlertDialogContent>
                <AlertDialogHeader>
                  <AlertDialogTitle>Czy na pewno chcesz usunąć tę listę?</AlertDialogTitle>
                  <AlertDialogDescription>
                    Lista &quot;{list.title}&quot; zostanie usunięta wraz ze wszystkimi elementami. Tej operacji nie
                    można cofnąć.
                  </AlertDialogDescription>
                </AlertDialogHeader>
                <AlertDialogFooter>
                  <AlertDialogCancel>Anuluj</AlertDialogCancel>
                  <AlertDialogAction onClick={handleDelete}>Usuń</AlertDialogAction>
                </AlertDialogFooter>
              </AlertDialogContent>
            </AlertDialog>
          </div>
        </div>
      </CardContent>

      <CardFooter className="pt-2 flex justify-end sm:hidden">
        <AlertDialog open={isConfirmOpen} onOpenChange={setIsConfirmOpen}>
          <AlertDialogTrigger asChild>
            <Button variant="destructive" size="sm" className="flex items-center gap-1" disabled={list.isDeleting}>
              <Trash2Icon className="h-4 w-4" />
              <span>Usuń</span>
              {list.isDeleting && (
                <span className="ml-1 inline-block h-3 w-3 animate-spin rounded-full border-2 border-current border-t-transparent" />
              )}
            </Button>
          </AlertDialogTrigger>

          <AlertDialogContent>
            <AlertDialogHeader>
              <AlertDialogTitle>Czy na pewno chcesz usunąć tę listę?</AlertDialogTitle>
              <AlertDialogDescription>
                Lista &quot;{list.title}&quot; zostanie usunięta wraz ze wszystkimi elementami. Tej operacji nie można
                cofnąć.
              </AlertDialogDescription>
            </AlertDialogHeader>
            <AlertDialogFooter>
              <AlertDialogCancel>Anuluj</AlertDialogCancel>
              <AlertDialogAction onClick={handleDelete}>Usuń</AlertDialogAction>
            </AlertDialogFooter>
          </AlertDialogContent>
        </AlertDialog>
      </CardFooter>
    </Card>
  );
});



================================================
File: src/components/shopping-lists/ShoppingLists.tsx
================================================
import { ShoppingListItem } from "./ShoppingListItem";
import type { ShoppingListSummaryDTO } from "../../types";

interface ShoppingListItemViewModel extends ShoppingListSummaryDTO {
  isDeleting: boolean;
}

interface ShoppingListsProps {
  lists: ShoppingListItemViewModel[];
  isLoading: boolean;
  onDeleteList: (listId: string) => Promise<void>;
}

export function ShoppingLists({ lists, isLoading, onDeleteList }: ShoppingListsProps) {
  // Gdy dane są ładowane, wyświetl placeholdery
  if (isLoading && lists.length === 0) {
    return (
      <div className="space-y-4">
        {Array.from({ length: 3 }).map((_, index) => (
          <div key={index} className="animate-pulse p-4 border rounded-lg">
            <div className="h-4 bg-muted rounded w-3/4 mb-2"></div>
            <div className="h-3 bg-muted rounded w-1/4"></div>
          </div>
        ))}
      </div>
    );
  }

  // Gdy brak list po załadowaniu
  if (!isLoading && lists.length === 0) {
    return (
      <div className="text-center p-8 border rounded-lg bg-muted/10">
        <p className="text-lg font-medium mb-2">Brak list zakupów</p>
        <p className="text-muted-foreground">
          Kliknij przycisk "Nowa lista", aby utworzyć swoją pierwszą listę zakupów.
        </p>
      </div>
    );
  }

  // Wyświetlenie list zakupów
  return (
    <div className="space-y-4">
      {lists.map((list) => (
        <ShoppingListItem key={list.id} list={list} onDeleteList={onDeleteList} />
      ))}
    </div>
  );
}



================================================
File: src/components/ui/PageHeader.tsx
================================================
interface PageHeaderProps {
  title: string;
}

export function PageHeader({ title }: PageHeaderProps) {
  return <h1 className="text-2xl font-bold tracking-tight sm:text-3xl">{title}</h1>;
}



================================================
File: src/components/ui/alert-dialog.tsx
================================================
import * as React from "react"
import * as AlertDialogPrimitive from "@radix-ui/react-alert-dialog"

import { cn } from "@/lib/utils"
import { buttonVariants } from "@/components/ui/button"

function AlertDialog({
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Root>) {
  return <AlertDialogPrimitive.Root data-slot="alert-dialog" {...props} />
}

function AlertDialogTrigger({
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Trigger>) {
  return (
    <AlertDialogPrimitive.Trigger data-slot="alert-dialog-trigger" {...props} />
  )
}

function AlertDialogPortal({
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Portal>) {
  return (
    <AlertDialogPrimitive.Portal data-slot="alert-dialog-portal" {...props} />
  )
}

function AlertDialogOverlay({
  className,
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Overlay>) {
  return (
    <AlertDialogPrimitive.Overlay
      data-slot="alert-dialog-overlay"
      className={cn(
        "data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",
        className
      )}
      {...props}
    />
  )
}

function AlertDialogContent({
  className,
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Content>) {
  return (
    <AlertDialogPortal>
      <AlertDialogOverlay />
      <AlertDialogPrimitive.Content
        data-slot="alert-dialog-content"
        className={cn(
          "bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",
          className
        )}
        {...props}
      />
    </AlertDialogPortal>
  )
}

function AlertDialogHeader({
  className,
  ...props
}: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-dialog-header"
      className={cn("flex flex-col gap-2 text-center sm:text-left", className)}
      {...props}
    />
  )
}

function AlertDialogFooter({
  className,
  ...props
}: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-dialog-footer"
      className={cn(
        "flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",
        className
      )}
      {...props}
    />
  )
}

function AlertDialogTitle({
  className,
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Title>) {
  return (
    <AlertDialogPrimitive.Title
      data-slot="alert-dialog-title"
      className={cn("text-lg font-semibold", className)}
      {...props}
    />
  )
}

function AlertDialogDescription({
  className,
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Description>) {
  return (
    <AlertDialogPrimitive.Description
      data-slot="alert-dialog-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

function AlertDialogAction({
  className,
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Action>) {
  return (
    <AlertDialogPrimitive.Action
      className={cn(buttonVariants(), className)}
      {...props}
    />
  )
}

function AlertDialogCancel({
  className,
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Cancel>) {
  return (
    <AlertDialogPrimitive.Cancel
      className={cn(buttonVariants({ variant: "outline" }), className)}
      {...props}
    />
  )
}

export {
  AlertDialog,
  AlertDialogPortal,
  AlertDialogOverlay,
  AlertDialogTrigger,
  AlertDialogContent,
  AlertDialogHeader,
  AlertDialogFooter,
  AlertDialogTitle,
  AlertDialogDescription,
  AlertDialogAction,
  AlertDialogCancel,
}



================================================
File: src/components/ui/alert.tsx
================================================
import * as React from "react"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const alertVariants = cva(
  "relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",
  {
    variants: {
      variant: {
        default: "bg-card text-card-foreground",
        destructive:
          "text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

function Alert({
  className,
  variant,
  ...props
}: React.ComponentProps<"div"> & VariantProps<typeof alertVariants>) {
  return (
    <div
      data-slot="alert"
      role="alert"
      className={cn(alertVariants({ variant }), className)}
      {...props}
    />
  )
}

function AlertTitle({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-title"
      className={cn(
        "col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",
        className
      )}
      {...props}
    />
  )
}

function AlertDescription({
  className,
  ...props
}: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-description"
      className={cn(
        "text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",
        className
      )}
      {...props}
    />
  )
}

export { Alert, AlertTitle, AlertDescription }



================================================
File: src/components/ui/avatar.tsx
================================================
import * as React from "react"
import * as AvatarPrimitive from "@radix-ui/react-avatar"

import { cn } from "@/lib/utils"

function Avatar({
  className,
  ...props
}: React.ComponentProps<typeof AvatarPrimitive.Root>) {
  return (
    <AvatarPrimitive.Root
      data-slot="avatar"
      className={cn(
        "relative flex size-8 shrink-0 overflow-hidden rounded-full",
        className
      )}
      {...props}
    />
  )
}

function AvatarImage({
  className,
  ...props
}: React.ComponentProps<typeof AvatarPrimitive.Image>) {
  return (
    <AvatarPrimitive.Image
      data-slot="avatar-image"
      className={cn("aspect-square size-full", className)}
      {...props}
    />
  )
}

function AvatarFallback({
  className,
  ...props
}: React.ComponentProps<typeof AvatarPrimitive.Fallback>) {
  return (
    <AvatarPrimitive.Fallback
      data-slot="avatar-fallback"
      className={cn(
        "bg-muted flex size-full items-center justify-center rounded-full",
        className
      )}
      {...props}
    />
  )
}

export { Avatar, AvatarImage, AvatarFallback }



================================================
File: src/components/ui/button.tsx
================================================
import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const buttonVariants = cva(
  "inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",
  {
    variants: {
      variant: {
        default:
          "bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",
        destructive:
          "bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",
        outline:
          "border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",
        secondary:
          "bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",
        ghost:
          "hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",
        link: "text-primary underline-offset-4 hover:underline",
      },
      size: {
        default: "h-9 px-4 py-2 has-[>svg]:px-3",
        sm: "h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",
        lg: "h-10 rounded-md px-6 has-[>svg]:px-4",
        icon: "size-9",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

function Button({
  className,
  variant,
  size,
  asChild = false,
  ...props
}: React.ComponentProps<"button"> &
  VariantProps<typeof buttonVariants> & {
    asChild?: boolean
  }) {
  const Comp = asChild ? Slot : "button"

  return (
    <Comp
      data-slot="button"
      className={cn(buttonVariants({ variant, size, className }))}
      {...props}
    />
  )
}

export { Button, buttonVariants }



================================================
File: src/components/ui/card.tsx
================================================
import * as React from "react"

import { cn } from "@/lib/utils"

function Card({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card"
      className={cn(
        "bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",
        className
      )}
      {...props}
    />
  )
}

function CardHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-header"
      className={cn(
        "@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",
        className
      )}
      {...props}
    />
  )
}

function CardTitle({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-title"
      className={cn("leading-none font-semibold", className)}
      {...props}
    />
  )
}

function CardDescription({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

function CardAction({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-action"
      className={cn(
        "col-start-2 row-span-2 row-start-1 self-start justify-self-end",
        className
      )}
      {...props}
    />
  )
}

function CardContent({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-content"
      className={cn("px-6", className)}
      {...props}
    />
  )
}

function CardFooter({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-footer"
      className={cn("flex items-center px-6 [.border-t]:pt-6", className)}
      {...props}
    />
  )
}

export {
  Card,
  CardHeader,
  CardFooter,
  CardTitle,
  CardAction,
  CardDescription,
  CardContent,
}



================================================
File: src/components/ui/checkbox.tsx
================================================
import * as React from "react"
import * as CheckboxPrimitive from "@radix-ui/react-checkbox"
import { CheckIcon } from "lucide-react"

import { cn } from "@/lib/utils"

function Checkbox({
  className,
  ...props
}: React.ComponentProps<typeof CheckboxPrimitive.Root>) {
  return (
    <CheckboxPrimitive.Root
      data-slot="checkbox"
      className={cn(
        "peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",
        className
      )}
      {...props}
    >
      <CheckboxPrimitive.Indicator
        data-slot="checkbox-indicator"
        className="flex items-center justify-center text-current transition-none"
      >
        <CheckIcon className="size-3.5" />
      </CheckboxPrimitive.Indicator>
    </CheckboxPrimitive.Root>
  )
}

export { Checkbox }



================================================
File: src/components/ui/input.tsx
================================================
import * as React from "react"

import { cn } from "@/lib/utils"

function Input({ className, type, ...props }: React.ComponentProps<"input">) {
  return (
    <input
      type={type}
      data-slot="input"
      className={cn(
        "file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
        "focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]",
        "aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",
        className
      )}
      {...props}
    />
  )
}

export { Input }



================================================
File: src/components/ui/label.tsx
================================================
import * as React from "react"
import * as LabelPrimitive from "@radix-ui/react-label"

import { cn } from "@/lib/utils"

function Label({
  className,
  ...props
}: React.ComponentProps<typeof LabelPrimitive.Root>) {
  return (
    <LabelPrimitive.Root
      data-slot="label"
      className={cn(
        "flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",
        className
      )}
      {...props}
    />
  )
}

export { Label }



================================================
File: src/components/ui/sonner.tsx
================================================
import { useTheme } from "next-themes";
import { Toaster as Sonner } from "sonner";

type ToasterProps = React.ComponentProps<typeof Sonner>;

const Toaster = ({ ...props }: ToasterProps) => {
  const { theme = "system" } = useTheme();

  return (
    <Sonner
      theme={theme as "light" | "dark" | "system"}
      className="toaster group"
      style={
        {
          "--normal-bg": "var(--popover)",
          "--normal-text": "var(--popover-foreground)",
          "--normal-border": "var(--border)",
        } as React.CSSProperties
      }
      {...props}
    />
  );
};

export { Toaster };



================================================
File: src/components/ui/textarea.tsx
================================================
import * as React from "react"

import { cn } from "@/lib/utils"

function Textarea({ className, ...props }: React.ComponentProps<"textarea">) {
  return (
    <textarea
      data-slot="textarea"
      className={cn(
        "border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
        className
      )}
      {...props}
    />
  )
}

export { Textarea }



================================================
File: src/components/views/ShoppingListDetailView.tsx
================================================
import * as React from "react";
// Usunięto nieużywane importy useState i useEffect
// Importuj hooka
import { useShoppingListDetail } from "@/lib/hooks/useShoppingListDetail";
import EditableShoppingListTitle from "@/components/shared/EditableShoppingListTitle"; // Importuj nowy komponent
import ProductList from "@/components/features/shopping-list/ProductList"; // Importuj ProductList
import ProductInputArea from "@/components/features/shopping-list/ProductInputArea"; // Importuj ProductInputArea
import { Loader2 } from "lucide-react"; // Ikona ładowania
import { Button } from "@/components/ui/button";
import { ArrowLeft } from "lucide-react";

interface ShoppingListDetailViewProps {
  listId: string;
}

const ShoppingListDetailView: React.FC<ShoppingListDetailViewProps> = ({ listId }) => {
  // Użyj hooka do zarządzania stanem
  const {
    title, // Używamy bezpośrednio title
    items, // Używamy bezpośrednio items
    isLoading,
    error,
    updateTitle,
    toggleItemPurchased,
    deleteItem,
    updateItemName,
    refreshListAfterAiUpdate, // Pobierz nową funkcję
  } = useShoppingListDetail(listId);

  // Obsługa stanu ładowania
  if (isLoading) {
    return (
      <div className="container mx-auto p-4 flex flex-col items-center justify-center min-h-[50vh]">
        <Loader2 className="h-8 w-8 animate-spin text-primary mb-4" />
        <p className="text-lg">Ładowanie szczegółów listy zakupów...</p>
        <p className="text-sm text-muted-foreground mt-2">Prosimy o cierpliwość, trwa pobieranie danych...</p>
      </div>
    );
  }

  // Obsługa błędów - unikamy pokazywania błędów autoryzacji, ponieważ są one obsługiwane
  // przez mechanizm automatycznych ponownych prób w hooku
  if (error) {
    // Ignorujemy tymczasowe błędy uwierzytelniania
    const isAuthError = error.includes("zalogowany") || error.includes("401") || error.includes("authentication");

    // Dla błędów uwierzytelniania pokazujemy przyjazny komunikat o ładowaniu zamiast błędu
    if (isAuthError) {
      return (
        <div className="container mx-auto p-4 flex flex-col items-center justify-center min-h-[50vh]">
          <Loader2 className="h-8 w-8 animate-spin text-primary mb-4" />
          <p className="text-lg">Inicjowanie sesji...</p>
        </div>
      );
    }

    // Dla innych błędów pokazujemy faktyczny komunikat
    return (
      <div className="container mx-auto p-4 flex flex-col items-center justify-center min-h-[50vh]">
        <div className="bg-destructive/10 p-6 rounded-lg border border-destructive/20 max-w-lg w-full">
          <h2 className="text-lg font-semibold text-destructive mb-2">Wystąpił błąd</h2>
          <p className="text-sm text-destructive/90">{error}</p>
          <button
            onClick={() => window.location.reload()}
            className="mt-4 px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors"
          >
            Odśwież stronę
          </button>
        </div>
      </div>
    );
  }

  // Obsługa sytuacji, gdy lista jest pusta (brak tytułu i elementów)
  if (title === null && items === null) {
    // Sprawdzamy, czy oba są null (początkowy stan lub błąd)
    return (
      <div className="container mx-auto p-4 flex flex-col items-center justify-center min-h-[50vh]">
        <p className="text-lg">Lista zakupów jest pusta lub wystąpił błąd ładowania.</p>
        <Button variant="ghost" size="icon" onClick={() => (window.location.href = "/")}>
          <ArrowLeft className="h-4 w-4" />
        </Button>
      </div>
    );
  }

  return (
    <div className="container mx-auto p-4 flex flex-col gap-6">
      <h1 className="text-2xl font-bold mb-4">Szczegóły Listy Zakupów</h1>

      {/* Użyj komponentu EditableShoppingListTitle - używamy title */}
      <div className="mb-6">
        <EditableShoppingListTitle initialTitle={title ?? "Nowa lista"} listId={listId} onUpdateTitle={updateTitle} />
      </div>

      {/* Obszar dodawania produktów - Zmieniono prop onAddItems */}
      <ProductInputArea listId={listId} onAddItems={refreshListAfterAiUpdate} />

      {/* Lista produktów - używamy items */}
      <div>
        <h3 className="text-lg font-medium mb-2">Produkty</h3>
        <ProductList
          items={items ?? []} // Użyj pustej tablicy, jeśli items jest null
          listId={listId}
          onTogglePurchase={toggleItemPurchased}
          onDeleteItem={deleteItem}
          onUpdateName={updateItemName}
        />
      </div>
    </div>
  );
};

export default ShoppingListDetailView;



================================================
File: src/db/database.types.ts
================================================
export type Json =
  | string
  | number
  | boolean
  | null
  | { [key: string]: Json | undefined }
  | Json[]

export type Database = {
  graphql_public: {
    Tables: {
      [_ in never]: never
    }
    Views: {
      [_ in never]: never
    }
    Functions: {
      graphql: {
        Args: {
          operationName?: string
          query?: string
          variables?: Json
          extensions?: Json
        }
        Returns: Json
      }
    }
    Enums: {
      [_ in never]: never
    }
    CompositeTypes: {
      [_ in never]: never
    }
  }
  public: {
    Tables: {
      conversations: {
        Row: {
          answer_accepted: boolean
          ended_at: string | null
          id: string
          messages: Json | null
          openai_thread_id: string | null
          started_at: string
          user_id: string
        }
        Insert: {
          answer_accepted?: boolean
          ended_at?: string | null
          id?: string
          messages?: Json | null
          openai_thread_id?: string | null
          started_at?: string
          user_id: string
        }
        Update: {
          answer_accepted?: boolean
          ended_at?: string | null
          id?: string
          messages?: Json | null
          openai_thread_id?: string | null
          started_at?: string
          user_id?: string
        }
        Relationships: [
          {
            foreignKeyName: "conversations_user_id_fkey"
            columns: ["user_id"]
            isOneToOne: false
            referencedRelation: "users"
            referencedColumns: ["id"]
          },
        ]
      }
      shopping_list_items: {
        Row: {
          created_at: string
          id: string
          item_name: string
          purchased: boolean
          shopping_list_id: string
          updated_at: string
        }
        Insert: {
          created_at?: string
          id?: string
          item_name: string
          purchased?: boolean
          shopping_list_id: string
          updated_at?: string
        }
        Update: {
          created_at?: string
          id?: string
          item_name?: string
          purchased?: boolean
          shopping_list_id?: string
          updated_at?: string
        }
        Relationships: [
          {
            foreignKeyName: "shopping_list_items_shopping_list_id_fkey"
            columns: ["shopping_list_id"]
            isOneToOne: false
            referencedRelation: "shopping_lists"
            referencedColumns: ["id"]
          },
        ]
      }
      shopping_lists: {
        Row: {
          created_at: string
          id: string
          title: string
          updated_at: string
          user_id: string
        }
        Insert: {
          created_at?: string
          id?: string
          title: string
          updated_at?: string
          user_id: string
        }
        Update: {
          created_at?: string
          id?: string
          title?: string
          updated_at?: string
          user_id?: string
        }
        Relationships: [
          {
            foreignKeyName: "shopping_lists_user_id_fkey"
            columns: ["user_id"]
            isOneToOne: false
            referencedRelation: "users"
            referencedColumns: ["id"]
          },
        ]
      }
      users: {
        Row: {
          email: string
          id: string
          last_login_date: string | null
          password_hash: string
          registration_date: string
          updated_date: string
        }
        Insert: {
          email: string
          id?: string
          last_login_date?: string | null
          password_hash: string
          registration_date?: string
          updated_date?: string
        }
        Update: {
          email?: string
          id?: string
          last_login_date?: string | null
          password_hash?: string
          registration_date?: string
          updated_date?: string
        }
        Relationships: []
      }
    }
    Views: {
      [_ in never]: never
    }
    Functions: {
      [_ in never]: never
    }
    Enums: {
      [_ in never]: never
    }
    CompositeTypes: {
      [_ in never]: never
    }
  }
}

type DefaultSchema = Database[Extract<keyof Database, "public">]

export type Tables<
  DefaultSchemaTableNameOrOptions extends
    | keyof (DefaultSchema["Tables"] & DefaultSchema["Views"])
    | { schema: keyof Database },
  TableName extends DefaultSchemaTableNameOrOptions extends {
    schema: keyof Database
  }
    ? keyof (Database[DefaultSchemaTableNameOrOptions["schema"]]["Tables"] &
        Database[DefaultSchemaTableNameOrOptions["schema"]]["Views"])
    : never = never,
> = DefaultSchemaTableNameOrOptions extends { schema: keyof Database }
  ? (Database[DefaultSchemaTableNameOrOptions["schema"]]["Tables"] &
      Database[DefaultSchemaTableNameOrOptions["schema"]]["Views"])[TableName] extends {
      Row: infer R
    }
    ? R
    : never
  : DefaultSchemaTableNameOrOptions extends keyof (DefaultSchema["Tables"] &
        DefaultSchema["Views"])
    ? (DefaultSchema["Tables"] &
        DefaultSchema["Views"])[DefaultSchemaTableNameOrOptions] extends {
        Row: infer R
      }
      ? R
      : never
    : never

export type TablesInsert<
  DefaultSchemaTableNameOrOptions extends
    | keyof DefaultSchema["Tables"]
    | { schema: keyof Database },
  TableName extends DefaultSchemaTableNameOrOptions extends {
    schema: keyof Database
  }
    ? keyof Database[DefaultSchemaTableNameOrOptions["schema"]]["Tables"]
    : never = never,
> = DefaultSchemaTableNameOrOptions extends { schema: keyof Database }
  ? Database[DefaultSchemaTableNameOrOptions["schema"]]["Tables"][TableName] extends {
      Insert: infer I
    }
    ? I
    : never
  : DefaultSchemaTableNameOrOptions extends keyof DefaultSchema["Tables"]
    ? DefaultSchema["Tables"][DefaultSchemaTableNameOrOptions] extends {
        Insert: infer I
      }
      ? I
      : never
    : never

export type TablesUpdate<
  DefaultSchemaTableNameOrOptions extends
    | keyof DefaultSchema["Tables"]
    | { schema: keyof Database },
  TableName extends DefaultSchemaTableNameOrOptions extends {
    schema: keyof Database
  }
    ? keyof Database[DefaultSchemaTableNameOrOptions["schema"]]["Tables"]
    : never = never,
> = DefaultSchemaTableNameOrOptions extends { schema: keyof Database }
  ? Database[DefaultSchemaTableNameOrOptions["schema"]]["Tables"][TableName] extends {
      Update: infer U
    }
    ? U
    : never
  : DefaultSchemaTableNameOrOptions extends keyof DefaultSchema["Tables"]
    ? DefaultSchema["Tables"][DefaultSchemaTableNameOrOptions] extends {
        Update: infer U
      }
      ? U
      : never
    : never

export type Enums<
  DefaultSchemaEnumNameOrOptions extends
    | keyof DefaultSchema["Enums"]
    | { schema: keyof Database },
  EnumName extends DefaultSchemaEnumNameOrOptions extends {
    schema: keyof Database
  }
    ? keyof Database[DefaultSchemaEnumNameOrOptions["schema"]]["Enums"]
    : never = never,
> = DefaultSchemaEnumNameOrOptions extends { schema: keyof Database }
  ? Database[DefaultSchemaEnumNameOrOptions["schema"]]["Enums"][EnumName]
  : DefaultSchemaEnumNameOrOptions extends keyof DefaultSchema["Enums"]
    ? DefaultSchema["Enums"][DefaultSchemaEnumNameOrOptions]
    : never

export type CompositeTypes<
  PublicCompositeTypeNameOrOptions extends
    | keyof DefaultSchema["CompositeTypes"]
    | { schema: keyof Database },
  CompositeTypeName extends PublicCompositeTypeNameOrOptions extends {
    schema: keyof Database
  }
    ? keyof Database[PublicCompositeTypeNameOrOptions["schema"]]["CompositeTypes"]
    : never = never,
> = PublicCompositeTypeNameOrOptions extends { schema: keyof Database }
  ? Database[PublicCompositeTypeNameOrOptions["schema"]]["CompositeTypes"][CompositeTypeName]
  : PublicCompositeTypeNameOrOptions extends keyof DefaultSchema["CompositeTypes"]
    ? DefaultSchema["CompositeTypes"][PublicCompositeTypeNameOrOptions]
    : never

export const Constants = {
  graphql_public: {
    Enums: {},
  },
  public: {
    Enums: {},
  },
} as const




================================================
File: src/db/supabase.client.ts
================================================
import { createBrowserClient } from "@supabase/ssr";
import type { Database } from "./database.types";

// Client-side configuration
const supabaseUrl = import.meta.env.PUBLIC_SUPABASE_URL;
const supabaseAnonKey = import.meta.env.PUBLIC_SUPABASE_ANON_KEY;

// Validate environment variables
if (!supabaseUrl || !supabaseAnonKey) {
  console.error(
    "Client-side Supabase URL or Anon Key is missing. Check environment variables (.env file and PUBLIC_ prefix)."
  );
  throw new Error("Supabase client configuration error: Client URL or Anon Key not found.");
}

// Create a singleton instance of the browser client
let browserClient: ReturnType<typeof createBrowserClient<Database>> | null = null;

/**
 * Zwraca instancję klienta Supabase do użytku po stronie przeglądarki
 * Implementacja wzorca singleton zapobiega tworzeniu wielu instancji
 */
export function getSupabaseBrowserClient() {
  if (browserClient) {
    return browserClient;
  }
  browserClient = createBrowserClient<Database>(supabaseUrl, supabaseAnonKey);
  return browserClient;
}

// Export the singleton instance
export const supabaseClient = getSupabaseBrowserClient();

// Server-side admin client logic has been moved to supabase.server.ts



================================================
File: src/db/supabase.server.ts
================================================
import type { AstroCookies } from "astro";
import { createServerClient, type CookieOptionsWithName } from "@supabase/ssr";
import type { Database } from "./database.types";

// Konfiguracja plików cookie, zwłaszcza dla bezpieczeństwa w środowisku produkcyjnym
export const cookieOptions: CookieOptionsWithName = {
  path: "/",
  secure: import.meta.env.PROD, // true w produkcji, false w środowisku deweloperskim
  httpOnly: true,
  sameSite: "lax",
};

/**
 * Parsuje nagłówek Cookie do formatu wymaganego przez @supabase/ssr
 */
function parseCookieHeader(cookieHeader: string): { name: string; value: string }[] {
  return cookieHeader.split(";").map((cookie) => {
    const [name, ...rest] = cookie.trim().split("=");
    return { name, value: rest.join("=") };
  });
}

/**
 * Tworzy instancję klienta Supabase do użytku po stronie serwera,
 * zgodnie z dokumentacją @supabase/ssr dla Astro
 */
export const createSupabaseServerInstance = (context: { headers: Headers; cookies: AstroCookies }) => {
  const supabase = createServerClient<Database>(import.meta.env.SUPABASE_URL, import.meta.env.SUPABASE_KEY, {
    cookieOptions,
    cookies: {
      // Implementacja getAll zamiast get/set/remove zgodnie z zaleceniami
      getAll() {
        return parseCookieHeader(context.headers.get("Cookie") ?? "");
      },
      setAll(cookiesToSet) {
        cookiesToSet.forEach(({ name, value, options }) => context.cookies.set(name, value, options));
      },
    },
  });

  return supabase;
};

// Dla operacji wymagających uprawnień administratora
// Używamy service_role key, który pomija RLS (Row Level Security)
export const createSupabaseAdminClient = () => {
  if (!import.meta.env.SUPABASE_URL || !import.meta.env.SUPABASE_SERVICE_ROLE_KEY) {
    throw new Error("Brak wymaganych zmiennych środowiskowych dla klienta administratora Supabase");
  }

  return createServerClient<Database>(import.meta.env.SUPABASE_URL, import.meta.env.SUPABASE_SERVICE_ROLE_KEY, {
    cookieOptions,
    cookies: {
      getAll: () => [],
      setAll: () => {
        // Administrator nie potrzebuje zapisywać ciasteczek sesji użytkownika
        // To celowo pusta metoda, ponieważ admin działa poza kontekstem sesji użytkownika
      },
    },
  });
};



================================================
File: src/db/supabase.types.ts.
================================================
[?25l
    Select a project:                                                                        
                                                                                             
  >  1. rydnomwagefozvnsnaby [name: ShoListeo, org: nwtxzftcqfnvvkzflase, region: eu-north-1]
                                                                                             
                                                                                             
    ↑/k up • ↓/j down • / filter • q quit • ? more                                           
                                                                                             [0D[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[2K[1A[0D[2K [0D[2K[?25h[?1002l[?1003l[?1006lexport type Json =
  | string
  | number
  | boolean
  | null
  | { [key: string]: Json | undefined }
  | Json[]

export type Database = {
  public: {
    Tables: {
      conversations: {
        Row: {
          answer_accepted: boolean
          ended_at: string | null
          id: string
          messages: Json | null
          openai_thread_id: string | null
          started_at: string
          user_id: string
        }
        Insert: {
          answer_accepted?: boolean
          ended_at?: string | null
          id?: string
          messages?: Json | null
          openai_thread_id?: string | null
          started_at?: string
          user_id: string
        }
        Update: {
          answer_accepted?: boolean
          ended_at?: string | null
          id?: string
          messages?: Json | null
          openai_thread_id?: string | null
          started_at?: string
          user_id?: string
        }
        Relationships: [
          {
            foreignKeyName: "conversations_user_id_fkey"
            columns: ["user_id"]
            isOneToOne: false
            referencedRelation: "users"
            referencedColumns: ["id"]
          },
        ]
      }
      shopping_list_items: {
        Row: {
          created_at: string
          id: string
          item_name: string
          purchased: boolean
          shopping_list_id: string
          updated_at: string
        }
        Insert: {
          created_at?: string
          id?: string
          item_name: string
          purchased?: boolean
          shopping_list_id: string
          updated_at?: string
        }
        Update: {
          created_at?: string
          id?: string
          item_name?: string
          purchased?: boolean
          shopping_list_id?: string
          updated_at?: string
        }
        Relationships: [
          {
            foreignKeyName: "shopping_list_items_shopping_list_id_fkey"
            columns: ["shopping_list_id"]
            isOneToOne: false
            referencedRelation: "shopping_lists"
            referencedColumns: ["id"]
          },
        ]
      }
      shopping_lists: {
        Row: {
          created_at: string
          id: string
          title: string
          updated_at: string
          user_id: string
        }
        Insert: {
          created_at?: string
          id?: string
          title: string
          updated_at?: string
          user_id: string
        }
        Update: {
          created_at?: string
          id?: string
          title?: string
          updated_at?: string
          user_id?: string
        }
        Relationships: [
          {
            foreignKeyName: "shopping_lists_user_id_fkey"
            columns: ["user_id"]
            isOneToOne: false
            referencedRelation: "users"
            referencedColumns: ["id"]
          },
        ]
      }
      users: {
        Row: {
          admin: boolean
          email: string
          id: string
          last_login_date: string | null
          password_hash: string
          registration_date: string
          updated_date: string
        }
        Insert: {
          admin?: boolean
          email: string
          id?: string
          last_login_date?: string | null
          password_hash: string
          registration_date?: string
          updated_date?: string
        }
        Update: {
          admin?: boolean
          email?: string
          id?: string
          last_login_date?: string | null
          password_hash?: string
          registration_date?: string
          updated_date?: string
        }
        Relationships: []
      }
    }
    Views: {
      [_ in never]: never
    }
    Functions: {
      [_ in never]: never
    }
    Enums: {
      [_ in never]: never
    }
    CompositeTypes: {
      [_ in never]: never
    }
  }
}

type DefaultSchema = Database[Extract<keyof Database, "public">]

export type Tables<
  DefaultSchemaTableNameOrOptions extends
    | keyof (DefaultSchema["Tables"] & DefaultSchema["Views"])
    | { schema: keyof Database },
  TableName extends DefaultSchemaTableNameOrOptions extends {
    schema: keyof Database
  }
    ? keyof (Database[DefaultSchemaTableNameOrOptions["schema"]]["Tables"] &
        Database[DefaultSchemaTableNameOrOptions["schema"]]["Views"])
    : never = never,
> = DefaultSchemaTableNameOrOptions extends { schema: keyof Database }
  ? (Database[DefaultSchemaTableNameOrOptions["schema"]]["Tables"] &
      Database[DefaultSchemaTableNameOrOptions["schema"]]["Views"])[TableName] extends {
      Row: infer R
    }
    ? R
    : never
  : DefaultSchemaTableNameOrOptions extends keyof (DefaultSchema["Tables"] &
        DefaultSchema["Views"])
    ? (DefaultSchema["Tables"] &
        DefaultSchema["Views"])[DefaultSchemaTableNameOrOptions] extends {
        Row: infer R
      }
      ? R
      : never
    : never

export type TablesInsert<
  DefaultSchemaTableNameOrOptions extends
    | keyof DefaultSchema["Tables"]
    | { schema: keyof Database },
  TableName extends DefaultSchemaTableNameOrOptions extends {
    schema: keyof Database
  }
    ? keyof Database[DefaultSchemaTableNameOrOptions["schema"]]["Tables"]
    : never = never,
> = DefaultSchemaTableNameOrOptions extends { schema: keyof Database }
  ? Database[DefaultSchemaTableNameOrOptions["schema"]]["Tables"][TableName] extends {
      Insert: infer I
    }
    ? I
    : never
  : DefaultSchemaTableNameOrOptions extends keyof DefaultSchema["Tables"]
    ? DefaultSchema["Tables"][DefaultSchemaTableNameOrOptions] extends {
        Insert: infer I
      }
      ? I
      : never
    : never

export type TablesUpdate<
  DefaultSchemaTableNameOrOptions extends
    | keyof DefaultSchema["Tables"]
    | { schema: keyof Database },
  TableName extends DefaultSchemaTableNameOrOptions extends {
    schema: keyof Database
  }
    ? keyof Database[DefaultSchemaTableNameOrOptions["schema"]]["Tables"]
    : never = never,
> = DefaultSchemaTableNameOrOptions extends { schema: keyof Database }
  ? Database[DefaultSchemaTableNameOrOptions["schema"]]["Tables"][TableName] extends {
      Update: infer U
    }
    ? U
    : never
  : DefaultSchemaTableNameOrOptions extends keyof DefaultSchema["Tables"]
    ? DefaultSchema["Tables"][DefaultSchemaTableNameOrOptions] extends {
        Update: infer U
      }
      ? U
      : never
    : never

export type Enums<
  DefaultSchemaEnumNameOrOptions extends
    | keyof DefaultSchema["Enums"]
    | { schema: keyof Database },
  EnumName extends DefaultSchemaEnumNameOrOptions extends {
    schema: keyof Database
  }
    ? keyof Database[DefaultSchemaEnumNameOrOptions["schema"]]["Enums"]
    : never = never,
> = DefaultSchemaEnumNameOrOptions extends { schema: keyof Database }
  ? Database[DefaultSchemaEnumNameOrOptions["schema"]]["Enums"][EnumName]
  : DefaultSchemaEnumNameOrOptions extends keyof DefaultSchema["Enums"]
    ? DefaultSchema["Enums"][DefaultSchemaEnumNameOrOptions]
    : never

export type CompositeTypes<
  PublicCompositeTypeNameOrOptions extends
    | keyof DefaultSchema["CompositeTypes"]
    | { schema: keyof Database },
  CompositeTypeName extends PublicCompositeTypeNameOrOptions extends {
    schema: keyof Database
  }
    ? keyof Database[PublicCompositeTypeNameOrOptions["schema"]]["CompositeTypes"]
    : never = never,
> = PublicCompositeTypeNameOrOptions extends { schema: keyof Database }
  ? Database[PublicCompositeTypeNameOrOptions["schema"]]["CompositeTypes"][CompositeTypeName]
  : PublicCompositeTypeNameOrOptions extends keyof DefaultSchema["CompositeTypes"]
    ? DefaultSchema["CompositeTypes"][PublicCompositeTypeNameOrOptions]
    : never

export const Constants = {
  public: {
    Enums: {},
  },
} as const



================================================
File: src/docs/api/auth.md
================================================
# Dokumentacja endpointów API autoryzacji

## Rejestracja użytkownika

- **URL:** `/api/auth/register`
- **Metoda:** `POST`
- **Dostęp:** Publiczny
- **Body (JSON):**
  ```json
  {
    "email": "przyklad@example.com",
    "password": "Haslo123!"
  }
  ```

### Wymagania dotyczące hasła:
- Minimum 8 znaków
- Przynajmniej jedna wielka litera
- Przynajmniej jedna mała litera
- Przynajmniej jedna cyfra
- Przynajmniej jeden znak specjalny (!@#$%^&*()_+{}[]:;<>,.?~\\/-)

### Przykłady wywołania

#### cURL
```bash
curl -X POST "https://shoplisteo.example.com/api/auth/register" \
  -H "Content-Type: application/json" \
  -d '{
    "email": "nowy@example.com",
    "password": "Haslo123!"
  }'
```

#### Postman
1. Ustaw metodę na **POST**
2. Wprowadź URL: `https://shoplisteo.example.com/api/auth/register`
3. Przejdź do zakładki **Body**
4. Wybierz format **raw** i typ **JSON**
5. Wprowadź dane:
```json
{
  "email": "nowy@example.com",
  "password": "Haslo123!"
}
```
6. Kliknij przycisk **Send**

#### Fetch API (JavaScript)
```javascript
fetch('https://shoplisteo.example.com/api/auth/register', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    email: 'nowy@example.com',
    password: 'Haslo123!'
  })
})
.then(response => response.json())
.then(data => console.log(data))
.catch(error => console.error('Błąd:', error));
```

### Przykładowa odpowiedź (sukces - 201 Created)

```json
{
  "id": "077f7996-bca0-4e19-9a3f-b9c8bcb55347",
  "email": "nowy@example.com",
  "registrationDate": "2023-05-20T14:30:00Z",
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

### Przykładowa odpowiedź (błąd walidacji - 400 Bad Request)

```json
{
  "error": "Nieprawidłowe dane rejestracji",
  "details": [
    "Hasło musi zawierać co najmniej 8 znaków",
    "Hasło musi zawierać co najmniej jedną wielką literę"
  ]
}
```

### Przykładowa odpowiedź (konflikt - 409 Conflict)

```json
{
  "error": "Użytkownik o podanym adresie email już istnieje"
}
```

### Kody odpowiedzi

- **201 Created** - Użytkownik został pomyślnie zarejestrowany
- **400 Bad Request** - Nieprawidłowe dane wejściowe (np. brak wymaganych pól, nieprawidłowy format email)
- **409 Conflict** - Email jest już zajęty przez innego użytkownika
- **500 Internal Server Error** - Błąd serwera

## Logowanie użytkownika

- **URL:** `/api/auth/login`
- **Metoda:** `POST`
- **Dostęp:** Publiczny
- **Body (JSON):**
  ```json
  {
    "email": "przyklad@example.com",
    "password": "Haslo123!"
  }
  ```

### Przykłady wywołania

#### cURL
```bash
curl -X POST "https://shoplisteo.example.com/api/auth/login" \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "password": "Haslo123!"
  }'
```

#### Postman
1. Ustaw metodę na **POST**
2. Wprowadź URL: `https://shoplisteo.example.com/api/auth/login`
3. Przejdź do zakładki **Body**
4. Wybierz format **raw** i typ **JSON**
5. Wprowadź dane:
```json
{
  "email": "user@example.com",
  "password": "Haslo123!"
}
```
6. Kliknij przycisk **Send**

#### Fetch API (JavaScript)
```javascript
fetch('https://shoplisteo.example.com/api/auth/login', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    email: 'user@example.com',
    password: 'Haslo123!'
  })
})
.then(response => response.json())
.then(data => console.log(data))
.catch(error => console.error('Błąd:', error));
```

### Przykładowa odpowiedź (sukces - 200 OK)

```json
{
  "id": "077f7996-bca0-4e19-9a3f-b9c8bcb55347",
  "email": "user@example.com",
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

### Przykładowa odpowiedź (błąd walidacji - 400 Bad Request)

```json
{
  "error": "Nieprawidłowe dane logowania",
  "details": [
    "Podaj poprawny adres email",
    "Podaj hasło"
  ]
}
```

### Przykładowa odpowiedź (nieprawidłowe dane logowania - 401 Unauthorized)

```json
{
  "error": "Nieprawidłowy email lub hasło"
}
```

### Kody odpowiedzi

- **200 OK** - Logowanie zakończone sukcesem
- **400 Bad Request** - Nieprawidłowe dane wejściowe (np. brak wymaganych pól, nieprawidłowy format email)
- **401 Unauthorized** - Nieprawidłowy email lub hasło
- **500 Internal Server Error** - Błąd serwera

## Wykorzystanie tokenu

Po pomyślnym zalogowaniu lub rejestracji, otrzymany token JWT należy dołączać do każdego żądania wymagającego autoryzacji. Token należy umieścić w nagłówku Authorization w formacie:

```
Authorization: Bearer {token}
```

### Przykład wykorzystania tokenu

#### cURL
```bash
curl -X GET "https://shoplisteo.example.com/api/shopping-lists" \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
```

#### Postman
1. Ustaw metodę na **GET**
2. Wprowadź URL: `https://shoplisteo.example.com/api/shopping-lists`
3. Przejdź do zakładki **Headers**
4. Dodaj nagłówek:
   - Key: `Authorization`
   - Value: `Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...`
5. Kliknij przycisk **Send**

#### Fetch API (JavaScript)
```javascript
fetch('https://shoplisteo.example.com/api/shopping-lists', {
  method: 'GET',
  headers: {
    'Authorization': `Bearer ${token}`
  }
})
.then(response => response.json())
.then(data => console.log(data))
.catch(error => console.error('Błąd:', error));
```

## Ważność tokenu

Token JWT jest ważny przez określony czas (zazwyczaj 24 godziny od momentu wydania). Po wygaśnięciu tokenu, użytkownik musi zalogować się ponownie, aby uzyskać nowy token.

## Obsługa błędów

W przypadku nieprawidłowego lub wygasłego tokenu, serwer zwróci odpowiedź z kodem błędu 401 Unauthorized:

```json
{
  "error": "Nieprawidłowy token uwierzytelniający"
}
``` 


================================================
File: src/docs/api/shopping-lists.md
================================================
# API Endpoint: Shopping Lists

Ten dokument zawiera informacje o endpointach API związanych z zarządzaniem listami zakupów.

## Endpoint: Tworzenie listy zakupów

Endpoint pozwala na utworzenie nowej listy zakupów dla zalogowanego użytkownika.

### Szczegóły żądania

- **Metoda HTTP:** POST
- **URL:** `/api/shopping-lists`
- **Wymagane uwierzytelnienie:** Tak
- **Format danych:** JSON

### Parametry żądania

| Nazwa | Typ | Wymagane | Opis | Walidacja |
|-------|-----|----------|------|-----------|
| title | string | Tak | Tytuł listy zakupów | Min. 1 znak, maks. 255 znaków |

### Przykładowe żądanie

```http
POST /api/shopping-lists HTTP/1.1
Content-Type: application/json
Authorization: Bearer <token>

{
  "title": "Lista zakupów na weekend"
}
```

### Przykład curl

```bash
curl -X POST "https://example.com/api/shopping-lists" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer <token>" \
  -d '{"title": "Lista zakupów na weekend"}'
```

### Odpowiedzi

#### Powodzenie (201 Created)

```json
{
  "id": "1a2b3c4d-5e6f-7g8h-9i0j-1k2l3m4n5o6p",
  "title": "Lista zakupów na weekend",
  "createdAt": "2023-07-01T14:30:45Z",
  "updatedAt": "2023-07-01T14:30:45Z"
}
```

#### Błąd: Nieprawidłowe dane wejściowe (400 Bad Request)

```json
{
  "error": "Nieprawidłowe dane wejściowe",
  "details": {
    "title": {
      "_errors": ["Tytuł listy zakupów nie może być pusty"]
    }
  }
}
```

#### Błąd: Brak uwierzytelnienia (401 Unauthorized)

```json
{
  "error": "Wymagane uwierzytelnienie"
}
```

#### Błąd: Konflikt (409 Conflict)

```json
{
  "error": "Lista zakupów o podanym tytule już istnieje",
  "code": "DUPLICATE_TITLE"
}
```

#### Błąd serwera (500 Internal Server Error)

```json
{
  "error": "Wystąpił błąd podczas przetwarzania żądania"
}
```

### Kody błędów biznesowych

| Kod | Opis |
|-----|------|
| DUPLICATE_TITLE | Lista zakupów o podanym tytule już istnieje |
| USER_NOT_FOUND | Nie znaleziono użytkownika |
| TABLE_NOT_FOUND | Błąd konfiguracji bazy danych: tabela nie istnieje |
| DATABASE_ERROR | Ogólny błąd bazy danych |
| NO_DATA_RETURNED | Brak danych zwrotnych z bazy danych |
| UNEXPECTED_ERROR | Nieoczekiwany błąd systemowy |

### Uwagi dla deweloperów

- Endpoint jest dostępny tylko dla zalogowanych użytkowników.
- W trybie deweloperskim można testować API bez logowania - w middleware jest zaimplementowany automatyczny mechanizm autoryzacji dla środowiska deweloperskiego.
- Lista zakupów jest zawsze powiązana z użytkownikiem, który ją utworzył.
- Tytuły list zakupów muszą być unikalne dla danego użytkownika.
- Zalecane jest używanie UUID jako identyfikatorów list zakupów w całej aplikacji.

---

## Endpoint: Pobieranie wszystkich list zakupów

Endpoint umożliwia pobieranie wszystkich list zakupów należących do zalogowanego użytkownika z obsługą paginacji i sortowania.

### Szczegóły żądania

- **Metoda HTTP:** GET
- **URL:** `/api/shopping-lists`
- **Wymagane uwierzytelnienie:** Tak
- **Format danych:** JSON

### Parametry zapytania (query)

| Nazwa | Typ | Wymagane | Opis | Domyślna wartość | Walidacja |
|-------|-----|----------|------|-----------------|-----------|
| page | number | Nie | Numer strony | 1 | Liczba całkowita > 0 |
| pageSize | number | Nie | Liczba elementów na stronę | 20 | Liczba całkowita > 0, maks. 100 |
| sort | string | Nie | Pole do sortowania | "createdAt" | Dopuszczalne wartości: "title", "createdAt", "updatedAt" |
| order | string | Nie | Kierunek sortowania | "desc" | Dopuszczalne wartości: "asc", "desc" |

### Przykładowe żądanie

```http
GET /api/shopping-lists?page=1&pageSize=10&sort=updatedAt&order=desc HTTP/1.1
Authorization: Bearer <token>
```

### Przykład curl

```bash
curl -X GET "https://example.com/api/shopping-lists?page=1&pageSize=10&sort=updatedAt&order=desc" \
  -H "Authorization: Bearer <token>"
```

### Odpowiedzi

#### Powodzenie (200 OK)

```json
{
  "data": [
    {
      "id": "1a2b3c4d-5e6f-7g8h-9i0j-1k2l3m4n5o6p",
      "title": "Lista zakupów na weekend",
      "createdAt": "2023-07-01T14:30:45Z",
      "updatedAt": "2023-07-01T15:20:10Z",
      "itemCount": 5
    },
    {
      "id": "2a3b4c5d-6e7f-8g9h-0i1j-2k3l4m5n6o7p",
      "title": "Zakupy na przyjęcie",
      "createdAt": "2023-06-28T10:15:30Z",
      "updatedAt": "2023-06-29T12:45:22Z",
      "itemCount": 12
    }
  ],
  "pagination": {
    "totalItems": 25,
    "totalPages": 3,
    "currentPage": 1,
    "pageSize": 10
  }
}
```

#### Błąd: Nieprawidłowe parametry zapytania (400 Bad Request)

```json
{
  "error": "Nieprawidłowe parametry zapytania",
  "details": {
    "pageSize": {
      "_errors": ["Liczba elementów na stronę nie może przekraczać 100"]
    }
  }
}
```

#### Błąd: Brak uwierzytelnienia (401 Unauthorized)

```json
{
  "error": "Wymagane uwierzytelnienie"
}
```

#### Błąd serwera (500 Internal Server Error)

```json
{
  "error": "Wystąpił błąd podczas przetwarzania żądania"
}
```

### Kody błędów biznesowych

| Kod | Opis |
|-----|------|
| USER_NOT_FOUND | Nie znaleziono użytkownika |
| DATABASE_ERROR | Ogólny błąd bazy danych |
| UNEXPECTED_ERROR | Nieoczekiwany błąd systemowy |

### Uwagi dla deweloperów

- Endpoint jest dostępny tylko dla zalogowanych użytkowników.
- Uwzględniana jest paginacja wyników dla optymalizacji wydajności.
- Pole `itemCount` zawiera liczbę elementów na każdej liście zakupów.
- Sortowanie jest dostępne według tytułu, daty utworzenia i daty aktualizacji.
- Dla każdego użytkownika zwracane są tylko jego własne listy zakupów.

---

## Endpoint: Pobieranie pojedynczej listy zakupów

Endpoint umożliwia pobieranie szczegółowych informacji o konkretnej liście zakupów wraz ze wszystkimi jej elementami.

### Szczegóły żądania

- **Metoda HTTP:** GET
- **URL:** `/api/shopping-lists/{id}`
- **Wymagane uwierzytelnienie:** Tak
- **Format danych:** JSON

### Parametry ścieżki (path)

| Nazwa | Typ | Wymagane | Opis | Walidacja |
|-------|-----|----------|------|-----------|
| id | string (UUID) | Tak | Identyfikator listy zakupów | Prawidłowy format UUID |

### Przykładowe żądanie

```http
GET /api/shopping-lists/1a2b3c4d-5e6f-7g8h-9i0j-1k2l3m4n5o6p HTTP/1.1
Authorization: Bearer <token>
```

### Przykład curl

```bash
curl -X GET "https://example.com/api/shopping-lists/1a2b3c4d-5e6f-7g8h-9i0j-1k2l3m4n5o6p" \
  -H "Authorization: Bearer <token>"
```

### Odpowiedzi

#### Powodzenie (200 OK)

```json
{
  "id": "1a2b3c4d-5e6f-7g8h-9i0j-1k2l3m4n5o6p",
  "title": "Lista zakupów na weekend",
  "createdAt": "2023-07-01T14:30:45Z",
  "updatedAt": "2023-07-01T15:20:10Z",
  "items": [
    {
      "id": "7a8b9c0d-1e2f-3g4h-5i6j-7k8l9m0n1o2p",
      "itemName": "Chleb",
      "purchased": true,
      "createdAt": "2023-07-01T14:31:20Z",
      "updatedAt": "2023-07-01T15:20:10Z"
    },
    {
      "id": "8a9b0c1d-2e3f-4g5h-6i7j-8k9l0m1n2o3p",
      "itemName": "Mleko",
      "purchased": false,
      "createdAt": "2023-07-01T14:32:15Z",
      "updatedAt": "2023-07-01T14:32:15Z"
    }
  ]
}
```

#### Błąd: Nieprawidłowy format identyfikatora (400 Bad Request)

```json
{
  "error": "Nieprawidłowy format identyfikatora listy zakupów",
  "details": {
    "_errors": ["Nieprawidłowy format identyfikatora listy zakupów"]
  }
}
```

#### Błąd: Brak uwierzytelnienia (401 Unauthorized)

```json
{
  "error": "Wymagane uwierzytelnienie"
}
```

#### Błąd: Nie znaleziono listy (404 Not Found)

```json
{
  "error": "Nie znaleziono listy zakupów o podanym ID",
  "code": "LIST_NOT_FOUND"
}
```

#### Błąd serwera (500 Internal Server Error)

```json
{
  "error": "Wystąpił błąd podczas przetwarzania żądania"
}
```

### Kody błędów biznesowych

| Kod | Opis |
|-----|------|
| INVALID_UUID | Nieprawidłowy format identyfikatora listy zakupów |
| LIST_NOT_FOUND | Nie znaleziono listy zakupów o podanym ID |
| USER_NOT_FOUND | Nie znaleziono użytkownika |
| DATABASE_ERROR | Ogólny błąd bazy danych |
| UNEXPECTED_ERROR | Nieoczekiwany błąd systemowy |

### Uwagi dla deweloperów

- Endpoint jest dostępny tylko dla zalogowanych użytkowników.
- Użytkownik może pobierać tylko własne listy zakupów.
- Wraz z listą zakupów zwracane są wszystkie elementy należące do tej listy.
- Elementy są sortowane według daty utworzenia (od najstarszych).

---

## Endpoint: Aktualizacja listy zakupów

Endpoint umożliwia aktualizację tytułu istniejącej listy zakupów.

### Szczegóły żądania

- **Metoda HTTP:** PUT
- **URL:** `/api/shopping-lists/{id}`
- **Wymagane uwierzytelnienie:** Tak
- **Format danych:** JSON

### Parametry ścieżki (path)

| Nazwa | Typ | Wymagane | Opis | Walidacja |
|-------|-----|----------|------|-----------|
| id | string (UUID) | Tak | Identyfikator listy zakupów | Prawidłowy format UUID |

### Parametry żądania

| Nazwa | Typ | Wymagane | Opis | Walidacja |
|-------|-----|----------|------|-----------|
| title | string | Tak | Nowy tytuł listy zakupów | Min. 1 znak, maks. 255 znaków |

### Przykładowe żądanie

```http
PUT /api/shopping-lists/1a2b3c4d-5e6f-7g8h-9i0j-1k2l3m4n5o6p HTTP/1.1
Content-Type: application/json
Authorization: Bearer <token>

{
  "title": "Zakupy na weekend - zaktualizowane"
}
```

### Przykład curl

```bash
curl -X PUT "https://example.com/api/shopping-lists/1a2b3c4d-5e6f-7g8h-9i0j-1k2l3m4n5o6p" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer <token>" \
  -d '{"title": "Zakupy na weekend - zaktualizowane"}'
```

### Odpowiedzi

#### Powodzenie (200 OK)

```json
{
  "id": "1a2b3c4d-5e6f-7g8h-9i0j-1k2l3m4n5o6p",
  "title": "Zakupy na weekend - zaktualizowane",
  "updatedAt": "2023-07-02T10:15:30Z"
}
```

#### Błąd: Nieprawidłowy format identyfikatora (400 Bad Request)

```json
{
  "error": "Nieprawidłowy format identyfikatora listy zakupów",
  "details": {
    "_errors": ["Nieprawidłowy format identyfikatora listy zakupów"]
  }
}
```

#### Błąd: Nieprawidłowe dane wejściowe (400 Bad Request)

```json
{
  "error": "Nieprawidłowe dane wejściowe",
  "details": {
    "title": {
      "_errors": ["Tytuł listy zakupów nie może być pusty"]
    }
  }
}
```

#### Błąd: Brak uwierzytelnienia (401 Unauthorized)

```json
{
  "error": "Wymagane uwierzytelnienie"
}
```

#### Błąd: Nie znaleziono listy (404 Not Found)

```json
{
  "error": "Nie znaleziono listy zakupów o podanym ID",
  "code": "LIST_NOT_FOUND"
}
```

#### Błąd: Konflikt (409 Conflict)

```json
{
  "error": "Lista zakupów o podanym tytule już istnieje",
  "code": "DUPLICATE_TITLE"
}
```

#### Błąd serwera (500 Internal Server Error)

```json
{
  "error": "Wystąpił błąd podczas przetwarzania żądania"
}
```

### Kody błędów biznesowych

| Kod | Opis |
|-----|------|
| INVALID_UUID | Nieprawidłowy format identyfikatora listy zakupów |
| LIST_NOT_FOUND | Nie znaleziono listy zakupów o podanym ID |
| DUPLICATE_TITLE | Lista zakupów o podanym tytule już istnieje |
| USER_NOT_FOUND | Nie znaleziono użytkownika |
| DATABASE_ERROR | Ogólny błąd bazy danych |
| NO_DATA_RETURNED | Brak danych zwrotnych z bazy danych |
| UNEXPECTED_ERROR | Nieoczekiwany błąd systemowy |

### Uwagi dla deweloperów

- Endpoint jest dostępny tylko dla zalogowanych użytkowników.
- Użytkownik może aktualizować tylko własne listy zakupów.
- Tytuły list zakupów muszą być unikalne dla danego użytkownika.
- Data aktualizacji (`updatedAt`) jest automatycznie ustawiana na bieżący czas.

---

## Endpoint: Usuwanie listy zakupów

Endpoint umożliwia usunięcie listy zakupów wraz ze wszystkimi jej elementami.

### Szczegóły żądania

- **Metoda HTTP:** DELETE
- **URL:** `/api/shopping-lists/{id}`
- **Wymagane uwierzytelnienie:** Tak

### Parametry ścieżki (path)

| Nazwa | Typ | Wymagane | Opis | Walidacja |
|-------|-----|----------|------|-----------|
| id | string (UUID) | Tak | Identyfikator listy zakupów | Prawidłowy format UUID |

### Przykładowe żądanie

```http
DELETE /api/shopping-lists/1a2b3c4d-5e6f-7g8h-9i0j-1k2l3m4n5o6p HTTP/1.1
Authorization: Bearer <token>
```

### Przykład curl

```bash
curl -X DELETE "https://example.com/api/shopping-lists/1a2b3c4d-5e6f-7g8h-9i0j-1k2l3m4n5o6p" \
  -H "Authorization: Bearer <token>"
```

### Odpowiedzi

#### Powodzenie (204 No Content)

*Brak treści odpowiedzi*

#### Błąd: Nieprawidłowy format identyfikatora (400 Bad Request)

```json
{
  "error": "Nieprawidłowy format identyfikatora listy zakupów",
  "details": {
    "_errors": ["Nieprawidłowy format identyfikatora listy zakupów"]
  }
}
```

#### Błąd: Brak uwierzytelnienia (401 Unauthorized)

```json
{
  "error": "Wymagane uwierzytelnienie"
}
```

#### Błąd: Nie znaleziono listy (404 Not Found)

```json
{
  "error": "Nie znaleziono listy zakupów o podanym ID",
  "code": "LIST_NOT_FOUND"
}
```

#### Błąd serwera (500 Internal Server Error)

```json
{
  "error": "Wystąpił błąd podczas przetwarzania żądania"
}
```

### Kody błędów biznesowych

| Kod | Opis |
|-----|------|
| INVALID_UUID | Nieprawidłowy format identyfikatora listy zakupów |
| LIST_NOT_FOUND | Nie znaleziono listy zakupów o podanym ID |
| USER_NOT_FOUND | Nie znaleziono użytkownika |
| DATABASE_ERROR | Ogólny błąd bazy danych |
| UNEXPECTED_ERROR | Nieoczekiwany błąd systemowy |

### Uwagi dla deweloperów

- Endpoint jest dostępny tylko dla zalogowanych użytkowników.
- Użytkownik może usuwać tylko własne listy zakupów.
- Wraz z listą zakupów usuwane są wszystkie elementy należące do tej listy (kaskadowe usuwanie).
- Operacja usuwania jest nieodwracalna - po usunięciu danych nie można ich odzyskać.
- Endpoint zwraca status 204 No Content bez treści odpowiedzi w przypadku powodzenia, zgodnie z konwencją REST. 


================================================
File: src/docs/api/users.md
================================================
# Dokumentacja endpointów API użytkowników

## Pobieranie wszystkich użytkowników

- **URL:** `/api/users`
- **Metoda:** `GET`
- **Dostęp:** Tylko administrator
- **Parametry zapytania:**
  - `page` (opcjonalny, domyślnie: 1) - Numer strony wyników
  - `pageSize` (opcjonalny, domyślnie: 20) - Liczba elementów na stronę
  - `sort` (opcjonalny) - Pole, po którym sortowane są wyniki (email, registrationDate)
  - `order` (opcjonalny) - Kolejność sortowania (asc, desc)
  - `emailFilter` (opcjonalny) - Filtrowanie po wzorcu email

### Przykłady wywołania

#### cURL
```bash
curl -X GET "https://shoplisteo.example.com/api/users?page=1&pageSize=10&sort=email&order=asc" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"
```

#### Postman
```
GET /api/users?page=1&pageSize=10&sort=email&order=asc HTTP/1.1
Host: shoplisteo.example.com
Authorization: Bearer YOUR_ACCESS_TOKEN
```

### Przykładowa odpowiedź (Status: 200 OK)

```json
{
  "data": [
    {
      "id": "077f7996-bca0-4e19-9a3f-b9c8bcb55347",
      "email": "user@example.com",
      "registrationDate": "2023-01-15T12:00:00Z",
      "lastLoginDate": "2023-02-20T15:30:00Z"
    }
  ],
  "pagination": {
    "totalItems": 50,
    "totalPages": 3,
    "currentPage": 1,
    "pageSize": 20
  }
}
```

### Kody błędów

- **400 Bad Request** - Nieprawidłowe parametry zapytania
- **401 Unauthorized** - Brak autoryzacji
- **403 Forbidden** - Brak uprawnień administratora
- **500 Internal Server Error** - Błąd serwera

## Pobieranie użytkownika według ID

- **URL:** `/api/users/{id}`
- **Metoda:** `GET`
- **Dostęp:** Własne dane użytkownika lub administrator
- **Parametry ścieżki:**
  - `id` (wymagany) - ID użytkownika (UUID)

### Przykłady wywołania

#### cURL
```bash
curl -X GET "https://shoplisteo.example.com/api/users/077f7996-bca0-4e19-9a3f-b9c8bcb55347" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"
```

#### Postman
```
GET /api/users/077f7996-bca0-4e19-9a3f-b9c8bcb55347 HTTP/1.1
Host: shoplisteo.example.com
Authorization: Bearer YOUR_ACCESS_TOKEN
```

### Przykładowa odpowiedź (Status: 200 OK)

```json
{
  "id": "077f7996-bca0-4e19-9a3f-b9c8bcb55347",
  "email": "user@example.com",
  "registrationDate": "2023-05-20T14:30:00Z",
  "lastLoginDate": "2023-05-25T09:15:30Z",
  "isAdmin": false
}
```

### Kody błędów

- **400 Bad Request** - Nieprawidłowy format ID
- **401 Unauthorized** - Brak autoryzacji
- **403 Forbidden** - Brak uprawnień do pobrania danych tego użytkownika
- **404 Not Found** - Nie znaleziono użytkownika
- **500 Internal Server Error** - Błąd serwera

## Aktualizacja użytkownika

- **URL:** `/api/users/{id}`
- **Metoda:** `PUT`
- **Dostęp:** Własne dane użytkownika lub administrator
- **Parametry ścieżki:**
  - `id` (wymagany) - ID użytkownika (UUID)
- **Body:**
  ```json
  {
    "email": "new-email@example.com", // opcjonalny
    "password": "newPassword123" // opcjonalny
  }
  ```
  Wymagane jest podanie co najmniej jednego pola.

### Przykłady wywołania

#### cURL
```bash
curl -X PUT "https://shoplisteo.example.com/api/users/077f7996-bca0-4e19-9a3f-b9c8bcb55347" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "email": "new-email@example.com",
    "password": "newSecurePassword123"
  }'
```

#### Postman
```
PUT /api/users/077f7996-bca0-4e19-9a3f-b9c8bcb55347 HTTP/1.1
Host: shoplisteo.example.com
Authorization: Bearer YOUR_ACCESS_TOKEN
Content-Type: application/json

{
  "email": "new-email@example.com",
  "password": "newSecurePassword123"
}
```

### Przykładowa odpowiedź (Status: 200 OK)

```json
{
  "id": "077f7996-bca0-4e19-9a3f-b9c8bcb55347",
  "email": "new-email@example.com",
  "updatedDate": "2023-06-15T14:30:00Z",
  "passwordUpdated": true
}
```

### Kody błędów

- **400 Bad Request** - Nieprawidłowy format ID lub dane aktualizacji
- **401 Unauthorized** - Brak autoryzacji
- **403 Forbidden** - Brak uprawnień do aktualizacji danych tego użytkownika
- **404 Not Found** - Nie znaleziono użytkownika
- **409 Conflict** - Email jest już używany przez innego użytkownika
- **500 Internal Server Error** - Błąd serwera

## Usuwanie użytkownika

- **URL:** `/api/users/{id}`
- **Metoda:** `DELETE`
- **Dostęp:** Własne konto użytkownika lub administrator
- **Parametry ścieżki:**
  - `id` (wymagany) - ID użytkownika (UUID)

### Przykłady wywołania

#### cURL
```bash
curl -X DELETE "https://shoplisteo.example.com/api/users/077f7996-bca0-4e19-9a3f-b9c8bcb55347" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"
```

#### Postman
```
DELETE /api/users/077f7996-bca0-4e19-9a3f-b9c8bcb55347 HTTP/1.1
Host: shoplisteo.example.com
Authorization: Bearer YOUR_ACCESS_TOKEN
```

### Odpowiedź w przypadku sukcesu (Status: 204 No Content)

Pusta odpowiedź.

### Kody błędów

- **400 Bad Request** - Nieprawidłowy format ID
- **401 Unauthorized** - Brak autoryzacji
- **403 Forbidden** - Brak uprawnień do usunięcia tego użytkownika
- **404 Not Found** - Nie znaleziono użytkownika
- **500 Internal Server Error** - Błąd serwera

| Pole | Typ | Opis |
| ---- | --- | ---- |
| id | string (UUID) | Unikalny identyfikator użytkownika |
| email | string | Adres email użytkownika |
| registrationDate | string (ISO 8601) | Data rejestracji użytkownika |
| lastLoginDate | string (ISO 8601) | Data ostatniego logowania lub null |
| isAdmin | boolean | Informacja czy użytkownik ma uprawnienia administratora | 


================================================
File: src/layouts/AuthLayout.astro
================================================
---
import "../styles/global.css";
import { ViewTransitions } from "astro:transitions";

interface Props {
  title?: string;
}

const { title = "ShopListeo - Autentykacja" } = Astro.props;
---

<!doctype html>
<html lang="pl" class="h-full">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/png" href="/favicon.png" />
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>
    <ViewTransitions />
  </head>
  <body class="h-full bg-background text-foreground antialiased">
    <main class="flex min-h-screen items-center justify-center p-4">
      <div class="w-full max-w-md">
        <slot />
      </div>
    </main>
  </body>
</html>



================================================
File: src/layouts/Layout.astro
================================================
---
import "../styles/global.css";
import { AuthProvider } from "../lib/auth/AuthContext";

interface Props {
  title?: string;
}

const { title = "ShopListeo" } = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/png" href="/favicon.png" />
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>
  </head>
  <body>
    <AuthProvider client:load>
      <slot />
    </AuthProvider>
  </body>
</html>

<style>
  html,
  body {
    margin: 0;
    width: 100%;
    height: 100%;
  }
</style>



================================================
File: src/layouts/MainLayout.astro
================================================
---
import "../styles/global.css";
// import { ViewTransitions } from "astro:transitions"; // Usunięto nieużywany import
// import { AuthProvider } from "@/lib/auth/AuthContext"; // Usunięto import AuthProvider
// Usunięto import AuthStatus i ToastProvider, będą renderowane przez MainLayoutContent
import MainLayoutContent from "@/components/layouts/MainLayoutContent"; // Import nowego komponentu

interface Props {
  title?: string;
}

const { title = "ShopListeo" } = Astro.props;
// Usunięto pobieranie authUser, nie jest już przekazywane do AuthStatus
// const { authUser } = Astro.locals as AstroLocals;
// Remove dynamic key logic
// const authKey = Astro.locals.user ? 'user-logged-in' : 'user-logged-out';
---

<!doctype html>
<html lang="pl" class="h-full">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>
    {/* <ViewTransitions /> */}{/* Tymczasowo wyłączone do debugowania */}
  </head>
  <body class="h-full bg-background text-foreground antialiased">
    {/* Usunięto AuthProvider - jest teraz wewnątrz MainLayoutContent */}
    {/* Renderuj MainLayoutContent jako jedyną wyspę React */}
    <MainLayoutContent client:load>
      <slot />
    </MainLayoutContent>
  </body>
</html>



================================================
File: src/lib/auth.service.ts
================================================
import type { SupabaseClient } from "@supabase/supabase-js";
import type { LoginUserRequest, RegisterUserRequest, LoginUserResponse, RegisterUserResponse } from "../types";

/**
 * Serwis obsługujący operacje autoryzacji użytkowników
 */
export class AuthService {
  private supabase: SupabaseClient;

  /**
   * Tworzy nową instancję serwisu autoryzacji
   * @param supabaseClient Klient Supabase do wykonywania operacji na bazie danych
   */
  constructor(supabaseClient: SupabaseClient) {
    this.supabase = supabaseClient;
  }

  /**
   * Sprawdza czy użytkownik o podanym adresie email istnieje w systemie
   * @param email Adres email do sprawdzenia
   * @returns true jeśli użytkownik istnieje, false w przeciwnym przypadku
   */
  async userExistsByEmail(email: string): Promise<boolean> {
    const { data, error } = await this.supabase.from("users").select("id").eq("email", email).maybeSingle();

    if (error) {
      console.error("Błąd podczas sprawdzania istnienia użytkownika:", error);
      throw new Error(`Nie można sprawdzić czy użytkownik istnieje: ${error.message}`);
    }

    return !!data;
  }

  /**
   * Rejestruje nowego użytkownika w systemie
   * @param userData Dane rejestracyjne użytkownika
   * @returns Dane zarejestrowanego użytkownika wraz z tokenem
   */
  async registerUser(userData: RegisterUserRequest): Promise<RegisterUserResponse> {
    const { email, password } = userData;
    console.log(`AuthService: Rejestracja użytkownika z email: ${email}`);

    // Sprawdzenie czy mamy poprawne połączenie z Supabase
    try {
      // Prostszy test połączenia - zamiast używać konkretnej tabeli, wykonujemy zapytanie o status
      try {
        // Proste zapytanie o status Supabase
        const { error } = await this.supabase
          .from("shopping_list_items")
          .select("count(*)", { count: "exact", head: true });

        if (error) {
          console.error("AuthService: Błąd połączenia z Supabase:", error);
          throw new Error(`Nie można połączyć się z bazą danych: ${error.message}`);
        }

        console.log("AuthService: Połączenie z Supabase nawiązane pomyślnie");
      } catch (connError) {
        console.error("AuthService: Błąd testowania połączenia:", connError);
        // Kontynuuj mimo błędu - możliwe, że API działa poprawnie, ale nie mamy dostępu do tabeli
      }

      // Sprawdzenie czy użytkownik istnieje
      const userExists = await this.userExistsByEmail(email);
      if (userExists) {
        console.log(`AuthService: Użytkownik ${email} już istnieje`);
        throw new Error("Użytkownik o podanym adresie email już istnieje");
      }

      console.log("AuthService: Użytkownik nie istnieje, kontynuuję rejestrację");

      // Rejestracja użytkownika za pomocą Supabase Auth
      console.log("AuthService: Wywołuję supabase.auth.signUp...");

      // Kluczowa zmiana: dodajemy autoconfirm dla środowiska deweloperskiego
      const { data: authData, error: authError } = await this.supabase.auth.signUp({
        email,
        password,
        options: {
          emailRedirectTo: `/login`,
          // Ustawienie data.email_confirmed pozwala na automatyczne potwierdzenie email w środowisku deweloperskim
          data: {
            email_confirmed: true,
            email: email,
            registration_date: new Date().toISOString(),
          },
        },
      });

      // Pełniejsze logowanie wyników
      console.log("AuthService: Wynik signUp:", {
        success: !authError,
        userId: authData?.user?.id,
        userEmail: authData?.user?.email,
        userCreatedAt: authData?.user?.created_at,
        identities: authData?.user?.identities,
        emailConfirmed: authData?.user?.email_confirmed_at,
        error: authError?.message || null,
        errorStatus: authError?.status || null,
      });

      if (authError) {
        console.error("Błąd podczas rejestracji użytkownika w Supabase Auth:", authError);
        throw new Error(`Nie udało się utworzyć konta użytkownika: ${authError.message || "Nieznany błąd"}`);
      }

      if (!authData.user) {
        console.error("Brak danych użytkownika po rejestracji w Supabase Auth.");
        throw new Error("Nie udało się utworzyć konta użytkownika: brak danych użytkownika w odpowiedzi");
      }

      // Kluczowa informacja - czy email został już potwierdzony
      const isEmailConfirmed = !!authData.user.email_confirmed_at;
      console.log(`AuthService: Stan potwierdzenia email: ${isEmailConfirmed ? "potwierdzony" : "niepotwierdzony"}`);

      // Po rejestracji nie zawsze istnieje sesja, zwłaszcza gdy wymagana jest weryfikacja email
      let sessionToken = "token-niedostepny-wymagane-potwierdzenie-email";

      // Próbujemy pobrać sesję tylko jeśli email jest potwierdzony
      if (isEmailConfirmed) {
        console.log("AuthService: Email potwierdzony, próbuję zalogować użytkownika...");
        // Zamiast getSession, próbujemy od razu zalogować użytkownika
        const { data: signInData, error: signInError } = await this.supabase.auth.signInWithPassword({
          email,
          password,
        });

        if (signInError) {
          console.warn("AuthService: Błąd logowania po rejestracji:", signInError);
          // Kontynuujemy mimo błędu - użytkownik zostanie poproszony o ręczne logowanie
        } else if (signInData.session) {
          console.log("AuthService: Pomyślnie zalogowano po rejestracji");
          sessionToken = signInData.session.access_token;
        }
      } else {
        console.log("AuthService: Email nie jest potwierdzony, użytkownik będzie musiał go potwierdzić");
      }

      const userId = authData.user.id;
      const registrationDate = new Date().toISOString();

      console.log(`AuthService: Pomyślnie utworzono konto dla ${email} z id=${userId}`);

      // Zapisanie dodatkowych danych użytkownika w tabeli users
      console.log("AuthService: Zapisywanie dodatkowych danych użytkownika w tabeli users");
      const { error: insertError } = await this.supabase.from("users").insert({
        id: userId,
        email,
        registration_date: registrationDate,
        password_hash: "Zarządzane przez Supabase Auth", // Hasło jest zarządzane przez Supabase Auth
      });

      if (insertError) {
        console.error("Błąd podczas zapisywania danych użytkownika:", insertError);
        console.error("Szczegóły błędu:", insertError.details, insertError.hint, insertError.code);
        // Kontynuujemy mimo błędu zapisu, ponieważ konto Auth zostało już utworzone
      } else {
        console.log("AuthService: Pomyślnie zapisano dane użytkownika w tabeli users");
      }

      // Zwrócenie informacji o utworzonym użytkowniku wraz z tokenem
      return {
        id: userId,
        email,
        registrationDate,
        token: sessionToken,
      };
    } catch (error) {
      console.error("AuthService: Błąd w procesie rejestracji:", error);
      throw error; // Przekazujemy błąd dalej
    }
  }

  /**
   * Loguje użytkownika do systemu
   * @param credentials Dane uwierzytelniające użytkownika
   * @returns Dane zalogowanego użytkownika wraz z tokenem
   */
  async loginUser(credentials: LoginUserRequest): Promise<LoginUserResponse> {
    const { email, password } = credentials;

    // Logowanie użytkownika przy użyciu Supabase Auth
    const { data: authData, error: authError } = await this.supabase.auth.signInWithPassword({
      email,
      password,
    });

    if (authError || !authData.user || !authData.session) {
      console.error("Błąd podczas logowania użytkownika:", authError);
      throw new Error("Nieprawidłowy email lub hasło");
    }

    const userId = authData.user.id;
    const token = authData.session.access_token;
    const currentDateTime = new Date().toISOString();

    // Aktualizacja pola last_login_date w tabeli users
    const { error: updateError } = await this.supabase
      .from("users")
      .update({ last_login_date: currentDateTime })
      .eq("id", userId);

    if (updateError) {
      console.error("Błąd podczas aktualizacji daty ostatniego logowania:", updateError);
      // Nie przerywamy procesu logowania z powodu błędu aktualizacji daty
    }

    // Zwrócenie odpowiedzi z danymi użytkownika i tokenem
    return {
      id: userId,
      email,
      token,
    };
  }
}



================================================
File: src/lib/logger.ts
================================================
/**
 * Prosty logger aplikacji z różnymi poziomami logowania
 * W późniejszym etapie można go rozszerzyć o bardziej zaawansowane funkcje
 * (np. integrację z zewnętrznymi systemami logowania)
 */

type LogLevel = "debug" | "info" | "warn" | "error";

interface LogEntry {
  level: LogLevel;
  message: string;
  timestamp: string;
  context?: Record<string, unknown>;
  error?: Error | unknown;
}

/**
 * Funkcja formatująca wpis logu
 */
function formatLogEntry(entry: LogEntry): string {
  const { level, message, timestamp, context, error } = entry;

  let formattedMessage = `[${timestamp}] ${level.toUpperCase()}: ${message}`;

  if (context && Object.keys(context).length > 0) {
    formattedMessage += `\nContext: ${JSON.stringify(context, null, 2)}`;
  }

  if (error instanceof Error) {
    formattedMessage += `\nError: ${error.message}`;
    if (error.stack) {
      formattedMessage += `\nStack: ${error.stack}`;
    }
  } else if (error) {
    formattedMessage += `\nError: ${JSON.stringify(error)}`;
  }

  return formattedMessage;
}

/**
 * Logger aplikacji
 */
export const logger = {
  /**
   * Loguje wiadomość z poziomem debug
   */
  debug(message: string, context?: Record<string, unknown>): void {
    this.log("debug", message, context);
  },

  /**
   * Loguje wiadomość z poziomem info
   */
  info(message: string, context?: Record<string, unknown>): void {
    this.log("info", message, context);
  },

  /**
   * Loguje wiadomość z poziomem warn
   */
  warn(message: string, context?: Record<string, unknown>, error?: Error | unknown): void {
    this.log("warn", message, context, error);
  },

  /**
   * Loguje wiadomość z poziomem error
   */
  error(message: string, context?: Record<string, unknown>, error?: Error | unknown): void {
    this.log("error", message, context, error);
  },

  /**
   * Główna funkcja logująca
   */
  log(level: LogLevel, message: string, context?: Record<string, unknown>, error?: Error | unknown): void {
    const timestamp = new Date().toISOString();
    const entry: LogEntry = { level, message, timestamp, context, error };
    const formattedLog = formatLogEntry(entry);

    // W zależności od poziomu logowania używamy odpowiedniej metody konsoli
    switch (level) {
      case "debug":
        console.debug(formattedLog);
        break;
      case "info":
        console.info(formattedLog);
        break;
      case "warn":
        console.warn(formattedLog);
        break;
      case "error":
        console.error(formattedLog);
        break;
    }

    // Tutaj w przyszłości można dodać kod zapisujący logi do zewnętrznego systemu
  },
};



================================================
File: src/lib/openrouter.service.ts
================================================
/**
 * Interfejsy i typy dla serwisu OpenRouter
 */
interface ModelParams {
  max_tokens: number;
  temperature: number;
  model_name: string;
}

interface ChatPayload {
  message: string;
  context?: string;
}

interface RequestPayload {
  messages: {
    role: "system" | "user";
    content: string;
  }[];
  model: string;
  max_tokens: number;
  temperature: number;
  response_format?: {
    type: string;
    schema?: Record<string, unknown>;
  };
}

interface LLMResponse {
  content: string;
  error?: string;
}

/**
 * Typ dla poziomów logowania
 */
type LogLevel = "info" | "warn" | "error";

/**
 * Serwis do komunikacji z API OpenRouter
 * Odpowiada za formatowanie żądań, wysyłanie ich do API i przetwarzanie odpowiedzi
 */
export class OpenRouterService {
  private readonly apiKey: string;
  private readonly baseUrl: string;
  private defaultModelParams: ModelParams;
  private systemMessage: string;
  private userMessage: string;
  private readonly maxRetries: number = 3;
  private retryCount = 0;

  constructor(
    apiKey: string = import.meta.env.OPENROUTER_API_KEY ?? "",
    baseUrl: string = import.meta.env.OPENROUTER_BASE_URL ?? "https://openrouter.ai/api/v1",
    defaultModelParams: Partial<ModelParams> = {}
  ) {
    console.log("[OpenRouterService] Inicjalizacja z parametrami:", {
      hasApiKey: !!apiKey,
      apiKeyLength: apiKey?.length ?? 0,
      baseUrl,
      envVars: {
        OPENROUTER_API_KEY_DEFINED: typeof import.meta.env.OPENROUTER_API_KEY !== "undefined",
        OPENROUTER_BASE_URL_DEFINED: typeof import.meta.env.OPENROUTER_BASE_URL !== "undefined",
        NODE_ENV: import.meta.env.NODE_ENV,
        DEV: import.meta.env.DEV,
        PROD: import.meta.env.PROD,
      },
    });

    if (!apiKey) {
      console.error("[OpenRouterService] Brak klucza API OpenRouter!", {
        allEnvKeys: Object.keys(import.meta.env)
          .filter((key) => !key.includes("PASSWORD") && !key.includes("SECRET"))
          .join(", "),
        processEnvKeys:
          typeof process !== "undefined"
            ? Object.keys(process.env || {})
                .filter((key) => !key.includes("PASSWORD") && !key.includes("SECRET"))
                .join(", ")
            : "process.env niedostępne",
      });
      throw new Error("OpenRouter API key is required");
    }

    this.apiKey = apiKey;
    this.baseUrl = baseUrl;
    this.defaultModelParams = {
      max_tokens: 512,
      temperature: 0.7,
      model_name: "openai/gpt-4o",
      ...defaultModelParams,
    };
    this.systemMessage = "You are a helpful assistant.";
    this.userMessage = "";
  }

  /**
   * Wysyła zapytanie do API OpenRouter i zwraca przetworzoną odpowiedź
   */
  public async sendChatRequest(chatPayload: ChatPayload): Promise<LLMResponse> {
    try {
      this.validateChatPayload(chatPayload);

      this.retryCount = 0;
      this.userMessage = chatPayload.message;

      this.log("info", `Sending chat request: ${chatPayload.message}`);
      const formattedRequest = this.formatRequest();
      const response = await this.makeRequest(formattedRequest);
      return this.parseResponse(response);
    } catch (error) {
      this.log("error", `Error in sendChatRequest: ${error instanceof Error ? error.message : "Unknown error"}`);

      if (this.retryCount < this.maxRetries) {
        this.retryCount++;
        this.log("warn", `Retrying request (attempt ${this.retryCount}/${this.maxRetries})`);
        return this.retryRequest(chatPayload);
      }
      return {
        content: "",
        error: error instanceof Error ? error.message : "Unknown error occurred",
      };
    }
  }

  /**
   * Waliduje payload zapytania
   */
  private validateChatPayload(payload: ChatPayload): void {
    if (!payload.message || payload.message.trim().length === 0) {
      throw new Error("Message cannot be empty");
    }

    if (payload.message.length > 4096) {
      throw new Error("Message exceeds maximum length of 4096 characters");
    }

    if (payload.context && payload.context.length > 2048) {
      throw new Error("Context exceeds maximum length of 2048 characters");
    }
  }

  /**
   * Loguje zdarzenia i błędy
   */
  private log(level: LogLevel, message: string): void {
    const timestamp = new Date().toISOString();
    const logMessage = `[${timestamp}] [${level.toUpperCase()}] OpenRouterService: ${message}`;

    switch (level) {
      case "error":
        console.error(logMessage);
        break;
      case "warn":
        console.warn(logMessage);
        break;
      default:
        console.log(logMessage);
    }
  }

  /**
   * Formatuje żądanie zgodnie z wymaganiami API OpenRouter
   */
  private formatRequest(): RequestPayload {
    console.log("[OpenRouterService] Formatowanie zapytania z modelem:", this.defaultModelParams.model_name);

    return {
      messages: [
        {
          role: "system",
          content: this.systemMessage,
        },
        {
          role: "user",
          content: this.userMessage,
        },
      ],
      model: this.defaultModelParams.model_name,
      max_tokens: this.defaultModelParams.max_tokens,
      temperature: this.defaultModelParams.temperature,
      response_format: {
        type: "json_object",
      },
    };
  }

  /**
   * Wysyła żądanie do API OpenRouter
   */
  private async makeRequest(payload: RequestPayload): Promise<Response> {
    const response = await fetch(`${this.baseUrl}/chat/completions`, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        Authorization: `Bearer ${this.apiKey}`,
      },
      body: JSON.stringify(payload),
    });

    if (!response.ok) {
      const errorText = await response.text();
      this.log("error", `API request failed with status ${response.status}: ${errorText}`);
      throw new Error(`API request failed with status ${response.status}: ${errorText}`);
    }

    return response;
  }

  /**
   * Przetwarza odpowiedź z API OpenRouter
   */
  private async parseResponse(response: Response): Promise<LLMResponse> {
    try {
      const responseText = await response.text();
      console.log("[OpenRouterService] Otrzymana surowa odpowiedź z API:", responseText);

      let data;
      try {
        data = JSON.parse(responseText);
      } catch (parseError) {
        this.log(
          "error",
          `Failed to parse JSON response: ${parseError instanceof Error ? parseError.message : "Unknown error"}`
        );
        console.error("[OpenRouterService] Nieprawidłowy format JSON w odpowiedzi:", responseText);
        return {
          content: "",
          error: `Invalid JSON response: ${parseError instanceof Error ? parseError.message : "Unknown error"}`,
        };
      }

      console.log("[OpenRouterService] Sparsowana odpowiedź z API:", JSON.stringify(data, null, 2));

      // Sprawdź pełną strukturę odpowiedzi
      if (!data.choices || !Array.isArray(data.choices) || data.choices.length === 0) {
        this.log("error", "API response missing choices array or choices array is empty");
        console.error("[OpenRouterService] Brak tablicy choices w odpowiedzi lub jest pusta:", data);
        return {
          content: "",
          error: "API response missing choices array or choices array is empty",
        };
      }

      const firstChoice = data.choices[0];
      if (!firstChoice.message) {
        this.log("error", "API response missing message in first choice");
        console.error("[OpenRouterService] Brak message w pierwszym elemencie choices:", firstChoice);
        return {
          content: "",
          error: "API response missing message in first choice",
        };
      }

      const content = firstChoice.message.content;
      if (!content) {
        this.log("error", "API response missing content in message");
        console.error("[OpenRouterService] Brak content w message pierwszego elementu choices:", firstChoice.message);
        return {
          content: "",
          error: "API response missing content in message",
        };
      }

      return {
        content,
        error: data.error?.message,
      };
    } catch (error) {
      this.log("error", `Failed to parse API response: ${error instanceof Error ? error.message : "Unknown error"}`);
      console.error("[OpenRouterService] Nieoczekiwany błąd przy przetwarzaniu odpowiedzi:", error);
      return {
        content: "",
        error: "Failed to parse API response",
      };
    }
  }

  /**
   * Ponawia żądanie w przypadku błędu
   */
  private async retryRequest(chatPayload: ChatPayload): Promise<LLMResponse> {
    const delay = Math.pow(2, this.retryCount) * 1000;
    this.log("info", `Waiting ${delay}ms before retry`);
    await new Promise((resolve) => setTimeout(resolve, delay));
    return this.sendChatRequest(chatPayload);
  }

  /**
   * Aktualizuje parametry modelu używane w zapytaniach
   */
  public setModelParams(params: Partial<ModelParams>): void {
    this.defaultModelParams = {
      ...this.defaultModelParams,
      ...params,
    };
  }

  /**
   * Aktualizuje komunikat systemowy
   */
  public updateSystemMessage(message: string): void {
    this.systemMessage = message;
  }

  /**
   * Aktualizuje komunikat użytkownika
   */
  public updateUserMessage(message: string): void {
    this.userMessage = message;
  }

  /**
   * Zwraca aktualny klucz API
   */
  public getApiKey(): string {
    return this.apiKey;
  }

  /**
   * Zwraca aktualny bazowy URL API
   */
  public getBaseUrl(): string {
    return this.baseUrl;
  }
}



================================================
File: src/lib/test-utils.ts
================================================
import { renderHook as originalRenderHook } from "@testing-library/react";
import type { RenderHookOptions } from "@testing-library/react";

// Własna wersja renderHook, która może być dostosowana
export function renderHook<Result, Props>(
  callback: (props: Props) => Result,
  options?: Omit<RenderHookOptions<Props>, "wrapper">
) {
  return originalRenderHook(callback, options);
}

// Reeksportujemy wszystko z testing-library
export { act, waitFor } from "@testing-library/react";



================================================
File: src/lib/test-utils.tsx
================================================
import React from "react";
import type { ReactNode } from "react";
import { render } from "@testing-library/react";
import type { RenderOptions } from "@testing-library/react";
import { ThemeProvider } from "next-themes"; // Odkomentowano
import { AuthProvider } from "./auth/AuthContext"; // Odkomentowano i poprawiono ścieżkę
import { Provider as TooltipProvider } from "@radix-ui/react-tooltip"; // Dodano TooltipProvider
// Zakomentowany TooltipProvider, bo nie znaleziono pliku tooltip.tsx
// import { TooltipProvider } from "@/components/ui/tooltip"; // Wymaga aliasu '@' lub poprawnej ścieżki

interface WrapperProps {
  children: ReactNode;
}

// Wrapper do testów React z potrzebnymi kontekstami
function TestWrapper({ children }: WrapperProps) {
  return (
    <ThemeProvider attribute="class" defaultTheme="system" enableSystem>
      <AuthProvider>
        <TooltipProvider delayDuration={0}>
          {" "}
          {/* Ustawiamy zerowe opóźnienie dla testów */}
          {/* <TooltipProvider delayDuration={0}> // Przykład użycia */}
          {children}
          {/* </TooltipProvider> */}
        </TooltipProvider>
      </AuthProvider>
    </ThemeProvider>
  );
}

// Funkcja pomocnicza do renderowania komponentów w testach
function renderWithProviders(ui: React.ReactElement, options?: Omit<RenderOptions, "wrapper">) {
  return render(ui, { wrapper: TestWrapper, ...options });
}

// Re-eksportujemy wszystko z testing-library/react
export * from "@testing-library/react";
// Eksportujemy nasze funkcje pomocnicze
export { TestWrapper, renderWithProviders };



================================================
File: src/lib/utils.ts
================================================
import { clsx, type ClassValue } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}



================================================
File: src/lib/auth/AuthContext.tsx
================================================
import * as React from "react";
import { createContext, useContext, useState, useEffect, useCallback } from "react";
import type { ReactNode } from "react";
import type { UserDTO } from "../../types";
// Usunięto import supabaseClient, ponieważ wylogowanie klienta nie jest już potrzebne
// import { supabaseClient } from "../../db/supabase.client";

// Interfejs kontekstu autoryzacji - usunięto 'token', zmodyfikowano 'login'
interface AuthContextType {
  user: UserDTO | null;
  isLoading: boolean;
  isAuthenticated: boolean;
  authCheckCompleted: number; // Licznik udanych sprawdzeń sesji
  login: () => void; // Funkcja login nie przyjmuje już tokenu
  logout: () => Promise<void>;
  fetchUserData: () => Promise<void>; // Udostępnienie funkcji do ręcznego odświeżenia
}

// Domyślne wartości kontekstu - usunięto 'token'
const defaultAuthContext: AuthContextType = {
  user: null,
  isLoading: true,
  isAuthenticated: false,
  authCheckCompleted: 0,
  // eslint-disable-next-line @typescript-eslint/no-empty-function
  login: () => {},
  // eslint-disable-next-line @typescript-eslint/no-empty-function
  logout: async () => {},
  // eslint-disable-next-line @typescript-eslint/no-empty-function
  fetchUserData: async () => {},
};

// Utworzenie kontekstu
const AuthContext = createContext<AuthContextType>(defaultAuthContext);

// Hook do korzystania z kontekstu autoryzacji
export const useAuth = () => useContext(AuthContext);

interface AuthProviderProps {
  children: ReactNode;
}

// Dostawca kontekstu autoryzacji
export function AuthProvider({ children }: AuthProviderProps) {
  console.log("%c[AuthContext] AuthProvider rendering/re-rendering...", "color: orange; font-weight: bold;");

  const [user, setUser] = useState<UserDTO | null>(null);
  const [isLoading, setIsLoading] = useState<boolean>(true); // Zaczynamy jako loading
  const [isAuthenticatedState, setIsAuthenticatedState] = useState<boolean>(false);
  const [authCheckCounter, setAuthCheckCounter] = useState<number>(0);
  const [initialLoadComplete, setInitialLoadComplete] = useState<boolean>(false); // Nowy stan

  // Funkcja do pobierania danych użytkownika przez API /api/users/me
  // Opiera się na ciasteczkach sesji sb-* wysyłanych automatycznie przez przeglądarkę
  const fetchUserData = useCallback(async () => {
    console.log("[AuthContext] fetchUserData: Starting fetch for /api/users/me...");
    setIsLoading(true); // Rozpoczynamy ładowanie

    try {
      // Wywołujemy endpoint /api/users/me bez nagłówka Authorization
      // Serwer zweryfikuje sesję na podstawie ciasteczek sb-*
      const response = await fetch("/api/users/me");
      console.log(`[AuthContext] fetchUserData: Fetch /api/users/me completed. Status: ${response.status}`);

      if (response.ok) {
        const userData: UserDTO = await response.json();
        console.log("[AuthContext] fetchUserData: User data received.", userData);
        setUser(userData);
        setIsAuthenticatedState(true); // Użytkownik jest uwierzytelniony
        setAuthCheckCounter((prev) => prev + 1); // Zwiększamy licznik udanych sprawdzeń
      } else {
        // Jeśli odpowiedź nie jest OK (np. 401 Unauthorized), oznacza to brak ważnej sesji
        console.warn(
          `[AuthContext] fetchUserData: Fetch not OK (${response.status}), user is not authenticated or session expired.`
        );
        setUser(null);
        setIsAuthenticatedState(false); // Użytkownik nie jest uwierzytelniony
        // Nie musimy czyścić żadnych tokenów po stronie klienta
      }
    } catch (error) {
      console.error("[AuthContext] fetchUserData: Error fetching user data:", error);
      setUser(null); // Wyczyść użytkownika w razie błędu sieciowego itp.
      setIsAuthenticatedState(false);
    } finally {
      console.log("[AuthContext] fetchUserData: Finished.");
      setIsLoading(false); // Kończymy ładowanie niezależnie od wyniku
      if (!initialLoadComplete) {
        setInitialLoadComplete(true); // Oznaczamy pierwsze ładowanie jako zakończone
      }
    }
  }, [initialLoadComplete]); // Dodano initialLoadComplete jako zależność useCallback, aby uniknąć ostrzeżenia, chociaż nie jest to ściśle konieczne dla logiki.

  // Efekt do początkowego sprawdzenia autentykacji przy montowaniu komponentu
  useEffect(() => {
    console.log(
      "%c[AuthContext] useEffect [MOUNT]: Running initial authentication check...",
      "color: blue; font-weight: bold;"
    );
    // Od razu wywołujemy fetchUserData, aby sprawdzić sesję serwerową
    fetchUserData();

    // Ten efekt powinien uruchomić się tylko raz przy montowaniu
  }, [fetchUserData]); // Pusta tablica zależności zapewnia uruchomienie tylko raz

  // Funkcja logowania: po prostu odświeża dane użytkownika
  // Zakładamy, że API logowania (/api/auth/login) poprawnie ustawiło ciasteczka sb-*
  const loginCallback = useCallback(() => {
    console.log("[AuthContext] loginCallback: Triggering user data fetch after login attempt.");
    fetchUserData(); // Odśwież dane użytkownika, aby zsynchronizować stan z sesją serwerową
  }, [fetchUserData]); // Zależność od fetchUserData

  // Funkcja wylogowania
  const logoutCallback = useCallback(async () => {
    console.log("[AuthContext] logoutCallback: Initiating logout process.");

    // Najpierw czyścimy stan lokalny dla szybszej reakcji interfejsu
    setUser(null);
    setIsAuthenticatedState(false);

    console.log("[AuthContext] logoutCallback: Calling server-side logout endpoint /api/auth/logout...");
    try {
      const response = await fetch("/api/auth/logout", { method: "POST" });
      console.log(`[AuthContext] logoutCallback: Fetch /api/auth/logout completed. Status: ${response.status}`);
      if (!response.ok && response.status !== 204) {
        // Logujemy błąd, ale kontynuujemy, ponieważ stan lokalny już wyczyszczony
        console.error(`[AuthContext] logoutCallback: Logout API endpoint failed with status: ${response.status}`);
      } else {
        console.log("[AuthContext] logoutCallback: Server-side logout successful.");
      }
    } catch (error) {
      console.error("[AuthContext] logoutCallback: Error during fetch /api/auth/logout:", error);
    }

    // Nie ma potrzeby wywoływać supabaseClient.auth.signOut() po stronie klienta
    // Nie ma potrzeby czyścić localStorage/sessionStorage/cookie authToken

    // Po zakończeniu operacji serwerowych, przekierowujemy użytkownika
    console.log("[AuthContext] logoutCallback: Redirecting to /login page.");
    window.location.href = "/login"; // Proste przekierowanie strony
  }, []); // Brak zależności

  // Przygotowanie wartości kontekstu
  const value: AuthContextType = {
    user,
    isLoading,
    isAuthenticated: isAuthenticatedState,
    authCheckCompleted: authCheckCounter,
    login: loginCallback,
    logout: logoutCallback,
    fetchUserData, // Udostępniamy funkcję na zewnątrz
  };

  console.log("[AuthContext] Providing context value:", {
    isLoading: value.isLoading,
    isAuthenticated: value.isAuthenticated,
    userId: value.user?.id,
    authCheckCompleted: value.authCheckCompleted,
  });

  // Renderuj dzieci tylko po zakończeniu pierwszego ładowania
  return <AuthContext.Provider value={value}>{initialLoadComplete ? children : null}</AuthContext.Provider>;
}

// Dodatkowe eksporty dla ułatwienia użycia
export { AuthContext }; // Eksport kontekstu, jeśli potrzebny bezpośrednio



================================================
File: src/lib/auth/adminAuth.ts
================================================
/**
 * Funkcje pomocnicze do sprawdzania uprawnień administratora
 */
import { createClient } from "@supabase/supabase-js";
import type { Database } from "../../db/database.types";

// Definiujemy typ SupabaseClient lokalnie
type SupabaseClient = ReturnType<typeof createClient<Database>>;

/**
 * Sprawdza, czy użytkownik ma uprawnienia administratora
 * @param supabase Klient Supabase
 * @param userId ID użytkownika
 * @param isDevelopment Czy aplikacja działa w trybie deweloperskim
 * @returns Informacja, czy użytkownik ma uprawnienia administratora
 */
export async function isUserAdmin(supabase: SupabaseClient, userId: string, isDevelopment = false): Promise<boolean> {
  // W trybie deweloperskim wszyscy użytkownicy mają uprawnienia administratora
  if (isDevelopment) {
    console.log(`🔧 Tryb deweloperski: użytkownik ${userId} ma automatyczne uprawnienia administratora`);
    return true;
  }

  // W trybie produkcyjnym sprawdzamy uprawnienia w bazie danych
  try {
    // Ponieważ kolumna 'admin' nie istnieje w tabeli 'users',
    // pobieramy użytkownika po ID i sprawdzamy czy jest administratorem
    // Na tę chwilę w trybie produkcyjnym tylko określone ID użytkowników są administratorami
    const { data, error } = await supabase.from("users").select("id").eq("id", userId).single();

    if (error || !data) {
      console.error("Błąd podczas sprawdzania uprawnień administratora:", error);
      return false;
    }

    // Lista ID użytkowników z uprawnieniami administratora
    const adminUserIds = ["4e0a9b6a-b416-48e6-8d35-5700bd1d674a"]; // ID deweloperskie jako przykład
    return adminUserIds.includes(data.id);
  } catch (error) {
    console.error("Wyjątek podczas sprawdzania uprawnień administratora:", error);
    return false;
  }
}



================================================
File: src/lib/auth/validate-session.ts
================================================
import { supabaseClient } from "@/db/supabase.client";
import type { UserDTO } from "@/types";

interface SessionValidationResult {
  success: boolean;
  data?: {
    userId: string;
  };
  error?: string;
}

interface AuthLocals {
  isAuthenticated?: boolean;
  authUser?: UserDTO | null;
  [key: string]: unknown;
}

export async function validateSession(request: Request, locals?: AuthLocals): Promise<SessionValidationResult> {
  console.log("[validateSession] Rozpoczęcie walidacji sesji");

  try {
    // Najpierw sprawdź, czy informacje o uwierzytelnieniu zostały przekazane z middleware
    if (locals && locals.isAuthenticated === true && locals.authUser && locals.authUser.id) {
      console.log("[validateSession] Znaleziono dane uwierzytelniające w locals z middleware");
      return {
        success: true,
        data: {
          userId: locals.authUser.id,
        },
      };
    }

    console.log("[validateSession] Brak danych uwierzytelniających w locals, próba pobrania bezpośrednio z Supabase");

    // Jeśli nie ma informacji z middleware, spróbuj pobrać dane użytkownika bezpośrednio
    const {
      data: { user },
      error,
    } = await supabaseClient.auth.getUser();

    if (error) {
      console.error("[validateSession] Błąd Supabase:", error.message);
      return {
        success: false,
        error: error.message || "Unauthorized",
      };
    }

    if (!user) {
      console.error("[validateSession] Brak użytkownika z Supabase");
      return {
        success: false,
        error: "Auth session missing!",
      };
    }

    console.log("[validateSession] Pomyślnie zwalidowano sesję dla użytkownika:", user.email);
    return {
      success: true,
      data: {
        userId: user.id,
      },
    };
  } catch (error) {
    console.error("[validateSession] Nieoczekiwany błąd:", error);
    return {
      success: false,
      error: error instanceof Error ? error.message : "Session validation failed",
    };
  }
}



================================================
File: src/lib/hooks/useShoppingListDetail.ts
================================================
import { useState, useEffect, useCallback, useRef } from "react";
import type {
  ShoppingListItemDTO,
  UpdateShoppingListRequest,
  UpdateShoppingListResponse,
  UpdateShoppingListItemRequest,
  UpdateShoppingListItemResponse,
  ShoppingListDetailResponse,
} from "@/types";
// Importuj usługi toast używając poprawnej ścieżki relatywnej
import { showSuccessToast, showErrorToast } from "../services/toast-service";

// Model widoku dla pojedynczego elementu listy zakupów (zgodnie z planem)
export interface ProductItemViewModel extends ShoppingListItemDTO {
  isEditingName: boolean; // Czy nazwa jest aktualnie edytowana?
  isUpdating: boolean; // Czy element jest aktualnie aktualizowany/usuwany?
}

// Model widoku dla szczegółów listy zakupów (zgodnie z planem)
interface ShoppingListDetailViewModel {
  id: string; // ID listy
  title: string; // Tytuł listy
  items: ProductItemViewModel[]; // Lista elementów (ViewModel)
  createdAt: string; // Dodaj datę utworzenia
  updatedAt: string; // Dodaj datę aktualizacji
}

// Hook do zarządzania stanem i logiką widoku szczegółów listy zakupów
export function useShoppingListDetail(listId: string) {
  const [viewModel, setViewModel] = useState<ShoppingListDetailViewModel | null>(null);
  const [isLoading, setIsLoading] = useState<boolean>(true);
  const [isUpdating, setIsUpdating] = useState<boolean>(false); // Ogólny stan aktualizacji
  const [error, setError] = useState<string | null>(null);
  const retryCount = useRef(0);
  const maxRetries = 3; // Maksymalna liczba prób
  const retryDelay = 500; // Opóźnienie między próbami w ms

  // Funkcja do pobierania szczegółów listy
  const fetchListDetails = useCallback(
    async (isRetry = false) => {
      // Jeśli to nie jest ponowna próba, resetujemy stan
      if (!isRetry) {
        console.log(`[useShoppingListDetail] Fetching details for list ID: ${listId}`);
        setIsLoading(true);
        setError(null);
        setViewModel(null); // Wyczyść poprzednie dane na czas ładowania
      } else {
        console.log(
          `[useShoppingListDetail] Retrying fetch for list ID: ${listId}, attempt: ${retryCount.current + 1}`
        );
      }

      try {
        // Używamy nowego endpointu klienta zamiast standardowego API
        // Nie potrzebujemy już pobierać tokena, ponieważ autentykacja odbywa się przez cookie
        const response = await fetch(`/api/shopping-lists/${listId}`, {
          method: "GET",
          credentials: "include", // Dołączamy cookies do zapytania
        });

        if (!response.ok) {
          const errorData = await response.json().catch(() => ({}));
          throw new Error(`Błąd API (${response.status}): ${errorData.error || response.statusText}`);
        }

        const data: ShoppingListDetailResponse = await response.json();

        // Zmapuj odpowiedź API na ViewModel
        const fetchedViewModel: ShoppingListDetailViewModel = {
          id: data.id,
          title: data.title,
          createdAt: data.createdAt,
          updatedAt: data.updatedAt,
          items: data.items.map((item: ShoppingListItemDTO) => ({
            ...item,
            isEditingName: false, // Domyślny stan dla widoku
            isUpdating: false, // Domyślny stan dla widoku
          })),
        };

        setViewModel(fetchedViewModel);
        retryCount.current = 0; // Resetuj licznik prób po sukcesie
        console.log("[useShoppingListDetail] List details loaded:", fetchedViewModel);
      } catch (err) {
        const errorMessage = err instanceof Error ? err.message : "Nieznany błąd podczas pobierania szczegółów listy.";
        console.error("[useShoppingListDetail] Error fetching details:", errorMessage);

        // Sprawdź, czy błąd dotyczy uwierzytelniania i czy możemy spróbować ponownie
        const isAuthError =
          errorMessage.includes("zalogowany") ||
          errorMessage.includes("401") ||
          errorMessage.includes("authentication");

        if (isAuthError && retryCount.current < maxRetries) {
          // Jeśli to błąd uwierzytelniania, spróbuj ponownie po krótkim opóźnieniu
          retryCount.current += 1;
          console.log(
            `[useShoppingListDetail] Auth error detected, scheduling retry #${retryCount.current} in ${retryDelay}ms`
          );

          // Nie ustawiamy błędu ani nie pokazujemy toastu dla automatycznych ponownych prób
          setTimeout(() => {
            fetchListDetails(true);
          }, retryDelay);

          return; // Wyjdź wcześniej, nie ustawiaj stanu błędu ani nie kończ ładowania
        }

        // Jeśli to nie błąd auth lub przekroczyliśmy limit prób, pokaż błąd
        setError(errorMessage);

        // Pokaż toast błędu tylko jeśli wyczerpaliśmy ponowne próby lub to nie jest błąd uwierzytelniania
        if (!isAuthError || retryCount.current >= maxRetries) {
          showErrorToast("Błąd pobierania listy", { description: errorMessage });
        }

        // Ustawiamy viewModel na null w przypadku błędu, aby komponent mógł to obsłużyć
        setViewModel(null);
        retryCount.current = 0; // Resetuj licznik prób po wyświetleniu błędu
      } finally {
        if (retryCount.current === 0 || retryCount.current >= maxRetries) {
          setIsLoading(false);
        }
      }
    },
    [listId]
  ); // Zależność od listId

  // Pobranie danych przy pierwszym renderowaniu lub zmianie listId
  useEffect(() => {
    if (listId) {
      fetchListDetails();
    } else {
      // Jeśli listId jest puste lub null, zresetuj stan
      setIsLoading(false);
      setViewModel(null);
      setError("Invalid List ID");
    }
  }, [listId, fetchListDetails]);

  // Funkcja do aktualizacji tytułu listy
  const updateTitle = useCallback(
    async (newTitle: string) => {
      if (!viewModel || newTitle === viewModel.title) {
        return; // Bez zmian
      }

      const trimmedTitle = newTitle.trim();
      if (trimmedTitle.length === 0 || trimmedTitle.length > 255) {
        showErrorToast("Nieprawidłowy tytuł", {
          description: "Tytuł musi zawierać od 1 do 255 znaków.",
        });
        throw new Error("Invalid title length"); // Rzuć błąd, aby komponent mógł zareagować
      }

      setIsUpdating(true);
      setError(null);

      try {
        const requestBody: UpdateShoppingListRequest = { title: trimmedTitle };

        const response = await fetch(`/api/shopping-lists/${listId}`, {
          method: "PUT",
          headers: {
            "Content-Type": "application/json",
          },
          credentials: "include", // Dołączamy cookies do zapytania
          body: JSON.stringify(requestBody),
        });

        if (!response.ok) {
          const errorData = await response.json().catch(() => ({}));
          throw new Error(`Błąd API (${response.status}): ${errorData.error || response.statusText}`);
        }

        const data: UpdateShoppingListResponse = await response.json();

        // Aktualizacja stanu po sukcesie - weź dane z odpowiedzi API
        setViewModel((prev) =>
          prev
            ? {
                ...prev,
                title: data.title,
                updatedAt: data.updatedAt, // Zaktualizuj updatedAt
              }
            : null
        );

        showSuccessToast("Tytuł zaktualizowany", {
          description: `Tytuł listy został zmieniony na "${data.title}".`,
          duration: 3000, // Standardowa długość dla powiadomień o sukcesie
        });
      } catch (err) {
        const errorMessage = err instanceof Error ? err.message : "Nieznany błąd podczas aktualizacji tytułu.";
        setError(errorMessage);
        showErrorToast("Błąd aktualizacji tytułu", {
          description: errorMessage,
          duration: 5000, // Dłuższy czas dla błędów
        });
        throw err; // Rzuć błąd dalej, aby komponent mógł zareagować
      } finally {
        setIsUpdating(false);
      }
    },
    [listId, viewModel]
  );

  const toggleItemPurchased = useCallback(
    async (itemId: string) => {
      if (!viewModel) return;

      const itemIndex = viewModel.items.findIndex((item) => item.id === itemId);
      if (itemIndex === -1) {
        console.error(`[toggleItemPurchased] Item with id ${itemId} not found.`);
        showErrorToast("Błąd", {
          description: "Nie znaleziono produktu do zaktualizowania.",
          duration: 5000, // Dłuższy czas dla błędów
        });
        return;
      }

      const originalItem = viewModel.items[itemIndex];
      const newPurchasedStatus = !originalItem.purchased;

      // Optymistyczna aktualizacja UI
      setViewModel((prev) => {
        if (!prev) return null;
        const updatedItems = [...prev.items];
        updatedItems[itemIndex] = {
          ...originalItem,
          purchased: newPurchasedStatus,
          isUpdating: true, // Oznacz jako aktualizowany
        };
        return { ...prev, items: updatedItems };
      });

      try {
        const requestBody: UpdateShoppingListItemRequest = { purchased: newPurchasedStatus };

        const response = await fetch(`/api/shopping-lists/${listId}/items/${itemId}`, {
          method: "PUT",
          headers: {
            "Content-Type": "application/json",
          },
          credentials: "include", // Dołączamy cookies do zapytania
          body: JSON.stringify(requestBody),
        });

        if (!response.ok) {
          const errorData = await response.json().catch(() => ({}));
          throw new Error(`Błąd API (${response.status}): ${errorData.error || response.statusText}`);
        }

        const data: UpdateShoppingListItemResponse = await response.json();

        // Potwierdzenie aktualizacji - zastosuj dane z serwera (głównie updatedAt)
        setViewModel((prev) => {
          if (!prev) return null;
          const confirmedItems = [...prev.items];
          const confirmedIndex = confirmedItems.findIndex((item) => item.id === itemId);
          if (confirmedIndex !== -1) {
            confirmedItems[confirmedIndex] = {
              ...confirmedItems[confirmedIndex],
              purchased: data.purchased, // Użyj danych z serwera
              updatedAt: data.updatedAt, // Zaktualizuj updatedAt
              isUpdating: false, // Zakończ ładowanie
            };
          }
          return { ...prev, items: confirmedItems };
        });

        // Nie pokazujemy toastu sukcesu dla tej akcji, bo zmiana jest widoczna od razu
        // showSuccessToast("Status produktu zaktualizowany");
      } catch (err) {
        const errorMessage =
          err instanceof Error ? err.message : "Nieznany błąd podczas aktualizacji statusu produktu.";
        setError(errorMessage); // Ustaw ogólny błąd hooka
        showErrorToast("Błąd aktualizacji produktu", {
          description: errorMessage,
          duration: 5000, // Dłuższy czas dla błędów
        });

        // Przywrócenie oryginalnego stanu listy w przypadku błędu
        setViewModel((prev) => {
          if (!prev) return null;
          const revertedItems = [...prev.items];
          const revertIndex = revertedItems.findIndex((item) => item.id === itemId);
          if (revertIndex !== -1) {
            revertedItems[revertIndex] = {
              ...originalItem,
              isUpdating: false, // Zakończ ładowanie
            };
          }
          return { ...prev, items: revertedItems };
        });
      }
    },
    [listId, viewModel]
  );

  const deleteItem = useCallback(
    async (itemId: string) => {
      if (!viewModel) return;

      const itemIndex = viewModel.items.findIndex((item) => item.id === itemId);
      if (itemIndex === -1) {
        console.error(`[deleteItem] Item with id ${itemId} not found.`);
        showErrorToast("Błąd", {
          description: "Nie znaleziono produktu do usunięcia.",
          duration: 5000, // Dłuższy czas dla błędów
        });
        return;
      }

      const itemToDelete = viewModel.items[itemIndex];

      // Aktualizacja optymistyczna UI (usuń z listy)
      setViewModel((prev) => {
        if (!prev) return null;
        const updatedItems = prev.items.filter((item) => item.id !== itemId);
        return { ...prev, items: updatedItems };
      });

      try {
        const response = await fetch(`/api/shopping-lists/${listId}/items/${itemId}`, {
          method: "DELETE",
          credentials: "include", // Dołączamy cookies do zapytania
        });

        if (!response.ok) {
          const errorData = await response.json().catch(() => ({}));
          throw new Error(`Błąd API (${response.status}): ${errorData.error || response.statusText}`);
        }

        // Potwierdzenie usunięcia
        console.log(`[deleteItem] Successfully deleted item ${itemId}`);
        // Nie pokazujemy osobnego toastu dla usunięć, aby nie zaśmiecać interfejsu
      } catch (err) {
        const errorMessage = err instanceof Error ? err.message : "Nieznany błąd podczas usuwania produktu.";
        setError(errorMessage);
        showErrorToast("Błąd usuwania produktu", {
          description: errorMessage,
          duration: 5000, // Dłuższy czas dla błędów
        });

        // Przywrócenie usuniętego produktu
        setViewModel((prev) => {
          if (!prev) return null;
          const restoredItems = [...prev.items];
          // Dodaj produkt z powrotem, zachowując oryginalną kolejność
          restoredItems.splice(itemIndex, 0, itemToDelete);
          return { ...prev, items: restoredItems };
        });
      }
    },
    [listId, viewModel]
  );

  // Funkcja do aktualizacji nazwy elementu
  const updateItemName = useCallback(
    async (itemId: string, newName: string) => {
      if (!viewModel) return;

      const itemIndex = viewModel.items.findIndex((item) => item.id === itemId);
      if (itemIndex === -1) {
        console.error(`[updateItemName] Item with id ${itemId} not found.`);
        showErrorToast("Błąd", {
          description: "Nie znaleziono produktu do zaktualizowania.",
          duration: 5000, // Dłuższy czas dla błędów
        });
        return;
      }

      const originalItem = viewModel.items[itemIndex];
      const trimmedName = newName.trim();

      // Walidacja
      if (trimmedName === "") {
        showErrorToast("Nieprawidłowa nazwa", {
          description: "Nazwa produktu nie może być pusta.",
          duration: 5000, // Dłuższy czas dla błędów
        });
        return;
      }

      if (trimmedName === originalItem.itemName) {
        // Bez zmian, wyjdź bez aktualizacji API/stanu
        return;
      }

      // Aktualizacja optymistyczna UI
      setViewModel((prev) => {
        if (!prev) return null;
        const updatedItems = [...prev.items];
        updatedItems[itemIndex] = {
          ...originalItem,
          itemName: trimmedName,
          isEditingName: false, // Zakończ edycję
          isUpdating: true, // Oznacz jako aktualizowany
        };
        return { ...prev, items: updatedItems };
      });

      try {
        const requestBody: UpdateShoppingListItemRequest = { itemName: trimmedName };

        const response = await fetch(`/api/shopping-lists/${listId}/items/${itemId}`, {
          method: "PUT",
          headers: {
            "Content-Type": "application/json",
          },
          credentials: "include", // Dołączamy cookies do zapytania
          body: JSON.stringify(requestBody),
        });

        if (!response.ok) {
          const errorData = await response.json().catch(() => ({}));
          throw new Error(`Błąd API (${response.status}): ${errorData.error || response.statusText}`);
        }

        const data: UpdateShoppingListItemResponse = await response.json();

        // Potwierdzenie aktualizacji
        setViewModel((prev) => {
          if (!prev) return null;
          const confirmedItems = [...prev.items];
          const confirmedIndex = confirmedItems.findIndex((item) => item.id === itemId);
          if (confirmedIndex !== -1) {
            confirmedItems[confirmedIndex] = {
              ...confirmedItems[confirmedIndex],
              itemName: data.itemName, // Użyj danych z serwera (mogą być znormalizowane)
              updatedAt: data.updatedAt, // Zaktualizuj updatedAt
              isUpdating: false, // Zakończ ładowanie
            };
          }
          return { ...prev, items: confirmedItems };
        });
      } catch (err) {
        const errorMessage = err instanceof Error ? err.message : "Nieznany błąd podczas aktualizacji nazwy produktu.";
        setError(errorMessage);
        showErrorToast("Błąd aktualizacji nazwy", {
          description: errorMessage,
          duration: 5000, // Dłuższy czas dla błędów
        });

        // Przywrócenie oryginalnego stanu
        setViewModel((prev) => {
          if (!prev) return null;
          const revertedItems = [...prev.items];
          const revertIndex = revertedItems.findIndex((item) => item.id === itemId);
          if (revertIndex !== -1) {
            revertedItems[revertIndex] = { ...originalItem, isUpdating: false };
          }
          return { ...prev, items: revertedItems };
        });
      }
    },
    [listId, viewModel]
  );

  // Zmieniono nazwę i logikę funkcji - teraz tylko odświeża listę
  const refreshListAfterAiUpdate = useCallback(async () => {
    console.log("[useShoppingListDetail] Refreshing list details after AI update...");
    // Po prostu wywołaj funkcję pobierającą świeże dane z serwera
    await fetchListDetails();
    // Nie ma potrzeby obsługi błędów tutaj, fetchListDetails ma swoją obsługę
    // Nie ma potrzeby optymistycznej aktualizacji
    // Nie ma potrzeby wysyłania żądań POST
  }, [fetchListDetails]); // Zależność od fetchListDetails

  // Funkcja pomocnicza do przełączania trybu edycji nazwy produktu
  const toggleItemNameEditing = (/* itemId: string, isEditing: boolean */) => {
    // Pełna implementacja tej funkcji jest niżej w kodzie pliku
    // Ta linia jest tylko częścią skopiowanego fragmentu
    // ... existing code ...
  };

  // Zwrócenie stanu i funkcji do użycia w komponencie
  return {
    // Rozpakuj viewModel ostrożnie, jeśli może być null
    id: viewModel?.id ?? listId, // Zwróć listId jeśli viewModel jest null
    title: viewModel?.title ?? "", // Zwróć pusty string, jeśli viewModel jest null
    items: viewModel?.items ?? [], // Zwróć pustą tablicę, jeśli viewModel jest null
    createdAt: viewModel?.createdAt, // Dodaj createdAt
    updatedAt: viewModel?.updatedAt, // Dodaj updatedAt
    isLoading,
    isUpdating, // Zwróć ogólny stan aktualizacji
    error,
    fetchListDetails, // Nadal eksportujemy dla potencjalnego ręcznego odświeżania
    updateTitle,
    toggleItemPurchased,
    deleteItem,
    updateItemName,
    refreshListAfterAiUpdate, // Eksportujemy nową funkcję
    toggleItemNameEditing,
  };
}



================================================
File: src/lib/hooks/useShoppingLists.ts
================================================
import { useState, useCallback } from "react";
import type {
  ShoppingListSummaryDTO,
  CreateShoppingListRequest,
  CreateShoppingListResponse,
  PaginationResponse,
} from "../../types";
import { showSuccessToast, showErrorToast } from "../services/toast-service";
import { useAuth } from "../auth/AuthContext";

// Define the shape of the props expected by the hook
interface UseShoppingListsProps {
  initialLists: ShoppingListSummaryDTO[];
  initialPagination: PaginationResponse | null;
  fetchError: string | null;
}

// Typ dla modelu widoku pojedynczego elementu list zakupów
interface ShoppingListItemViewModel extends ShoppingListSummaryDTO {
  isDeleting: boolean;
}

// Typ dla całego modelu widoku list zakupów
interface ShoppingListsViewModel {
  lists: ShoppingListItemViewModel[];
  isLoading: boolean;
  isCreating: boolean;
  error: string | null;
  pagination: PaginationResponse | null;
}

// Hook now accepts initial props
export function useShoppingLists({
  initialLists = [],
  initialPagination = null,
  fetchError = null,
}: UseShoppingListsProps) {
  // Initialize state using the props passed from the server-side fetch
  const [viewModel, setViewModel] = useState<ShoppingListsViewModel>(() => {
    // Map initialLists to add isDeleting flag
    const mappedInitialLists = initialLists.map((list) => ({ ...list, isDeleting: false }));
    return {
      lists: mappedInitialLists,
      isLoading: false, // Initial load happened on server
      isCreating: false,
      error: fetchError, // Use error from server fetch
      pagination: initialPagination, // Use pagination from server fetch
    };
  });

  // We still need auth context for user ID in create/delete actions
  const { isAuthenticated, user } = useAuth();

  // REMOVED the useEffect that was responsible for the initial client-side fetch
  // The initial data is now provided via props.

  // Define fetchShoppingLists for potential future use (e.g., manual refresh)
  // but it's not called automatically on load anymore.
  const fetchShoppingLists = useCallback(
    async (page = 1, pageSize = 20) => {
      if (!isAuthenticated || !user) {
        console.warn("[useShoppingLists] fetchShoppingLists called but user not authenticated.");
        setViewModel((prev) => ({ ...prev, isLoading: false, error: "Użytkownik nie jest zalogowany" }));
        return;
      }

      setViewModel((prev) => ({ ...prev, isLoading: true, error: null }));
      console.log(`[useShoppingLists] Refetching shopping lists (Page: ${page})...`);

      try {
        // Zmieniamy URL na endpoint klienta - Updated to new path
        const apiUrl = new URL("/api/shopping-lists", window.location.origin);
        apiUrl.searchParams.set("page", page.toString());
        apiUrl.searchParams.set("pageSize", pageSize.toString());

        // Usuwamy logikę dodawania nagłówka Authorization Bearer
        // const headers: Record<string, string> = { "Content-Type": "application/json" };
        // if (token) {
        //   headers["Authorization"] = `Bearer ${token}`;
        // }

        // Wywołujemy fetch bez nagłówka Authorization, ale z credentials: "include"
        const response = await fetch(apiUrl.toString(), {
          headers: { "Content-Type": "application/json" }, // Content-Type jest nadal potrzebny
          credentials: "include", // Kluczowe dla używania sesji/ciasteczek
        });

        if (!response.ok) {
          const errorData = await response.json().catch(() => ({ message: response.statusText }));
          // Dodajemy obsługę statusu 401 (Unauthorized)
          if (response.status === 401) {
            throw new Error("Sesja wygasła lub użytkownik nie jest zalogowany.");
          }
          throw new Error(
            `Błąd podczas pobierania list (${response.status}): ${errorData.message || errorData.error || response.statusText}`
          );
        }

        const data: { data: ShoppingListSummaryDTO[]; pagination: PaginationResponse } = await response.json();
        const mappedLists: ShoppingListItemViewModel[] = data.data.map((list) => ({ ...list, isDeleting: false }));

        setViewModel((prev) => ({
          ...prev,
          lists: mappedLists,
          isLoading: false,
          pagination: data.pagination,
        }));
      } catch (err) {
        const errorMessage = err instanceof Error ? err.message : "Nieznany błąd podczas pobierania list zakupów";
        setViewModel((prev) => ({ ...prev, isLoading: false, error: errorMessage }));
        showErrorToast("Nie udało się odświeżyć list zakupów", { description: errorMessage });
      }
    },
    // Usuwamy token z zależności, bo już go nie używamy
    [isAuthenticated, user] // Only need isAuthenticated and user now
  ); // Dependencies for the refetch function

  // Create and Delete functions remain largely the same,
  // they rely on cookies (via fetch) or token from context for auth,
  // and useAuth() provides the necessary user.id.

  const createList = async (): Promise<string | null> => {
    // Auth check removed
    setViewModel((prev) => ({ ...prev, isCreating: true, error: null }));
    console.log("[useShoppingLists] Creating new list via client endpoint...");

    try {
      const defaultTitle = `Lista zakupów ${new Date().toLocaleDateString("pl-PL")}`;
      const requestData: CreateShoppingListRequest = { title: defaultTitle };
      // Headers: Remove Authorization header logic
      const headers: Record<string, string> = { "Content-Type": "application/json" };
      /* 
      if (token) {
        headers["Authorization"] = `Bearer ${token}`;
      }
      */

      // Use the NEW client-specific endpoint - Corrected path to match backend
      const response = await fetch("/api/shopping-lists/", {
        // Remove /create
        method: "POST",
        headers: headers,
        body: JSON.stringify(requestData),
        credentials: "include", // Keep this
      });

      console.log(`[useShoppingLists] Create list (client endpoint) response status: ${response.status}`);

      if (!response.ok) {
        const errorData = await response.json().catch(() => ({ message: response.statusText }));
        console.error(`[useShoppingLists] Error creating list (${response.status}):`, errorData);
        if (response.status === 401) {
          throw new Error("Sesja wygasła lub użytkownik nie jest zalogowany.");
        }
        throw new Error(
          `Błąd podczas tworzenia listy (${response.status}): ${errorData.message || errorData.error || "Nieznany błąd API"}`
        );
      }

      // Assuming the new endpoint returns the same CreateShoppingListResponse shape
      const data: CreateShoppingListResponse = await response.json();
      console.log("[useShoppingLists] List created successfully:", data);

      // Przygotuj nowy element listy w formacie ViewModel
      const newListViewModel: ShoppingListItemViewModel = {
        id: data.id,
        title: defaultTitle, // Użyj domyślnego tytułu użytego w żądaniu
        createdAt: new Date().toISOString(), // Przybliżona data utworzenia
        updatedAt: new Date().toISOString(), // Przybliżona data aktualizacji
        itemCount: 0, // Nowa lista nie ma jeszcze elementów
        isDeleting: false,
      };

      setViewModel((prev) => ({
        ...prev,
        isCreating: false,
        // Dodaj nową listę na początek istniejącej listy
        lists: [newListViewModel, ...prev.lists],
        // Opcjonalnie: Zaktualizuj paginację, jeśli jest używana
        pagination: prev.pagination ? { ...prev.pagination, totalItems: prev.pagination.totalItems + 1 } : null, // Możesz potrzebować bardziej złożonej logiki, jeśli listy są sortowane inaczej niż wg daty utworzenia
      }));

      showSuccessToast("Lista zakupów została utworzona", {
        description: `Lista "${defaultTitle}" została pomyślnie utworzona.`,
      });
      return data.id;
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : "Nieznany błąd podczas tworzenia listy";
      console.error("[useShoppingLists] Create list catch block error:", errorMessage);
      setViewModel((prev) => ({ ...prev, isCreating: false, error: errorMessage }));
      showErrorToast("Nie udało się utworzyć listy zakupów", { description: errorMessage });
      return null;
    }
  };

  // Funkcja do usuwania listy zakupów
  const deleteList = async (listId: string): Promise<void> => {
    // Auth check removed
    const listToDelete = viewModel.lists.find((list) => list.id === listId);
    const listTitle = listToDelete?.title || "Lista zakupów";
    setViewModel((prev) => ({
      ...prev,
      lists: prev.lists.map((list) => (list.id === listId ? { ...list, isDeleting: true } : list)),
    }));
    console.log(`[useShoppingLists] Attempting to delete list ${listId} via client endpoint...`);

    try {
      // Headers: Remove Authorization header logic
      const headers: Record<string, string> = {};
      /*
      if (token) {
        headers["Authorization"] = `Bearer ${token}`;
      }
      */

      // Use the NEW client-specific endpoint - Updated to new path
      const response = await fetch(`/api/shopping-lists/${listId}`, {
        method: "DELETE",
        headers: headers,
        credentials: "include", // Keep this
      });

      console.log(`[useShoppingLists] Delete list (client endpoint) response status: ${response.status}`);

      if (!response.ok) {
        // Revert optimistic update
        setViewModel((prev) => ({
          ...prev,
          lists: prev.lists.map((list) => (list.id === listId ? { ...list, isDeleting: false } : list)),
        }));

        // Try to parse error, default to status text
        let errorJson = { message: response.statusText };
        try {
          errorJson = await response.json();
        } catch (
          // eslint-disable-next-line @typescript-eslint/no-unused-vars
          _
        ) {
          /* Ignore parsing error - fix linter */
        }

        console.error(`[useShoppingLists] Error deleting list ${listId} (${response.status}):`, errorJson);
        if (response.status === 401) {
          throw new Error("Sesja wygasła lub użytkownik nie jest zalogowany.");
        }
        if (response.status === 404) {
          throw new Error("Nie znaleziono listy do usunięcia.");
        }
        throw new Error(
          `Błąd podczas usuwania listy (${response.status}): ${errorJson.message || "Nieznany błąd API"}`
        );
      }

      // Status 204 No Content on successful delete
      console.log(`[useShoppingLists] List ${listId} deleted successfully.`);
      setViewModel((prev) => ({
        ...prev,
        lists: prev.lists.filter((list) => list.id !== listId),
        pagination: prev.pagination ? { ...prev.pagination, totalItems: prev.pagination.totalItems - 1 } : null,
      }));
      showSuccessToast("Lista zakupów została usunięta", {
        description: `Lista "${listTitle}" została pomyślnie usunięta.`,
        duration: 3000, // Standardowa długość dla powiadomień o sukcesie
      });
    } catch (err) {
      // Revert optimistic update on error
      setViewModel((prev) => ({
        ...prev,
        lists: prev.lists.map((list) => (list.id === listId ? { ...list, isDeleting: false } : list)),
        error: err instanceof Error ? err.message : "Nieznany błąd podczas usuwania listy",
      }));
      console.error(`[useShoppingLists] Delete list ${listId} catch block error:`, err);
      showErrorToast("Nie udało się usunąć listy zakupów", {
        description: err instanceof Error ? err.message : "Nieznany błąd podczas usuwania listy",
        duration: 5000, // Dłuższy czas dla błędów
      });
    }
  };

  // Return state and actions
  return {
    lists: viewModel.lists,
    // isLoading now primarily reflects the creating/deleting state or manual refresh
    isLoading: viewModel.isLoading || viewModel.isCreating,
    isCreating: viewModel.isCreating, // Keep this for specific create button state
    error: viewModel.error,
    pagination: viewModel.pagination,
    createList,
    deleteList,
    refetch: fetchShoppingLists, // Expose refetch if manual refresh is needed
  };
}



================================================
File: src/lib/schemas/userSchemas.ts
================================================
/**
 * Schematy walidacji danych użytkowników używające Zod
 */
import { z } from "zod";

/**
 * Schemat UUID dla identyfikatorów użytkowników
 */
export const userIdSchema = z.string().uuid({
  message: "ID użytkownika musi być poprawnym UUID",
});

/**
 * Schemat adresu email
 */
export const emailSchema = z.string().email({
  message: "Podaj poprawny adres email",
});

/**
 * Schemat hasła
 */
export const passwordSchema = z.string().min(8, {
  message: "Hasło musi mieć co najmniej 8 znaków",
});

/**
 * Schemat parametrów zapytania dla pobierania wszystkich użytkowników
 */
export const getAllUsersQuerySchema = z.object({
  page: z.coerce.number().int().positive().default(1),
  pageSize: z.coerce.number().int().positive().max(100).default(20),
  sort: z.enum(["email", "registrationDate"]).optional().default("email"),
  order: z.enum(["asc", "desc"]).optional().default("asc"),
  emailFilter: z.string().optional().nullable(),
});

/**
 * Schemat aktualizacji użytkownika
 */
export const updateUserSchema = z
  .object({
    email: emailSchema.optional(),
    password: passwordSchema.optional(),
  })
  .refine((data) => data.email !== undefined || data.password !== undefined, {
    message: "Musisz podać email lub hasło do aktualizacji",
  });



================================================
File: src/lib/services/shopping-list.service.ts
================================================
import type { SupabaseClient, PostgrestError } from "@supabase/supabase-js";
import type {
  CreateShoppingListRequest,
  CreateShoppingListResponse,
  ShoppingListSummaryDTO,
  GetAllShoppingListsResponse,
  PaginationResponse,
  GetShoppingListByIdResponse,
  ShoppingListItemDTO,
  UpdateShoppingListRequest,
  UpdateShoppingListResponse,
  ShoppingListDetailResponse,
  UpdateShoppingListItemResponse,
} from "../../types";
import { logger } from "../logger";

/**
 * Klasa reprezentująca błąd związany z listą zakupów
 */
export class ShoppingListError extends Error {
  constructor(
    message: string,
    public readonly code: string,
    public readonly originalError?: PostgrestError | Error | unknown
  ) {
    super(message);
    this.name = "ShoppingListError";
  }
}

/**
 * Tworzy nową listę zakupów dla użytkownika
 *
 * @param supabase Klient Supabase
 * @param userId ID użytkownika
 * @param data Dane listy zakupów do utworzenia
 * @returns Nowo utworzona lista zakupów
 * @throws {ShoppingListError} Gdy wystąpi błąd podczas tworzenia listy zakupów
 */
export async function createShoppingList(
  supabase: SupabaseClient,
  userId: string,
  data: CreateShoppingListRequest
): Promise<CreateShoppingListResponse> {
  logger.info("Rozpoczęcie tworzenia nowej listy zakupów", { userId, title: data.title });

  try {
    const { data: shoppingList, error } = await supabase
      .from("shopping_lists")
      .insert([
        {
          user_id: userId,
          title: data.title,
        },
      ])
      .select("id, title, created_at, updated_at")
      .single();

    if (error) {
      // Mapowanie błędów Supabase na własne kody błędów
      logger.error("Błąd bazy danych podczas tworzenia listy zakupów", { userId, errorCode: error.code }, error);

      if (error.code === "23505") {
        throw new ShoppingListError("Lista zakupów o podanym tytule już istnieje", "DUPLICATE_TITLE", error);
      } else if (error.code === "23503") {
        throw new ShoppingListError("Nie znaleziono użytkownika o podanym ID", "USER_NOT_FOUND", error);
      } else if (error.code === "42P01") {
        throw new ShoppingListError("Błąd konfiguracji bazy danych: tabela nie istnieje", "DATABASE_ERROR", error);
      } else {
        throw new ShoppingListError("Nie udało się utworzyć listy zakupów", "DATABASE_ERROR", error);
      }
    }

    if (!shoppingList) {
      logger.error("Błąd podczas tworzenia listy zakupów - brak danych zwrotnych", { userId });
      throw new ShoppingListError("Nie udało się utworzyć listy zakupów - brak danych zwrotnych", "NO_DATA_RETURNED");
    }

    // Pomyślnie utworzono listę zakupów
    logger.info("Pomyślnie utworzono nową listę zakupów", {
      userId,
      listId: shoppingList.id,
      title: shoppingList.title,
    });

    // Mapowanie zwróconych danych na format DTO
    return {
      id: shoppingList.id,
      title: shoppingList.title,
      createdAt: shoppingList.created_at,
      updatedAt: shoppingList.updated_at,
    };
  } catch (error) {
    // Przechwytujemy i przekazujemy dalej błędy ShoppingListError
    if (error instanceof ShoppingListError) {
      throw error;
    }

    // Pozostałe błędy opakowujemy w ShoppingListError
    logger.error("Nieoczekiwany błąd podczas tworzenia listy zakupów", { userId }, error);
    throw new ShoppingListError(
      "Wystąpił nieoczekiwany błąd podczas tworzenia listy zakupów",
      "UNEXPECTED_ERROR",
      error
    );
  }
}

/**
 * Pobiera wszystkie listy zakupów dla użytkownika
 *
 * @param supabase Klient Supabase
 * @param userId ID użytkownika
 * @param page Numer strony (domyślnie: 1)
 * @param pageSize Liczba elementów na stronę (domyślnie: 20)
 * @param sort Pole, według którego sortowane są wyniki (domyślnie: "createdAt")
 * @param order Kolejność sortowania (domyślnie: "desc")
 * @returns Listy zakupów z informacjami o paginacji
 * @throws {ShoppingListError} Gdy wystąpi błąd podczas pobierania list zakupów
 */
export async function getAllShoppingLists(
  supabase: SupabaseClient,
  userId: string,
  page = 1,
  pageSize = 20,
  sort = "createdAt",
  order: "asc" | "desc" = "desc"
): Promise<GetAllShoppingListsResponse> {
  logger.info("Rozpoczęcie pobierania list zakupów", { userId, page, pageSize, sort, order });

  try {
    // Mapowanie pól sortowania z camelCase na snake_case używane w bazie danych
    const sortFieldMap: Record<string, string> = {
      title: "title",
      createdAt: "created_at",
      updatedAt: "updated_at",
    };

    const sortField = sortFieldMap[sort] || "created_at";

    // Obliczanie offsetu dla paginacji
    const offset = (page - 1) * pageSize;

    // 1. Pobieranie całkowitej liczby list zakupów użytkownika
    const { count, error: countError } = await supabase
      .from("shopping_lists")
      .select("*", { count: "exact", head: true })
      .eq("user_id", userId);

    if (countError) {
      logger.error("Błąd podczas liczenia list zakupów", { userId, errorCode: countError.code }, countError);
      throw new ShoppingListError("Nie udało się pobrać liczby list zakupów", "DATABASE_ERROR", countError);
    }

    const totalItems = count || 0;
    const totalPages = Math.ceil(totalItems / pageSize);

    // 2. Pobieranie list zakupów z paginacją i sortowaniem
    const { data: lists, error: listsError } = await supabase
      .from("shopping_lists")
      .select("id, title, created_at, updated_at")
      .eq("user_id", userId)
      .order(sortField, { ascending: order === "asc" })
      .range(offset, offset + pageSize - 1);

    if (listsError) {
      logger.error("Błąd podczas pobierania list zakupów", { userId, errorCode: listsError.code }, listsError);
      throw new ShoppingListError("Nie udało się pobrać list zakupów", "DATABASE_ERROR", listsError);
    }

    // 3. Pobieranie liczby elementów dla każdej listy
    const listsWithCounts: ShoppingListSummaryDTO[] = await Promise.all(
      (lists || []).map(async (list) => {
        const { count: itemCount, error: itemCountError } = await supabase
          .from("shopping_list_items")
          .select("*", { count: "exact", head: true })
          .eq("shopping_list_id", list.id);

        if (itemCountError) {
          logger.warn(
            "Błąd podczas liczenia elementów listy",
            { userId, listId: list.id, errorCode: itemCountError.code },
            itemCountError
          );
          // W przypadku błędu przy liczeniu elementów, zakładamy 0
          return {
            id: list.id,
            title: list.title,
            createdAt: list.created_at,
            updatedAt: list.updated_at,
            itemCount: 0,
          };
        }

        return {
          id: list.id,
          title: list.title,
          createdAt: list.created_at,
          updatedAt: list.updated_at,
          itemCount: itemCount || 0,
        };
      })
    );

    // 4. Przygotowanie informacji o paginacji
    const pagination: PaginationResponse = {
      totalItems,
      totalPages,
      currentPage: page,
      pageSize,
    };

    logger.info("Pomyślnie pobrano listy zakupów", {
      userId,
      page,
      pageSize,
      totalItems,
      totalPages,
      listsCount: listsWithCounts.length,
    });

    // 5. Zwrócenie wyników
    return {
      data: listsWithCounts,
      pagination,
    };
  } catch (error) {
    // Przechwytujemy i przekazujemy dalej błędy ShoppingListError
    if (error instanceof ShoppingListError) {
      throw error;
    }

    // Pozostałe błędy opakowujemy w ShoppingListError
    logger.error("Nieoczekiwany błąd podczas pobierania list zakupów", { userId }, error);
    throw new ShoppingListError(
      "Wystąpił nieoczekiwany błąd podczas pobierania list zakupów",
      "UNEXPECTED_ERROR",
      error
    );
  }
}

/**
 * Pobiera szczegóły pojedynczej listy zakupów wraz z elementami
 *
 * @param supabase Klient Supabase
 * @param userId ID użytkownika
 * @param listId ID listy zakupów
 * @returns Szczegóły listy zakupów wraz z elementami
 * @throws {ShoppingListError} Gdy wystąpi błąd podczas pobierania listy zakupów
 */
export async function getShoppingListById(
  supabase: SupabaseClient,
  userId: string,
  listId: string
): Promise<GetShoppingListByIdResponse> {
  logger.info("Rozpoczęcie pobierania szczegółów listy zakupów", { userId, listId });

  try {
    // 1. Pobieranie informacji o liście zakupów
    const { data: shoppingList, error: listError } = await supabase
      .from("shopping_lists")
      .select("id, title, created_at, updated_at")
      .eq("id", listId)
      .eq("user_id", userId)
      .single();

    if (listError) {
      // Przypadek specjalny dla PGSQL code 22P02 (nieprawidłowy UUID)
      if (listError.code === "22P02") {
        logger.warn("Próba dostępu z nieprawidłowym formatem UUID", { userId, listId });
        throw new ShoppingListError("Nieprawidłowy format identyfikatora listy zakupów", "INVALID_UUID", listError);
      }

      // Przypadek specjalny dla "błąd PGRST116" (nie znaleziono rekordu)
      if (listError.code === "PGRST116") {
        logger.warn("Próba dostępu do nieistniejącej listy zakupów", { userId, listId });
        throw new ShoppingListError("Nie znaleziono listy zakupów o podanym ID", "LIST_NOT_FOUND", listError);
      }

      logger.error("Błąd podczas pobierania listy zakupów", { userId, listId, errorCode: listError.code }, listError);
      throw new ShoppingListError("Nie udało się pobrać listy zakupów", "DATABASE_ERROR", listError);
    }

    if (!shoppingList) {
      logger.warn("Nie znaleziono listy zakupów", { userId, listId });
      throw new ShoppingListError("Nie znaleziono listy zakupów o podanym ID", "LIST_NOT_FOUND");
    }

    // 2. Pobieranie elementów listy zakupów
    const { data: items, error: itemsError } = await supabase
      .from("shopping_list_items")
      .select("id, item_name, purchased, created_at, updated_at")
      .eq("shopping_list_id", listId)
      .order("created_at", { ascending: true });

    if (itemsError) {
      logger.error(
        "Błąd podczas pobierania elementów listy zakupów",
        { userId, listId, errorCode: itemsError.code },
        itemsError
      );
      throw new ShoppingListError("Nie udało się pobrać elementów listy zakupów", "DATABASE_ERROR", itemsError);
    }

    // 3. Mapowanie elementów na format DTO
    const itemsDto: ShoppingListItemDTO[] = (items || []).map((item) => ({
      id: item.id,
      itemName: item.item_name,
      purchased: item.purchased,
      createdAt: item.created_at,
      updatedAt: item.updated_at,
    }));

    // 4. Przygotowanie odpowiedzi
    const result: GetShoppingListByIdResponse = {
      id: shoppingList.id,
      title: shoppingList.title,
      createdAt: shoppingList.created_at,
      updatedAt: shoppingList.updated_at,
      items: itemsDto,
    };

    logger.info("Pomyślnie pobrano szczegóły listy zakupów", {
      userId,
      listId,
      title: shoppingList.title,
      itemsCount: itemsDto.length,
    });

    return result;
  } catch (error) {
    // Przechwytujemy i przekazujemy dalej błędy ShoppingListError
    if (error instanceof ShoppingListError) {
      throw error;
    }

    // Pozostałe błędy opakowujemy w ShoppingListError
    logger.error("Nieoczekiwany błąd podczas pobierania szczegółów listy zakupów", { userId, listId }, error);
    throw new ShoppingListError(
      "Wystąpił nieoczekiwany błąd podczas pobierania szczegółów listy zakupów",
      "UNEXPECTED_ERROR",
      error
    );
  }
}

/**
 * Aktualizuje tytuł listy zakupów
 *
 * @param supabase Klient Supabase
 * @param userId ID użytkownika
 * @param listId ID listy zakupów
 * @param data Dane do aktualizacji
 * @returns Zaktualizowana lista zakupów
 * @throws {ShoppingListError} Gdy wystąpi błąd podczas aktualizacji listy zakupów
 */
export async function updateShoppingList(
  supabase: SupabaseClient,
  userId: string,
  listId: string,
  data: UpdateShoppingListRequest
): Promise<UpdateShoppingListResponse> {
  logger.info("Rozpoczęcie aktualizacji listy zakupów", { userId, listId, title: data.title });

  try {
    // 1. Sprawdzenie czy lista istnieje i należy do użytkownika
    const { error: listError } = await supabase
      .from("shopping_lists")
      .select("id")
      .eq("id", listId)
      .eq("user_id", userId)
      .single();

    if (listError) {
      // Przypadek specjalny dla PGSQL code 22P02 (nieprawidłowy UUID)
      if (listError.code === "22P02") {
        logger.warn("Próba aktualizacji z nieprawidłowym formatem UUID", { userId, listId });
        throw new ShoppingListError("Nieprawidłowy format identyfikatora listy zakupów", "INVALID_UUID", listError);
      }

      // Przypadek specjalny dla "błąd PGRST116" (nie znaleziono rekordu)
      if (listError.code === "PGRST116") {
        logger.warn("Próba aktualizacji nieistniejącej listy zakupów", { userId, listId });
        throw new ShoppingListError("Nie znaleziono listy zakupów o podanym ID", "LIST_NOT_FOUND", listError);
      }

      logger.error("Błąd podczas sprawdzania listy zakupów", { userId, listId, errorCode: listError.code }, listError);
      throw new ShoppingListError("Nie udało się zweryfikować listy zakupów", "DATABASE_ERROR", listError);
    }

    // 2. Aktualizacja listy zakupów
    const { data: updatedList, error: updateError } = await supabase
      .from("shopping_lists")
      .update({
        title: data.title,
        updated_at: new Date().toISOString(), // Jawne ustawienie daty aktualizacji
      })
      .eq("id", listId)
      .eq("user_id", userId)
      .select("id, title, updated_at")
      .single();

    if (updateError) {
      logger.error(
        "Błąd podczas aktualizacji listy zakupów",
        { userId, listId, errorCode: updateError.code },
        updateError
      );

      if (updateError.code === "23505") {
        throw new ShoppingListError("Lista zakupów o podanym tytule już istnieje", "DUPLICATE_TITLE", updateError);
      } else {
        throw new ShoppingListError("Nie udało się zaktualizować listy zakupów", "DATABASE_ERROR", updateError);
      }
    }

    if (!updatedList) {
      logger.error("Błąd podczas aktualizacji listy zakupów - brak danych zwrotnych", { userId, listId });
      throw new ShoppingListError(
        "Nie udało się zaktualizować listy zakupów - brak danych zwrotnych",
        "NO_DATA_RETURNED"
      );
    }

    // 3. Przygotowanie odpowiedzi
    const result: UpdateShoppingListResponse = {
      id: updatedList.id,
      title: updatedList.title,
      updatedAt: updatedList.updated_at,
    };

    logger.info("Pomyślnie zaktualizowano listę zakupów", {
      userId,
      listId,
      title: updatedList.title,
    });

    return result;
  } catch (error) {
    // Przechwytujemy i przekazujemy dalej błędy ShoppingListError
    if (error instanceof ShoppingListError) {
      throw error;
    }

    // Pozostałe błędy opakowujemy w ShoppingListError
    logger.error("Nieoczekiwany błąd podczas aktualizacji listy zakupów", { userId, listId }, error);
    throw new ShoppingListError(
      "Wystąpił nieoczekiwany błąd podczas aktualizacji listy zakupów",
      "UNEXPECTED_ERROR",
      error
    );
  }
}

/**
 * Usuwa listę zakupów wraz z jej elementami
 *
 * @param supabase Klient Supabase
 * @param userId ID użytkownika
 * @param listId ID listy zakupów
 * @throws {ShoppingListError} Gdy wystąpi błąd podczas usuwania listy zakupów
 */
export async function deleteShoppingList(supabase: SupabaseClient, userId: string, listId: string): Promise<void> {
  logger.info("Rozpoczęcie usuwania listy zakupów", { userId, listId });

  try {
    // 1. Sprawdzenie czy lista istnieje i należy do użytkownika
    const { data: existingList, error: checkError } = await supabase
      .from("shopping_lists")
      .select("id")
      .eq("id", listId)
      .eq("user_id", userId)
      .single();

    if (checkError) {
      // Przypadek specjalny dla PGSQL code 22P02 (nieprawidłowy UUID)
      if (checkError.code === "22P02") {
        logger.warn("Próba usunięcia z nieprawidłowym formatem UUID", { userId, listId });
        throw new ShoppingListError("Nieprawidłowy format identyfikatora listy zakupów", "INVALID_UUID", checkError);
      }

      // Przypadek specjalny dla "błąd PGRST116" (nie znaleziono rekordu)
      if (checkError.code === "PGRST116") {
        logger.warn("Próba usunięcia nieistniejącej listy zakupów", { userId, listId });
        throw new ShoppingListError("Nie znaleziono listy zakupów o podanym ID", "LIST_NOT_FOUND", checkError);
      }

      logger.error(
        "Błąd podczas sprawdzania listy zakupów do usunięcia",
        { userId, listId, errorCode: checkError.code },
        checkError
      );
      throw new ShoppingListError("Nie udało się zweryfikować listy zakupów", "DATABASE_ERROR", checkError);
    }

    if (!existingList) {
      logger.warn("Próba usunięcia nieistniejącej listy zakupów", { userId, listId });
      throw new ShoppingListError("Nie znaleziono listy zakupów o podanym ID", "LIST_NOT_FOUND");
    }

    // 2. Usuwanie listy zakupów - elementy zostaną usunięte automatycznie dzięki ON DELETE CASCADE
    const { error: deleteError } = await supabase
      .from("shopping_lists")
      .delete()
      .eq("id", listId)
      .eq("user_id", userId);

    if (deleteError) {
      logger.error("Błąd podczas usuwania listy zakupów", { userId, listId, errorCode: deleteError.code }, deleteError);
      throw new ShoppingListError("Nie udało się usunąć listy zakupów", "DATABASE_ERROR", deleteError);
    }

    logger.info("Pomyślnie usunięto listę zakupów", { userId, listId });

    // Zwracamy void, ponieważ DELETE nie potrzebuje zwracać danych
    return;
  } catch (error) {
    // Przechwytujemy i przekazujemy dalej błędy ShoppingListError
    if (error instanceof ShoppingListError) {
      throw error;
    }

    // Pozostałe błędy opakowujemy w ShoppingListError
    logger.error("Nieoczekiwany błąd podczas usuwania listy zakupów", { userId, listId }, error);
    throw new ShoppingListError(
      "Wystąpił nieoczekiwany błąd podczas usuwania listy zakupów",
      "UNEXPECTED_ERROR",
      error
    );
  }
}

/**
 * Pobiera szczegóły listy zakupów do wyświetlenia w interfejsie
 *
 * @param supabase Klient Supabase
 * @param userId ID użytkownika
 * @param listId ID listy zakupów
 * @returns Szczegóły listy zakupów w formacie odpowiednim dla interfejsu
 * @throws {ShoppingListError} Gdy wystąpi błąd podczas pobierania listy zakupów
 */
export async function getShoppingListDetails(
  supabase: SupabaseClient,
  userId: string,
  listId: string
): Promise<ShoppingListDetailResponse> {
  logger.info("Pobieranie szczegółów listy zakupów dla klienta", { userId, listId });

  try {
    // Wykorzystujemy istniejącą funkcję getShoppingListById
    const listData = await getShoppingListById(supabase, userId, listId);

    // Konwertujemy do formatu ShoppingListDetailResponse
    const response: ShoppingListDetailResponse = {
      id: listData.id,
      title: listData.title,
      createdAt: listData.createdAt,
      updatedAt: listData.updatedAt,
      items: listData.items,
    };

    logger.info("Pomyślnie pobrano szczegóły listy zakupów dla klienta", { userId, listId });
    return response;
  } catch (error) {
    logger.error("Błąd podczas pobierania szczegółów listy zakupów dla klienta", { userId, listId }, error);

    // Przekazujemy dalej błędy ShoppingListError
    if (error instanceof ShoppingListError) {
      throw error;
    }

    // Inne błędy opakowujemy
    throw new ShoppingListError(
      "Wystąpił nieoczekiwany błąd podczas pobierania szczegółów listy zakupów",
      "UNEXPECTED_ERROR",
      error
    );
  }
}

/**
 * Dodaje nowy element do listy zakupów
 *
 * @param supabase Klient Supabase
 * @param userId ID użytkownika
 * @param listId ID listy zakupów
 * @param data Dane elementu do dodania
 * @returns Nowo dodany element listy zakupów
 * @throws {ShoppingListError} Gdy wystąpi błąd podczas dodawania elementu
 */
export async function addItemToShoppingList(
  supabase: SupabaseClient,
  userId: string,
  listId: string,
  data: { itemName: string; purchased?: boolean }
): Promise<ShoppingListItemDTO> {
  logger.info("Rozpoczęcie dodawania elementu do listy zakupów", { userId, listId, itemName: data.itemName });

  try {
    // 1. Sprawdź, czy lista istnieje i należy do użytkownika
    const { error: listError } = await supabase
      .from("shopping_lists")
      .select("id")
      .eq("id", listId)
      .eq("user_id", userId)
      .single();

    if (listError) {
      logger.error("Błąd podczas sprawdzania listy zakupów", { userId, listId, errorCode: listError.code }, listError);
      if (listError.code === "PGRST116") {
        throw new ShoppingListError("Lista zakupów nie istnieje lub brak dostępu", "NOT_FOUND", listError);
      }
      throw new ShoppingListError("Nie udało się zweryfikować listy zakupów", "DATABASE_ERROR", listError);
    }

    // 2. Dodaj element do listy
    const { data: newItem, error: insertError } = await supabase
      .from("shopping_list_items")
      .insert([
        {
          shopping_list_id: listId,
          item_name: data.itemName,
          purchased: data.purchased || false,
        },
      ])
      .select("id, item_name, purchased, created_at, updated_at")
      .single();

    if (insertError) {
      logger.error(
        "Błąd podczas dodawania elementu do listy zakupów",
        { userId, listId, itemName: data.itemName, errorCode: insertError.code },
        insertError
      );
      throw new ShoppingListError("Nie udało się dodać elementu do listy zakupów", "DATABASE_ERROR", insertError);
    }

    logger.info("Pomyślnie dodano element do listy zakupów", {
      userId,
      listId,
      itemId: newItem.id,
      itemName: data.itemName,
    });

    // 3. Zwróć dodany element w formacie DTO
    return {
      id: newItem.id,
      itemName: newItem.item_name,
      purchased: newItem.purchased,
      createdAt: newItem.created_at,
      updatedAt: newItem.updated_at,
    };
  } catch (error) {
    // Przechwytujemy i przekazujemy dalej błędy ShoppingListError
    if (error instanceof ShoppingListError) {
      throw error;
    }

    // Pozostałe błędy opakowujemy w ShoppingListError
    logger.error("Nieoczekiwany błąd podczas dodawania elementu do listy zakupów", { userId, listId }, error);
    throw new ShoppingListError(
      "Wystąpił nieoczekiwany błąd podczas dodawania elementu do listy zakupów",
      "UNEXPECTED_ERROR",
      error
    );
  }
}

/**
 * Aktualizuje element listy zakupów
 *
 * @param supabase Klient Supabase
 * @param userId ID użytkownika
 * @param listId ID listy zakupów
 * @param itemId ID elementu do aktualizacji
 * @param data Dane do aktualizacji
 * @returns Zaktualizowany element listy zakupów
 * @throws {ShoppingListError} Gdy wystąpi błąd podczas aktualizacji elementu
 */
export async function updateShoppingListItem(
  supabase: SupabaseClient,
  userId: string,
  listId: string,
  itemId: string,
  data: { itemName?: string; purchased?: boolean }
): Promise<UpdateShoppingListItemResponse> {
  logger.info("Rozpoczęcie aktualizacji elementu listy zakupów", { userId, listId, itemId, data });

  try {
    // Przygotuj dane do aktualizacji
    const updateData: { item_name?: string; purchased?: boolean; updated_at: string } = {
      updated_at: new Date().toISOString(),
    };

    if (data.itemName !== undefined) {
      updateData.item_name = data.itemName;
    }

    if (data.purchased !== undefined) {
      updateData.purchased = data.purchased;
    }

    // Wykonaj aktualizację
    const { data: updatedItem, error: updateError } = await supabase
      .from("shopping_list_items")
      .update(updateData)
      .eq("id", itemId)
      .eq("shopping_list_id", listId)
      .select("id, item_name, purchased, updated_at")
      .single();

    if (updateError) {
      logger.error(
        "Błąd podczas aktualizacji elementu listy zakupów",
        { userId, listId, itemId, errorCode: updateError.code },
        updateError
      );
      if (updateError.code === "PGRST116") {
        throw new ShoppingListError(
          "Element nie istnieje lub brak dostępu do jego aktualizacji",
          "NOT_FOUND",
          updateError
        );
      }
      throw new ShoppingListError("Nie udało się zaktualizować elementu listy zakupów", "DATABASE_ERROR", updateError);
    }

    logger.info("Pomyślnie zaktualizowano element listy zakupów", {
      userId,
      listId,
      itemId,
      data,
    });

    // Zwróć zaktualizowany element w formacie DTO
    return {
      id: updatedItem.id,
      itemName: updatedItem.item_name,
      purchased: updatedItem.purchased,
      updatedAt: updatedItem.updated_at,
    };
  } catch (error) {
    // Przechwytujemy i przekazujemy dalej błędy ShoppingListError
    if (error instanceof ShoppingListError) {
      throw error;
    }

    // Pozostałe błędy opakowujemy w ShoppingListError
    logger.error("Nieoczekiwany błąd podczas aktualizacji elementu listy zakupów", { userId, listId, itemId }, error);
    throw new ShoppingListError(
      "Wystąpił nieoczekiwany błąd podczas aktualizacji elementu listy zakupów",
      "UNEXPECTED_ERROR",
      error
    );
  }
}

/**
 * Usuwa element z listy zakupów
 *
 * @param supabase Klient Supabase
 * @param userId ID użytkownika
 * @param listId ID listy zakupów
 * @param itemId ID elementu do usunięcia
 * @throws {ShoppingListError} Gdy wystąpi błąd podczas usuwania elementu
 */
export async function deleteShoppingListItem(
  supabase: SupabaseClient,
  userId: string,
  listId: string,
  itemId: string
): Promise<void> {
  logger.info("Rozpoczęcie usuwania elementu z listy zakupów", { userId, listId, itemId });

  try {
    // Usuń element
    const { error: deleteError, count } = await supabase
      .from("shopping_list_items")
      .delete()
      .eq("id", itemId)
      .eq("shopping_list_id", listId);

    if (deleteError) {
      logger.error(
        "Błąd podczas usuwania elementu z listy zakupów",
        { userId, listId, itemId, errorCode: deleteError.code },
        deleteError
      );
      throw new ShoppingListError("Nie udało się usunąć elementu z listy zakupów", "DATABASE_ERROR", deleteError);
    }

    // Sprawdź, czy element został usunięty
    if (count === 0) {
      logger.warn("Element nie został usunięty - nie znaleziono lub brak uprawnień", { userId, listId, itemId });
      throw new ShoppingListError("Element nie istnieje lub brak dostępu do jego usunięcia", "NOT_FOUND");
    }

    logger.info("Pomyślnie usunięto element z listy zakupów", { userId, listId, itemId });
  } catch (error) {
    // Przechwytujemy i przekazujemy dalej błędy ShoppingListError
    if (error instanceof ShoppingListError) {
      throw error;
    }

    // Pozostałe błędy opakowujemy w ShoppingListError
    logger.error("Nieoczekiwany błąd podczas usuwania elementu z listy zakupów", { userId, listId, itemId }, error);
    throw new ShoppingListError(
      "Wystąpił nieoczekiwany błąd podczas usuwania elementu z listy zakupów",
      "UNEXPECTED_ERROR",
      error
    );
  }
}



================================================
File: src/lib/services/toast-service.ts
================================================
import { toast } from "sonner";

// Typy powiadomień
export type ToastType = "success" | "error" | "info" | "warning";

// Opcje powiadomień
export interface ToastOptions {
  id?: string;
  duration?: number;
  description?: string;
  action?: {
    label: string;
    onClick: () => void;
  };
}

/**
 * Wyświetla powiadomienie o sukcesie
 * @param message Treść powiadomienia
 * @param options Opcje powiadomienia
 */
export function showSuccessToast(message: string, options?: ToastOptions): void {
  toast.success(message, {
    id: options?.id,
    duration: options?.duration || 3000,
    description: options?.description,
    className: "toast-notification",
    action: options?.action
      ? {
          label: options.action.label,
          onClick: options.action.onClick,
        }
      : undefined,
  });
}

/**
 * Wyświetla powiadomienie o błędzie
 * @param message Treść powiadomienia
 * @param options Opcje powiadomienia
 */
export function showErrorToast(message: string, options?: ToastOptions): void {
  toast.error(message, {
    id: options?.id,
    duration: options?.duration || 5000, // Dłuższy czas dla błędów
    description: options?.description,
    className: "toast-notification",
    action: options?.action
      ? {
          label: options.action.label,
          onClick: options.action.onClick,
        }
      : undefined,
  });
}

/**
 * Wyświetla powiadomienie informacyjne
 * @param message Treść powiadomienia
 * @param options Opcje powiadomienia
 */
export function showInfoToast(message: string, options?: ToastOptions): void {
  toast.info(message, {
    id: options?.id,
    duration: options?.duration || 3000,
    description: options?.description,
    className: "toast-notification",
    action: options?.action
      ? {
          label: options.action.label,
          onClick: options.action.onClick,
        }
      : undefined,
  });
}

/**
 * Wyświetla powiadomienie ostrzegawcze
 * @param message Treść powiadomienia
 * @param options Opcje powiadomienia
 */
export function showWarningToast(message: string, options?: ToastOptions): void {
  toast.warning(message, {
    id: options?.id,
    duration: options?.duration || 4000,
    description: options?.description,
    className: "toast-notification",
    action: options?.action
      ? {
          label: options.action.label,
          onClick: options.action.onClick,
        }
      : undefined,
  });
}

/**
 * Usuwa powiadomienie o określonym ID
 * @param id ID powiadomienia do usunięcia
 */
export function dismissToast(id: string): void {
  toast.dismiss(id);
}

/**
 * Usuwa wszystkie powiadomienia
 */
export function dismissAllToasts(): void {
  toast.dismiss();
}



================================================
File: src/lib/services/userService.ts
================================================
/**
 * Serwis do obsługi operacji związanych z użytkownikami
 */
import { createClient } from "@supabase/supabase-js";
import type { Database } from "../../db/database.types";
import { createHash } from "crypto";
import type { UserDTO, UpdateUserRequest } from "../../types";

// Definiujemy typ SupabaseClient lokalnie
type SupabaseClient = ReturnType<typeof createClient<Database>>;

/**
 * Pobiera wszystkich użytkowników z bazy danych
 * @param supabase Klient Supabase
 * @param page Numer strony (indeksowany od 1)
 * @param pageSize Liczba elementów na stronę
 * @param sort Pole do sortowania (email, registrationDate)
 * @param order Kolejność sortowania (asc, desc)
 * @param emailFilter Filtr dla adresu email
 * @param isDevelopment Flaga określająca, czy aplikacja działa w trybie deweloperskim
 * @returns Dane użytkowników i informacje o paginacji
 */
export async function getAllUsers(
  supabase: SupabaseClient,
  page = 1,
  pageSize = 20,
  sort = "email",
  order: "asc" | "desc" = "asc",
  emailFilter?: string,
  isDevelopment = false
) {
  // Mapowanie nazw pól do kolumn w bazie danych
  const sortMap: Record<string, string> = {
    email: "email",
    registrationDate: "registration_date",
  };

  // Określenie zakresu dla paginacji
  const from = (page - 1) * pageSize;
  const to = from + pageSize - 1;

  // Budowanie zapytania
  let query = supabase.from("users").select("id, email, registration_date, last_login_date", { count: "exact" });

  // Dodanie filtrowania po email, jeśli podano
  if (emailFilter) {
    query = query.ilike("email", `%${emailFilter}%`);
  }

  // Dodanie sortowania
  const sortColumn = sortMap[sort] || "email";
  query = query.order(sortColumn, { ascending: order === "asc" });

  // Wykonanie zapytania z paginacją
  const { data, error, count } = await query.range(from, to);

  if (error) {
    console.error("Błąd podczas pobierania użytkowników:", error);
    return { data: [], pagination: { totalItems: 0, totalPages: 0, currentPage: page, pageSize } };
  }

  // Lista ID użytkowników z uprawnieniami administratora
  const adminUserIds = ["4e0a9b6a-b416-48e6-8d35-5700bd1d674a"]; // ID deweloperskie jako przykład

  // Mapowanie danych do DTO
  const userDTOs = data.map((user) => ({
    id: user.id,
    email: user.email,
    registrationDate: user.registration_date,
    lastLoginDate: user.last_login_date,
    isAdmin: isDevelopment || adminUserIds.includes(user.id),
  }));

  // Obliczenie informacji o paginacji
  const totalItems = count || 0;
  const totalPages = Math.ceil(totalItems / pageSize);

  return {
    data: userDTOs,
    pagination: {
      totalItems,
      totalPages,
      currentPage: page,
      pageSize,
    },
  };
}

/**
 * Pobiera użytkownika po ID
 * @param supabase Klient Supabase
 * @param userId ID użytkownika
 * @param isDevelopment Flaga określająca, czy aplikacja działa w trybie deweloperskim
 * @returns Dane użytkownika lub null jeśli nie znaleziono
 */
export async function getUserById(
  supabase: SupabaseClient,
  userId: string,
  isDevelopment = false
): Promise<UserDTO | null> {
  const { data, error } = await supabase
    .from("users")
    .select("id, email, registration_date, last_login_date")
    .eq("id", userId)
    .single();

  if (error || !data) {
    console.error("Błąd podczas pobierania użytkownika:", error);
    return null;
  }

  // Sprawdzenie, czy użytkownik jest administratorem
  // Lista ID użytkowników z uprawnieniami administratora
  const adminUserIds = ["4e0a9b6a-b416-48e6-8d35-5700bd1d674a"]; // ID deweloperskie jako przykład
  const isAdmin = isDevelopment || adminUserIds.includes(data.id);

  // Mapowanie danych do DTO
  return {
    id: data.id,
    email: data.email,
    registrationDate: data.registration_date,
    lastLoginDate: data.last_login_date,
    isAdmin,
  };
}

/**
 * Funkcja pomocnicza do sprawdzania czy email jest już używany
 * @param supabase Klient Supabase
 * @param email Adres email do sprawdzenia
 * @param userId ID użytkownika (aby wykluczyć jego własny email)
 * @returns Informacja czy email jest już zajęty
 */
export async function isEmailTaken(supabase: SupabaseClient, email: string, userId: string): Promise<boolean> {
  const { data, error } = await supabase.from("users").select("id").eq("email", email).neq("id", userId).single();

  if (error && error.code !== "PGRST116") {
    // PGRST116 = No rows returned
    console.error("Błąd podczas sprawdzania unikalności email:", error);
    // W razie błędu lepiej uznać, że email jest zajęty
    return true;
  }

  return !!data;
}

/**
 * Funkcja pomocnicza do hashowania hasła
 * @param password Hasło w formie plaintext
 * @returns Zahashowane hasło
 */
export function hashPassword(password: string): string {
  return createHash("sha256").update(password).digest("hex");
}

/**
 * Aktualizuje dane użytkownika
 * @param supabase Klient Supabase
 * @param userId ID użytkownika
 * @param userData Dane do aktualizacji
 * @returns Zaktualizowane dane użytkownika lub null w przypadku błędu
 */
export async function updateUser(
  supabase: SupabaseClient,
  userId: string,
  userData: UpdateUserRequest
): Promise<{ id: string; email: string; updatedDate: string; passwordUpdated: boolean } | null> {
  // Przygotowanie danych do aktualizacji
  const updateData: Record<string, unknown> = {
    updated_date: new Date().toISOString(),
  };

  let passwordUpdated = false;

  // Jeśli podano email, sprawdź czy jest unikalny
  if (userData.email) {
    const emailTaken = await isEmailTaken(supabase, userData.email, userId);
    if (emailTaken) {
      throw new Error("Email jest już używany przez innego użytkownika");
    }
    updateData.email = userData.email;
  }

  // Jeśli podano hasło, zahashuj je
  if (userData.password) {
    updateData.password_hash = hashPassword(userData.password);
    passwordUpdated = true;
  }

  // Aktualizacja danych użytkownika
  const { data, error } = await supabase
    .from("users")
    .update(updateData)
    .eq("id", userId)
    .select("id, email, updated_date")
    .single();

  if (error || !data) {
    console.error("Błąd podczas aktualizacji użytkownika:", error);
    return null;
  }

  // Zwrócenie zaktualizowanych danych
  return {
    id: data.id,
    email: data.email,
    updatedDate: data.updated_date,
    passwordUpdated,
  };
}

/**
 * Usuwa użytkownika z bazy danych
 * @param supabase Klient Supabase
 * @param userId ID użytkownika do usunięcia
 * @returns Informacja, czy usunięcie się powiodło
 */
export async function deleteUser(supabase: SupabaseClient, userId: string): Promise<boolean> {
  // Usunięcie użytkownika z bazy danych
  // Dzięki klauzuli ON DELETE CASCADE w bazie danych,
  // wszystkie powiązane rekordy zostaną automatycznie usunięte
  const { error } = await supabase.from("users").delete().eq("id", userId);

  // Zwrócenie informacji o powodzeniu operacji
  return !error;
}



================================================
File: src/lib/utils/error.ts
================================================
/**
 * Gets a human-readable error message from any error type
 */
export function getErrorMessage(error: unknown): string {
  if (error instanceof Error) {
    return error.message;
  }
  if (typeof error === "string") {
    return error;
  }
  return "An unknown error occurred";
}



================================================
File: src/lib/validators/shopping-list.validators.ts
================================================
import { z } from "zod";

/**
 * Schemat walidacji dla tworzenia nowej listy zakupów
 */
export const createShoppingListSchema = z.object({
  title: z
    .string()
    .min(1, { message: "Tytuł listy zakupów nie może być pusty" })
    .max(255, { message: "Tytuł listy zakupów nie może przekraczać 255 znaków" }),
});

/**
 * Schemat walidacji dla parametrów zapytania przy pobieraniu list zakupów
 */
export const getAllShoppingListsQuerySchema = z.object({
  page: z
    .preprocess((val) => (val ? String(val) : undefined), z.string().optional())
    .transform((val) => (val ? parseInt(val, 10) : 1))
    .pipe(z.number().int().positive().default(1)),
  pageSize: z
    .preprocess((val) => (val ? String(val) : undefined), z.string().optional())
    .transform((val) => (val ? parseInt(val, 10) : 20))
    .pipe(z.number().int().positive().max(100).default(20)),
  sort: z.preprocess(
    (val) => val ?? undefined,
    z.enum(["title", "createdAt", "updatedAt"]).optional().default("createdAt")
  ),
  order: z.preprocess((val) => val ?? undefined, z.enum(["asc", "desc"]).optional().default("desc")),
});

/**
 * Schemat walidacji dla ID listy zakupów (UUID)
 */
export const shoppingListIdSchema = z.string().uuid({ message: "Nieprawidłowy format identyfikatora listy zakupów" });

/**
 * Schemat walidacji dla aktualizacji listy zakupów
 */
export const updateShoppingListSchema = z.object({
  title: z
    .string()
    .min(1, { message: "Tytuł listy zakupów nie może być pusty" })
    .max(255, { message: "Tytuł listy zakupów nie może przekraczać 255 znaków" }),
});

/**
 * Schemat walidacji dla dodawania elementu do listy zakupów
 */
export const addItemToShoppingListSchema = z.object({
  itemName: z
    .string()
    .min(1, { message: "Nazwa produktu nie może być pusta" })
    .max(128, { message: "Nazwa produktu nie może przekraczać 128 znaków" }),
  purchased: z.boolean().optional().default(false),
});

/**
 * Schemat walidacji dla aktualizacji elementu listy zakupów
 */
export const updateShoppingListItemSchema = z
  .object({
    itemName: z
      .string()
      .min(1, { message: "Nazwa produktu nie może być pusta" })
      .max(128, { message: "Nazwa produktu nie może przekraczać 128 znaków" })
      .optional(),
    purchased: z.boolean().optional(),
  })
  .refine((data) => data.itemName !== undefined || data.purchased !== undefined, {
    message: "Co najmniej jedno pole musi być podane: nazwa produktu lub status zakupu",
  });



================================================
File: src/middleware/index.ts
================================================
import { defineMiddleware } from "astro:middleware";
import { createSupabaseServerInstance } from "../db/supabase.server";
import type { AstroLocals } from "../types/locals";
import type { UserDTO } from "../types";

// Ścieżki wymagające autentykacji - usunięto /shopping-lists
const PROTECTED_ROUTES = ["/", "/profile"];

// Ścieżki dostępne tylko dla niezalogowanych użytkowników (lub obu stanów)
const AUTH_ROUTES = ["/login", "/register", "/reset-password", "/set-new-password", "/recover", "/recover-password"];

// Ścieżki API związane z autoryzacją, które powinny być dostępne bez logowania
const AUTH_API_ROUTES = [
  "/api/auth/register",
  "/api/auth/login",
  "/api/auth/logout",
  "/api/auth/reset-password",
  "/api/auth/request-reset",
  "/api/auth/set-new-password",
];

// Ścieżki API związane z listami zakupów - chronione, ale bez przekierowania
// Usunięto /api/shopping-lists/ z tej listy, ponieważ nie istnieje
const SHOPPING_LIST_API_ROUTES = ["/api/client/shopping-lists/"];

// Ścieżki dostępne tylko dla administratorów
const ADMIN_ROUTES = ["/admin"];

export const prerender = false;

/**
 * Middleware obsługujące uwierzytelnianie, dostęp do Supabase i kontrolę dostępu
 */
export const onRequest = defineMiddleware(async ({ request, locals, cookies, redirect }, next) => {
  // Pobieramy ścieżkę z URL
  const url = new URL(request.url);
  const pathname = url.pathname;

  // Pomijamy sprawdzanie autoryzacji dla statycznych zasobów (ale nie dla endpointów API)
  if (pathname.includes("_astro") || pathname.match(/\.(ico|png|jpg|jpeg|svg|css|js|woff|woff2)$/)) {
    return next();
  }

  console.log(`Middleware: Running auth checks for path: ${pathname}`);

  // Tworzymy instancję klienta Supabase dla tego żądania
  const supabase = createSupabaseServerInstance({
    headers: request.headers,
    cookies,
  });

  // Zapisujemy instancję klienta w lokalnym kontekście żądania
  (locals as AstroLocals).supabase = supabase;

  // Sprawdzamy, czy użytkownik jest zalogowany
  let authUser: UserDTO | null = null;
  let isAuthenticated = false;

  console.log("Middleware: Attempting to get user via supabase.auth.getUser()...");
  const { data, error: getUserError } = await supabase.auth.getUser();

  // Pobieramy sesję osobno, ponieważ getUser nie zwraca sesji bezpośrednio
  const { data: sessionData } = await supabase.auth.getSession();
  const session = sessionData?.session;

  if (getUserError || !data.user) {
    console.log("Middleware: User not found or error. Auth session missing!");
    isAuthenticated = false;
    authUser = null;
  } else {
    // Użytkownik jest zalogowany
    const user = data.user;
    console.log(`Middleware: User verified: ${user.email}`);
    isAuthenticated = true;

    // Jeśli mamy aktywną sesję, ustawiamy token sesji jako cookie
    if (session?.access_token) {
      console.log("Middleware: Setting supabase specific cookies");
      // Dodajemy specjalne cookie dla Supabase
      cookies.set("sb-access-token", session.access_token, {
        path: "/",
        httpOnly: true,
        secure: process.env.NODE_ENV === "production",
        sameSite: "lax",
        maxAge: 60 * 60 * 24 * 7, // 7 dni
      });

      if (session.refresh_token) {
        cookies.set("sb-refresh-token", session.refresh_token, {
          path: "/",
          httpOnly: true,
          secure: process.env.NODE_ENV === "production",
          sameSite: "lax",
          maxAge: 60 * 60 * 24 * 7, // 7 dni
        });
      }
    }

    // Mapujemy dane użytkownika do UserDTO
    authUser = {
      id: user.id,
      email: user.email || "",
      registrationDate: user.created_at || "",
      lastLoginDate: user.last_sign_in_at || null,
      isAdmin: user.app_metadata?.isAdmin || false,
    };
  }

  // Ustawiamy dane autoryzacyjne w kontekście lokalnym
  (locals as AstroLocals).user = data.user;
  (locals as AstroLocals & { userDTO: UserDTO | null; isAuthenticated: boolean }).userDTO = authUser;
  (locals as AstroLocals & { userDTO: UserDTO | null; isAuthenticated: boolean }).isAuthenticated = isAuthenticated;
  console.log("Middleware: Locals set", { isAuthenticated, userId: authUser?.id });

  // Sprawdzamy reguły przekierowania
  const isProtectedRoute = PROTECTED_ROUTES.some((route) => pathname.startsWith(route));
  const isAuthRoute = AUTH_ROUTES.some((route) => pathname.startsWith(route));
  const isAuthApiRoute = AUTH_API_ROUTES.some((route) => pathname.startsWith(route));
  const isShoppingListApiRoute = SHOPPING_LIST_API_ROUTES.some((route) => pathname.startsWith(route));
  const isAdminRoute = ADMIN_ROUTES.some((route) => pathname.startsWith(route));

  console.log("Middleware: Checking redirects for path:", pathname, {
    isProtectedRoute,
    isAuthRoute,
    isAuthApiRoute,
    isShoppingListApiRoute,
    isAdminRoute,
    isAuthenticated,
  });

  // Przekierowanie na stronę logowania, gdy próbujemy uzyskać dostęp do chronionej strony będąc niezalogowanym
  // (z wyjątkiem ścieżek autoryzacyjnych i API autoryzacji)
  if (isProtectedRoute && !isAuthenticated && !isAuthRoute && !isAuthApiRoute && !isShoppingListApiRoute) {
    console.log("Middleware: Redirecting to /login (protected route, not authenticated, not auth route)");
    return redirect("/login");
  }

  // Przekierowanie na stronę główną, gdy próbujemy uzyskać dostęp do strony autoryzacji będąc zalogowanym
  if (isAuthRoute && isAuthenticated) {
    console.log("Middleware: Redirecting to / (auth route, authenticated)");
    return redirect("/");
  }

  // Przekierowanie na stronę główną, gdy próbujemy uzyskać dostęp do strony admina bez bycia adminem
  if (isAdminRoute && (!isAuthenticated || !authUser?.isAdmin)) {
    console.log("Middleware: Redirecting to / (admin route, not admin or not authenticated)");
    return redirect("/");
  }

  // Brak przekierowania, przechodzimy do żądanej strony
  console.log("Middleware: No redirect needed, calling next()");
  return await next();
});



================================================
File: src/pages/index.astro
================================================
---
import MainLayout from "@/layouts/MainLayout.astro";
import ShoppingListsView from "@/components/ShoppingListsView";
import type { ShoppingListSummaryDTO, PaginationResponse } from "@/types";
import { getAllShoppingLists } from "@/lib/services/shopping-list.service";
import { logger } from "@/lib/logger";

// Wyłączamy prerendering, ponieważ strona jest dynamiczna
export const prerender = false;

// Server-side data fetching
let initialLists: ShoppingListSummaryDTO[] = [];
let initialPagination: PaginationResponse | null = null;
let fetchError: string | null = null;

// Get user and supabase client from locals (set by middleware)
const { user, supabase } = Astro.locals;

if (!user || !supabase) {
  // If user is not logged in server-side, set an error or handle appropriately
  // This case shouldn't happen if middleware redirects unauthenticated users,
  // but it's good practice to check.
  logger.warn("[index.astro] User or Supabase client not found in locals.");
  fetchError = "Użytkownik nie jest zalogowany lub wystąpił błąd serwera.";
  // Redirecting might be better here:
  // return Astro.redirect('/login');
} else {
  try {
    logger.info(`[index.astro] Fetching initial shopping lists for user ${user.id} on server-side.`);
    // Fetch the first page of lists (adjust parameters as needed)
    const result = await getAllShoppingLists(supabase, user.id, 1, 20);
    initialLists = result.data;
    initialPagination = result.pagination;
    logger.info(`[index.astro] Successfully fetched ${initialLists.length} initial lists.`);
  } catch (error) {
    logger.error("[index.astro] Error fetching initial shopping lists:", { error });
    if (error instanceof Error) {
      fetchError = error.message;
    } else {
      fetchError = "Wystąpił nieznany błąd podczas pobierania list zakupów.";
    }
  }
}
---

<MainLayout title="Twoje Listy Zakupów">
  {/* Pass initial data and error status to the client component */}
  <ShoppingListsView
    client:load
    initialLists={initialLists}
    initialPagination={initialPagination}
    fetchError={fetchError}
  />
  {/* Note: AuthStatus in layout should work now */}
</MainLayout>



================================================
File: src/pages/login.astro
================================================
---
import LoginView from "@/components/auth/LoginView.tsx";
import AuthLayout from "@/layouts/AuthLayout.astro";

export const prerender = false;

// Przekierowanie, jeśli użytkownik jest już zalogowany
// (to jest dodatkowe zabezpieczenie, główna logika jest w middleware)
if (Astro.locals.isAuthenticated) {
  return Astro.redirect("/"); // Zmieniono z /shopping-lists
}
---

<AuthLayout title="Logowanie">
  <LoginView client:load />
</AuthLayout>



================================================
File: src/pages/recover-password.astro
================================================
---
import AuthLayout from "../layouts/AuthLayout.astro";
import RecoverPasswordView from "../components/auth/RecoverPasswordView";

export const prerender = false;
---

<AuthLayout title="Odzyskaj hasło">
  <h1 class="text-2xl font-semibold tracking-tight text-center mb-6">Odzyskaj hasło</h1>
  <RecoverPasswordView client:load />
</AuthLayout>



================================================
File: src/pages/recover.astro
================================================
---
import AuthLayout from "../layouts/AuthLayout.astro";
import RecoverPasswordView from "../components/auth/RecoverPasswordView";

export const prerender = false;
---

<AuthLayout title="Odzyskaj hasło">
  <h1 class="text-2xl font-semibold tracking-tight text-center mb-6">Odzyskaj hasło</h1>
  <RecoverPasswordView client:load />
</AuthLayout>



================================================
File: src/pages/register.astro
================================================
---
import AuthLayout from "../layouts/AuthLayout.astro";
import RegisterView from "../components/auth/RegisterView";

export const prerender = false;

// Przekierowanie zalogowanych użytkowników, jeśli spróbują uzyskać dostęp do strony rejestracji
// (to jest dodatkowe zabezpieczenie, główna logika jest w middleware)
if (Astro.locals.isAuthenticated) {
  return Astro.redirect("/");
}
---

<AuthLayout title="Zarejestruj się">
  <h1 class="text-2xl font-semibold tracking-tight text-center mb-6">Utwórz konto</h1>
  <RegisterView client:load />
</AuthLayout>



================================================
File: src/pages/reset-password.astro
================================================
---
import AuthLayout from "../layouts/AuthLayout.astro";
import ResetPasswordView from "../components/auth/ResetPasswordView";

export const prerender = false;
---

<AuthLayout title="Resetowanie hasła">
  <h1 class="text-2xl font-semibold tracking-tight text-center mb-6">Resetowanie hasła</h1>
  <ResetPasswordView client:load />
</AuthLayout>



================================================
File: src/pages/api/auth/login.ts
================================================
import type { APIRoute } from "astro";
import { z } from "zod";
import type { AstroLocals } from "src/types/locals";
import type { LoginUserResponse } from "src/types";

export const prerender = false;

// Schema do walidacji danych wejściowych
const LoginSchema = z.object({
  email: z.string().email("Nieprawidłowy format adresu email."),
  password: z.string().min(1, "Hasło jest wymagane."),
  rememberMe: z.boolean().optional(),
});

export const POST: APIRoute = async ({ request, locals }) => {
  // Sprawdzanie dostępności klienta Supabase
  const supabase = (locals as AstroLocals)?.supabase;
  if (!supabase) {
    console.error("API /auth/login: Supabase client not found in locals");
    return new Response(JSON.stringify({ message: "Błąd serwera - brak połączenia z usługą autoryzacji." }), {
      status: 500,
    });
  }

  // Pobieranie i parsowanie danych JSON z żądania
  let requestData;
  try {
    requestData = await request.json();
  } catch (error) {
    console.error("API /auth/login: Invalid JSON", error);
    return new Response(JSON.stringify({ message: "Nieprawidłowy format danych." }), { status: 400 });
  }

  // Walidacja danych wejściowych
  const validationResult = LoginSchema.safeParse(requestData);
  if (!validationResult.success) {
    const formattedErrors = validationResult.error.format();
    console.error("API /auth/login: Validation error", formattedErrors);
    return new Response(
      JSON.stringify({
        message: "Błąd walidacji danych.",
        errors: formattedErrors,
      }),
      { status: 400 }
    );
  }

  const { email, password } = validationResult.data;
  console.log(`API /auth/login: Login attempt for ${email}`);

  try {
    // Próba logowania przez Supabase Auth
    const { data, error } = await supabase.auth.signInWithPassword({
      email,
      password,
    });

    // Obsługa błędu logowania
    if (error) {
      console.error("API /auth/login: Supabase auth error", error);

      // Zwracamy ogólny komunikat dla bezpieczeństwa
      return new Response(JSON.stringify({ message: "Nieprawidłowy email lub hasło." }), { status: 401 });
    }

    // Sprawdzenie czy mamy poprawne dane użytkownika i sesji
    if (!data.user || !data.session) {
      console.error("API /auth/login: Missing user or session data");
      return new Response(JSON.stringify({ message: "Błąd autoryzacji - brak danych użytkownika." }), { status: 500 });
    }

    // Logowanie pomyślne - budujemy odpowiedź
    console.log(`API /auth/login: Login successful for user: ${data.user.email}`);

    // Przygotowanie odpowiedzi - usunięto zwracanie tokenu
    const responseBody: Omit<LoginUserResponse, "token"> = {
      id: data.user.id,
      email: data.user.email || "",
      // token: data.session.access_token, // Token nie jest już zwracany
    };

    return new Response(JSON.stringify(responseBody), {
      status: 200,
      headers: { "Content-Type": "application/json" },
    });
  } catch (error) {
    console.error("API /auth/login: Unexpected error during login", error);
    return new Response(JSON.stringify({ message: "Wystąpił nieoczekiwany błąd podczas logowania." }), { status: 500 });
  }
};



================================================
File: src/pages/api/auth/logout.ts
================================================
import type { APIContext } from 'astro';
import type { AstroLocals } from '@/types/locals';
import { logger } from '@/lib/logger';

export const prerender = false;

/**
 * API endpoint to handle user logout.
 * Calls Supabase signOut on the server-side to clear the session cookie.
 */
export async function POST({ locals, cookies }: APIContext) {
  const requestId = crypto.randomUUID();
  logger.info('[API Logout] Received POST request', { requestId });

  const { supabase } = locals as AstroLocals;

  if (!supabase) {
    logger.error('[API Logout] Supabase client not found in locals', { requestId });
    return new Response(JSON.stringify({ error: 'Internal server error: Supabase client missing' }), {
      status: 500,
      headers: { 'Content-Type': 'application/json' },
    });
  }

  try {
    // Sign out the user on the server side
    const { error } = await supabase.auth.signOut();

    if (error) {
      logger.error('[API Logout] Error signing out from Supabase', { requestId }, error);
      // Even if Supabase fails, proceed to clear cookies as a fallback
    }

    logger.info('[API Logout] Supabase signOut completed (or error occurred, proceeding)', { requestId });

    // Explicitly clear potential Supabase cookies (names might vary, adjust if needed)
    // Astro's signOut might handle this, but being explicit can help
    cookies.delete('sb-access-token', { path: '/' });
    cookies.delete('sb-refresh-token', { path: '/' });
    // Add any other relevant session cookies if necessary

    logger.info('[API Logout] Session cookies cleared', { requestId });

    // Return a success response (No Content)
    return new Response(null, { status: 204 });

  } catch (err) {
    logger.error('[API Logout] Unexpected error during logout process', { requestId }, err);
    return new Response(JSON.stringify({ error: 'Wystąpił nieoczekiwany błąd podczas wylogowywania.' }), {
      status: 500,
      headers: { 'Content-Type': 'application/json' },
    });
  }
}

// Optional: Handle GET requests or other methods if needed,
// otherwise they will result in a 405 Method Not Allowed error.
export const ALL: APIRoute = ({ redirect }) => {
  // Redirect GET requests or other methods to login as well, or show an error
  return redirect("/login");
};



================================================
File: src/pages/api/auth/register.ts
================================================
import type { APIRoute } from "astro";
import { z } from "zod";
import type { AstroLocals } from "src/types/locals";
import type { RegisterUserResponse } from "src/types";

export const prerender = false;

// Schema do walidacji danych wejściowych
const RegisterSchema = z.object({
  email: z.string().email("Nieprawidłowy format adresu email."),
  password: z.string().min(8, "Hasło musi mieć minimum 8 znaków."),
});

export const POST: APIRoute = async ({ request, locals }) => {
  // Sprawdzanie dostępności klienta Supabase
  const supabase = (locals as AstroLocals)?.supabase;
  if (!supabase) {
    console.error("API /auth/register: Supabase client not found in locals");
    return new Response(JSON.stringify({ message: "Błąd serwera - brak połączenia z usługą autoryzacji." }), {
      status: 500,
    });
  }

  // Pobieranie i parsowanie danych JSON z żądania
  let requestData;
  try {
    requestData = await request.json();
  } catch (error) {
    console.error("API /auth/register: Invalid JSON", error);
    return new Response(JSON.stringify({ message: "Nieprawidłowy format danych." }), { status: 400 });
  }

  // Walidacja danych wejściowych
  const validationResult = RegisterSchema.safeParse(requestData);
  if (!validationResult.success) {
    const formattedErrors = validationResult.error.format();
    console.error("API /auth/register: Validation error", formattedErrors);
    return new Response(
      JSON.stringify({
        message: "Błąd walidacji danych.",
        errors: formattedErrors,
      }),
      { status: 400 }
    );
  }

  const { email, password } = validationResult.data;
  console.log(`API /auth/register: Registration attempt for ${email}`);

  try {
    // Rejestracja nowego użytkownika przez Supabase Auth
    const { data, error } = await supabase.auth.signUp({
      email,
      password,
      options: {
        // Opcja auto-potwierdzenia emaila w środowisku deweloperskim
        emailRedirectTo: `${new URL(request.url).origin}/login`,
        data: {
          // Auto-potwierdzenie tylko w dev
          email_confirmed: process.env.NODE_ENV !== "production",
          registration_date: new Date().toISOString(),
        },
      },
    });

    // Obsługa błędu rejestracji
    if (error) {
      console.error("API /auth/register: Supabase auth error", error);

      // Sprawdzanie typowych błędów
      if (error.message.includes("already registered")) {
        return new Response(JSON.stringify({ message: "Użytkownik z tym adresem email już istnieje." }), {
          status: 400,
        });
      }

      return new Response(JSON.stringify({ message: `Błąd rejestracji: ${error.message}` }), { status: 400 });
    }

    // Sprawdzenie czy mamy poprawne dane użytkownika
    if (!data.user) {
      console.error("API /auth/register: Missing user data");
      return new Response(JSON.stringify({ message: "Błąd rejestracji - brak danych użytkownika." }), { status: 500 });
    }

    console.log(`API /auth/register: Registration successful for user: ${data.user.email}`);

    // Po pomyślnej rejestracji automatycznie logujemy użytkownika, aby ustawić ciasteczka sesji
    if (process.env.NODE_ENV !== "production" && data.user.email) {
      console.log("API /auth/register: Auto-login after registration (dev mode) to set session cookies");
      const { error: signInError } = await supabase.auth.signInWithPassword({
        email,
        password,
      });

      if (signInError) {
        console.error("API /auth/register: Auto-login failed", signInError);
        // Kontynuujemy mimo błędu auto-logowania, rejestracja się powiodła
      } else {
        console.log("API /auth/register: Auto-login successful, session cookies should be set.");
        // Nie potrzebujemy już tokenu z loginData.session?.access_token
      }
    }

    // Przygotowanie odpowiedzi - usunięto zwracanie tokenu
    const responseBody: Omit<RegisterUserResponse, "token"> = {
      id: data.user.id,
      email: data.user.email || "",
      registrationDate: data.user.created_at || new Date().toISOString(),
      // token: sessionToken || data.session?.access_token || "", // Token nie jest już zwracany
    };

    return new Response(JSON.stringify(responseBody), {
      status: 200,
      headers: { "Content-Type": "application/json" },
    });
  } catch (error) {
    console.error("API /auth/register: Unexpected error during registration", error);
    return new Response(JSON.stringify({ message: "Wystąpił nieoczekiwany błąd podczas rejestracji." }), {
      status: 500,
    });
  }
};



================================================
File: src/pages/api/auth/request-reset.ts
================================================
import type { APIRoute } from "astro";
import { z } from "zod";
import type { AstroLocals } from "../../../types/locals"; // Adjust path if needed

export const prerender = false;

// Input validation schema
const RequestResetSchema = z.object({
  email: z.string().email("Nieprawidłowy format adresu email."),
});

export const POST: APIRoute = async ({ request, locals }) => {
  // Ensure locals and supabase client are available
  const supabase = (locals as AstroLocals)?.supabase;
  if (!supabase) {
    console.error("API Error: Supabase client not found in locals");
    return new Response(JSON.stringify({ message: "Błąd serwera: Klient Supabase niedostępny." }), { status: 500 });
  }

  let requestData;
  try {
    requestData = await request.json();
  } catch {
    return new Response(JSON.stringify({ message: "Nieprawidłowy format zapytania (oczekiwano JSON)." }), {
      status: 400,
    });
  }

  // Validate input
  const validationResult = RequestResetSchema.safeParse(requestData);
  if (!validationResult.success) {
    return new Response(
      JSON.stringify({
        message: "Błąd walidacji.",
        errors: validationResult.error.flatten().fieldErrors,
      }),
      { status: 400 }
    );
  }

  const { email } = validationResult.data;

  console.log(`API: Received password reset request for email: ${email}`);

  try {
    // Call Supabase to send the password reset email
    // Note: Configure email templates and redirect URL in Supabase project settings
    const { error } = await supabase.auth.resetPasswordForEmail(email, {
      // This URL should point to your set-new-password page
      redirectTo: new URL("/set-new-password", request.url).toString(),
    });

    if (error) {
      console.error("API: Supabase resetPasswordForEmail error:", error.message);
      // Avoid revealing if email exists - return generic success message anyway
      // Or return a specific error for logging but generic for user
      // return new Response(JSON.stringify({ message: error.message || 'Błąd podczas wysyłania emaila.' }), { status: 500 });
    }

    // IMPORTANT: Always return a generic success message to prevent email enumeration attacks
    console.log(`API: Password reset email initiated for ${email} (if user exists).`);
    return new Response(
      JSON.stringify({
        message: "Jeśli konto istnieje, link do resetowania hasła został wysłany na podany adres email.",
      }),
      { status: 200 }
    );
  } catch (error: unknown) {
    console.error("API: Unexpected error during password reset request:", error);
    return new Response(JSON.stringify({ message: "Wystąpił nieoczekiwany błąd serwera." }), { status: 500 });
  }
};



================================================
File: src/pages/api/auth/set-new-password.ts
================================================
import type { APIRoute } from "astro";
import { z } from "zod";
import type { AstroLocals } from "../../../types/locals"; // Adjust path if needed

export const prerender = false;

// Input validation schema
const SetNewPasswordSchema = z.object({
  // Token received by the client from the URL hash fragment
  accessToken: z.string().min(1, "Token dostępu jest wymagany."),
  password: z.string().min(8, "Hasło musi mieć co najmniej 8 znaków."),
  // No need for confirmPassword here, validation happens client-side before calling API
});

export const POST: APIRoute = async ({ request, locals }) => {
  const supabase = (locals as AstroLocals)?.supabase;
  if (!supabase) {
    console.error("API Error: Supabase client not found in locals");
    return new Response(JSON.stringify({ message: "Błąd serwera: Klient Supabase niedostępny." }), { status: 500 });
  }

  let requestData;
  try {
    requestData = await request.json();
  } catch {
    return new Response(JSON.stringify({ message: "Nieprawidłowy format zapytania (oczekiwano JSON)." }), {
      status: 400,
    });
  }

  // Validate input
  const validationResult = SetNewPasswordSchema.safeParse(requestData);
  if (!validationResult.success) {
    return new Response(
      JSON.stringify({
        message: "Błąd walidacji.",
        errors: validationResult.error.flatten().fieldErrors,
      }),
      { status: 400 }
    );
  }

  const { accessToken, password } = validationResult.data;

  console.log(`API: Received request to set new password.`);

  try {
    // Step 1: Verify the access token to get the user context
    const {
      data: { user },
      error: getUserError,
    } = await supabase.auth.getUser(accessToken);

    if (getUserError || !user) {
      console.error("API: Failed to verify access token:", getUserError?.message);
      // Use a generic error message for security
      return new Response(
        JSON.stringify({ message: "Link do resetowania hasła jest nieprawidłowy lub wygasł. Spróbuj ponownie." }),
        { status: 401 }
      ); // Unauthorized
    }

    // Step 2: If token is valid, update the user's password
    // The user context is now set for the Supabase client for this request
    console.log(`API: Access token verified for user: ${user.email}. Attempting password update.`);
    const { error: updateError } = await supabase.auth.updateUser({
      password: password,
      // No need to pass accessToken here, context is already set
    });

    // Check for errors during the update process
    if (updateError) {
      console.error("API: Supabase updateUser error after token verification:", updateError.message);
      let userMessage = "Nie udało się zaktualizować hasła po weryfikacji tokenu.";
      if (updateError.message.includes("same password")) {
        userMessage = "Nowe hasło nie może być takie samo jak stare.";
      }
      // Use 500 here as it's likely a server/DB issue if getUser succeeded but updateUser failed
      return new Response(JSON.stringify({ message: userMessage }), { status: 500 });
    }

    // Password updated successfully
    console.log(`API: Password successfully updated for user: ${user.email}`); // Log email obtained from getUser

    return new Response(
      JSON.stringify({
        message: "Hasło zostało pomyślnie zaktualizowane. Możesz się teraz zalogować.",
      }),
      { status: 200 }
    );
  } catch (error: unknown) {
    console.error("API: Unexpected error during password update:", error);
    return new Response(
      JSON.stringify({ message: "Wystąpił nieoczekiwany błąd serwera podczas aktualizacji hasła." }),
      { status: 500 }
    );
  }
};



================================================
File: src/pages/api/client/shopping-lists/[listId].ts
================================================
import type { APIContext, AstroLocals } from "astro";
import { getShoppingListById } from "../../../lib/services/shopping-list.service";
import { ShoppingListError } from "../../../lib/errors/ShoppingListError";
import { logger } from "../../../lib/logger"; // Assuming logger is configured

/**
 * Endpoint for getting shopping list details by ID.
 * Handles GET requests to /api/client/shopping-lists/{listId}
 * Relies on server-side authentication via Astro.locals.
 */
export async function GET({ params, locals }: APIContext) {
  const requestId = crypto.randomUUID();
  // Use listId from params, consistent with filename
  const listId = params.listId;

  logger.info(`[API Client Get List] Received GET request for list ID: ${listId}`, { requestId });

  if (!listId) {
    logger.warn("[API Client Get List] Missing list ID in request path", { requestId });
    return new Response(JSON.stringify({ error: "Brak ID listy" }), {
      status: 400,
      headers: { "Content-Type": "application/json" },
    });
  }

  const { supabase, user } = locals as AstroLocals;

  // 1. Check authentication (crucial for client-side endpoint)
  if (!user || !supabase) {
    logger.warn("[API Client Get List] Authentication failed", { requestId, listId });
    return new Response(JSON.stringify({ error: "Wymagane uwierzytelnienie" }), {
      status: 401,
      headers: { "Content-Type": "application/json" },
    });
  }

  logger.info("[API Client Get List] User authenticated", { requestId, userId: user.id, listId });

  try {
    // 2. Call the service function to get the list details
    // We use getShoppingListById which fetches details including items
    const listDetails = await getShoppingListById(supabase, user.id, listId);
    logger.info("[API Client Get List] List details fetched successfully", { requestId, userId: user.id, listId });

    // 3. Return success response
    return new Response(JSON.stringify(listDetails), {
      status: 200,
      headers: { "Content-Type": "application/json" },
    });
  } catch (error) {
    logger.error("[API Client Get List] Error fetching list details", { requestId, userId: user.id, listId, error });

    if (error instanceof ShoppingListError) {
      // Handle specific errors from the service layer
      let statusCode = 500; // Default to internal server error
      switch (error.code) {
        case "LIST_NOT_FOUND":
        case "NOT_FOUND": // Keep both for potential variations
          statusCode = 404;
          break;
        case "FORBIDDEN":
          statusCode = 403; // User doesn't own this list
          break;
        case "INVALID_UUID":
          statusCode = 400; // Bad request due to invalid ID format
          break;
        case "DATABASE_ERROR":
          // Keep 500 for database errors
          break;
        // Add other specific error codes if needed
      }
      logger.warn(`[API Client Get List] Returning ${statusCode} due to ShoppingListError`, {
        requestId,
        listId,
        errorCode: error.code,
        errorMessage: error.message,
      });
      return new Response(JSON.stringify({ error: error.message, code: error.code }), {
        status: statusCode,
        headers: { "Content-Type": "application/json" },
      });
    }

    // Generic internal server error for unexpected issues
    logger.error("[API Client Get List] Returning 500 due to unexpected error", { requestId, listId, error });
    return new Response(JSON.stringify({ error: "Wystąpił wewnętrzny błąd serwera" }), {
      status: 500,
      headers: { "Content-Type": "application/json" },
    });
  }
}

// Note: We might need PUT and DELETE handlers here as well,
// depending on how the frontend interacts with this endpoint for updates/deletions.
// For now, only GET is implemented as requested by the user's problem description.



================================================
File: src/pages/api/shopping-lists/[listId].ts
================================================
import type { APIContext } from "astro";
import type { AstroLocals } from "@/types/locals";
import {
  deleteShoppingList,
  getShoppingListById,
  updateShoppingList,
  ShoppingListError,
} from "@/lib/services/shopping-list.service";
import { logger } from "@/lib/logger";
import { updateShoppingListSchema } from "@/lib/validators/shopping-list.validators";

export const prerender = false;

/**
 * Endpoint for getting shopping list details by ID.
 * Handles GET requests to /api/shopping-lists/{listId}
 */
export async function GET({ params, locals }: APIContext) {
  const requestId = crypto.randomUUID();
  // Use listId from params, consistent with filename
  const listId = params.listId;

  logger.info(`[API Get List] Received GET request for list ID: ${listId}`, { requestId });

  if (!listId) {
    logger.warn("[API Get List] Missing list ID in request path", { requestId });
    return new Response(JSON.stringify({ error: "Brak ID listy" }), {
      status: 400,
      headers: { "Content-Type": "application/json" },
    });
  }

  const { supabase, user } = locals as AstroLocals;

  // 1. Check authentication
  if (!user || !supabase) {
    logger.warn("[API Get List] Authentication failed", { requestId, listId });
    return new Response(JSON.stringify({ error: "Wymagane uwierzytelnienie" }), {
      status: 401,
      headers: { "Content-Type": "application/json" },
    });
  }

  logger.info("[API Get List] User authenticated", { requestId, userId: user.id, listId });

  try {
    // 2. Call the service function to get the list details
    const listDetails = await getShoppingListById(supabase, user.id, listId);
    logger.info("[API Get List] List details fetched successfully", { requestId, userId: user.id, listId });

    // 3. Return success response
    return new Response(JSON.stringify(listDetails), {
      status: 200,
      headers: { "Content-Type": "application/json" },
    });
  } catch (error) {
    logger.error("[API Get List] Error fetching list details", { requestId, userId: user.id, listId }, error);

    if (error instanceof ShoppingListError) {
      // Handle specific errors, e.g., NOT_FOUND or FORBIDDEN
      let statusCode = 500;
      switch (error.code) {
        case "NOT_FOUND":
        case "LIST_NOT_FOUND": // Added LIST_NOT_FOUND based on service
          statusCode = 404;
          break;
        case "FORBIDDEN":
          statusCode = 403;
          break;
        case "INVALID_UUID": // Added INVALID_UUID based on service
          statusCode = 400;
          break;
        // Add other specific error codes if needed
      }
      return new Response(JSON.stringify({ error: error.message, code: error.code }), {
        status: statusCode,
        headers: { "Content-Type": "application/json" },
      });
    }

    // Generic internal server error
    return new Response(JSON.stringify({ error: "Wystąpił wewnętrzny błąd serwera" }), {
      status: 500,
      headers: { "Content-Type": "application/json" },
    });
  }
}

/**
 * Endpoint for deleting a shopping list by ID.
 * Handles DELETE requests to /api/shopping-lists/{listId}
 */
export async function DELETE({ params, locals }: APIContext) {
  const requestId = crypto.randomUUID();
  // Use listId from params, consistent with filename
  const listId = params.listId;

  logger.info(`[API Delete List] Received DELETE request for list ID: ${listId}`, { requestId });

  if (!listId) {
    logger.warn("[API Delete List] Missing list ID in request path", { requestId });
    return new Response(JSON.stringify({ error: "Brak ID listy" }), {
      status: 400,
      headers: { "Content-Type": "application/json" },
    });
  }

  const { supabase, user } = locals as AstroLocals;

  // 1. Check authentication
  if (!user || !supabase) {
    logger.warn("[API Delete List] Authentication failed", { requestId, listId });
    return new Response(JSON.stringify({ error: "Wymagane uwierzytelnienie" }), {
      status: 401,
      headers: { "Content-Type": "application/json" },
    });
  }

  logger.info("[API Delete List] User authenticated", { requestId, userId: user.id, listId });

  try {
    // 2. Call the service function to delete the list
    await deleteShoppingList(supabase, user.id, listId);
    logger.info("[API Delete List] List deleted successfully", { requestId, userId: user.id, listId });

    // 3. Return success response (No Content)
    return new Response(null, { status: 204 }); // No Content
  } catch (error) {
    logger.error("[API Delete List] Error during list deletion", { requestId, userId: user.id, listId }, error);

    if (error instanceof ShoppingListError) {
      // Handle specific errors
      let statusCode = 500;
      switch (error.code) {
        case "NOT_FOUND":
        case "LIST_NOT_FOUND":
          statusCode = 404;
          break;
        case "FORBIDDEN":
          statusCode = 403;
          break;
        case "INVALID_UUID":
          statusCode = 400;
          break;
        // Add other specific error codes if needed
      }
      return new Response(JSON.stringify({ error: error.message, code: error.code }), {
        status: statusCode,
        headers: { "Content-Type": "application/json" },
      });
    }

    // Generic internal server error
    return new Response(JSON.stringify({ error: "Wystąpił wewnętrzny błąd serwera" }), {
      status: 500,
      headers: { "Content-Type": "application/json" },
    });
  }
}

/**
 * Endpoint for updating a shopping list by ID.
 * Handles PUT requests to /api/shopping-lists/{listId}
 */
export async function PUT({ params, request, locals }: APIContext) {
  const requestId = crypto.randomUUID();
  // Use listId from params, consistent with filename
  const listId = params.listId;

  logger.info(`[API Update List] Received PUT request for list ID: ${listId}`, { requestId });

  if (!listId) {
    logger.warn("[API Update List] Missing list ID in request path", { requestId });
    return new Response(JSON.stringify({ error: "Brak ID listy" }), {
      status: 400,
      headers: { "Content-Type": "application/json" },
    });
  }

  const { supabase, user } = locals as AstroLocals;

  // 1. Check authentication
  if (!user || !supabase) {
    logger.warn("[API Update List] Authentication failed", { requestId, listId });
    return new Response(JSON.stringify({ error: "Wymagane uwierzytelnienie" }), {
      status: 401,
      headers: { "Content-Type": "application/json" },
    });
  }

  logger.info("[API Update List] User authenticated", { requestId, userId: user.id, listId });

  try {
    // 2. Parse and validate request body
    const requestData = await request.json();
    const validationResult = updateShoppingListSchema.safeParse(requestData);

    if (!validationResult.success) {
      const validationErrors = validationResult.error.format();
      logger.warn("[API Update List] Validation failed", { requestId, errors: validationErrors });
      return new Response(JSON.stringify({ error: "Nieprawidłowe dane", details: validationErrors }), {
        status: 400,
        headers: { "Content-Type": "application/json" },
      });
    }

    // 3. Call the service function
    const updatedList = await updateShoppingList(supabase, user.id, listId, validationResult.data);
    logger.info("[API Update List] List updated successfully", { requestId, userId: user.id, listId });

    // 4. Return success response
    return new Response(JSON.stringify(updatedList), {
      status: 200,
      headers: { "Content-Type": "application/json" },
    });
  } catch (error) {
    logger.error("[API Update List] Error updating list", { requestId, userId: user.id, listId }, error);

    if (error instanceof ShoppingListError) {
      // Handle specific errors
      let statusCode = 500;
      switch (error.code) {
        case "NOT_FOUND":
        case "LIST_NOT_FOUND":
          statusCode = 404;
          break;
        case "FORBIDDEN":
          statusCode = 403;
          break;
        case "DUPLICATE_TITLE":
          statusCode = 409;
          break;
        case "INVALID_UUID":
          statusCode = 400;
          break;
        // Add other specific error codes if needed
      }
      return new Response(JSON.stringify({ error: error.message, code: error.code }), {
        status: statusCode,
        headers: { "Content-Type": "application/json" },
      });
    }

    // Generic internal server error
    return new Response(JSON.stringify({ error: "Wystąpił wewnętrzny błąd serwera" }), {
      status: 500,
      headers: { "Content-Type": "application/json" },
    });
  }
}



================================================
File: src/pages/api/shopping-lists/index.ts
================================================
import type { APIContext } from "astro";
import type { AstroLocals } from "@/types/locals";
import type { CreateShoppingListRequest } from "@/types";
import { createShoppingListSchema } from "@/lib/validators/shopping-list.validators";
import { createShoppingList, ShoppingListError } from "@/lib/services/shopping-list.service";
import { logger } from "@/lib/logger";

export const prerender = false;

/**
 * Endpoint for creating a new shopping list.
 * Handles POST requests to /api/shopping-lists/
 */
export async function POST({ request, locals }: APIContext) {
  const requestId = crypto.randomUUID();
  logger.info("[API Create List] Received POST request", { requestId });

  const { supabase, user } = locals as AstroLocals;

  // 1. Check authentication (using user from locals)
  if (!user || !supabase) {
    logger.warn("[API Create List] Authentication failed (no user or supabase in locals)", { requestId });
    return new Response(JSON.stringify({ error: "Wymagane uwierzytelnienie" }), {
      status: 401,
      headers: { "Content-Type": "application/json" },
    });
  }

  logger.info("[API Create List] User authenticated", { requestId, userId: user.id });

  try {
    // 2. Parse and validate request body
    const requestData = await request.json();
    logger.debug("[API Create List] Received request data", { requestId, body: requestData });

    const validationResult = createShoppingListSchema.safeParse(requestData);
    if (!validationResult.success) {
      const validationErrors = validationResult.error.format();
      logger.warn("[API Create List] Validation failed", { requestId, errors: validationErrors });
      return new Response(JSON.stringify({ error: "Nieprawidłowe dane", details: validationErrors }), {
        status: 400,
        headers: { "Content-Type": "application/json" },
      });
    }

    // 3. Call the service function
    const shoppingListData: CreateShoppingListRequest = {
      title: validationResult.data.title,
    };

    // Pass the server-side supabase client and validated user ID
    const newList = await createShoppingList(supabase, user.id, shoppingListData);
    logger.info("[API Create List] List created successfully", { requestId, userId: user.id, listId: newList.id });

    // 4. Return success response
    return new Response(JSON.stringify(newList), {
      status: 201, // Created
      headers: { "Content-Type": "application/json" },
    });
  } catch (error) {
    // Handle potential errors from the service function
    logger.error("[API Create List] Error during list creation", { requestId, userId: user.id }, error);

    if (error instanceof ShoppingListError) {
      // Handle specific shopping list errors (duplicate title, etc.)
      let statusCode = 500;
      switch (error.code) {
        case "DUPLICATE_TITLE":
          statusCode = 409;
          break;
        // Add other specific error codes if needed
      }
      return new Response(JSON.stringify({ error: error.message, code: error.code }), {
        status: statusCode,
        headers: { "Content-Type": "application/json" },
      });
    }

    // Generic internal server error
    return new Response(JSON.stringify({ error: "Wystąpił wewnętrzny błąd serwera" }), {
      status: 500,
      headers: { "Content-Type": "application/json" },
    });
  }
}



================================================
File: src/pages/api/shopping-lists/[listId]/ai-parse.ts
================================================
import type { APIRoute } from "astro";
import { OpenRouterService } from "@/lib/openrouter.service";
import { getErrorMessage } from "@/lib/utils/error";
import { supabaseClient } from "@/db/supabase.client";
import type { AstroLocals } from "@/types/locals";

// Pobieramy klucz API ze zmiennych środowiskowych
const OPENROUTER_API_KEY = import.meta.env.OPENROUTER_API_KEY;

export const POST: APIRoute = async ({ params, request, locals }) => {
  // Dodaję identyfikator żądania dla łatwiejszego śledzenia
  const requestId = crypto.randomUUID();
  console.log(`[${requestId}] [ai-parse] Otrzymano żądanie POST z ${request.url}`);

  try {
    // Sprawdź, czy klucz API OpenRouter jest dostępny
    if (!OPENROUTER_API_KEY) {
      console.error(
        `[${requestId}] [ai-parse] Brak klucza API OpenRouter w zmiennych środowiskowych (OPENROUTER_API_KEY)`
      );
      return new Response(
        JSON.stringify({ error: "Configuration error", details: "OpenRouter API key is not configured" }),
        { status: 500 }
      );
    }
    console.log(`[${requestId}] [ai-parse] Klucz API OpenRouter załadowany ze zmiennych środowiskowych.`);

    // Pobieramy dane uwierzytelniające bezpośrednio z middleware locals
    const { user, isAuthenticated, authUser } = locals as AstroLocals & { isAuthenticated: boolean };

    console.log(`[${requestId}] [ai-parse] Dane uwierzytelniające z middleware:`, {
      userExists: !!user,
      isAuthenticated,
      authUserExists: !!authUser,
      userId: user?.id || authUser?.id,
    });

    // Sprawdź, czy użytkownik jest zalogowany
    if (!isAuthenticated || (!user && !authUser)) {
      console.error(`[${requestId}] [ai-parse] Brak uwierzytelnienia, użytkownik niezalogowany`);
      return new Response(JSON.stringify({ error: "Unauthorized", details: "Użytkownik niezalogowany" }), {
        status: 401,
      });
    }

    // Ustal ID użytkownika (mogą być dwa źródła: user z Supabase i authUser ze zserializowanego DTO)
    const userId = user?.id || authUser?.id;

    if (!userId) {
      console.error(`[${requestId}] [ai-parse] Brak ID użytkownika mimo pozytywnej walidacji`);
      return new Response(JSON.stringify({ error: "Unauthorized", details: "Brak ID użytkownika" }), {
        status: 401,
      });
    }

    console.log(`[${requestId}] [ai-parse] Użytkownik zalogowany, userId: ${userId}`);

    // Get list ID from params
    const { listId } = params;
    if (!listId) {
      console.error(`[${requestId}] [ai-parse] Brak ID listy w parametrach`);
      return new Response(JSON.stringify({ error: "List ID is required" }), {
        status: 400,
      });
    }

    // Użyj supabase z locals jeśli dostępne, w przeciwnym razie użyj globalnego klienta
    const supabase = (locals as AstroLocals).supabase || supabaseClient;

    // Verify list exists and belongs to user
    console.log(`[${requestId}] [ai-parse] Weryfikacja czy lista ${listId} należy do użytkownika ${userId}`);
    const { data: list, error: listError } = await supabase
      .from("shopping_lists")
      .select("id")
      .eq("id", listId)
      .eq("user_id", userId)
      .single();

    if (listError) {
      console.error(`[${requestId}] [ai-parse] Błąd pobierania listy: ${listError.message}`);
      return new Response(JSON.stringify({ error: "List not found", details: listError.message }), {
        status: 404,
      });
    }

    if (!list) {
      console.error(`[${requestId}] [ai-parse] Lista nie istnieje lub nie należy do użytkownika`);
      return new Response(JSON.stringify({ error: "List not found" }), {
        status: 404,
      });
    }

    // Pobierz istniejące produkty z listy zakupów wraz ze statusem purchased
    console.log(`[${requestId}] [ai-parse] Pobieranie istniejących produktów z listy ${listId}`);
    const { data: existingItems, error: itemsError } = await supabase
      .from("shopping_list_items")
      .select("id, item_name, purchased")
      .eq("shopping_list_id", listId)
      .order("created_at", { ascending: true });

    if (itemsError) {
      console.error(`[${requestId}] [ai-parse] Błąd pobierania produktów: ${itemsError.message}`);
      return new Response(JSON.stringify({ error: "Failed to fetch existing products", details: itemsError.message }), {
        status: 500,
      });
    }

    // Get text content from request body
    console.log(`[${requestId}] [ai-parse] Parsowanie danych z ciała żądania`);
    let body;
    try {
      body = await request.json();
    } catch (error) {
      console.error(`[${requestId}] [ai-parse] Błąd parsowania JSON z ciała żądania: ${getErrorMessage(error)}`);
      return new Response(JSON.stringify({ error: "Invalid JSON in request body" }), {
        status: 400,
      });
    }

    const { text } = body as { text: string };

    if (!text || typeof text !== "string") {
      console.error(`[${requestId}] [ai-parse] Brak tekstu lub nieprawidłowy format tekstu w żądaniu`);
      return new Response(JSON.stringify({ error: "Text content is required" }), {
        status: 400,
      });
    }

    // Przygotuj obecną listę produktów ze statusem purchased
    const productsWithStatus = existingItems.map((item) => ({
      name: item.item_name,
      purchased: item.purchased,
    }));

    // Initialize OpenRouter service
    console.log(`[${requestId}] [ai-parse] Inicjalizacja serwisu OpenRouter z kluczem API ze zmiennych środowiskowych`);
    try {
      // Używamy klucza ze zmiennej środowiskowej
      const openRouter = new OpenRouterService(OPENROUTER_API_KEY);

      // Formatowanie istniejących produktów do przekazania asystentowi AI
      const existingProductsFormatted = JSON.stringify(productsWithStatus);

      // Przygotuj zapytanie ręcznie z wymaganymi parametrami
      console.log(`[${requestId}] [ai-parse] Przygotowywanie zapytania do OpenRouter`);
      const requestPayload = {
        model: "openai/gpt-4o",
        messages: [
          {
            role: "system",
            content: `Jesteś asystentem, który ma pomóc zarządzać listą zakupów. Twoje zadanie to:

1. Analizować nowy tekst użytkownika z informacjami o produktach do dodania lub usunięcia.
2. Uwzględniać istniejące produkty na liście wraz z ich statusem (purchased: true/false).
3. Zwrócić **kompletną i finalną** listę produktów po zastosowaniu wszystkich zmian (dodanie, usunięcie, zachowanie).

Zasady:
- Jeżeli jest mowa o określonej ilości (np. "kilogram czereśni"), dodaj tę informację przy produkcie (np. "1 kg czereśni").
- **Kluczowe:** Gdy użytkownik wspomina o usunięciu produktu (np. "nie kupuj masła", "usuń masło", "bez masła", "już mam masło"), **MUSISZ** usunąć ten produkt z finalnej listy. Nie dołączaj go do odpowiedzi.
- Zachowaj wszystkie istniejące produkty, których użytkownik **nie prosił** o usunięcie. Ich status 'purchased' powinien zostać zachowany.
- Nowo dodane produkty powinny mieć status purchased: false (chyba że użytkownik wyraźnie mówi, że już je kupił).
- Usuń duplikaty (case-insensitive, np. "Mleko" i "mleko" to to samo) i ogranicz listę do 50 pozycji.
- Utrzymuj proste nazwy produktów.

Zwróć odpowiedź **wyłącznie** w formacie JSON z tablicą 'products', gdzie każdy produkt ma właściwości 'name' (string) i 'purchased' (boolean). Upewnij się, że odpowiedź to poprawny JSON.`,
          },
          {
            role: "user",
            content: `Istniejące produkty na mojej liście zakupów (format JSON): ${existingProductsFormatted}

Przetwórz ten tekst i zaktualizuj moją listę zakupów (dodaj nowe produkty, usuń te, o których napisałem, że nie chcę ich kupować): "${text}"`,
          },
        ],
        response_format: { type: "json_object" },
        temperature: 0.2,
        max_tokens: 1000,
      };

      console.log(`[${requestId}] [ai-parse] Wysyłanie zapytania do OpenRouter, długość tekstu: ${text.length} znaków`);
      const response = await fetch(`${openRouter.getBaseUrl()}/chat/completions`, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          Authorization: `Bearer ${openRouter.getApiKey()}`,
        },
        body: JSON.stringify(requestPayload),
      });

      if (!response.ok) {
        const errorText = await response.text();
        console.error(`[${requestId}] [ai-parse] Błąd API OpenRouter: ${response.status} ${errorText}`);
        return new Response(
          JSON.stringify({ error: "Failed to process text with AI", details: `API error: ${response.status}` }),
          {
            status: 500,
          }
        );
      }

      // Parse the response
      console.log(`[${requestId}] [ai-parse] Otrzymano odpowiedź z OpenRouter, status: ${response.status}`);
      try {
        const responseData = await response.json();
        console.log(`[${requestId}] [ai-parse] Odpowiedź OpenRouter:`, JSON.stringify(responseData, null, 2));

        // Sprawdź, czy odpowiedź ma oczekiwaną strukturę
        if (!responseData.choices || !responseData.choices[0]?.message?.content) {
          console.error(`[${requestId}] [ai-parse] Nieprawidłowa struktura odpowiedzi:`, responseData);
          return new Response(
            JSON.stringify({ error: "Invalid response from AI", details: "Missing choices or content" }),
            {
              status: 500,
            }
          );
        }

        // Próba parsowania JSON z zawartości wiadomości
        const contentStr = responseData.choices[0].message.content;
        try {
          const contentJson = JSON.parse(contentStr);

          // Sprawdź, czy zawiera tablicę produktów
          if (!contentJson.products || !Array.isArray(contentJson.products)) {
            console.error(`[${requestId}] [ai-parse] Brak tablicy products w odpowiedzi:`, contentJson);
            return new Response(
              JSON.stringify({
                error: "Invalid response format",
                details: "Response does not contain products array",
              }),
              { status: 500 }
            );
          }

          // Sprawdź, czy produkty mają wymagane pola
          for (const product of contentJson.products) {
            if (!Object.prototype.hasOwnProperty.call(product, "name")) {
              product.name = "Produkt bez nazwy";
            }
            // Jeśli AI nie określiło statusu purchased, ustaw domyślnie na false
            if (!Object.prototype.hasOwnProperty.call(product, "purchased")) {
              product.purchased = false;
            }
          }

          // 1. Pobierz ponownie istniejące elementy dla pewności (lub użyj `existingItems` pobranych wcześniej)
          //    Dla uproszczenia na razie użyjemy `existingItems` pobranych na początku.
          //    W bardziej złożonym scenariuszu warto byłoby pobrać je ponownie tuż przed transakcją.
          console.log(`[${requestId}] [ai-parse] Przygotowywanie zmian na podstawie odpowiedzi AI.`);
          const currentItems = existingItems; // Używamy danych pobranych wcześniej
          const aiItems = contentJson.products as { name: string; purchased: boolean }[];

          // Pomocnicza funkcja do normalizacji i porównywania nazw
          const normalizeName = (name: string) => name.trim().toLowerCase();

          // Mapy do szybkiego wyszukiwania
          const currentItemsMap = new Map(currentItems.map((item) => [normalizeName(item.item_name), item]));
          const aiItemsMap = new Map(aiItems.map((item) => [normalizeName(item.name), item]));

          // 2. Oblicz różnice (Diff)
          const itemsToAdd: { item_name: string; purchased: boolean; shopping_list_id: string }[] = [];
          const itemsToDelete: { id: string }[] = [];
          // Potencjalnie: const itemsToUpdate: { id: string; purchased?: boolean; item_name?: string }[] = [];

          // Znajdź elementy do dodania (są w AI, nie ma ich w obecnych)
          for (const [normalizedName, aiItem] of aiItemsMap.entries()) {
            if (!currentItemsMap.has(normalizedName)) {
              itemsToAdd.push({
                shopping_list_id: listId,
                item_name: aiItem.name.trim(), // Użyj oryginalnej nazwy z AI, ale przyciętej
                purchased: aiItem.purchased,
              });
            }
            // Opcjonalnie: obsługa aktualizacji, jeśli nazwa pasuje, ale np. status 'purchased' się zmienił
            // else {
            //   const currentItem = currentItemsMap.get(normalizedName)!;
            //   if (currentItem.purchased !== aiItem.purchased || currentItem.item_name !== aiItem.name.trim()) {
            //     // Dodaj do listy do aktualizacji
            //   }
            // }
          }

          // Znajdź elementy do usunięcia (są w obecnych, nie ma ich w AI)
          for (const [normalizedName, currentItem] of currentItemsMap.entries()) {
            if (!aiItemsMap.has(normalizedName)) {
              itemsToDelete.push({ id: currentItem.id });
            }
          }

          console.log(`[${requestId}] [ai-parse] Zidentyfikowano zmiany:`, {
            toAdd: itemsToAdd.length,
            toDelete: itemsToDelete.length,
            // toUpdate: itemsToUpdate.length (jeśli zaimplementowano)
          });

          // 3. Wywołaj funkcję RPC w Supabase, aby zastosować zmiany w transakcji
          if (itemsToAdd.length > 0 || itemsToDelete.length > 0 /*|| itemsToUpdate.length > 0*/) {
            console.log(`[${requestId}] [ai-parse] Wywoływanie funkcji RPC 'apply_shopping_list_changes'`);
            const { error: rpcError } = await supabase.rpc("apply_shopping_list_changes", {
              p_list_id: listId,
              p_user_id: userId, // Przekazujemy userId do weryfikacji uprawnień w funkcji SQL
              items_to_add: itemsToAdd,
              items_to_delete: itemsToDelete.map((item) => item.id), // Przekazujemy tylko tablicę ID
              // items_to_update: itemsToUpdate, // Przekaż, jeśli zaimplementowano
            });

            if (rpcError) {
              console.error(
                `[${requestId}] [ai-parse] Błąd podczas wywoływania RPC 'apply_shopping_list_changes': ${rpcError.message}`
              );
              return new Response(
                JSON.stringify({ error: "Failed to apply changes atomically", details: rpcError.message }),
                { status: 500 }
              );
            }
            console.log(`[${requestId}] [ai-parse] Pomyślnie zastosowano zmiany przez RPC.`);
          } else {
            console.log(`[${requestId}] [ai-parse] Brak zmian do zastosowania w bazie danych.`);
          }

          // 4. Zwróć nową listę elementów (można pobrać zaktualizowaną listę lub zwrócić tę z AI)
          //    Dla spójności i pewności, pobierzmy zaktualizowaną listę z bazy.
          console.log(`[${requestId}] [ai-parse] Pobieranie zaktualizowanej listy produktów po zmianach`);
          const { data: updatedItems, error: fetchUpdatedError } = await supabase
            .from("shopping_list_items")
            .select("id, item_name, purchased, created_at, updated_at")
            .eq("shopping_list_id", listId)
            .order("created_at", { ascending: true });

          if (fetchUpdatedError) {
            console.error(
              `[${requestId}] [ai-parse] Błąd pobierania zaktualizowanych produktów: ${fetchUpdatedError.message}`
            );
            // Zwróć błąd, ale operacje mogły się powieść
            return new Response(
              JSON.stringify({
                error: "Failed to fetch updated products after applying changes",
                details: fetchUpdatedError.message,
              }),
              { status: 500 }
            );
          }

          // Mapujemy na format DTO
          const updatedItemsDTO = updatedItems.map((item) => ({
            id: item.id,
            itemName: item.item_name,
            purchased: item.purchased,
            createdAt: item.created_at,
            updatedAt: item.updated_at,
          }));

          console.log(
            `[${requestId}] [ai-parse] Zwracanie zaktualizowanej listy (${updatedItemsDTO.length} produktów).`
          );
          return new Response(JSON.stringify({ products: updatedItemsDTO }), {
            status: 200,
            headers: {
              "Content-Type": "application/json",
            },
          });
        } catch (jsonError) {
          console.error(
            `[${requestId}] [ai-parse] Błąd parsowania JSON z odpowiedzi AI: ${getErrorMessage(jsonError)}`,
            contentStr
          );
          return new Response(JSON.stringify({ error: "Failed to parse AI response" }), {
            status: 500,
          });
        }
      } catch (internalError) {
        console.error(`[${requestId}] [ai-parse] Błąd wewnętrzny przy obsłudze odpowiedzi AI: ${internalError}`);
        return new Response(JSON.stringify({ error: "Internal error processing AI response" }), {
          status: 500,
        });
      }
    } catch (error) {
      console.error(`[${requestId}] [ai-parse] Nieoczekiwany błąd inicjalizacji serwisu OpenRouter: ${error}`);
      return new Response(JSON.stringify({ error: "AI service initialization failed" }), {
        status: 500,
      });
    }
  } catch (error) {
    const errorMessage = getErrorMessage(error);
    console.error(`[${requestId}] [ai-parse] Nadrzędny błąd: ${errorMessage}`);
    return new Response(JSON.stringify({ error: "Internal Server Error", details: errorMessage }), {
      status: 500,
    });
  }
};



================================================
File: src/pages/api/shopping-lists/[listId]/clear-items.ts
================================================
import type { APIRoute } from "astro";
import { supabaseClient } from "@/db/supabase.client";
import type { AstroLocals } from "@/types/locals";
import { getErrorMessage } from "@/lib/utils/error";

/**
 * Endpoint do usuwania wszystkich elementów z listy zakupów
 *
 * @method DELETE
 * @path /api/shopping-lists/[listId]/clear-items
 */
export const DELETE: APIRoute = async ({ params, locals }) => {
  // Dodaję identyfikator żądania dla łatwiejszego śledzenia
  const requestId = crypto.randomUUID();
  console.log(`[${requestId}] [clear-items] Otrzymano żądanie DELETE dla listy ${params.listId}`);

  try {
    // Pobieramy dane uwierzytelniające bezpośrednio z middleware locals
    const { user, isAuthenticated, authUser } = locals as AstroLocals & { isAuthenticated: boolean };

    console.log(`[${requestId}] [clear-items] Dane uwierzytelniające z middleware:`, {
      userExists: !!user,
      isAuthenticated,
      authUserExists: !!authUser,
      userId: user?.id || authUser?.id,
    });

    // Sprawdź, czy użytkownik jest zalogowany
    if (!isAuthenticated || (!user && !authUser)) {
      console.error(`[${requestId}] [clear-items] Brak uwierzytelnienia, użytkownik niezalogowany`);
      return new Response(JSON.stringify({ error: "Unauthorized", details: "Użytkownik niezalogowany" }), {
        status: 401,
      });
    }

    // Ustal ID użytkownika (mogą być dwa źródła: user z Supabase i authUser ze zserializowanego DTO)
    const userId = user?.id || authUser?.id;

    if (!userId) {
      console.error(`[${requestId}] [clear-items] Brak ID użytkownika mimo pozytywnej walidacji`);
      return new Response(JSON.stringify({ error: "Unauthorized", details: "Brak ID użytkownika" }), {
        status: 401,
      });
    }

    // Get list ID from params
    const { listId } = params;
    if (!listId) {
      console.error(`[${requestId}] [clear-items] Brak ID listy w parametrach`);
      return new Response(JSON.stringify({ error: "List ID is required" }), {
        status: 400,
      });
    }

    // Użyj supabase z locals jeśli dostępne, w przeciwnym razie użyj globalnego klienta
    const supabase = (locals as AstroLocals).supabase || supabaseClient;

    // Verify list exists and belongs to user
    console.log(`[${requestId}] [clear-items] Weryfikacja czy lista ${listId} należy do użytkownika ${userId}`);
    const { data: list, error: listError } = await supabase
      .from("shopping_lists")
      .select("id")
      .eq("id", listId)
      .eq("user_id", userId)
      .single();

    if (listError) {
      console.error(`[${requestId}] [clear-items] Błąd pobierania listy: ${listError.message}`);
      return new Response(JSON.stringify({ error: "List not found", details: listError.message }), {
        status: 404,
      });
    }

    if (!list) {
      console.error(`[${requestId}] [clear-items] Lista nie istnieje lub nie należy do użytkownika`);
      return new Response(JSON.stringify({ error: "List not found" }), {
        status: 404,
      });
    }

    // Usuwanie wszystkich elementów z listy zakupów
    console.log(`[${requestId}] [clear-items] Usuwanie wszystkich elementów z listy ${listId}`);
    const { error: deleteError } = await supabase.from("shopping_list_items").delete().eq("shopping_list_id", listId);

    if (deleteError) {
      console.error(`[${requestId}] [clear-items] Błąd usuwania elementów: ${deleteError.message}`);
      return new Response(
        JSON.stringify({ error: "Failed to clear shopping list items", details: deleteError.message }),
        { status: 500 }
      );
    }

    console.log(`[${requestId}] [clear-items] Pomyślnie usunięto wszystkie elementy z listy ${listId}`);
    return new Response(JSON.stringify({ success: true }), {
      status: 200,
    });
  } catch (error) {
    console.error(`[${requestId}] [clear-items] Nieobsłużony błąd: ${getErrorMessage(error)}`);
    return new Response(JSON.stringify({ error: getErrorMessage(error) }), {
      status: 500,
    });
  }
};



================================================
File: src/pages/api/shopping-lists/[listId]/items/[itemId].ts
================================================
import type { APIContext } from "astro";
import type { AstroLocals } from "@/types/locals";
import {
  updateShoppingListItem,
  deleteShoppingListItem,
  ShoppingListError,
} from "@/lib/services/shopping-list.service";
import { logger } from "@/lib/logger";
import { updateShoppingListItemSchema } from "@/lib/validators/shopping-list.validators";

export const prerender = false;

/**
 * Endpoint for updating a specific shopping list item.
 * Handles PUT requests to /api/shopping-lists/{listId}/items/{itemId}
 */
// --- PUT Handler (Aktualizacja elementu listy) ---
export async function PUT({ params, request, locals }: APIContext) {
  const requestId = crypto.randomUUID();
  const { listId, itemId } = params;

  logger.info(`[API Update Item] Received PUT request for list ID: ${listId}, item ID: ${itemId}`, { requestId });

  if (!listId || !itemId) {
    logger.warn("[API Update Item] Missing list ID or item ID in request path", { requestId });
    return new Response(JSON.stringify({ error: "Brak ID listy lub ID elementu" }), {
      status: 400,
      headers: { "Content-Type": "application/json" },
    });
  }

  const { supabase, user } = locals as AstroLocals;

  // 1. Check authentication
  if (!user || !supabase) {
    logger.warn("[API Update Item] Authentication failed", { requestId, listId, itemId });
    return new Response(JSON.stringify({ error: "Wymagane uwierzytelnienie" }), {
      status: 401,
      headers: { "Content-Type": "application/json" },
    });
  }

  logger.info("[API Update Item] User authenticated", { requestId, userId: user.id, listId, itemId });

  try {
    // 2. Parse and validate request body
    const requestData = await request.json();
    const validationResult = updateShoppingListItemSchema.safeParse(requestData);

    if (!validationResult.success) {
      const validationErrors = validationResult.error.format();
      logger.warn("[API Update Item] Validation failed", { requestId, errors: validationErrors });
      return new Response(JSON.stringify({ error: "Nieprawidłowe dane", details: validationErrors }), {
        status: 400,
        headers: { "Content-Type": "application/json" },
      });
    }

    // 3. Call the service function
    const updatedItem = await updateShoppingListItem(supabase, user.id, listId, itemId, validationResult.data);
    logger.info("[API Update Item] Item updated successfully", { requestId, userId: user.id, listId, itemId });

    // 4. Return success response
    return new Response(JSON.stringify(updatedItem), {
      status: 200,
      headers: { "Content-Type": "application/json" },
    });
  } catch (error) {
    logger.error("[API Update Item] Error updating item", { requestId, userId: user.id, listId, itemId }, error);

    if (error instanceof ShoppingListError) {
      // Handle specific errors
      let statusCode = 500;
      switch (error.code) {
        case "NOT_FOUND": // e.g., item or list not found
          statusCode = 404;
          break;
        case "FORBIDDEN": // e.g., user doesn't own the list
          statusCode = 403;
          break;
        // Add other specific error codes if needed
      }
      return new Response(JSON.stringify({ error: error.message, code: error.code }), {
        status: statusCode,
        headers: { "Content-Type": "application/json" },
      });
    }

    // Generic internal server error
    return new Response(JSON.stringify({ error: "Wystąpił wewnętrzny błąd serwera" }), {
      status: 500,
      headers: { "Content-Type": "application/json" },
    });
  }
}

/**
 * Endpoint for deleting a specific shopping list item.
 * Handles DELETE requests to /api/shopping-lists/{listId}/items/{itemId}
 */
// --- DELETE Handler (Usuwanie elementu listy) ---
export async function DELETE({ params, locals }: APIContext) {
  const requestId = crypto.randomUUID();
  const { listId, itemId } = params;

  logger.info(`[API Delete Item] Received DELETE request for list ID: ${listId}, item ID: ${itemId}`, { requestId });

  if (!listId || !itemId) {
    logger.warn("[API Delete Item] Missing list ID or item ID in request path", { requestId });
    return new Response(JSON.stringify({ error: "Brak ID listy lub ID elementu" }), {
      status: 400,
      headers: { "Content-Type": "application/json" },
    });
  }

  const { supabase, user } = locals as AstroLocals;

  // 1. Check authentication
  if (!user || !supabase) {
    logger.warn("[API Delete Item] Authentication failed", { requestId, listId, itemId });
    return new Response(JSON.stringify({ error: "Wymagane uwierzytelnienie" }), {
      status: 401,
      headers: { "Content-Type": "application/json" },
    });
  }

  logger.info("[API Delete Item] User authenticated", { requestId, userId: user.id, listId, itemId });

  try {
    // 2. Call the service function to delete the item
    await deleteShoppingListItem(supabase, user.id, listId, itemId);
    logger.info("[API Delete Item] Item deleted successfully", { requestId, userId: user.id, listId, itemId });

    // 3. Return success response (No Content)
    return new Response(null, { status: 204 }); // No Content
  } catch (error) {
    logger.error("[API Delete Item] Error deleting item", { requestId, userId: user.id, listId, itemId }, error);

    if (error instanceof ShoppingListError) {
      // Handle specific errors
      let statusCode = 500;
      switch (error.code) {
        case "NOT_FOUND": // e.g., item or list not found
          statusCode = 404;
          break;
        case "FORBIDDEN": // e.g., user doesn't own the list
          statusCode = 403;
          break;
        // Add other specific error codes if needed
      }
      return new Response(JSON.stringify({ error: error.message, code: error.code }), {
        status: statusCode,
        headers: { "Content-Type": "application/json" },
      });
    }

    // Generic internal server error
    return new Response(JSON.stringify({ error: "Wystąpił wewnętrzny błąd serwera" }), {
      status: 500,
      headers: { "Content-Type": "application/json" },
    });
  }
}



================================================
File: src/pages/api/shopping-lists/[listId]/items/index.ts
================================================
import type { APIContext } from "astro";
import type { AstroLocals } from "@/types/locals";
import { addItemToShoppingList, ShoppingListError } from "@/lib/services/shopping-list.service";
import { logger } from "@/lib/logger";
import { addItemToShoppingListSchema } from "@/lib/validators/shopping-list.validators";

export const prerender = false;

/**
 * Endpoint for adding an item to a shopping list.
 * Handles POST requests to /api/shopping-lists/{listId}/items
 */
export async function POST({ params, request, locals }: APIContext) {
  const requestId = crypto.randomUUID();
  const { listId } = params;

  logger.info(`[API Add Item] Received POST request for list ID: ${listId}`, { requestId });

  if (!listId) {
    logger.warn("[API Add Item] Missing list ID in request path", { requestId });
    return new Response(JSON.stringify({ error: "Brak ID listy" }), {
      status: 400,
      headers: { "Content-Type": "application/json" },
    });
  }

  const { supabase, user } = locals as AstroLocals;

  // 1. Check authentication
  if (!user || !supabase) {
    logger.warn("[API Add Item] Authentication failed", { requestId, listId });
    return new Response(JSON.stringify({ error: "Wymagane uwierzytelnienie" }), {
      status: 401,
      headers: { "Content-Type": "application/json" },
    });
  }

  logger.info("[API Add Item] User authenticated", { requestId, userId: user.id, listId });

  try {
    // 2. Parse and validate request body
    const requestData = await request.json();
    const validationResult = addItemToShoppingListSchema.safeParse(requestData);

    if (!validationResult.success) {
      const validationErrors = validationResult.error.format();
      logger.warn("[API Add Item] Validation failed", { requestId, errors: validationErrors });
      return new Response(JSON.stringify({ error: "Nieprawidłowe dane", details: validationErrors }), {
        status: 400,
        headers: { "Content-Type": "application/json" },
      });
    }

    // 3. Call the service function
    const newItem = await addItemToShoppingList(supabase, user.id, listId, validationResult.data);
    logger.info("[API Add Item] Item added successfully", { requestId, userId: user.id, listId, itemId: newItem.id });

    // 4. Return success response
    return new Response(JSON.stringify(newItem), {
      status: 201, // Created
      headers: { "Content-Type": "application/json" },
    });
  } catch (error) {
    logger.error("[API Add Item] Error adding item", { requestId, userId: user.id, listId }, error);

    if (error instanceof ShoppingListError) {
      // Handle specific errors
      let statusCode = 500;
      switch (error.code) {
        case "NOT_FOUND": // e.g., list not found
          statusCode = 404;
          break;
        case "FORBIDDEN": // e.g., user doesn't own the list
          statusCode = 403;
          break;
        // Add other specific error codes if needed
      }
      return new Response(JSON.stringify({ error: error.message, code: error.code }), {
        status: statusCode,
        headers: { "Content-Type": "application/json" },
      });
    }

    // Generic internal server error
    return new Response(JSON.stringify({ error: "Wystąpił wewnętrzny błąd serwera" }), {
      status: 500,
      headers: { "Content-Type": "application/json" },
    });
  }
}



================================================
File: src/pages/api/users/[id].ts
================================================
/**
 * Endpointy do zarządzania pojedynczym użytkownikiem:
 * GET /api/users/{id} - pobieranie użytkownika
 * PUT /api/users/{id} - aktualizacja użytkownika
 * DELETE /api/users/{id} - usuwanie użytkownika
 */
import type { APIRoute } from "astro";
import { getUserById, updateUser, deleteUser } from "../../../lib/services/userService";
import { isUserAdmin } from "../../../lib/auth/adminAuth";
import { userIdSchema, updateUserSchema } from "../../../lib/schemas/userSchemas";
import type { AstroLocals } from "../../../types/locals";

/**
 * Endpoint GET /api/users/{id} - pobieranie użytkownika według ID
 * Użytkownik może pobrać własne dane lub administrator może pobrać dane dowolnego użytkownika
 */
export const GET: APIRoute = async ({ params, locals }) => {
  const isDevelopment = process.env.NODE_ENV === "development";
  const endpointName = "GET /api/users/:id";

  if (isDevelopment) {
    console.log(`🔧 Endpoint ${endpointName} działa w trybie deweloperskim`);
  }

  try {
    // Pobieranie użytkownika z kontekstu
    const { user, supabase } = locals as AstroLocals;
    const currentUserId = user?.id;

    // Sprawdzenie czy użytkownik jest zalogowany
    if (!currentUserId) {
      return new Response(JSON.stringify({ error: "Brak autoryzacji" }), {
        status: 401,
        headers: { "Content-Type": "application/json" },
      });
    }

    // Walidacja parametru id
    const userId = params.id;

    if (!userId) {
      return new Response(JSON.stringify({ error: "Brak ID użytkownika" }), {
        status: 400,
        headers: { "Content-Type": "application/json" },
      });
    }

    const validationResult = userIdSchema.safeParse(userId);

    if (!validationResult.success) {
      return new Response(
        JSON.stringify({
          error: "Nieprawidłowy format ID użytkownika",
          details: validationResult.error.format(),
        }),
        {
          status: 400,
          headers: { "Content-Type": "application/json" },
        }
      );
    }

    // Sprawdzenie czy użytkownik ma uprawnienia
    const isAdmin = await isUserAdmin(supabase, currentUserId, isDevelopment);
    const isSelfAccess = currentUserId === userId;

    if (!isAdmin && !isSelfAccess) {
      return new Response(JSON.stringify({ error: "Brak uprawnień" }), {
        status: 403,
        headers: { "Content-Type": "application/json" },
      });
    }

    // Pobieranie danych użytkownika
    const userData = await getUserById(supabase, userId, isDevelopment);

    if (!userData) {
      return new Response(JSON.stringify({ error: "Użytkownik nie został znaleziony" }), {
        status: 404,
        headers: { "Content-Type": "application/json" },
      });
    }

    // Zwrócenie odpowiedzi
    return new Response(JSON.stringify(userData), {
      status: 200,
      headers: { "Content-Type": "application/json" },
    });
  } catch (error) {
    console.error(`Błąd podczas pobierania użytkownika:`, error);

    return new Response(
      JSON.stringify({
        error: "Wystąpił błąd podczas przetwarzania żądania",
        message: error instanceof Error ? error.message : "Nieznany błąd",
      }),
      {
        status: 500,
        headers: { "Content-Type": "application/json" },
      }
    );
  }
};

/**
 * Endpoint PUT /api/users/{id} - aktualizacja użytkownika
 * Użytkownik może aktualizować własne dane lub administrator może aktualizować dane dowolnego użytkownika
 */
export const PUT: APIRoute = async ({ params, request, locals }) => {
  const isDevelopment = process.env.NODE_ENV === "development";
  const endpointName = "PUT /api/users/{id}";

  if (isDevelopment) {
    console.log(`🔧 Endpoint ${endpointName} działa w trybie deweloperskim`);
  }

  try {
    // Pobieranie użytkownika z kontekstu
    const { user, supabase } = locals as AstroLocals;
    const currentUserId = user?.id;

    // Sprawdzenie czy użytkownik jest zalogowany
    if (!currentUserId) {
      return new Response(JSON.stringify({ error: "Brak autoryzacji" }), {
        status: 401,
        headers: { "Content-Type": "application/json" },
      });
    }

    // Walidacja parametru ID
    const { id } = params;
    const idValidation = userIdSchema.safeParse(id);

    if (!idValidation.success) {
      return new Response(
        JSON.stringify({
          error: "Nieprawidłowy format ID użytkownika",
          details: idValidation.error.format(),
        }),
        {
          status: 400,
          headers: { "Content-Type": "application/json" },
        }
      );
    }

    const targetUserId = idValidation.data;

    // Sprawdzenie autoryzacji:
    // 1. Użytkownik zawsze może aktualizować własne dane
    // 2. Administrator może aktualizować dane dowolnego użytkownika
    const isOwnData = currentUserId === targetUserId;
    const isAdmin = await isUserAdmin(supabase, currentUserId, isDevelopment);

    if (isDevelopment) {
      console.log(
        `🔧 Endpoint ${endpointName} działa w trybie deweloperskim (uprawnienia administratora: ${isAdmin}, własne dane: ${isOwnData})`
      );
    }

    if (!isOwnData && !isAdmin) {
      return new Response(JSON.stringify({ error: "Brak uprawnień do aktualizacji danych tego użytkownika" }), {
        status: 403,
        headers: { "Content-Type": "application/json" },
      });
    }

    // Sprawdzenie czy użytkownik istnieje
    const existingUser = await getUserById(supabase, targetUserId);
    if (!existingUser) {
      return new Response(JSON.stringify({ error: "Nie znaleziono użytkownika o podanym ID" }), {
        status: 404,
        headers: { "Content-Type": "application/json" },
      });
    }

    // Walidacja danych wejściowych
    const requestBody = await request.json().catch(() => ({}));
    const validationResult = updateUserSchema.safeParse(requestBody);

    if (!validationResult.success) {
      return new Response(
        JSON.stringify({
          error: "Nieprawidłowe dane aktualizacji",
          details: validationResult.error.format(),
        }),
        {
          status: 400,
          headers: { "Content-Type": "application/json" },
        }
      );
    }

    const updateData = validationResult.data;

    // Aktualizacja danych użytkownika
    try {
      const updatedUser = await updateUser(supabase, targetUserId, updateData);

      if (!updatedUser) {
        return new Response(JSON.stringify({ error: "Nie udało się zaktualizować użytkownika" }), {
          status: 500,
          headers: { "Content-Type": "application/json" },
        });
      }

      // Zwrócenie odpowiedzi
      return new Response(JSON.stringify(updatedUser), {
        status: 200,
        headers: { "Content-Type": "application/json" },
      });
    } catch (error) {
      // Obsługa konfliktu adresu email
      if (error instanceof Error && error.message.includes("Email jest już używany")) {
        return new Response(JSON.stringify({ error: error.message }), {
          status: 409,
          headers: { "Content-Type": "application/json" },
        });
      }

      throw error;
    }
  } catch (error) {
    console.error(`Błąd podczas aktualizacji użytkownika:`, error);

    return new Response(
      JSON.stringify({
        error: "Wystąpił błąd podczas przetwarzania żądania",
        message: error instanceof Error ? error.message : "Nieznany błąd",
      }),
      {
        status: 500,
        headers: { "Content-Type": "application/json" },
      }
    );
  }
};

/**
 * Endpoint DELETE /api/users/{id} - usuwanie użytkownika
 * Użytkownik może usunąć swoje konto lub administrator może usunąć konto dowolnego użytkownika
 */
export const DELETE: APIRoute = async ({ params, locals }) => {
  const isDevelopment = process.env.NODE_ENV === "development";
  const endpointName = "DELETE /api/users/{id}";

  if (isDevelopment) {
    console.log(`🔧 Endpoint ${endpointName} działa w trybie deweloperskim`);
  }

  try {
    // Pobieranie użytkownika z kontekstu
    const { user, supabase } = locals as AstroLocals;
    const currentUserId = user?.id;

    // Sprawdzenie czy użytkownik jest zalogowany
    if (!currentUserId) {
      return new Response(JSON.stringify({ error: "Brak autoryzacji" }), {
        status: 401,
        headers: { "Content-Type": "application/json" },
      });
    }

    // Walidacja parametru ID
    const { id } = params;
    const idValidation = userIdSchema.safeParse(id);

    if (!idValidation.success) {
      return new Response(
        JSON.stringify({
          error: "Nieprawidłowy format ID użytkownika",
          details: idValidation.error.format(),
        }),
        {
          status: 400,
          headers: { "Content-Type": "application/json" },
        }
      );
    }

    const targetUserId = idValidation.data;

    // Sprawdzenie autoryzacji:
    // 1. Użytkownik zawsze może usunąć własne konto
    // 2. Administrator może usunąć konto dowolnego użytkownika
    const isOwnData = currentUserId === targetUserId;
    const isAdmin = await isUserAdmin(supabase, currentUserId, isDevelopment);

    if (isDevelopment) {
      console.log(
        `🔧 Endpoint ${endpointName} działa w trybie deweloperskim (uprawnienia administratora: ${isAdmin}, własne dane: ${isOwnData})`
      );
    }

    if (!isOwnData && !isAdmin) {
      return new Response(JSON.stringify({ error: "Brak uprawnień do usunięcia tego użytkownika" }), {
        status: 403,
        headers: { "Content-Type": "application/json" },
      });
    }

    // Sprawdzenie czy użytkownik istnieje
    const existingUser = await getUserById(supabase, targetUserId);
    if (!existingUser) {
      return new Response(JSON.stringify({ error: "Nie znaleziono użytkownika o podanym ID" }), {
        status: 404,
        headers: { "Content-Type": "application/json" },
      });
    }

    // Usunięcie użytkownika
    const success = await deleteUser(supabase, targetUserId);

    if (!success) {
      return new Response(JSON.stringify({ error: "Nie udało się usunąć użytkownika" }), {
        status: 500,
        headers: { "Content-Type": "application/json" },
      });
    }

    // Zwrócenie odpowiedzi (pusta odpowiedź z kodem 204)
    return new Response(null, {
      status: 204,
    });
  } catch (error) {
    console.error(`Błąd podczas usuwania użytkownika:`, error);

    return new Response(
      JSON.stringify({
        error: "Wystąpił błąd podczas przetwarzania żądania",
        message: error instanceof Error ? error.message : "Nieznany błąd",
      }),
      {
        status: 500,
        headers: { "Content-Type": "application/json" },
      }
    );
  }
};



================================================
File: src/pages/api/users/index.ts
================================================
/**
 * Endpoint GET /api/users - pobieranie wszystkich użytkowników
 * Dostępny tylko dla administratorów
 */
import type { APIRoute } from "astro";
import { getAllUsers } from "../../../lib/services/userService";
import { isUserAdmin } from "../../../lib/auth/adminAuth";
import { getAllUsersQuerySchema } from "../../../lib/schemas/userSchemas";
import type { AstroLocals } from "../../../types/locals";

export const GET: APIRoute = async ({ request, locals }) => {
  const isDevelopment = process.env.NODE_ENV === "development";
  const endpointName = "GET /api/users";

  if (isDevelopment) {
    console.log(`🔧 Endpoint ${endpointName} działa w trybie deweloperskim`);
  }

  try {
    // Pobieranie użytkownika z kontekstu
    const { user, supabase } = locals as AstroLocals;
    const currentUserId = user?.id;

    // Sprawdzenie czy użytkownik jest zalogowany
    if (!currentUserId) {
      return new Response(JSON.stringify({ error: "Brak autoryzacji" }), {
        status: 401,
        headers: { "Content-Type": "application/json" },
      });
    }

    // Sprawdzenie uprawnień administratora
    const isAdmin = await isUserAdmin(supabase, currentUserId, isDevelopment);

    if (isDevelopment) {
      console.log(`🔧 Endpoint ${endpointName} działa w trybie deweloperskim (uprawnienia administratora: ${isAdmin})`);
    }

    if (!isAdmin) {
      return new Response(JSON.stringify({ error: "Brak uprawnień administratora" }), {
        status: 403,
        headers: { "Content-Type": "application/json" },
      });
    }

    // Pobieranie i walidacja parametrów zapytania
    const url = new URL(request.url);
    const params = {
      page: url.searchParams.get("page"),
      pageSize: url.searchParams.get("pageSize"),
      sort: url.searchParams.get("sort"),
      order: url.searchParams.get("order"),
      emailFilter: url.searchParams.get("emailFilter"),
    };

    // Walidacja parametrów zapytania
    const validationResult = getAllUsersQuerySchema.safeParse({
      page: params.page,
      pageSize: params.pageSize,
      sort: params.sort,
      order: params.order,
      emailFilter: params.emailFilter,
    });

    if (!validationResult.success) {
      return new Response(
        JSON.stringify({
          error: "Nieprawidłowe parametry zapytania",
          details: validationResult.error.format(),
        }),
        {
          status: 400,
          headers: { "Content-Type": "application/json" },
        }
      );
    }

    const validParams = validationResult.data;

    // Pobieranie danych użytkowników
    const result = await getAllUsers(
      supabase,
      validParams.page,
      validParams.pageSize,
      validParams.sort,
      validParams.order,
      validParams.emailFilter || undefined,
      isDevelopment
    );

    // Zwrócenie odpowiedzi
    return new Response(JSON.stringify(result), {
      status: 200,
      headers: { "Content-Type": "application/json" },
    });
  } catch (error) {
    console.error(`Błąd podczas pobierania użytkowników:`, error);

    return new Response(
      JSON.stringify({
        error: "Wystąpił błąd podczas przetwarzania żądania",
        message: error instanceof Error ? error.message : "Nieznany błąd",
      }),
      {
        status: 500,
        headers: { "Content-Type": "application/json" },
      }
    );
  }
};



================================================
File: src/pages/api/users/me.ts
================================================
import type { APIRoute } from "astro";
import type { AstroLocals } from "src/types/locals"; // Using path from src/
import type { UserDTO } from "src/types"; // Using path from src/

export const prerender = false;

export const GET: APIRoute = async ({ locals }) => {
  const supabase = (locals as AstroLocals)?.supabase;
  if (!supabase) {
    console.error("API Error: Supabase client not found in locals for /api/users/me");
    return new Response(JSON.stringify({ message: "Błąd serwera: Klient Supabase niedostępny." }), { status: 500 });
  }

  // Sprawdź użytkownika z lokalnego kontekstu - używamy userDTO
  const {
    userDTO: userFromLocals, // Zmieniono user na userDTO
    isAuthenticated,
    // Usunięto authUser, ponieważ userDTO zawiera potrzebne dane
  } = locals as AstroLocals & { userDTO: UserDTO | null; isAuthenticated: boolean };

  console.log("API /api/users/me: Checking authentication from middleware locals:", {
    userDTOExists: !!userFromLocals, // Zmieniono userExists na userDTOExists
    isAuthenticated,
  });

  // Jeśli userDTO jest dostępny w lokalnym kontekście z middleware, użyj go
  if (userFromLocals && isAuthenticated) {
    // Dodano sprawdzenie isAuthenticated dla pewności
    console.log(`API /api/users/me: Using authenticated user DTO from middleware: ${userFromLocals.email}`);

    // userFromLocals jest już typu UserDTO, więc zwracamy go bezpośrednio
    return new Response(JSON.stringify(userFromLocals), {
      status: 200,
      headers: { "Content-Type": "application/json" },
    });
  }

  // Jeśli nie ma userDTO w lokalnym kontekście lub isAuthenticated jest false,
  // oznacza to, że użytkownik nie jest uwierzytelniony.
  console.log("API /api/users/me: No authenticated user DTO found in middleware locals. Returning 401.");
  return new Response(JSON.stringify({ message: "Brak autoryzacji." }), { status: 401 });
};



================================================
File: src/pages/list/[id].astro
================================================
---
import MainLayout from "@/layouts/MainLayout.astro";
import ShoppingListDetailView from "@/components/views/ShoppingListDetailView";

// Pobierz ID listy z parametrów ścieżki
const { id } = Astro.params;

// Sprawdzenie, czy ID jest dostępne (opcjonalne, ale dobre praktyki)
if (!id) {
  // Można tu zwrócić błąd 404 lub przekierować
  return Astro.redirect("/404"); // Przykładowe przekierowanie
}

// Wyłączamy prerendering, ponieważ strona jest dynamiczna
export const prerender = false;
---

<MainLayout title="Szczegóły Listy Zakupów">
  <ShoppingListDetailView listId={id} client:load />
</MainLayout>



================================================
File: src/pages/shopping-lists/index.astro
================================================
---
import MainLayout from "@/layouts/MainLayout.astro";
import ShoppingListsView from "@/components/ShoppingListsView";
import type { ShoppingListSummaryDTO, PaginationResponse } from "@/types";
import { getAllShoppingLists } from "@/lib/services/shopping-list.service";
import { logger } from "@/lib/logger";

// Wyłączamy prerendering, ponieważ strona jest dynamiczna
export const prerender = false;

// Server-side data fetching
let initialLists: ShoppingListSummaryDTO[] = [];
let initialPagination: PaginationResponse | null = null;
let fetchError: string | null = null;

// Get user and supabase client from locals (set by middleware)
const { user, supabase } = Astro.locals;

if (!user || !supabase) {
  // If user is not logged in server-side, set an error or handle appropriately
  // This case shouldn't happen if middleware redirects unauthenticated users,
  // but it's good practice to check.
  logger.warn("[index.astro] User or Supabase client not found in locals.");
  fetchError = "Użytkownik nie jest zalogowany lub wystąpił błąd serwera.";
  // Redirecting might be better here:
  // return Astro.redirect('/login');
} else {
  try {
    logger.info(`[index.astro] Fetching initial shopping lists for user ${user.id} on server-side.`);
    // Fetch the first page of lists (adjust parameters as needed)
    const result = await getAllShoppingLists(supabase, user.id, 1, 20);
    initialLists = result.data;
    initialPagination = result.pagination;
    logger.info(`[index.astro] Successfully fetched ${initialLists.length} initial lists.`);
  } catch (error) {
    logger.error("[index.astro] Error fetching initial shopping lists:", { error });
    if (error instanceof Error) {
      fetchError = error.message;
    } else {
      fetchError = "Wystąpił nieznany błąd podczas pobierania list zakupów.";
    }
  }
}
---

<MainLayout title="Twoje Listy Zakupów">
  {/* Pass initial data and error status to the client component */}
  <ShoppingListsView
    client:load
    initialLists={initialLists}
    initialPagination={initialPagination}
    fetchError={fetchError}
  />
  {/* Note: AuthStatus in layout should work now */}
</MainLayout>



================================================
File: src/styles/global.css
================================================
@import "tailwindcss";
@import "tw-animate-css";

@custom-variant dark (&:is(.dark *));

:root {
  --radius: 0.625rem;
  --background: oklch(1 0 0);
  --foreground: oklch(0.145 0 0);
  --card: oklch(1 0 0);
  --card-foreground: oklch(0.145 0 0);
  --popover: oklch(1 0 0);
  --popover-foreground: oklch(0.145 0 0);
  --primary: oklch(0.205 0 0);
  --primary-foreground: oklch(0.985 0 0);
  --secondary: oklch(0.97 0 0);
  --secondary-foreground: oklch(0.205 0 0);
  --muted: oklch(0.97 0 0);
  --muted-foreground: oklch(0.556 0 0);
  --accent: oklch(0.97 0 0);
  --accent-foreground: oklch(0.205 0 0);
  --destructive: oklch(0.577 0.245 27.325);
  --border: oklch(0.922 0 0);
  --input: oklch(0.922 0 0);
  --ring: oklch(0.708 0 0);
  --chart-1: oklch(0.646 0.222 41.116);
  --chart-2: oklch(0.6 0.118 184.704);
  --chart-3: oklch(0.398 0.07 227.392);
  --chart-4: oklch(0.828 0.189 84.429);
  --chart-5: oklch(0.769 0.188 70.08);
  --sidebar: oklch(0.985 0 0);
  --sidebar-foreground: oklch(0.145 0 0);
  --sidebar-primary: oklch(0.205 0 0);
  --sidebar-primary-foreground: oklch(0.985 0 0);
  --sidebar-accent: oklch(0.97 0 0);
  --sidebar-accent-foreground: oklch(0.205 0 0);
  --sidebar-border: oklch(0.922 0 0);
  --sidebar-ring: oklch(0.708 0 0);
}

.dark {
  --background: oklch(0.145 0 0);
  --foreground: oklch(0.985 0 0);
  --card: oklch(0.205 0 0);
  --card-foreground: oklch(0.985 0 0);
  --popover: oklch(0.205 0 0);
  --popover-foreground: oklch(0.985 0 0);
  --primary: oklch(0.922 0 0);
  --primary-foreground: oklch(0.205 0 0);
  --secondary: oklch(0.269 0 0);
  --secondary-foreground: oklch(0.985 0 0);
  --muted: oklch(0.269 0 0);
  --muted-foreground: oklch(0.708 0 0);
  --accent: oklch(0.269 0 0);
  --accent-foreground: oklch(0.985 0 0);
  --destructive: oklch(0.704 0.191 22.216);
  --border: oklch(1 0 0 / 10%);
  --input: oklch(1 0 0 / 15%);
  --ring: oklch(0.556 0 0);
  --chart-1: oklch(0.488 0.243 264.376);
  --chart-2: oklch(0.696 0.17 162.48);
  --chart-3: oklch(0.769 0.188 70.08);
  --chart-4: oklch(0.627 0.265 303.9);
  --chart-5: oklch(0.645 0.246 16.439);
  --sidebar: oklch(0.205 0 0);
  --sidebar-foreground: oklch(0.985 0 0);
  --sidebar-primary: oklch(0.488 0.243 264.376);
  --sidebar-primary-foreground: oklch(0.985 0 0);
  --sidebar-accent: oklch(0.269 0 0);
  --sidebar-accent-foreground: oklch(0.985 0 0);
  --sidebar-border: oklch(1 0 0 / 10%);
  --sidebar-ring: oklch(0.556 0 0);
}

@theme inline {
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);
  --color-destructive: var(--destructive);
  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);
  --color-chart-1: var(--chart-1);
  --color-chart-2: var(--chart-2);
  --color-chart-3: var(--chart-3);
  --color-chart-4: var(--chart-4);
  --color-chart-5: var(--chart-5);
  --color-sidebar: var(--sidebar);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  body {
    @apply bg-background text-foreground;
  }
}



================================================
File: src/types/api.ts
================================================
import type { APIContext } from "astro";
import type { User } from "@supabase/supabase-js";
import type { Mock } from "vitest";

/**
 * Typ reprezentujący mockowane funkcje Supabase w testach
 */
export type MockFunction = Mock;

/**
 * Typ reprezentujący mockowany klient Supabase w testach
 */
export interface MockSupabaseClient {
  from: MockFunction;
  insert?: MockFunction;
  select?: MockFunction;
  update?: MockFunction;
  delete?: MockFunction;
  single?: MockFunction;
  auth?: {
    getUser: MockFunction;
  };
}

/**
 * Interfejs do typowania contexts w testach API
 */
export type MockAPIContext = APIContext<Record<string, unknown>>;

/**
 * Typ reprezentujący mockowane parametry kontekstu API w testach
 */
export interface MockAPIParams {
  request: Request;
  locals: {
    supabase: MockSupabaseClient;
    user: User | null;
    [key: string]: unknown;
  };
}



================================================
File: src/types/locals.ts
================================================
import type { User as SupabaseUser } from "@supabase/supabase-js";
import type { Database } from "../db/database.types";
import type { SupabaseClient as SupabaseClientGeneric } from "@supabase/supabase-js";
import type { UserDTO } from "../types";

// Definiujemy typ SupabaseClient z naszą typowaną bazą danych
type SupabaseClient = SupabaseClientGeneric<Database>;

/**
 * Typ reprezentujący dane dostępne w kontekście lokalnym Astro
 */
export interface AstroLocals {
  /**
   * Klient Supabase do wykonywania operacji na bazie danych
   */
  supabase: SupabaseClient;

  /**
   * Zalogowany użytkownik z Supabase (null jeśli nie jest zalogowany)
   */
  user: SupabaseUser | null;

  /**
   * Zalogowany użytkownik w formacie UserDTO (null jeśli nie jest zalogowany)
   */
  authUser?: UserDTO | null;

  /**
   * Informacja czy użytkownik jest zalogowany
   */
  isAuthenticated?: boolean;
}



================================================
File: supabase/20240424_1405_schema_dump_latest.sql
================================================
--
-- PostgreSQL database dump
--

-- Dumped from database version 15.8
-- Dumped by pg_dump version 15.8

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

--
-- Name: _realtime; Type: SCHEMA; Schema: -; Owner: postgres
--

CREATE SCHEMA _realtime;


ALTER SCHEMA _realtime OWNER TO postgres;

--
-- Name: auth; Type: SCHEMA; Schema: -; Owner: supabase_admin
--

CREATE SCHEMA auth;


ALTER SCHEMA auth OWNER TO supabase_admin;

--
-- Name: extensions; Type: SCHEMA; Schema: -; Owner: postgres
--

CREATE SCHEMA extensions;


ALTER SCHEMA extensions OWNER TO postgres;

--
-- Name: graphql; Type: SCHEMA; Schema: -; Owner: supabase_admin
--

CREATE SCHEMA graphql;


ALTER SCHEMA graphql OWNER TO supabase_admin;

--
-- Name: graphql_public; Type: SCHEMA; Schema: -; Owner: supabase_admin
--

CREATE SCHEMA graphql_public;


ALTER SCHEMA graphql_public OWNER TO supabase_admin;

--
-- Name: pg_net; Type: EXTENSION; Schema: -; Owner: -
--

CREATE EXTENSION IF NOT EXISTS pg_net WITH SCHEMA extensions;


--
-- Name: EXTENSION pg_net; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION pg_net IS 'Async HTTP';


--
-- Name: pgbouncer; Type: SCHEMA; Schema: -; Owner: pgbouncer
--

CREATE SCHEMA pgbouncer;


ALTER SCHEMA pgbouncer OWNER TO pgbouncer;

--
-- Name: realtime; Type: SCHEMA; Schema: -; Owner: supabase_admin
--

CREATE SCHEMA realtime;


ALTER SCHEMA realtime OWNER TO supabase_admin;

--
-- Name: storage; Type: SCHEMA; Schema: -; Owner: supabase_admin
--

CREATE SCHEMA storage;


ALTER SCHEMA storage OWNER TO supabase_admin;

--
-- Name: supabase_functions; Type: SCHEMA; Schema: -; Owner: supabase_admin
--

CREATE SCHEMA supabase_functions;


ALTER SCHEMA supabase_functions OWNER TO supabase_admin;

--
-- Name: supabase_migrations; Type: SCHEMA; Schema: -; Owner: postgres
--

CREATE SCHEMA supabase_migrations;


ALTER SCHEMA supabase_migrations OWNER TO postgres;

--
-- Name: vault; Type: SCHEMA; Schema: -; Owner: supabase_admin
--

CREATE SCHEMA vault;


ALTER SCHEMA vault OWNER TO supabase_admin;

--
-- Name: pg_graphql; Type: EXTENSION; Schema: -; Owner: -
--

CREATE EXTENSION IF NOT EXISTS pg_graphql WITH SCHEMA graphql;


--
-- Name: EXTENSION pg_graphql; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION pg_graphql IS 'pg_graphql: GraphQL support';


--
-- Name: pg_stat_statements; Type: EXTENSION; Schema: -; Owner: -
--

CREATE EXTENSION IF NOT EXISTS pg_stat_statements WITH SCHEMA extensions;


--
-- Name: EXTENSION pg_stat_statements; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION pg_stat_statements IS 'track planning and execution statistics of all SQL statements executed';


--
-- Name: pgcrypto; Type: EXTENSION; Schema: -; Owner: -
--

CREATE EXTENSION IF NOT EXISTS pgcrypto WITH SCHEMA extensions;


--
-- Name: EXTENSION pgcrypto; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION pgcrypto IS 'cryptographic functions';


--
-- Name: pgjwt; Type: EXTENSION; Schema: -; Owner: -
--

CREATE EXTENSION IF NOT EXISTS pgjwt WITH SCHEMA extensions;


--
-- Name: EXTENSION pgjwt; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION pgjwt IS 'JSON Web Token API for Postgresql';


--
-- Name: supabase_vault; Type: EXTENSION; Schema: -; Owner: -
--

CREATE EXTENSION IF NOT EXISTS supabase_vault WITH SCHEMA vault;


--
-- Name: EXTENSION supabase_vault; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION supabase_vault IS 'Supabase Vault Extension';


--
-- Name: uuid-ossp; Type: EXTENSION; Schema: -; Owner: -
--

CREATE EXTENSION IF NOT EXISTS "uuid-ossp" WITH SCHEMA extensions;


--
-- Name: EXTENSION "uuid-ossp"; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION "uuid-ossp" IS 'generate universally unique identifiers (UUIDs)';


--
-- Name: aal_level; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TYPE auth.aal_level AS ENUM (
    'aal1',
    'aal2',
    'aal3'
);


ALTER TYPE auth.aal_level OWNER TO supabase_auth_admin;

--
-- Name: code_challenge_method; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TYPE auth.code_challenge_method AS ENUM (
    's256',
    'plain'
);


ALTER TYPE auth.code_challenge_method OWNER TO supabase_auth_admin;

--
-- Name: factor_status; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TYPE auth.factor_status AS ENUM (
    'unverified',
    'verified'
);


ALTER TYPE auth.factor_status OWNER TO supabase_auth_admin;

--
-- Name: factor_type; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TYPE auth.factor_type AS ENUM (
    'totp',
    'webauthn',
    'phone'
);


ALTER TYPE auth.factor_type OWNER TO supabase_auth_admin;

--
-- Name: one_time_token_type; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TYPE auth.one_time_token_type AS ENUM (
    'confirmation_token',
    'reauthentication_token',
    'recovery_token',
    'email_change_token_new',
    'email_change_token_current',
    'phone_change_token'
);


ALTER TYPE auth.one_time_token_type OWNER TO supabase_auth_admin;

--
-- Name: action; Type: TYPE; Schema: realtime; Owner: supabase_admin
--

CREATE TYPE realtime.action AS ENUM (
    'INSERT',
    'UPDATE',
    'DELETE',
    'TRUNCATE',
    'ERROR'
);


ALTER TYPE realtime.action OWNER TO supabase_admin;

--
-- Name: equality_op; Type: TYPE; Schema: realtime; Owner: supabase_admin
--

CREATE TYPE realtime.equality_op AS ENUM (
    'eq',
    'neq',
    'lt',
    'lte',
    'gt',
    'gte',
    'in'
);


ALTER TYPE realtime.equality_op OWNER TO supabase_admin;

--
-- Name: user_defined_filter; Type: TYPE; Schema: realtime; Owner: supabase_admin
--

CREATE TYPE realtime.user_defined_filter AS (
	column_name text,
	op realtime.equality_op,
	value text
);


ALTER TYPE realtime.user_defined_filter OWNER TO supabase_admin;

--
-- Name: wal_column; Type: TYPE; Schema: realtime; Owner: supabase_admin
--

CREATE TYPE realtime.wal_column AS (
	name text,
	type_name text,
	type_oid oid,
	value jsonb,
	is_pkey boolean,
	is_selectable boolean
);


ALTER TYPE realtime.wal_column OWNER TO supabase_admin;

--
-- Name: wal_rls; Type: TYPE; Schema: realtime; Owner: supabase_admin
--

CREATE TYPE realtime.wal_rls AS (
	wal jsonb,
	is_rls_enabled boolean,
	subscription_ids uuid[],
	errors text[]
);


ALTER TYPE realtime.wal_rls OWNER TO supabase_admin;

--
-- Name: email(); Type: FUNCTION; Schema: auth; Owner: supabase_auth_admin
--

CREATE FUNCTION auth.email() RETURNS text
    LANGUAGE sql STABLE
    AS $$
  select 
  coalesce(
    nullif(current_setting('request.jwt.claim.email', true), ''),
    (nullif(current_setting('request.jwt.claims', true), '')::jsonb ->> 'email')
  )::text
$$;


ALTER FUNCTION auth.email() OWNER TO supabase_auth_admin;

--
-- Name: FUNCTION email(); Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON FUNCTION auth.email() IS 'Deprecated. Use auth.jwt() -> ''email'' instead.';


--
-- Name: jwt(); Type: FUNCTION; Schema: auth; Owner: supabase_auth_admin
--

CREATE FUNCTION auth.jwt() RETURNS jsonb
    LANGUAGE sql STABLE
    AS $$
  select 
    coalesce(
        nullif(current_setting('request.jwt.claim', true), ''),
        nullif(current_setting('request.jwt.claims', true), '')
    )::jsonb
$$;


ALTER FUNCTION auth.jwt() OWNER TO supabase_auth_admin;

--
-- Name: role(); Type: FUNCTION; Schema: auth; Owner: supabase_auth_admin
--

CREATE FUNCTION auth.role() RETURNS text
    LANGUAGE sql STABLE
    AS $$
  select 
  coalesce(
    nullif(current_setting('request.jwt.claim.role', true), ''),
    (nullif(current_setting('request.jwt.claims', true), '')::jsonb ->> 'role')
  )::text
$$;


ALTER FUNCTION auth.role() OWNER TO supabase_auth_admin;

--
-- Name: FUNCTION role(); Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON FUNCTION auth.role() IS 'Deprecated. Use auth.jwt() -> ''role'' instead.';


--
-- Name: uid(); Type: FUNCTION; Schema: auth; Owner: supabase_auth_admin
--

CREATE FUNCTION auth.uid() RETURNS uuid
    LANGUAGE sql STABLE
    AS $$
  select 
  coalesce(
    nullif(current_setting('request.jwt.claim.sub', true), ''),
    (nullif(current_setting('request.jwt.claims', true), '')::jsonb ->> 'sub')
  )::uuid
$$;


ALTER FUNCTION auth.uid() OWNER TO supabase_auth_admin;

--
-- Name: FUNCTION uid(); Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON FUNCTION auth.uid() IS 'Deprecated. Use auth.jwt() -> ''sub'' instead.';


--
-- Name: grant_pg_cron_access(); Type: FUNCTION; Schema: extensions; Owner: postgres
--

CREATE FUNCTION extensions.grant_pg_cron_access() RETURNS event_trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
  IF EXISTS (
    SELECT
    FROM pg_event_trigger_ddl_commands() AS ev
    JOIN pg_extension AS ext
    ON ev.objid = ext.oid
    WHERE ext.extname = 'pg_cron'
  )
  THEN
    grant usage on schema cron to postgres with grant option;

    alter default privileges in schema cron grant all on tables to postgres with grant option;
    alter default privileges in schema cron grant all on functions to postgres with grant option;
    alter default privileges in schema cron grant all on sequences to postgres with grant option;

    alter default privileges for user supabase_admin in schema cron grant all
        on sequences to postgres with grant option;
    alter default privileges for user supabase_admin in schema cron grant all
        on tables to postgres with grant option;
    alter default privileges for user supabase_admin in schema cron grant all
        on functions to postgres with grant option;

    grant all privileges on all tables in schema cron to postgres with grant option;
    revoke all on table cron.job from postgres;
    grant select on table cron.job to postgres with grant option;
  END IF;
END;
$$;


ALTER FUNCTION extensions.grant_pg_cron_access() OWNER TO postgres;

--
-- Name: FUNCTION grant_pg_cron_access(); Type: COMMENT; Schema: extensions; Owner: postgres
--

COMMENT ON FUNCTION extensions.grant_pg_cron_access() IS 'Grants access to pg_cron';


--
-- Name: grant_pg_graphql_access(); Type: FUNCTION; Schema: extensions; Owner: supabase_admin
--

CREATE FUNCTION extensions.grant_pg_graphql_access() RETURNS event_trigger
    LANGUAGE plpgsql
    AS $_$
DECLARE
    func_is_graphql_resolve bool;
BEGIN
    func_is_graphql_resolve = (
        SELECT n.proname = 'resolve'
        FROM pg_event_trigger_ddl_commands() AS ev
        LEFT JOIN pg_catalog.pg_proc AS n
        ON ev.objid = n.oid
    );

    IF func_is_graphql_resolve
    THEN
        -- Update public wrapper to pass all arguments through to the pg_graphql resolve func
        DROP FUNCTION IF EXISTS graphql_public.graphql;
        create or replace function graphql_public.graphql(
            "operationName" text default null,
            query text default null,
            variables jsonb default null,
            extensions jsonb default null
        )
            returns jsonb
            language sql
        as $$
            select graphql.resolve(
                query := query,
                variables := coalesce(variables, '{}'),
                "operationName" := "operationName",
                extensions := extensions
            );
        $$;

        -- This hook executes when `graphql.resolve` is created. That is not necessarily the last
        -- function in the extension so we need to grant permissions on existing entities AND
        -- update default permissions to any others that are created after `graphql.resolve`
        grant usage on schema graphql to postgres, anon, authenticated, service_role;
        grant select on all tables in schema graphql to postgres, anon, authenticated, service_role;
        grant execute on all functions in schema graphql to postgres, anon, authenticated, service_role;
        grant all on all sequences in schema graphql to postgres, anon, authenticated, service_role;
        alter default privileges in schema graphql grant all on tables to postgres, anon, authenticated, service_role;
        alter default privileges in schema graphql grant all on functions to postgres, anon, authenticated, service_role;
        alter default privileges in schema graphql grant all on sequences to postgres, anon, authenticated, service_role;

        -- Allow postgres role to allow granting usage on graphql and graphql_public schemas to custom roles
        grant usage on schema graphql_public to postgres with grant option;
        grant usage on schema graphql to postgres with grant option;
    END IF;

END;
$_$;


ALTER FUNCTION extensions.grant_pg_graphql_access() OWNER TO supabase_admin;

--
-- Name: FUNCTION grant_pg_graphql_access(); Type: COMMENT; Schema: extensions; Owner: supabase_admin
--

COMMENT ON FUNCTION extensions.grant_pg_graphql_access() IS 'Grants access to pg_graphql';


--
-- Name: grant_pg_net_access(); Type: FUNCTION; Schema: extensions; Owner: postgres
--

CREATE FUNCTION extensions.grant_pg_net_access() RETURNS event_trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
  IF EXISTS (
    SELECT 1
    FROM pg_event_trigger_ddl_commands() AS ev
    JOIN pg_extension AS ext
    ON ev.objid = ext.oid
    WHERE ext.extname = 'pg_net'
  )
  THEN
    GRANT USAGE ON SCHEMA net TO supabase_functions_admin, postgres, anon, authenticated, service_role;

    ALTER function net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) SECURITY DEFINER;
    ALTER function net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) SECURITY DEFINER;

    ALTER function net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) SET search_path = net;
    ALTER function net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) SET search_path = net;

    REVOKE ALL ON FUNCTION net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) FROM PUBLIC;
    REVOKE ALL ON FUNCTION net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) FROM PUBLIC;

    GRANT EXECUTE ON FUNCTION net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) TO supabase_functions_admin, postgres, anon, authenticated, service_role;
    GRANT EXECUTE ON FUNCTION net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) TO supabase_functions_admin, postgres, anon, authenticated, service_role;
  END IF;
END;
$$;


ALTER FUNCTION extensions.grant_pg_net_access() OWNER TO postgres;

--
-- Name: FUNCTION grant_pg_net_access(); Type: COMMENT; Schema: extensions; Owner: postgres
--

COMMENT ON FUNCTION extensions.grant_pg_net_access() IS 'Grants access to pg_net';


--
-- Name: pgrst_ddl_watch(); Type: FUNCTION; Schema: extensions; Owner: supabase_admin
--

CREATE FUNCTION extensions.pgrst_ddl_watch() RETURNS event_trigger
    LANGUAGE plpgsql
    AS $$
DECLARE
  cmd record;
BEGIN
  FOR cmd IN SELECT * FROM pg_event_trigger_ddl_commands()
  LOOP
    IF cmd.command_tag IN (
      'CREATE SCHEMA', 'ALTER SCHEMA'
    , 'CREATE TABLE', 'CREATE TABLE AS', 'SELECT INTO', 'ALTER TABLE'
    , 'CREATE FOREIGN TABLE', 'ALTER FOREIGN TABLE'
    , 'CREATE VIEW', 'ALTER VIEW'
    , 'CREATE MATERIALIZED VIEW', 'ALTER MATERIALIZED VIEW'
    , 'CREATE FUNCTION', 'ALTER FUNCTION'
    , 'CREATE TRIGGER'
    , 'CREATE TYPE', 'ALTER TYPE'
    , 'CREATE RULE'
    , 'COMMENT'
    )
    -- don't notify in case of CREATE TEMP table or other objects created on pg_temp
    AND cmd.schema_name is distinct from 'pg_temp'
    THEN
      NOTIFY pgrst, 'reload schema';
    END IF;
  END LOOP;
END; $$;


ALTER FUNCTION extensions.pgrst_ddl_watch() OWNER TO supabase_admin;

--
-- Name: pgrst_drop_watch(); Type: FUNCTION; Schema: extensions; Owner: supabase_admin
--

CREATE FUNCTION extensions.pgrst_drop_watch() RETURNS event_trigger
    LANGUAGE plpgsql
    AS $$
DECLARE
  obj record;
BEGIN
  FOR obj IN SELECT * FROM pg_event_trigger_dropped_objects()
  LOOP
    IF obj.object_type IN (
      'schema'
    , 'table'
    , 'foreign table'
    , 'view'
    , 'materialized view'
    , 'function'
    , 'trigger'
    , 'type'
    , 'rule'
    )
    AND obj.is_temporary IS false -- no pg_temp objects
    THEN
      NOTIFY pgrst, 'reload schema';
    END IF;
  END LOOP;
END; $$;


ALTER FUNCTION extensions.pgrst_drop_watch() OWNER TO supabase_admin;

--
-- Name: set_graphql_placeholder(); Type: FUNCTION; Schema: extensions; Owner: supabase_admin
--

CREATE FUNCTION extensions.set_graphql_placeholder() RETURNS event_trigger
    LANGUAGE plpgsql
    AS $_$
    DECLARE
    graphql_is_dropped bool;
    BEGIN
    graphql_is_dropped = (
        SELECT ev.schema_name = 'graphql_public'
        FROM pg_event_trigger_dropped_objects() AS ev
        WHERE ev.schema_name = 'graphql_public'
    );

    IF graphql_is_dropped
    THEN
        create or replace function graphql_public.graphql(
            "operationName" text default null,
            query text default null,
            variables jsonb default null,
            extensions jsonb default null
        )
            returns jsonb
            language plpgsql
        as $$
            DECLARE
                server_version float;
            BEGIN
                server_version = (SELECT (SPLIT_PART((select version()), ' ', 2))::float);

                IF server_version >= 14 THEN
                    RETURN jsonb_build_object(
                        'errors', jsonb_build_array(
                            jsonb_build_object(
                                'message', 'pg_graphql extension is not enabled.'
                            )
                        )
                    );
                ELSE
                    RETURN jsonb_build_object(
                        'errors', jsonb_build_array(
                            jsonb_build_object(
                                'message', 'pg_graphql is only available on projects running Postgres 14 onwards.'
                            )
                        )
                    );
                END IF;
            END;
        $$;
    END IF;

    END;
$_$;


ALTER FUNCTION extensions.set_graphql_placeholder() OWNER TO supabase_admin;

--
-- Name: FUNCTION set_graphql_placeholder(); Type: COMMENT; Schema: extensions; Owner: supabase_admin
--

COMMENT ON FUNCTION extensions.set_graphql_placeholder() IS 'Reintroduces placeholder function for graphql_public.graphql';


--
-- Name: get_auth(text); Type: FUNCTION; Schema: pgbouncer; Owner: supabase_admin
--

CREATE FUNCTION pgbouncer.get_auth(p_usename text) RETURNS TABLE(username text, password text)
    LANGUAGE plpgsql SECURITY DEFINER
    AS $$
BEGIN
    RAISE WARNING 'PgBouncer auth request: %', p_usename;

    RETURN QUERY
    SELECT usename::TEXT, passwd::TEXT FROM pg_catalog.pg_shadow
    WHERE usename = p_usename;
END;
$$;


ALTER FUNCTION pgbouncer.get_auth(p_usename text) OWNER TO supabase_admin;

--
-- Name: handle_new_user(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.handle_new_user() RETURNS trigger
    LANGUAGE plpgsql SECURITY DEFINER
    SET search_path TO 'public'
    AS $$begin
  -- Ensure the table name 'users' matches your public table name
  insert into public.users (id, email)
  values (new.id, new.email);
  return new;
end;$$;


ALTER FUNCTION public.handle_new_user() OWNER TO postgres;

--
-- Name: trigger_set_timestamp(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.trigger_set_timestamp() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
begin
  new.updated_at = current_timestamp;
  return new;
end;
$$;


ALTER FUNCTION public.trigger_set_timestamp() OWNER TO postgres;

--
-- Name: trigger_set_timestamp_users(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.trigger_set_timestamp_users() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
begin
  new.updated_date = current_timestamp;
  return new;
end;
$$;


ALTER FUNCTION public.trigger_set_timestamp_users() OWNER TO postgres;

--
-- Name: FUNCTION trigger_set_timestamp_users(); Type: COMMENT; Schema: public; Owner: postgres
--

COMMENT ON FUNCTION public.trigger_set_timestamp_users() IS 'Updates the updated_date column to current timestamp on record update';


--
-- Name: apply_rls(jsonb, integer); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer DEFAULT (1024 * 1024)) RETURNS SETOF realtime.wal_rls
    LANGUAGE plpgsql
    AS $$
declare
-- Regclass of the table e.g. public.notes
entity_ regclass = (quote_ident(wal ->> 'schema') || '.' || quote_ident(wal ->> 'table'))::regclass;

-- I, U, D, T: insert, update ...
action realtime.action = (
    case wal ->> 'action'
        when 'I' then 'INSERT'
        when 'U' then 'UPDATE'
        when 'D' then 'DELETE'
        else 'ERROR'
    end
);

-- Is row level security enabled for the table
is_rls_enabled bool = relrowsecurity from pg_class where oid = entity_;

subscriptions realtime.subscription[] = array_agg(subs)
    from
        realtime.subscription subs
    where
        subs.entity = entity_;

-- Subscription vars
roles regrole[] = array_agg(distinct us.claims_role::text)
    from
        unnest(subscriptions) us;

working_role regrole;
claimed_role regrole;
claims jsonb;

subscription_id uuid;
subscription_has_access bool;
visible_to_subscription_ids uuid[] = '{}';

-- structured info for wal's columns
columns realtime.wal_column[];
-- previous identity values for update/delete
old_columns realtime.wal_column[];

error_record_exceeds_max_size boolean = octet_length(wal::text) > max_record_bytes;

-- Primary jsonb output for record
output jsonb;

begin
perform set_config('role', null, true);

columns =
    array_agg(
        (
            x->>'name',
            x->>'type',
            x->>'typeoid',
            realtime.cast(
                (x->'value') #>> '{}',
                coalesce(
                    (x->>'typeoid')::regtype, -- null when wal2json version <= 2.4
                    (x->>'type')::regtype
                )
            ),
            (pks ->> 'name') is not null,
            true
        )::realtime.wal_column
    )
    from
        jsonb_array_elements(wal -> 'columns') x
        left join jsonb_array_elements(wal -> 'pk') pks
            on (x ->> 'name') = (pks ->> 'name');

old_columns =
    array_agg(
        (
            x->>'name',
            x->>'type',
            x->>'typeoid',
            realtime.cast(
                (x->'value') #>> '{}',
                coalesce(
                    (x->>'typeoid')::regtype, -- null when wal2json version <= 2.4
                    (x->>'type')::regtype
                )
            ),
            (pks ->> 'name') is not null,
            true
        )::realtime.wal_column
    )
    from
        jsonb_array_elements(wal -> 'identity') x
        left join jsonb_array_elements(wal -> 'pk') pks
            on (x ->> 'name') = (pks ->> 'name');

for working_role in select * from unnest(roles) loop

    -- Update `is_selectable` for columns and old_columns
    columns =
        array_agg(
            (
                c.name,
                c.type_name,
                c.type_oid,
                c.value,
                c.is_pkey,
                pg_catalog.has_column_privilege(working_role, entity_, c.name, 'SELECT')
            )::realtime.wal_column
        )
        from
            unnest(columns) c;

    old_columns =
            array_agg(
                (
                    c.name,
                    c.type_name,
                    c.type_oid,
                    c.value,
                    c.is_pkey,
                    pg_catalog.has_column_privilege(working_role, entity_, c.name, 'SELECT')
                )::realtime.wal_column
            )
            from
                unnest(old_columns) c;

    if action <> 'DELETE' and count(1) = 0 from unnest(columns) c where c.is_pkey then
        return next (
            jsonb_build_object(
                'schema', wal ->> 'schema',
                'table', wal ->> 'table',
                'type', action
            ),
            is_rls_enabled,
            -- subscriptions is already filtered by entity
            (select array_agg(s.subscription_id) from unnest(subscriptions) as s where claims_role = working_role),
            array['Error 400: Bad Request, no primary key']
        )::realtime.wal_rls;

    -- The claims role does not have SELECT permission to the primary key of entity
    elsif action <> 'DELETE' and sum(c.is_selectable::int) <> count(1) from unnest(columns) c where c.is_pkey then
        return next (
            jsonb_build_object(
                'schema', wal ->> 'schema',
                'table', wal ->> 'table',
                'type', action
            ),
            is_rls_enabled,
            (select array_agg(s.subscription_id) from unnest(subscriptions) as s where claims_role = working_role),
            array['Error 401: Unauthorized']
        )::realtime.wal_rls;

    else
        output = jsonb_build_object(
            'schema', wal ->> 'schema',
            'table', wal ->> 'table',
            'type', action,
            'commit_timestamp', to_char(
                ((wal ->> 'timestamp')::timestamptz at time zone 'utc'),
                'YYYY-MM-DD"T"HH24:MI:SS.MS"Z"'
            ),
            'columns', (
                select
                    jsonb_agg(
                        jsonb_build_object(
                            'name', pa.attname,
                            'type', pt.typname
                        )
                        order by pa.attnum asc
                    )
                from
                    pg_attribute pa
                    join pg_type pt
                        on pa.atttypid = pt.oid
                where
                    attrelid = entity_
                    and attnum > 0
                    and pg_catalog.has_column_privilege(working_role, entity_, pa.attname, 'SELECT')
            )
        )
        -- Add "record" key for insert and update
        || case
            when action in ('INSERT', 'UPDATE') then
                jsonb_build_object(
                    'record',
                    (
                        select
                            jsonb_object_agg(
                                -- if unchanged toast, get column name and value from old record
                                coalesce((c).name, (oc).name),
                                case
                                    when (c).name is null then (oc).value
                                    else (c).value
                                end
                            )
                        from
                            unnest(columns) c
                            full outer join unnest(old_columns) oc
                                on (c).name = (oc).name
                        where
                            coalesce((c).is_selectable, (oc).is_selectable)
                            and ( not error_record_exceeds_max_size or (octet_length((c).value::text) <= 64))
                    )
                )
            else '{}'::jsonb
        end
        -- Add "old_record" key for update and delete
        || case
            when action = 'UPDATE' then
                jsonb_build_object(
                        'old_record',
                        (
                            select jsonb_object_agg((c).name, (c).value)
                            from unnest(old_columns) c
                            where
                                (c).is_selectable
                                and ( not error_record_exceeds_max_size or (octet_length((c).value::text) <= 64))
                        )
                    )
            when action = 'DELETE' then
                jsonb_build_object(
                    'old_record',
                    (
                        select jsonb_object_agg((c).name, (c).value)
                        from unnest(old_columns) c
                        where
                            (c).is_selectable
                            and ( not error_record_exceeds_max_size or (octet_length((c).value::text) <= 64))
                            and ( not is_rls_enabled or (c).is_pkey ) -- if RLS enabled, we can't secure deletes so filter to pkey
                    )
                )
            else '{}'::jsonb
        end;

        -- Create the prepared statement
        if is_rls_enabled and action <> 'DELETE' then
            if (select 1 from pg_prepared_statements where name = 'walrus_rls_stmt' limit 1) > 0 then
                deallocate walrus_rls_stmt;
            end if;
            execute realtime.build_prepared_statement_sql('walrus_rls_stmt', entity_, columns);
        end if;

        visible_to_subscription_ids = '{}';

        for subscription_id, claims in (
                select
                    subs.subscription_id,
                    subs.claims
                from
                    unnest(subscriptions) subs
                where
                    subs.entity = entity_
                    and subs.claims_role = working_role
                    and (
                        realtime.is_visible_through_filters(columns, subs.filters)
                        or (
                          action = 'DELETE'
                          and realtime.is_visible_through_filters(old_columns, subs.filters)
                        )
                    )
        ) loop

            if not is_rls_enabled or action = 'DELETE' then
                visible_to_subscription_ids = visible_to_subscription_ids || subscription_id;
            else
                -- Check if RLS allows the role to see the record
                perform
                    -- Trim leading and trailing quotes from working_role because set_config
                    -- doesn't recognize the role as valid if they are included
                    set_config('role', trim(both '"' from working_role::text), true),
                    set_config('request.jwt.claims', claims::text, true);

                execute 'execute walrus_rls_stmt' into subscription_has_access;

                if subscription_has_access then
                    visible_to_subscription_ids = visible_to_subscription_ids || subscription_id;
                end if;
            end if;
        end loop;

        perform set_config('role', null, true);

        return next (
            output,
            is_rls_enabled,
            visible_to_subscription_ids,
            case
                when error_record_exceeds_max_size then array['Error 413: Payload Too Large']
                else '{}'
            end
        )::realtime.wal_rls;

    end if;
end loop;

perform set_config('role', null, true);
end;
$$;


ALTER FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer) OWNER TO supabase_admin;

--
-- Name: broadcast_changes(text, text, text, text, text, record, record, text); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.broadcast_changes(topic_name text, event_name text, operation text, table_name text, table_schema text, new record, old record, level text DEFAULT 'ROW'::text) RETURNS void
    LANGUAGE plpgsql
    AS $$
DECLARE
    -- Declare a variable to hold the JSONB representation of the row
    row_data jsonb := '{}'::jsonb;
BEGIN
    IF level = 'STATEMENT' THEN
        RAISE EXCEPTION 'function can only be triggered for each row, not for each statement';
    END IF;
    -- Check the operation type and handle accordingly
    IF operation = 'INSERT' OR operation = 'UPDATE' OR operation = 'DELETE' THEN
        row_data := jsonb_build_object('old_record', OLD, 'record', NEW, 'operation', operation, 'table', table_name, 'schema', table_schema);
        PERFORM realtime.send (row_data, event_name, topic_name);
    ELSE
        RAISE EXCEPTION 'Unexpected operation type: %', operation;
    END IF;
EXCEPTION
    WHEN OTHERS THEN
        RAISE EXCEPTION 'Failed to process the row: %', SQLERRM;
END;

$$;


ALTER FUNCTION realtime.broadcast_changes(topic_name text, event_name text, operation text, table_name text, table_schema text, new record, old record, level text) OWNER TO supabase_admin;

--
-- Name: build_prepared_statement_sql(text, regclass, realtime.wal_column[]); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]) RETURNS text
    LANGUAGE sql
    AS $$
      /*
      Builds a sql string that, if executed, creates a prepared statement to
      tests retrive a row from *entity* by its primary key columns.
      Example
          select realtime.build_prepared_statement_sql('public.notes', '{"id"}'::text[], '{"bigint"}'::text[])
      */
          select
      'prepare ' || prepared_statement_name || ' as
          select
              exists(
                  select
                      1
                  from
                      ' || entity || '
                  where
                      ' || string_agg(quote_ident(pkc.name) || '=' || quote_nullable(pkc.value #>> '{}') , ' and ') || '
              )'
          from
              unnest(columns) pkc
          where
              pkc.is_pkey
          group by
              entity
      $$;


ALTER FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]) OWNER TO supabase_admin;

--
-- Name: cast(text, regtype); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime."cast"(val text, type_ regtype) RETURNS jsonb
    LANGUAGE plpgsql IMMUTABLE
    AS $$
    declare
      res jsonb;
    begin
      execute format('select to_jsonb(%L::'|| type_::text || ')', val)  into res;
      return res;
    end
    $$;


ALTER FUNCTION realtime."cast"(val text, type_ regtype) OWNER TO supabase_admin;

--
-- Name: check_equality_op(realtime.equality_op, regtype, text, text); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text) RETURNS boolean
    LANGUAGE plpgsql IMMUTABLE
    AS $$
      /*
      Casts *val_1* and *val_2* as type *type_* and check the *op* condition for truthiness
      */
      declare
          op_symbol text = (
              case
                  when op = 'eq' then '='
                  when op = 'neq' then '!='
                  when op = 'lt' then '<'
                  when op = 'lte' then '<='
                  when op = 'gt' then '>'
                  when op = 'gte' then '>='
                  when op = 'in' then '= any'
                  else 'UNKNOWN OP'
              end
          );
          res boolean;
      begin
          execute format(
              'select %L::'|| type_::text || ' ' || op_symbol
              || ' ( %L::'
              || (
                  case
                      when op = 'in' then type_::text || '[]'
                      else type_::text end
              )
              || ')', val_1, val_2) into res;
          return res;
      end;
      $$;


ALTER FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text) OWNER TO supabase_admin;

--
-- Name: is_visible_through_filters(realtime.wal_column[], realtime.user_defined_filter[]); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]) RETURNS boolean
    LANGUAGE sql IMMUTABLE
    AS $_$
    /*
    Should the record be visible (true) or filtered out (false) after *filters* are applied
    */
        select
            -- Default to allowed when no filters present
            $2 is null -- no filters. this should not happen because subscriptions has a default
            or array_length($2, 1) is null -- array length of an empty array is null
            or bool_and(
                coalesce(
                    realtime.check_equality_op(
                        op:=f.op,
                        type_:=coalesce(
                            col.type_oid::regtype, -- null when wal2json version <= 2.4
                            col.type_name::regtype
                        ),
                        -- cast jsonb to text
                        val_1:=col.value #>> '{}',
                        val_2:=f.value
                    ),
                    false -- if null, filter does not match
                )
            )
        from
            unnest(filters) f
            join unnest(columns) col
                on f.column_name = col.name;
    $_$;


ALTER FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]) OWNER TO supabase_admin;

--
-- Name: list_changes(name, name, integer, integer); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer) RETURNS SETOF realtime.wal_rls
    LANGUAGE sql
    SET log_min_messages TO 'fatal'
    AS $$
      with pub as (
        select
          concat_ws(
            ',',
            case when bool_or(pubinsert) then 'insert' else null end,
            case when bool_or(pubupdate) then 'update' else null end,
            case when bool_or(pubdelete) then 'delete' else null end
          ) as w2j_actions,
          coalesce(
            string_agg(
              realtime.quote_wal2json(format('%I.%I', schemaname, tablename)::regclass),
              ','
            ) filter (where ppt.tablename is not null and ppt.tablename not like '% %'),
            ''
          ) w2j_add_tables
        from
          pg_publication pp
          left join pg_publication_tables ppt
            on pp.pubname = ppt.pubname
        where
          pp.pubname = publication
        group by
          pp.pubname
        limit 1
      ),
      w2j as (
        select
          x.*, pub.w2j_add_tables
        from
          pub,
          pg_logical_slot_get_changes(
            slot_name, null, max_changes,
            'include-pk', 'true',
            'include-transaction', 'false',
            'include-timestamp', 'true',
            'include-type-oids', 'true',
            'format-version', '2',
            'actions', pub.w2j_actions,
            'add-tables', pub.w2j_add_tables
          ) x
      )
      select
        xyz.wal,
        xyz.is_rls_enabled,
        xyz.subscription_ids,
        xyz.errors
      from
        w2j,
        realtime.apply_rls(
          wal := w2j.data::jsonb,
          max_record_bytes := max_record_bytes
        ) xyz(wal, is_rls_enabled, subscription_ids, errors)
      where
        w2j.w2j_add_tables <> ''
        and xyz.subscription_ids[1] is not null
    $$;


ALTER FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer) OWNER TO supabase_admin;

--
-- Name: quote_wal2json(regclass); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.quote_wal2json(entity regclass) RETURNS text
    LANGUAGE sql IMMUTABLE STRICT
    AS $$
      select
        (
          select string_agg('' || ch,'')
          from unnest(string_to_array(nsp.nspname::text, null)) with ordinality x(ch, idx)
          where
            not (x.idx = 1 and x.ch = '"')
            and not (
              x.idx = array_length(string_to_array(nsp.nspname::text, null), 1)
              and x.ch = '"'
            )
        )
        || '.'
        || (
          select string_agg('' || ch,'')
          from unnest(string_to_array(pc.relname::text, null)) with ordinality x(ch, idx)
          where
            not (x.idx = 1 and x.ch = '"')
            and not (
              x.idx = array_length(string_to_array(nsp.nspname::text, null), 1)
              and x.ch = '"'
            )
          )
      from
        pg_class pc
        join pg_namespace nsp
          on pc.relnamespace = nsp.oid
      where
        pc.oid = entity
    $$;


ALTER FUNCTION realtime.quote_wal2json(entity regclass) OWNER TO supabase_admin;

--
-- Name: send(jsonb, text, text, boolean); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.send(payload jsonb, event text, topic text, private boolean DEFAULT true) RETURNS void
    LANGUAGE plpgsql
    AS $$
BEGIN
  BEGIN
    -- Set the topic configuration
    EXECUTE format('SET LOCAL realtime.topic TO %L', topic);

    -- Attempt to insert the message
    INSERT INTO realtime.messages (payload, event, topic, private, extension)
    VALUES (payload, event, topic, private, 'broadcast');
  EXCEPTION
    WHEN OTHERS THEN
      -- Capture and notify the error
      PERFORM pg_notify(
          'realtime:system',
          jsonb_build_object(
              'error', SQLERRM,
              'function', 'realtime.send',
              'event', event,
              'topic', topic,
              'private', private
          )::text
      );
  END;
END;
$$;


ALTER FUNCTION realtime.send(payload jsonb, event text, topic text, private boolean) OWNER TO supabase_admin;

--
-- Name: subscription_check_filters(); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.subscription_check_filters() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
    /*
    Validates that the user defined filters for a subscription:
    - refer to valid columns that the claimed role may access
    - values are coercable to the correct column type
    */
    declare
        col_names text[] = coalesce(
                array_agg(c.column_name order by c.ordinal_position),
                '{}'::text[]
            )
            from
                information_schema.columns c
            where
                format('%I.%I', c.table_schema, c.table_name)::regclass = new.entity
                and pg_catalog.has_column_privilege(
                    (new.claims ->> 'role'),
                    format('%I.%I', c.table_schema, c.table_name)::regclass,
                    c.column_name,
                    'SELECT'
                );
        filter realtime.user_defined_filter;
        col_type regtype;

        in_val jsonb;
    begin
        for filter in select * from unnest(new.filters) loop
            -- Filtered column is valid
            if not filter.column_name = any(col_names) then
                raise exception 'invalid column for filter %', filter.column_name;
            end if;

            -- Type is sanitized and safe for string interpolation
            col_type = (
                select atttypid::regtype
                from pg_catalog.pg_attribute
                where attrelid = new.entity
                      and attname = filter.column_name
            );
            if col_type is null then
                raise exception 'failed to lookup type for column %', filter.column_name;
            end if;

            -- Set maximum number of entries for in filter
            if filter.op = 'in'::realtime.equality_op then
                in_val = realtime.cast(filter.value, (col_type::text || '[]')::regtype);
                if coalesce(jsonb_array_length(in_val), 0) > 100 then
                    raise exception 'too many values for `in` filter. Maximum 100';
                end if;
            else
                -- raises an exception if value is not coercable to type
                perform realtime.cast(filter.value, col_type);
            end if;

        end loop;

        -- Apply consistent order to filters so the unique constraint on
        -- (subscription_id, entity, filters) can't be tricked by a different filter order
        new.filters = coalesce(
            array_agg(f order by f.column_name, f.op, f.value),
            '{}'
        ) from unnest(new.filters) f;

        return new;
    end;
    $$;


ALTER FUNCTION realtime.subscription_check_filters() OWNER TO supabase_admin;

--
-- Name: to_regrole(text); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.to_regrole(role_name text) RETURNS regrole
    LANGUAGE sql IMMUTABLE
    AS $$ select role_name::regrole $$;


ALTER FUNCTION realtime.to_regrole(role_name text) OWNER TO supabase_admin;

--
-- Name: topic(); Type: FUNCTION; Schema: realtime; Owner: supabase_realtime_admin
--

CREATE FUNCTION realtime.topic() RETURNS text
    LANGUAGE sql STABLE
    AS $$
select nullif(current_setting('realtime.topic', true), '')::text;
$$;


ALTER FUNCTION realtime.topic() OWNER TO supabase_realtime_admin;

--
-- Name: add_prefixes(text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.add_prefixes(_bucket_id text, _name text) RETURNS void
    LANGUAGE plpgsql SECURITY DEFINER
    AS $$
DECLARE
    prefixes text[];
BEGIN
    prefixes := "storage"."get_prefixes"("_name");

    IF array_length(prefixes, 1) > 0 THEN
        INSERT INTO storage.prefixes (name, bucket_id)
        SELECT UNNEST(prefixes) as name, "_bucket_id" ON CONFLICT DO NOTHING;
    END IF;
END;
$$;


ALTER FUNCTION storage.add_prefixes(_bucket_id text, _name text) OWNER TO supabase_storage_admin;

--
-- Name: can_insert_object(text, text, uuid, jsonb); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.can_insert_object(bucketid text, name text, owner uuid, metadata jsonb) RETURNS void
    LANGUAGE plpgsql
    AS $$
BEGIN
  INSERT INTO "storage"."objects" ("bucket_id", "name", "owner", "metadata") VALUES (bucketid, name, owner, metadata);
  -- hack to rollback the successful insert
  RAISE sqlstate 'PT200' using
  message = 'ROLLBACK',
  detail = 'rollback successful insert';
END
$$;


ALTER FUNCTION storage.can_insert_object(bucketid text, name text, owner uuid, metadata jsonb) OWNER TO supabase_storage_admin;

--
-- Name: delete_prefix(text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.delete_prefix(_bucket_id text, _name text) RETURNS boolean
    LANGUAGE plpgsql SECURITY DEFINER
    AS $$
BEGIN
    -- Check if we can delete the prefix
    IF EXISTS(
        SELECT FROM "storage"."prefixes"
        WHERE "prefixes"."bucket_id" = "_bucket_id"
          AND level = "storage"."get_level"("_name") + 1
          AND "prefixes"."name" COLLATE "C" LIKE "_name" || '/%'
        LIMIT 1
    )
    OR EXISTS(
        SELECT FROM "storage"."objects"
        WHERE "objects"."bucket_id" = "_bucket_id"
          AND "storage"."get_level"("objects"."name") = "storage"."get_level"("_name") + 1
          AND "objects"."name" COLLATE "C" LIKE "_name" || '/%'
        LIMIT 1
    ) THEN
    -- There are sub-objects, skip deletion
    RETURN false;
    ELSE
        DELETE FROM "storage"."prefixes"
        WHERE "prefixes"."bucket_id" = "_bucket_id"
          AND level = "storage"."get_level"("_name")
          AND "prefixes"."name" = "_name";
        RETURN true;
    END IF;
END;
$$;


ALTER FUNCTION storage.delete_prefix(_bucket_id text, _name text) OWNER TO supabase_storage_admin;

--
-- Name: delete_prefix_hierarchy_trigger(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.delete_prefix_hierarchy_trigger() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
DECLARE
    prefix text;
BEGIN
    prefix := "storage"."get_prefix"(OLD."name");

    IF coalesce(prefix, '') != '' THEN
        PERFORM "storage"."delete_prefix"(OLD."bucket_id", prefix);
    END IF;

    RETURN OLD;
END;
$$;


ALTER FUNCTION storage.delete_prefix_hierarchy_trigger() OWNER TO supabase_storage_admin;

--
-- Name: extension(text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.extension(name text) RETURNS text
    LANGUAGE plpgsql
    AS $$
DECLARE
_parts text[];
_filename text;
BEGIN
	select string_to_array(name, '/') into _parts;
	select _parts[array_length(_parts,1)] into _filename;
	-- @todo return the last part instead of 2
	return reverse(split_part(reverse(_filename), '.', 1));
END
$$;


ALTER FUNCTION storage.extension(name text) OWNER TO supabase_storage_admin;

--
-- Name: filename(text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.filename(name text) RETURNS text
    LANGUAGE plpgsql
    AS $$
DECLARE
_parts text[];
BEGIN
	select string_to_array(name, '/') into _parts;
	return _parts[array_length(_parts,1)];
END
$$;


ALTER FUNCTION storage.filename(name text) OWNER TO supabase_storage_admin;

--
-- Name: foldername(text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.foldername(name text) RETURNS text[]
    LANGUAGE plpgsql
    AS $$
DECLARE
_parts text[];
BEGIN
	select string_to_array(name, '/') into _parts;
	return _parts[1:array_length(_parts,1)-1];
END
$$;


ALTER FUNCTION storage.foldername(name text) OWNER TO supabase_storage_admin;

--
-- Name: get_level(text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.get_level(name text) RETURNS integer
    LANGUAGE sql IMMUTABLE STRICT
    AS $$
SELECT array_length(string_to_array("name", '/'), 1);
$$;


ALTER FUNCTION storage.get_level(name text) OWNER TO supabase_storage_admin;

--
-- Name: get_prefix(text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.get_prefix(name text) RETURNS text
    LANGUAGE sql IMMUTABLE STRICT
    AS $_$
SELECT
    CASE WHEN strpos("name", '/') > 0 THEN
             regexp_replace("name", '[\/]{1}[^\/]+\/?$', '')
         ELSE
             ''
        END;
$_$;


ALTER FUNCTION storage.get_prefix(name text) OWNER TO supabase_storage_admin;

--
-- Name: get_prefixes(text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.get_prefixes(name text) RETURNS text[]
    LANGUAGE plpgsql IMMUTABLE STRICT
    AS $$
DECLARE
    parts text[];
    prefixes text[];
    prefix text;
BEGIN
    -- Split the name into parts by '/'
    parts := string_to_array("name", '/');
    prefixes := '{}';

    -- Construct the prefixes, stopping one level below the last part
    FOR i IN 1..array_length(parts, 1) - 1 LOOP
            prefix := array_to_string(parts[1:i], '/');
            prefixes := array_append(prefixes, prefix);
    END LOOP;

    RETURN prefixes;
END;
$$;


ALTER FUNCTION storage.get_prefixes(name text) OWNER TO supabase_storage_admin;

--
-- Name: get_size_by_bucket(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.get_size_by_bucket() RETURNS TABLE(size bigint, bucket_id text)
    LANGUAGE plpgsql
    AS $$
BEGIN
    return query
        select sum((metadata->>'size')::int) as size, obj.bucket_id
        from "storage".objects as obj
        group by obj.bucket_id;
END
$$;


ALTER FUNCTION storage.get_size_by_bucket() OWNER TO supabase_storage_admin;

--
-- Name: list_multipart_uploads_with_delimiter(text, text, text, integer, text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.list_multipart_uploads_with_delimiter(bucket_id text, prefix_param text, delimiter_param text, max_keys integer DEFAULT 100, next_key_token text DEFAULT ''::text, next_upload_token text DEFAULT ''::text) RETURNS TABLE(key text, id text, created_at timestamp with time zone)
    LANGUAGE plpgsql
    AS $_$
BEGIN
    RETURN QUERY EXECUTE
        'SELECT DISTINCT ON(key COLLATE "C") * from (
            SELECT
                CASE
                    WHEN position($2 IN substring(key from length($1) + 1)) > 0 THEN
                        substring(key from 1 for length($1) + position($2 IN substring(key from length($1) + 1)))
                    ELSE
                        key
                END AS key, id, created_at
            FROM
                storage.s3_multipart_uploads
            WHERE
                bucket_id = $5 AND
                key ILIKE $1 || ''%'' AND
                CASE
                    WHEN $4 != '''' AND $6 = '''' THEN
                        CASE
                            WHEN position($2 IN substring(key from length($1) + 1)) > 0 THEN
                                substring(key from 1 for length($1) + position($2 IN substring(key from length($1) + 1))) COLLATE "C" > $4
                            ELSE
                                key COLLATE "C" > $4
                            END
                    ELSE
                        true
                END AND
                CASE
                    WHEN $6 != '''' THEN
                        id COLLATE "C" > $6
                    ELSE
                        true
                    END
            ORDER BY
                key COLLATE "C" ASC, created_at ASC) as e order by key COLLATE "C" LIMIT $3'
        USING prefix_param, delimiter_param, max_keys, next_key_token, bucket_id, next_upload_token;
END;
$_$;


ALTER FUNCTION storage.list_multipart_uploads_with_delimiter(bucket_id text, prefix_param text, delimiter_param text, max_keys integer, next_key_token text, next_upload_token text) OWNER TO supabase_storage_admin;

--
-- Name: list_objects_with_delimiter(text, text, text, integer, text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.list_objects_with_delimiter(bucket_id text, prefix_param text, delimiter_param text, max_keys integer DEFAULT 100, start_after text DEFAULT ''::text, next_token text DEFAULT ''::text) RETURNS TABLE(name text, id uuid, metadata jsonb, updated_at timestamp with time zone)
    LANGUAGE plpgsql
    AS $_$
BEGIN
    RETURN QUERY EXECUTE
        'SELECT DISTINCT ON(name COLLATE "C") * from (
            SELECT
                CASE
                    WHEN position($2 IN substring(name from length($1) + 1)) > 0 THEN
                        substring(name from 1 for length($1) + position($2 IN substring(name from length($1) + 1)))
                    ELSE
                        name
                END AS name, id, metadata, updated_at
            FROM
                storage.objects
            WHERE
                bucket_id = $5 AND
                name ILIKE $1 || ''%'' AND
                CASE
                    WHEN $6 != '''' THEN
                    name COLLATE "C" > $6
                ELSE true END
                AND CASE
                    WHEN $4 != '''' THEN
                        CASE
                            WHEN position($2 IN substring(name from length($1) + 1)) > 0 THEN
                                substring(name from 1 for length($1) + position($2 IN substring(name from length($1) + 1))) COLLATE "C" > $4
                            ELSE
                                name COLLATE "C" > $4
                            END
                    ELSE
                        true
                END
            ORDER BY
                name COLLATE "C" ASC) as e order by name COLLATE "C" LIMIT $3'
        USING prefix_param, delimiter_param, max_keys, next_token, bucket_id, start_after;
END;
$_$;


ALTER FUNCTION storage.list_objects_with_delimiter(bucket_id text, prefix_param text, delimiter_param text, max_keys integer, start_after text, next_token text) OWNER TO supabase_storage_admin;

--
-- Name: objects_insert_prefix_trigger(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.objects_insert_prefix_trigger() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
    PERFORM "storage"."add_prefixes"(NEW."bucket_id", NEW."name");
    NEW.level := "storage"."get_level"(NEW."name");

    RETURN NEW;
END;
$$;


ALTER FUNCTION storage.objects_insert_prefix_trigger() OWNER TO supabase_storage_admin;

--
-- Name: operation(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.operation() RETURNS text
    LANGUAGE plpgsql STABLE
    AS $$
BEGIN
    RETURN current_setting('storage.operation', true);
END;
$$;


ALTER FUNCTION storage.operation() OWNER TO supabase_storage_admin;

--
-- Name: prefixes_insert_trigger(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.prefixes_insert_trigger() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
    PERFORM "storage"."add_prefixes"(NEW."bucket_id", NEW."name");
    RETURN NEW;
END;
$$;


ALTER FUNCTION storage.prefixes_insert_trigger() OWNER TO supabase_storage_admin;

--
-- Name: search(text, text, integer, integer, integer, text, text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.search(prefix text, bucketname text, limits integer DEFAULT 100, levels integer DEFAULT 1, offsets integer DEFAULT 0, search text DEFAULT ''::text, sortcolumn text DEFAULT 'name'::text, sortorder text DEFAULT 'asc'::text) RETURNS TABLE(name text, id uuid, updated_at timestamp with time zone, created_at timestamp with time zone, last_accessed_at timestamp with time zone, metadata jsonb)
    LANGUAGE plpgsql STABLE
    AS $$
declare
    can_bypass_rls BOOLEAN;
begin
    SELECT rolbypassrls
    INTO can_bypass_rls
    FROM pg_roles
    WHERE rolname = coalesce(nullif(current_setting('role', true), 'none'), current_user);

    IF can_bypass_rls THEN
        RETURN QUERY SELECT * FROM storage.search_v1_optimised(prefix, bucketname, limits, levels, offsets, search, sortcolumn, sortorder);
    ELSE
        RETURN QUERY SELECT * FROM storage.search_legacy_v1(prefix, bucketname, limits, levels, offsets, search, sortcolumn, sortorder);
    END IF;
end;
$$;


ALTER FUNCTION storage.search(prefix text, bucketname text, limits integer, levels integer, offsets integer, search text, sortcolumn text, sortorder text) OWNER TO supabase_storage_admin;

--
-- Name: search_legacy_v1(text, text, integer, integer, integer, text, text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.search_legacy_v1(prefix text, bucketname text, limits integer DEFAULT 100, levels integer DEFAULT 1, offsets integer DEFAULT 0, search text DEFAULT ''::text, sortcolumn text DEFAULT 'name'::text, sortorder text DEFAULT 'asc'::text) RETURNS TABLE(name text, id uuid, updated_at timestamp with time zone, created_at timestamp with time zone, last_accessed_at timestamp with time zone, metadata jsonb)
    LANGUAGE plpgsql STABLE
    AS $_$
declare
    v_order_by text;
    v_sort_order text;
begin
    case
        when sortcolumn = 'name' then
            v_order_by = 'name';
        when sortcolumn = 'updated_at' then
            v_order_by = 'updated_at';
        when sortcolumn = 'created_at' then
            v_order_by = 'created_at';
        when sortcolumn = 'last_accessed_at' then
            v_order_by = 'last_accessed_at';
        else
            v_order_by = 'name';
        end case;

    case
        when sortorder = 'asc' then
            v_sort_order = 'asc';
        when sortorder = 'desc' then
            v_sort_order = 'desc';
        else
            v_sort_order = 'asc';
        end case;

    v_order_by = v_order_by || ' ' || v_sort_order;

    return query execute
        'with folders as (
           select path_tokens[$1] as folder
           from storage.objects
             where objects.name ilike $2 || $3 || ''%''
               and bucket_id = $4
               and array_length(objects.path_tokens, 1) <> $1
           group by folder
           order by folder ' || v_sort_order || '
     )
     (select folder as "name",
            null as id,
            null as updated_at,
            null as created_at,
            null as last_accessed_at,
            null as metadata from folders)
     union all
     (select path_tokens[$1] as "name",
            id,
            updated_at,
            created_at,
            last_accessed_at,
            metadata
     from storage.objects
     where objects.name ilike $2 || $3 || ''%''
       and bucket_id = $4
       and array_length(objects.path_tokens, 1) = $1
     order by ' || v_order_by || ')
     limit $5
     offset $6' using levels, prefix, search, bucketname, limits, offsets;
end;
$_$;


ALTER FUNCTION storage.search_legacy_v1(prefix text, bucketname text, limits integer, levels integer, offsets integer, search text, sortcolumn text, sortorder text) OWNER TO supabase_storage_admin;

--
-- Name: search_v1_optimised(text, text, integer, integer, integer, text, text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.search_v1_optimised(prefix text, bucketname text, limits integer DEFAULT 100, levels integer DEFAULT 1, offsets integer DEFAULT 0, search text DEFAULT ''::text, sortcolumn text DEFAULT 'name'::text, sortorder text DEFAULT 'asc'::text) RETURNS TABLE(name text, id uuid, updated_at timestamp with time zone, created_at timestamp with time zone, last_accessed_at timestamp with time zone, metadata jsonb)
    LANGUAGE plpgsql STABLE
    AS $_$
declare
    v_order_by text;
    v_sort_order text;
begin
    case
        when sortcolumn = 'name' then
            v_order_by = 'name';
        when sortcolumn = 'updated_at' then
            v_order_by = 'updated_at';
        when sortcolumn = 'created_at' then
            v_order_by = 'created_at';
        when sortcolumn = 'last_accessed_at' then
            v_order_by = 'last_accessed_at';
        else
            v_order_by = 'name';
        end case;

    case
        when sortorder = 'asc' then
            v_sort_order = 'asc';
        when sortorder = 'desc' then
            v_sort_order = 'desc';
        else
            v_sort_order = 'asc';
        end case;

    v_order_by = v_order_by || ' ' || v_sort_order;

    return query execute
        'with folders as (
           select (string_to_array(name, ''/''))[level] as name
           from storage.prefixes
             where lower(prefixes.name) like lower($2 || $3) || ''%''
               and bucket_id = $4
               and level = $1
           order by name ' || v_sort_order || '
     )
     (select name,
            null as id,
            null as updated_at,
            null as created_at,
            null as last_accessed_at,
            null as metadata from folders)
     union all
     (select path_tokens[level] as "name",
            id,
            updated_at,
            created_at,
            last_accessed_at,
            metadata
     from storage.objects
     where lower(objects.name) like lower($2 || $3) || ''%''
       and bucket_id = $4
       and level = $1
     order by ' || v_order_by || ')
     limit $5
     offset $6' using levels, prefix, search, bucketname, limits, offsets;
end;
$_$;


ALTER FUNCTION storage.search_v1_optimised(prefix text, bucketname text, limits integer, levels integer, offsets integer, search text, sortcolumn text, sortorder text) OWNER TO supabase_storage_admin;

--
-- Name: search_v2(text, text, integer, integer, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.search_v2(prefix text, bucket_name text, limits integer DEFAULT 100, levels integer DEFAULT 1, start_after text DEFAULT ''::text) RETURNS TABLE(key text, name text, id uuid, updated_at timestamp with time zone, created_at timestamp with time zone, metadata jsonb)
    LANGUAGE plpgsql STABLE
    AS $_$
BEGIN
    RETURN query EXECUTE
        $sql$
        SELECT * FROM (
            (
                SELECT
                    split_part(name, '/', $4) AS key,
                    name || '/' AS name,
                    NULL::uuid AS id,
                    NULL::timestamptz AS updated_at,
                    NULL::timestamptz AS created_at,
                    NULL::jsonb AS metadata
                FROM storage.prefixes
                WHERE name COLLATE "C" LIKE $1 || '%'
                AND bucket_id = $2
                AND level = $4
                AND name COLLATE "C" > $5
                ORDER BY prefixes.name COLLATE "C" LIMIT $3
            )
            UNION ALL
            (SELECT split_part(name, '/', $4) AS key,
                name,
                id,
                updated_at,
                created_at,
                metadata
            FROM storage.objects
            WHERE name COLLATE "C" LIKE $1 || '%'
                AND bucket_id = $2
                AND level = $4
                AND name COLLATE "C" > $5
            ORDER BY name COLLATE "C" LIMIT $3)
        ) obj
        ORDER BY name COLLATE "C" LIMIT $3;
        $sql$
        USING prefix, bucket_name, limits, levels, start_after;
END;
$_$;


ALTER FUNCTION storage.search_v2(prefix text, bucket_name text, limits integer, levels integer, start_after text) OWNER TO supabase_storage_admin;

--
-- Name: update_updated_at_column(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.update_updated_at_column() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
    NEW.updated_at = now();
    RETURN NEW; 
END;
$$;


ALTER FUNCTION storage.update_updated_at_column() OWNER TO supabase_storage_admin;

--
-- Name: http_request(); Type: FUNCTION; Schema: supabase_functions; Owner: supabase_functions_admin
--

CREATE FUNCTION supabase_functions.http_request() RETURNS trigger
    LANGUAGE plpgsql SECURITY DEFINER
    SET search_path TO 'supabase_functions'
    AS $$
  DECLARE
    request_id bigint;
    payload jsonb;
    url text := TG_ARGV[0]::text;
    method text := TG_ARGV[1]::text;
    headers jsonb DEFAULT '{}'::jsonb;
    params jsonb DEFAULT '{}'::jsonb;
    timeout_ms integer DEFAULT 1000;
  BEGIN
    IF url IS NULL OR url = 'null' THEN
      RAISE EXCEPTION 'url argument is missing';
    END IF;

    IF method IS NULL OR method = 'null' THEN
      RAISE EXCEPTION 'method argument is missing';
    END IF;

    IF TG_ARGV[2] IS NULL OR TG_ARGV[2] = 'null' THEN
      headers = '{"Content-Type": "application/json"}'::jsonb;
    ELSE
      headers = TG_ARGV[2]::jsonb;
    END IF;

    IF TG_ARGV[3] IS NULL OR TG_ARGV[3] = 'null' THEN
      params = '{}'::jsonb;
    ELSE
      params = TG_ARGV[3]::jsonb;
    END IF;

    IF TG_ARGV[4] IS NULL OR TG_ARGV[4] = 'null' THEN
      timeout_ms = 1000;
    ELSE
      timeout_ms = TG_ARGV[4]::integer;
    END IF;

    CASE
      WHEN method = 'GET' THEN
        SELECT http_get INTO request_id FROM net.http_get(
          url,
          params,
          headers,
          timeout_ms
        );
      WHEN method = 'POST' THEN
        payload = jsonb_build_object(
          'old_record', OLD,
          'record', NEW,
          'type', TG_OP,
          'table', TG_TABLE_NAME,
          'schema', TG_TABLE_SCHEMA
        );

        SELECT http_post INTO request_id FROM net.http_post(
          url,
          payload,
          params,
          headers,
          timeout_ms
        );
      ELSE
        RAISE EXCEPTION 'method argument % is invalid', method;
    END CASE;

    INSERT INTO supabase_functions.hooks
      (hook_table_id, hook_name, request_id)
    VALUES
      (TG_RELID, TG_NAME, request_id);

    RETURN NEW;
  END
$$;


ALTER FUNCTION supabase_functions.http_request() OWNER TO supabase_functions_admin;

SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- Name: extensions; Type: TABLE; Schema: _realtime; Owner: supabase_admin
--

CREATE TABLE _realtime.extensions (
    id uuid NOT NULL,
    type text,
    settings jsonb,
    tenant_external_id text,
    inserted_at timestamp(0) without time zone NOT NULL,
    updated_at timestamp(0) without time zone NOT NULL
);


ALTER TABLE _realtime.extensions OWNER TO supabase_admin;

--
-- Name: schema_migrations; Type: TABLE; Schema: _realtime; Owner: supabase_admin
--

CREATE TABLE _realtime.schema_migrations (
    version bigint NOT NULL,
    inserted_at timestamp(0) without time zone
);


ALTER TABLE _realtime.schema_migrations OWNER TO supabase_admin;

--
-- Name: tenants; Type: TABLE; Schema: _realtime; Owner: supabase_admin
--

CREATE TABLE _realtime.tenants (
    id uuid NOT NULL,
    name text,
    external_id text,
    jwt_secret text,
    max_concurrent_users integer DEFAULT 200 NOT NULL,
    inserted_at timestamp(0) without time zone NOT NULL,
    updated_at timestamp(0) without time zone NOT NULL,
    max_events_per_second integer DEFAULT 100 NOT NULL,
    postgres_cdc_default text DEFAULT 'postgres_cdc_rls'::text,
    max_bytes_per_second integer DEFAULT 100000 NOT NULL,
    max_channels_per_client integer DEFAULT 100 NOT NULL,
    max_joins_per_second integer DEFAULT 500 NOT NULL,
    suspend boolean DEFAULT false,
    jwt_jwks jsonb,
    notify_private_alpha boolean DEFAULT false,
    private_only boolean DEFAULT false NOT NULL
);


ALTER TABLE _realtime.tenants OWNER TO supabase_admin;

--
-- Name: audit_log_entries; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.audit_log_entries (
    instance_id uuid,
    id uuid NOT NULL,
    payload json,
    created_at timestamp with time zone,
    ip_address character varying(64) DEFAULT ''::character varying NOT NULL
);


ALTER TABLE auth.audit_log_entries OWNER TO supabase_auth_admin;

--
-- Name: TABLE audit_log_entries; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.audit_log_entries IS 'Auth: Audit trail for user actions.';


--
-- Name: flow_state; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.flow_state (
    id uuid NOT NULL,
    user_id uuid,
    auth_code text NOT NULL,
    code_challenge_method auth.code_challenge_method NOT NULL,
    code_challenge text NOT NULL,
    provider_type text NOT NULL,
    provider_access_token text,
    provider_refresh_token text,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    authentication_method text NOT NULL,
    auth_code_issued_at timestamp with time zone
);


ALTER TABLE auth.flow_state OWNER TO supabase_auth_admin;

--
-- Name: TABLE flow_state; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.flow_state IS 'stores metadata for pkce logins';


--
-- Name: identities; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.identities (
    provider_id text NOT NULL,
    user_id uuid NOT NULL,
    identity_data jsonb NOT NULL,
    provider text NOT NULL,
    last_sign_in_at timestamp with time zone,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    email text GENERATED ALWAYS AS (lower((identity_data ->> 'email'::text))) STORED,
    id uuid DEFAULT gen_random_uuid() NOT NULL
);


ALTER TABLE auth.identities OWNER TO supabase_auth_admin;

--
-- Name: TABLE identities; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.identities IS 'Auth: Stores identities associated to a user.';


--
-- Name: COLUMN identities.email; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON COLUMN auth.identities.email IS 'Auth: Email is a generated column that references the optional email property in the identity_data';


--
-- Name: instances; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.instances (
    id uuid NOT NULL,
    uuid uuid,
    raw_base_config text,
    created_at timestamp with time zone,
    updated_at timestamp with time zone
);


ALTER TABLE auth.instances OWNER TO supabase_auth_admin;

--
-- Name: TABLE instances; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.instances IS 'Auth: Manages users across multiple sites.';


--
-- Name: mfa_amr_claims; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.mfa_amr_claims (
    session_id uuid NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    authentication_method text NOT NULL,
    id uuid NOT NULL
);


ALTER TABLE auth.mfa_amr_claims OWNER TO supabase_auth_admin;

--
-- Name: TABLE mfa_amr_claims; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.mfa_amr_claims IS 'auth: stores authenticator method reference claims for multi factor authentication';


--
-- Name: mfa_challenges; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.mfa_challenges (
    id uuid NOT NULL,
    factor_id uuid NOT NULL,
    created_at timestamp with time zone NOT NULL,
    verified_at timestamp with time zone,
    ip_address inet NOT NULL,
    otp_code text,
    web_authn_session_data jsonb
);


ALTER TABLE auth.mfa_challenges OWNER TO supabase_auth_admin;

--
-- Name: TABLE mfa_challenges; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.mfa_challenges IS 'auth: stores metadata about challenge requests made';


--
-- Name: mfa_factors; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.mfa_factors (
    id uuid NOT NULL,
    user_id uuid NOT NULL,
    friendly_name text,
    factor_type auth.factor_type NOT NULL,
    status auth.factor_status NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    secret text,
    phone text,
    last_challenged_at timestamp with time zone,
    web_authn_credential jsonb,
    web_authn_aaguid uuid
);


ALTER TABLE auth.mfa_factors OWNER TO supabase_auth_admin;

--
-- Name: TABLE mfa_factors; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.mfa_factors IS 'auth: stores metadata about factors';


--
-- Name: one_time_tokens; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.one_time_tokens (
    id uuid NOT NULL,
    user_id uuid NOT NULL,
    token_type auth.one_time_token_type NOT NULL,
    token_hash text NOT NULL,
    relates_to text NOT NULL,
    created_at timestamp without time zone DEFAULT now() NOT NULL,
    updated_at timestamp without time zone DEFAULT now() NOT NULL,
    CONSTRAINT one_time_tokens_token_hash_check CHECK ((char_length(token_hash) > 0))
);


ALTER TABLE auth.one_time_tokens OWNER TO supabase_auth_admin;

--
-- Name: refresh_tokens; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.refresh_tokens (
    instance_id uuid,
    id bigint NOT NULL,
    token character varying(255),
    user_id character varying(255),
    revoked boolean,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    parent character varying(255),
    session_id uuid
);


ALTER TABLE auth.refresh_tokens OWNER TO supabase_auth_admin;

--
-- Name: TABLE refresh_tokens; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.refresh_tokens IS 'Auth: Store of tokens used to refresh JWT tokens once they expire.';


--
-- Name: refresh_tokens_id_seq; Type: SEQUENCE; Schema: auth; Owner: supabase_auth_admin
--

CREATE SEQUENCE auth.refresh_tokens_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE auth.refresh_tokens_id_seq OWNER TO supabase_auth_admin;

--
-- Name: refresh_tokens_id_seq; Type: SEQUENCE OWNED BY; Schema: auth; Owner: supabase_auth_admin
--

ALTER SEQUENCE auth.refresh_tokens_id_seq OWNED BY auth.refresh_tokens.id;


--
-- Name: saml_providers; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.saml_providers (
    id uuid NOT NULL,
    sso_provider_id uuid NOT NULL,
    entity_id text NOT NULL,
    metadata_xml text NOT NULL,
    metadata_url text,
    attribute_mapping jsonb,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    name_id_format text,
    CONSTRAINT "entity_id not empty" CHECK ((char_length(entity_id) > 0)),
    CONSTRAINT "metadata_url not empty" CHECK (((metadata_url = NULL::text) OR (char_length(metadata_url) > 0))),
    CONSTRAINT "metadata_xml not empty" CHECK ((char_length(metadata_xml) > 0))
);


ALTER TABLE auth.saml_providers OWNER TO supabase_auth_admin;

--
-- Name: TABLE saml_providers; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.saml_providers IS 'Auth: Manages SAML Identity Provider connections.';


--
-- Name: saml_relay_states; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.saml_relay_states (
    id uuid NOT NULL,
    sso_provider_id uuid NOT NULL,
    request_id text NOT NULL,
    for_email text,
    redirect_to text,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    flow_state_id uuid,
    CONSTRAINT "request_id not empty" CHECK ((char_length(request_id) > 0))
);


ALTER TABLE auth.saml_relay_states OWNER TO supabase_auth_admin;

--
-- Name: TABLE saml_relay_states; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.saml_relay_states IS 'Auth: Contains SAML Relay State information for each Service Provider initiated login.';


--
-- Name: schema_migrations; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.schema_migrations (
    version character varying(255) NOT NULL
);


ALTER TABLE auth.schema_migrations OWNER TO supabase_auth_admin;

--
-- Name: TABLE schema_migrations; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.schema_migrations IS 'Auth: Manages updates to the auth system.';


--
-- Name: sessions; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.sessions (
    id uuid NOT NULL,
    user_id uuid NOT NULL,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    factor_id uuid,
    aal auth.aal_level,
    not_after timestamp with time zone,
    refreshed_at timestamp without time zone,
    user_agent text,
    ip inet,
    tag text
);


ALTER TABLE auth.sessions OWNER TO supabase_auth_admin;

--
-- Name: TABLE sessions; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.sessions IS 'Auth: Stores session data associated to a user.';


--
-- Name: COLUMN sessions.not_after; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON COLUMN auth.sessions.not_after IS 'Auth: Not after is a nullable column that contains a timestamp after which the session should be regarded as expired.';


--
-- Name: sso_domains; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.sso_domains (
    id uuid NOT NULL,
    sso_provider_id uuid NOT NULL,
    domain text NOT NULL,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    CONSTRAINT "domain not empty" CHECK ((char_length(domain) > 0))
);


ALTER TABLE auth.sso_domains OWNER TO supabase_auth_admin;

--
-- Name: TABLE sso_domains; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.sso_domains IS 'Auth: Manages SSO email address domain mapping to an SSO Identity Provider.';


--
-- Name: sso_providers; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.sso_providers (
    id uuid NOT NULL,
    resource_id text,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    CONSTRAINT "resource_id not empty" CHECK (((resource_id = NULL::text) OR (char_length(resource_id) > 0)))
);


ALTER TABLE auth.sso_providers OWNER TO supabase_auth_admin;

--
-- Name: TABLE sso_providers; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.sso_providers IS 'Auth: Manages SSO identity provider information; see saml_providers for SAML.';


--
-- Name: COLUMN sso_providers.resource_id; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON COLUMN auth.sso_providers.resource_id IS 'Auth: Uniquely identifies a SSO provider according to a user-chosen resource ID (case insensitive), useful in infrastructure as code.';


--
-- Name: users; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.users (
    instance_id uuid,
    id uuid NOT NULL,
    aud character varying(255),
    role character varying(255),
    email character varying(255),
    encrypted_password character varying(255),
    email_confirmed_at timestamp with time zone,
    invited_at timestamp with time zone,
    confirmation_token character varying(255),
    confirmation_sent_at timestamp with time zone,
    recovery_token character varying(255),
    recovery_sent_at timestamp with time zone,
    email_change_token_new character varying(255),
    email_change character varying(255),
    email_change_sent_at timestamp with time zone,
    last_sign_in_at timestamp with time zone,
    raw_app_meta_data jsonb,
    raw_user_meta_data jsonb,
    is_super_admin boolean,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    phone text DEFAULT NULL::character varying,
    phone_confirmed_at timestamp with time zone,
    phone_change text DEFAULT ''::character varying,
    phone_change_token character varying(255) DEFAULT ''::character varying,
    phone_change_sent_at timestamp with time zone,
    confirmed_at timestamp with time zone GENERATED ALWAYS AS (LEAST(email_confirmed_at, phone_confirmed_at)) STORED,
    email_change_token_current character varying(255) DEFAULT ''::character varying,
    email_change_confirm_status smallint DEFAULT 0,
    banned_until timestamp with time zone,
    reauthentication_token character varying(255) DEFAULT ''::character varying,
    reauthentication_sent_at timestamp with time zone,
    is_sso_user boolean DEFAULT false NOT NULL,
    deleted_at timestamp with time zone,
    is_anonymous boolean DEFAULT false NOT NULL,
    CONSTRAINT users_email_change_confirm_status_check CHECK (((email_change_confirm_status >= 0) AND (email_change_confirm_status <= 2)))
);


ALTER TABLE auth.users OWNER TO supabase_auth_admin;

--
-- Name: TABLE users; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.users IS 'Auth: Stores user login data within a secure schema.';


--
-- Name: COLUMN users.is_sso_user; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON COLUMN auth.users.is_sso_user IS 'Auth: Set this column to true when the account comes from SSO. These accounts can have duplicate emails.';


--
-- Name: conversations; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.conversations (
    id uuid DEFAULT gen_random_uuid() NOT NULL,
    user_id uuid NOT NULL,
    started_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP NOT NULL,
    ended_at timestamp without time zone,
    openai_thread_id text,
    answer_accepted boolean DEFAULT false NOT NULL,
    messages jsonb
);


ALTER TABLE public.conversations OWNER TO postgres;

--
-- Name: shopping_list_items; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.shopping_list_items (
    id uuid DEFAULT gen_random_uuid() NOT NULL,
    shopping_list_id uuid NOT NULL,
    item_name text NOT NULL,
    purchased boolean DEFAULT false NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP NOT NULL,
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP NOT NULL
);


ALTER TABLE public.shopping_list_items OWNER TO postgres;

--
-- Name: shopping_lists; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.shopping_lists (
    id uuid DEFAULT gen_random_uuid() NOT NULL,
    user_id uuid NOT NULL,
    title character varying(255) NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP NOT NULL,
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP NOT NULL
);


ALTER TABLE public.shopping_lists OWNER TO postgres;

--
-- Name: users; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.users (
    id uuid DEFAULT gen_random_uuid() NOT NULL,
    email character varying(128) NOT NULL,
    updated_date timestamp without time zone DEFAULT CURRENT_TIMESTAMP NOT NULL,
    admin boolean DEFAULT false NOT NULL
);


ALTER TABLE public.users OWNER TO postgres;

--
-- Name: TABLE users; Type: COMMENT; Schema: public; Owner: postgres
--

COMMENT ON TABLE public.users IS 'Stores user accounts including regular users and administrators';


--
-- Name: COLUMN users.admin; Type: COMMENT; Schema: public; Owner: postgres
--

COMMENT ON COLUMN public.users.admin IS 'Identifies users with administrative privileges. Default is false for regular users.';


--
-- Name: messages; Type: TABLE; Schema: realtime; Owner: supabase_realtime_admin
--

CREATE TABLE realtime.messages (
    topic text NOT NULL,
    extension text NOT NULL,
    payload jsonb,
    event text,
    private boolean DEFAULT false,
    updated_at timestamp without time zone DEFAULT now() NOT NULL,
    inserted_at timestamp without time zone DEFAULT now() NOT NULL,
    id uuid DEFAULT gen_random_uuid() NOT NULL
)
PARTITION BY RANGE (inserted_at);


ALTER TABLE realtime.messages OWNER TO supabase_realtime_admin;

--
-- Name: schema_migrations; Type: TABLE; Schema: realtime; Owner: supabase_admin
--

CREATE TABLE realtime.schema_migrations (
    version bigint NOT NULL,
    inserted_at timestamp(0) without time zone
);


ALTER TABLE realtime.schema_migrations OWNER TO supabase_admin;

--
-- Name: subscription; Type: TABLE; Schema: realtime; Owner: supabase_admin
--

CREATE TABLE realtime.subscription (
    id bigint NOT NULL,
    subscription_id uuid NOT NULL,
    entity regclass NOT NULL,
    filters realtime.user_defined_filter[] DEFAULT '{}'::realtime.user_defined_filter[] NOT NULL,
    claims jsonb NOT NULL,
    claims_role regrole GENERATED ALWAYS AS (realtime.to_regrole((claims ->> 'role'::text))) STORED NOT NULL,
    created_at timestamp without time zone DEFAULT timezone('utc'::text, now()) NOT NULL
);


ALTER TABLE realtime.subscription OWNER TO supabase_admin;

--
-- Name: subscription_id_seq; Type: SEQUENCE; Schema: realtime; Owner: supabase_admin
--

ALTER TABLE realtime.subscription ALTER COLUMN id ADD GENERATED ALWAYS AS IDENTITY (
    SEQUENCE NAME realtime.subscription_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: buckets; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TABLE storage.buckets (
    id text NOT NULL,
    name text NOT NULL,
    owner uuid,
    created_at timestamp with time zone DEFAULT now(),
    updated_at timestamp with time zone DEFAULT now(),
    public boolean DEFAULT false,
    avif_autodetection boolean DEFAULT false,
    file_size_limit bigint,
    allowed_mime_types text[],
    owner_id text
);


ALTER TABLE storage.buckets OWNER TO supabase_storage_admin;

--
-- Name: COLUMN buckets.owner; Type: COMMENT; Schema: storage; Owner: supabase_storage_admin
--

COMMENT ON COLUMN storage.buckets.owner IS 'Field is deprecated, use owner_id instead';


--
-- Name: migrations; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TABLE storage.migrations (
    id integer NOT NULL,
    name character varying(100) NOT NULL,
    hash character varying(40) NOT NULL,
    executed_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP
);


ALTER TABLE storage.migrations OWNER TO supabase_storage_admin;

--
-- Name: objects; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TABLE storage.objects (
    id uuid DEFAULT gen_random_uuid() NOT NULL,
    bucket_id text,
    name text,
    owner uuid,
    created_at timestamp with time zone DEFAULT now(),
    updated_at timestamp with time zone DEFAULT now(),
    last_accessed_at timestamp with time zone DEFAULT now(),
    metadata jsonb,
    path_tokens text[] GENERATED ALWAYS AS (string_to_array(name, '/'::text)) STORED,
    version text,
    owner_id text,
    user_metadata jsonb,
    level integer
);


ALTER TABLE storage.objects OWNER TO supabase_storage_admin;

--
-- Name: COLUMN objects.owner; Type: COMMENT; Schema: storage; Owner: supabase_storage_admin
--

COMMENT ON COLUMN storage.objects.owner IS 'Field is deprecated, use owner_id instead';


--
-- Name: prefixes; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TABLE storage.prefixes (
    bucket_id text NOT NULL,
    name text NOT NULL COLLATE pg_catalog."C",
    level integer GENERATED ALWAYS AS (storage.get_level(name)) STORED NOT NULL,
    created_at timestamp with time zone DEFAULT now(),
    updated_at timestamp with time zone DEFAULT now()
);


ALTER TABLE storage.prefixes OWNER TO supabase_storage_admin;

--
-- Name: s3_multipart_uploads; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TABLE storage.s3_multipart_uploads (
    id text NOT NULL,
    in_progress_size bigint DEFAULT 0 NOT NULL,
    upload_signature text NOT NULL,
    bucket_id text NOT NULL,
    key text NOT NULL COLLATE pg_catalog."C",
    version text NOT NULL,
    owner_id text,
    created_at timestamp with time zone DEFAULT now() NOT NULL,
    user_metadata jsonb
);


ALTER TABLE storage.s3_multipart_uploads OWNER TO supabase_storage_admin;

--
-- Name: s3_multipart_uploads_parts; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TABLE storage.s3_multipart_uploads_parts (
    id uuid DEFAULT gen_random_uuid() NOT NULL,
    upload_id text NOT NULL,
    size bigint DEFAULT 0 NOT NULL,
    part_number integer NOT NULL,
    bucket_id text NOT NULL,
    key text NOT NULL COLLATE pg_catalog."C",
    etag text NOT NULL,
    owner_id text,
    version text NOT NULL,
    created_at timestamp with time zone DEFAULT now() NOT NULL
);


ALTER TABLE storage.s3_multipart_uploads_parts OWNER TO supabase_storage_admin;

--
-- Name: hooks; Type: TABLE; Schema: supabase_functions; Owner: supabase_functions_admin
--

CREATE TABLE supabase_functions.hooks (
    id bigint NOT NULL,
    hook_table_id integer NOT NULL,
    hook_name text NOT NULL,
    created_at timestamp with time zone DEFAULT now() NOT NULL,
    request_id bigint
);


ALTER TABLE supabase_functions.hooks OWNER TO supabase_functions_admin;

--
-- Name: TABLE hooks; Type: COMMENT; Schema: supabase_functions; Owner: supabase_functions_admin
--

COMMENT ON TABLE supabase_functions.hooks IS 'Supabase Functions Hooks: Audit trail for triggered hooks.';


--
-- Name: hooks_id_seq; Type: SEQUENCE; Schema: supabase_functions; Owner: supabase_functions_admin
--

CREATE SEQUENCE supabase_functions.hooks_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE supabase_functions.hooks_id_seq OWNER TO supabase_functions_admin;

--
-- Name: hooks_id_seq; Type: SEQUENCE OWNED BY; Schema: supabase_functions; Owner: supabase_functions_admin
--

ALTER SEQUENCE supabase_functions.hooks_id_seq OWNED BY supabase_functions.hooks.id;


--
-- Name: migrations; Type: TABLE; Schema: supabase_functions; Owner: supabase_functions_admin
--

CREATE TABLE supabase_functions.migrations (
    version text NOT NULL,
    inserted_at timestamp with time zone DEFAULT now() NOT NULL
);


ALTER TABLE supabase_functions.migrations OWNER TO supabase_functions_admin;

--
-- Name: schema_migrations; Type: TABLE; Schema: supabase_migrations; Owner: postgres
--

CREATE TABLE supabase_migrations.schema_migrations (
    version text NOT NULL,
    statements text[],
    name text
);


ALTER TABLE supabase_migrations.schema_migrations OWNER TO postgres;

--
-- Name: refresh_tokens id; Type: DEFAULT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.refresh_tokens ALTER COLUMN id SET DEFAULT nextval('auth.refresh_tokens_id_seq'::regclass);


--
-- Name: hooks id; Type: DEFAULT; Schema: supabase_functions; Owner: supabase_functions_admin
--

ALTER TABLE ONLY supabase_functions.hooks ALTER COLUMN id SET DEFAULT nextval('supabase_functions.hooks_id_seq'::regclass);


--
-- Name: extensions extensions_pkey; Type: CONSTRAINT; Schema: _realtime; Owner: supabase_admin
--

ALTER TABLE ONLY _realtime.extensions
    ADD CONSTRAINT extensions_pkey PRIMARY KEY (id);


--
-- Name: schema_migrations schema_migrations_pkey; Type: CONSTRAINT; Schema: _realtime; Owner: supabase_admin
--

ALTER TABLE ONLY _realtime.schema_migrations
    ADD CONSTRAINT schema_migrations_pkey PRIMARY KEY (version);


--
-- Name: tenants tenants_pkey; Type: CONSTRAINT; Schema: _realtime; Owner: supabase_admin
--

ALTER TABLE ONLY _realtime.tenants
    ADD CONSTRAINT tenants_pkey PRIMARY KEY (id);


--
-- Name: mfa_amr_claims amr_id_pk; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.mfa_amr_claims
    ADD CONSTRAINT amr_id_pk PRIMARY KEY (id);


--
-- Name: audit_log_entries audit_log_entries_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.audit_log_entries
    ADD CONSTRAINT audit_log_entries_pkey PRIMARY KEY (id);


--
-- Name: flow_state flow_state_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.flow_state
    ADD CONSTRAINT flow_state_pkey PRIMARY KEY (id);


--
-- Name: identities identities_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.identities
    ADD CONSTRAINT identities_pkey PRIMARY KEY (id);


--
-- Name: identities identities_provider_id_provider_unique; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.identities
    ADD CONSTRAINT identities_provider_id_provider_unique UNIQUE (provider_id, provider);


--
-- Name: instances instances_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.instances
    ADD CONSTRAINT instances_pkey PRIMARY KEY (id);


--
-- Name: mfa_amr_claims mfa_amr_claims_session_id_authentication_method_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.mfa_amr_claims
    ADD CONSTRAINT mfa_amr_claims_session_id_authentication_method_pkey UNIQUE (session_id, authentication_method);


--
-- Name: mfa_challenges mfa_challenges_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.mfa_challenges
    ADD CONSTRAINT mfa_challenges_pkey PRIMARY KEY (id);


--
-- Name: mfa_factors mfa_factors_last_challenged_at_key; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.mfa_factors
    ADD CONSTRAINT mfa_factors_last_challenged_at_key UNIQUE (last_challenged_at);


--
-- Name: mfa_factors mfa_factors_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.mfa_factors
    ADD CONSTRAINT mfa_factors_pkey PRIMARY KEY (id);


--
-- Name: one_time_tokens one_time_tokens_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.one_time_tokens
    ADD CONSTRAINT one_time_tokens_pkey PRIMARY KEY (id);


--
-- Name: refresh_tokens refresh_tokens_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.refresh_tokens
    ADD CONSTRAINT refresh_tokens_pkey PRIMARY KEY (id);


--
-- Name: refresh_tokens refresh_tokens_token_unique; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.refresh_tokens
    ADD CONSTRAINT refresh_tokens_token_unique UNIQUE (token);


--
-- Name: saml_providers saml_providers_entity_id_key; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.saml_providers
    ADD CONSTRAINT saml_providers_entity_id_key UNIQUE (entity_id);


--
-- Name: saml_providers saml_providers_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.saml_providers
    ADD CONSTRAINT saml_providers_pkey PRIMARY KEY (id);


--
-- Name: saml_relay_states saml_relay_states_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.saml_relay_states
    ADD CONSTRAINT saml_relay_states_pkey PRIMARY KEY (id);


--
-- Name: schema_migrations schema_migrations_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.schema_migrations
    ADD CONSTRAINT schema_migrations_pkey PRIMARY KEY (version);


--
-- Name: sessions sessions_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.sessions
    ADD CONSTRAINT sessions_pkey PRIMARY KEY (id);


--
-- Name: sso_domains sso_domains_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.sso_domains
    ADD CONSTRAINT sso_domains_pkey PRIMARY KEY (id);


--
-- Name: sso_providers sso_providers_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.sso_providers
    ADD CONSTRAINT sso_providers_pkey PRIMARY KEY (id);


--
-- Name: users users_phone_key; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.users
    ADD CONSTRAINT users_phone_key UNIQUE (phone);


--
-- Name: users users_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.users
    ADD CONSTRAINT users_pkey PRIMARY KEY (id);


--
-- Name: conversations conversations_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.conversations
    ADD CONSTRAINT conversations_pkey PRIMARY KEY (id);


--
-- Name: shopping_list_items shopping_list_items_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.shopping_list_items
    ADD CONSTRAINT shopping_list_items_pkey PRIMARY KEY (id);


--
-- Name: shopping_lists shopping_lists_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.shopping_lists
    ADD CONSTRAINT shopping_lists_pkey PRIMARY KEY (id);


--
-- Name: users users_email_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT users_email_key UNIQUE (email);


--
-- Name: users users_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT users_pkey PRIMARY KEY (id);


--
-- Name: messages messages_pkey; Type: CONSTRAINT; Schema: realtime; Owner: supabase_realtime_admin
--

ALTER TABLE ONLY realtime.messages
    ADD CONSTRAINT messages_pkey PRIMARY KEY (id, inserted_at);


--
-- Name: subscription pk_subscription; Type: CONSTRAINT; Schema: realtime; Owner: supabase_admin
--

ALTER TABLE ONLY realtime.subscription
    ADD CONSTRAINT pk_subscription PRIMARY KEY (id);


--
-- Name: schema_migrations schema_migrations_pkey; Type: CONSTRAINT; Schema: realtime; Owner: supabase_admin
--

ALTER TABLE ONLY realtime.schema_migrations
    ADD CONSTRAINT schema_migrations_pkey PRIMARY KEY (version);


--
-- Name: buckets buckets_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.buckets
    ADD CONSTRAINT buckets_pkey PRIMARY KEY (id);


--
-- Name: migrations migrations_name_key; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.migrations
    ADD CONSTRAINT migrations_name_key UNIQUE (name);


--
-- Name: migrations migrations_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.migrations
    ADD CONSTRAINT migrations_pkey PRIMARY KEY (id);


--
-- Name: objects objects_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.objects
    ADD CONSTRAINT objects_pkey PRIMARY KEY (id);


--
-- Name: prefixes prefixes_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.prefixes
    ADD CONSTRAINT prefixes_pkey PRIMARY KEY (bucket_id, level, name);


--
-- Name: s3_multipart_uploads_parts s3_multipart_uploads_parts_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.s3_multipart_uploads_parts
    ADD CONSTRAINT s3_multipart_uploads_parts_pkey PRIMARY KEY (id);


--
-- Name: s3_multipart_uploads s3_multipart_uploads_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.s3_multipart_uploads
    ADD CONSTRAINT s3_multipart_uploads_pkey PRIMARY KEY (id);


--
-- Name: hooks hooks_pkey; Type: CONSTRAINT; Schema: supabase_functions; Owner: supabase_functions_admin
--

ALTER TABLE ONLY supabase_functions.hooks
    ADD CONSTRAINT hooks_pkey PRIMARY KEY (id);


--
-- Name: migrations migrations_pkey; Type: CONSTRAINT; Schema: supabase_functions; Owner: supabase_functions_admin
--

ALTER TABLE ONLY supabase_functions.migrations
    ADD CONSTRAINT migrations_pkey PRIMARY KEY (version);


--
-- Name: schema_migrations schema_migrations_pkey; Type: CONSTRAINT; Schema: supabase_migrations; Owner: postgres
--

ALTER TABLE ONLY supabase_migrations.schema_migrations
    ADD CONSTRAINT schema_migrations_pkey PRIMARY KEY (version);


--
-- Name: extensions_tenant_external_id_index; Type: INDEX; Schema: _realtime; Owner: supabase_admin
--

CREATE INDEX extensions_tenant_external_id_index ON _realtime.extensions USING btree (tenant_external_id);


--
-- Name: extensions_tenant_external_id_type_index; Type: INDEX; Schema: _realtime; Owner: supabase_admin
--

CREATE UNIQUE INDEX extensions_tenant_external_id_type_index ON _realtime.extensions USING btree (tenant_external_id, type);


--
-- Name: tenants_external_id_index; Type: INDEX; Schema: _realtime; Owner: supabase_admin
--

CREATE UNIQUE INDEX tenants_external_id_index ON _realtime.tenants USING btree (external_id);


--
-- Name: audit_logs_instance_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX audit_logs_instance_id_idx ON auth.audit_log_entries USING btree (instance_id);


--
-- Name: confirmation_token_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX confirmation_token_idx ON auth.users USING btree (confirmation_token) WHERE ((confirmation_token)::text !~ '^[0-9 ]*$'::text);


--
-- Name: email_change_token_current_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX email_change_token_current_idx ON auth.users USING btree (email_change_token_current) WHERE ((email_change_token_current)::text !~ '^[0-9 ]*$'::text);


--
-- Name: email_change_token_new_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX email_change_token_new_idx ON auth.users USING btree (email_change_token_new) WHERE ((email_change_token_new)::text !~ '^[0-9 ]*$'::text);


--
-- Name: factor_id_created_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX factor_id_created_at_idx ON auth.mfa_factors USING btree (user_id, created_at);


--
-- Name: flow_state_created_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX flow_state_created_at_idx ON auth.flow_state USING btree (created_at DESC);


--
-- Name: identities_email_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX identities_email_idx ON auth.identities USING btree (email text_pattern_ops);


--
-- Name: INDEX identities_email_idx; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON INDEX auth.identities_email_idx IS 'Auth: Ensures indexed queries on the email column';


--
-- Name: identities_user_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX identities_user_id_idx ON auth.identities USING btree (user_id);


--
-- Name: idx_auth_code; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX idx_auth_code ON auth.flow_state USING btree (auth_code);


--
-- Name: idx_user_id_auth_method; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX idx_user_id_auth_method ON auth.flow_state USING btree (user_id, authentication_method);


--
-- Name: mfa_challenge_created_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX mfa_challenge_created_at_idx ON auth.mfa_challenges USING btree (created_at DESC);


--
-- Name: mfa_factors_user_friendly_name_unique; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX mfa_factors_user_friendly_name_unique ON auth.mfa_factors USING btree (friendly_name, user_id) WHERE (TRIM(BOTH FROM friendly_name) <> ''::text);


--
-- Name: mfa_factors_user_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX mfa_factors_user_id_idx ON auth.mfa_factors USING btree (user_id);


--
-- Name: one_time_tokens_relates_to_hash_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX one_time_tokens_relates_to_hash_idx ON auth.one_time_tokens USING hash (relates_to);


--
-- Name: one_time_tokens_token_hash_hash_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX one_time_tokens_token_hash_hash_idx ON auth.one_time_tokens USING hash (token_hash);


--
-- Name: one_time_tokens_user_id_token_type_key; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX one_time_tokens_user_id_token_type_key ON auth.one_time_tokens USING btree (user_id, token_type);


--
-- Name: reauthentication_token_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX reauthentication_token_idx ON auth.users USING btree (reauthentication_token) WHERE ((reauthentication_token)::text !~ '^[0-9 ]*$'::text);


--
-- Name: recovery_token_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX recovery_token_idx ON auth.users USING btree (recovery_token) WHERE ((recovery_token)::text !~ '^[0-9 ]*$'::text);


--
-- Name: refresh_tokens_instance_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX refresh_tokens_instance_id_idx ON auth.refresh_tokens USING btree (instance_id);


--
-- Name: refresh_tokens_instance_id_user_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX refresh_tokens_instance_id_user_id_idx ON auth.refresh_tokens USING btree (instance_id, user_id);


--
-- Name: refresh_tokens_parent_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX refresh_tokens_parent_idx ON auth.refresh_tokens USING btree (parent);


--
-- Name: refresh_tokens_session_id_revoked_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX refresh_tokens_session_id_revoked_idx ON auth.refresh_tokens USING btree (session_id, revoked);


--
-- Name: refresh_tokens_updated_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX refresh_tokens_updated_at_idx ON auth.refresh_tokens USING btree (updated_at DESC);


--
-- Name: saml_providers_sso_provider_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX saml_providers_sso_provider_id_idx ON auth.saml_providers USING btree (sso_provider_id);


--
-- Name: saml_relay_states_created_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX saml_relay_states_created_at_idx ON auth.saml_relay_states USING btree (created_at DESC);


--
-- Name: saml_relay_states_for_email_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX saml_relay_states_for_email_idx ON auth.saml_relay_states USING btree (for_email);


--
-- Name: saml_relay_states_sso_provider_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX saml_relay_states_sso_provider_id_idx ON auth.saml_relay_states USING btree (sso_provider_id);


--
-- Name: sessions_not_after_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX sessions_not_after_idx ON auth.sessions USING btree (not_after DESC);


--
-- Name: sessions_user_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX sessions_user_id_idx ON auth.sessions USING btree (user_id);


--
-- Name: sso_domains_domain_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX sso_domains_domain_idx ON auth.sso_domains USING btree (lower(domain));


--
-- Name: sso_domains_sso_provider_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX sso_domains_sso_provider_id_idx ON auth.sso_domains USING btree (sso_provider_id);


--
-- Name: sso_providers_resource_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX sso_providers_resource_id_idx ON auth.sso_providers USING btree (lower(resource_id));


--
-- Name: unique_phone_factor_per_user; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX unique_phone_factor_per_user ON auth.mfa_factors USING btree (user_id, phone);


--
-- Name: user_id_created_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX user_id_created_at_idx ON auth.sessions USING btree (user_id, created_at);


--
-- Name: users_email_partial_key; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX users_email_partial_key ON auth.users USING btree (email) WHERE (is_sso_user = false);


--
-- Name: INDEX users_email_partial_key; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON INDEX auth.users_email_partial_key IS 'Auth: A partial unique index that applies only when is_sso_user is false';


--
-- Name: users_instance_id_email_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX users_instance_id_email_idx ON auth.users USING btree (instance_id, lower((email)::text));


--
-- Name: users_instance_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX users_instance_id_idx ON auth.users USING btree (instance_id);


--
-- Name: users_is_anonymous_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX users_is_anonymous_idx ON auth.users USING btree (is_anonymous);


--
-- Name: idx_conversations_user_id; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_conversations_user_id ON public.conversations USING btree (user_id);


--
-- Name: idx_shopping_list_items_shopping_list_id; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_shopping_list_items_shopping_list_id ON public.shopping_list_items USING btree (shopping_list_id);


--
-- Name: idx_shopping_lists_user_id; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_shopping_lists_user_id ON public.shopping_lists USING btree (user_id);


--
-- Name: ix_realtime_subscription_entity; Type: INDEX; Schema: realtime; Owner: supabase_admin
--

CREATE INDEX ix_realtime_subscription_entity ON realtime.subscription USING btree (entity);


--
-- Name: subscription_subscription_id_entity_filters_key; Type: INDEX; Schema: realtime; Owner: supabase_admin
--

CREATE UNIQUE INDEX subscription_subscription_id_entity_filters_key ON realtime.subscription USING btree (subscription_id, entity, filters);


--
-- Name: bname; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE UNIQUE INDEX bname ON storage.buckets USING btree (name);


--
-- Name: bucketid_objname; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE UNIQUE INDEX bucketid_objname ON storage.objects USING btree (bucket_id, name);


--
-- Name: idx_multipart_uploads_list; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE INDEX idx_multipart_uploads_list ON storage.s3_multipart_uploads USING btree (bucket_id, key, created_at);


--
-- Name: idx_name_bucket_unique; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE UNIQUE INDEX idx_name_bucket_unique ON storage.objects USING btree (name COLLATE "C", bucket_id);


--
-- Name: idx_objects_bucket_id_name; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE INDEX idx_objects_bucket_id_name ON storage.objects USING btree (bucket_id, name COLLATE "C");


--
-- Name: idx_objects_lower_name; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE INDEX idx_objects_lower_name ON storage.objects USING btree ((path_tokens[level]), lower(name) text_pattern_ops, bucket_id, level);


--
-- Name: idx_prefixes_lower_name; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE INDEX idx_prefixes_lower_name ON storage.prefixes USING btree (bucket_id, level, ((string_to_array(name, '/'::text))[level]), lower(name) text_pattern_ops);


--
-- Name: name_prefix_search; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE INDEX name_prefix_search ON storage.objects USING btree (name text_pattern_ops);


--
-- Name: objects_bucket_id_level_idx; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE UNIQUE INDEX objects_bucket_id_level_idx ON storage.objects USING btree (bucket_id, level, name COLLATE "C");


--
-- Name: supabase_functions_hooks_h_table_id_h_name_idx; Type: INDEX; Schema: supabase_functions; Owner: supabase_functions_admin
--

CREATE INDEX supabase_functions_hooks_h_table_id_h_name_idx ON supabase_functions.hooks USING btree (hook_table_id, hook_name);


--
-- Name: supabase_functions_hooks_request_id_idx; Type: INDEX; Schema: supabase_functions; Owner: supabase_functions_admin
--

CREATE INDEX supabase_functions_hooks_request_id_idx ON supabase_functions.hooks USING btree (request_id);


--
-- Name: users on_auth_user_created; Type: TRIGGER; Schema: auth; Owner: supabase_auth_admin
--

CREATE TRIGGER on_auth_user_created AFTER INSERT ON auth.users FOR EACH ROW EXECUTE FUNCTION public.handle_new_user();


--
-- Name: shopping_list_items set_timestamp_shopping_list_items; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER set_timestamp_shopping_list_items BEFORE UPDATE ON public.shopping_list_items FOR EACH ROW EXECUTE FUNCTION public.trigger_set_timestamp();


--
-- Name: shopping_lists set_timestamp_shopping_lists; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER set_timestamp_shopping_lists BEFORE UPDATE ON public.shopping_lists FOR EACH ROW EXECUTE FUNCTION public.trigger_set_timestamp();


--
-- Name: users set_timestamp_users; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER set_timestamp_users BEFORE UPDATE ON public.users FOR EACH ROW EXECUTE FUNCTION public.trigger_set_timestamp_users();


--
-- Name: subscription tr_check_filters; Type: TRIGGER; Schema: realtime; Owner: supabase_admin
--

CREATE TRIGGER tr_check_filters BEFORE INSERT OR UPDATE ON realtime.subscription FOR EACH ROW EXECUTE FUNCTION realtime.subscription_check_filters();


--
-- Name: objects objects_delete_delete_prefix; Type: TRIGGER; Schema: storage; Owner: supabase_storage_admin
--

CREATE TRIGGER objects_delete_delete_prefix AFTER DELETE ON storage.objects FOR EACH ROW EXECUTE FUNCTION storage.delete_prefix_hierarchy_trigger();


--
-- Name: objects objects_insert_create_prefix; Type: TRIGGER; Schema: storage; Owner: supabase_storage_admin
--

CREATE TRIGGER objects_insert_create_prefix BEFORE INSERT ON storage.objects FOR EACH ROW EXECUTE FUNCTION storage.objects_insert_prefix_trigger();


--
-- Name: objects objects_update_create_prefix; Type: TRIGGER; Schema: storage; Owner: supabase_storage_admin
--

CREATE TRIGGER objects_update_create_prefix BEFORE UPDATE ON storage.objects FOR EACH ROW WHEN ((new.name <> old.name)) EXECUTE FUNCTION storage.objects_insert_prefix_trigger();


--
-- Name: prefixes prefixes_create_hierarchy; Type: TRIGGER; Schema: storage; Owner: supabase_storage_admin
--

CREATE TRIGGER prefixes_create_hierarchy BEFORE INSERT ON storage.prefixes FOR EACH ROW WHEN ((pg_trigger_depth() < 1)) EXECUTE FUNCTION storage.prefixes_insert_trigger();


--
-- Name: prefixes prefixes_delete_hierarchy; Type: TRIGGER; Schema: storage; Owner: supabase_storage_admin
--

CREATE TRIGGER prefixes_delete_hierarchy AFTER DELETE ON storage.prefixes FOR EACH ROW EXECUTE FUNCTION storage.delete_prefix_hierarchy_trigger();


--
-- Name: objects update_objects_updated_at; Type: TRIGGER; Schema: storage; Owner: supabase_storage_admin
--

CREATE TRIGGER update_objects_updated_at BEFORE UPDATE ON storage.objects FOR EACH ROW EXECUTE FUNCTION storage.update_updated_at_column();


--
-- Name: extensions extensions_tenant_external_id_fkey; Type: FK CONSTRAINT; Schema: _realtime; Owner: supabase_admin
--

ALTER TABLE ONLY _realtime.extensions
    ADD CONSTRAINT extensions_tenant_external_id_fkey FOREIGN KEY (tenant_external_id) REFERENCES _realtime.tenants(external_id) ON DELETE CASCADE;


--
-- Name: identities identities_user_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.identities
    ADD CONSTRAINT identities_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE;


--
-- Name: mfa_amr_claims mfa_amr_claims_session_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.mfa_amr_claims
    ADD CONSTRAINT mfa_amr_claims_session_id_fkey FOREIGN KEY (session_id) REFERENCES auth.sessions(id) ON DELETE CASCADE;


--
-- Name: mfa_challenges mfa_challenges_auth_factor_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.mfa_challenges
    ADD CONSTRAINT mfa_challenges_auth_factor_id_fkey FOREIGN KEY (factor_id) REFERENCES auth.mfa_factors(id) ON DELETE CASCADE;


--
-- Name: mfa_factors mfa_factors_user_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.mfa_factors
    ADD CONSTRAINT mfa_factors_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE;


--
-- Name: one_time_tokens one_time_tokens_user_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.one_time_tokens
    ADD CONSTRAINT one_time_tokens_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE;


--
-- Name: refresh_tokens refresh_tokens_session_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.refresh_tokens
    ADD CONSTRAINT refresh_tokens_session_id_fkey FOREIGN KEY (session_id) REFERENCES auth.sessions(id) ON DELETE CASCADE;


--
-- Name: saml_providers saml_providers_sso_provider_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.saml_providers
    ADD CONSTRAINT saml_providers_sso_provider_id_fkey FOREIGN KEY (sso_provider_id) REFERENCES auth.sso_providers(id) ON DELETE CASCADE;


--
-- Name: saml_relay_states saml_relay_states_flow_state_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.saml_relay_states
    ADD CONSTRAINT saml_relay_states_flow_state_id_fkey FOREIGN KEY (flow_state_id) REFERENCES auth.flow_state(id) ON DELETE CASCADE;


--
-- Name: saml_relay_states saml_relay_states_sso_provider_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.saml_relay_states
    ADD CONSTRAINT saml_relay_states_sso_provider_id_fkey FOREIGN KEY (sso_provider_id) REFERENCES auth.sso_providers(id) ON DELETE CASCADE;


--
-- Name: sessions sessions_user_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.sessions
    ADD CONSTRAINT sessions_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE;


--
-- Name: sso_domains sso_domains_sso_provider_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.sso_domains
    ADD CONSTRAINT sso_domains_sso_provider_id_fkey FOREIGN KEY (sso_provider_id) REFERENCES auth.sso_providers(id) ON DELETE CASCADE;


--
-- Name: conversations conversations_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.conversations
    ADD CONSTRAINT conversations_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(id) ON DELETE CASCADE;


--
-- Name: shopping_list_items shopping_list_items_shopping_list_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.shopping_list_items
    ADD CONSTRAINT shopping_list_items_shopping_list_id_fkey FOREIGN KEY (shopping_list_id) REFERENCES public.shopping_lists(id) ON DELETE CASCADE;


--
-- Name: shopping_lists shopping_lists_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.shopping_lists
    ADD CONSTRAINT shopping_lists_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(id) ON DELETE CASCADE;


--
-- Name: objects objects_bucketId_fkey; Type: FK CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.objects
    ADD CONSTRAINT "objects_bucketId_fkey" FOREIGN KEY (bucket_id) REFERENCES storage.buckets(id);


--
-- Name: prefixes prefixes_bucketId_fkey; Type: FK CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.prefixes
    ADD CONSTRAINT "prefixes_bucketId_fkey" FOREIGN KEY (bucket_id) REFERENCES storage.buckets(id);


--
-- Name: s3_multipart_uploads s3_multipart_uploads_bucket_id_fkey; Type: FK CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.s3_multipart_uploads
    ADD CONSTRAINT s3_multipart_uploads_bucket_id_fkey FOREIGN KEY (bucket_id) REFERENCES storage.buckets(id);


--
-- Name: s3_multipart_uploads_parts s3_multipart_uploads_parts_bucket_id_fkey; Type: FK CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.s3_multipart_uploads_parts
    ADD CONSTRAINT s3_multipart_uploads_parts_bucket_id_fkey FOREIGN KEY (bucket_id) REFERENCES storage.buckets(id);


--
-- Name: s3_multipart_uploads_parts s3_multipart_uploads_parts_upload_id_fkey; Type: FK CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.s3_multipart_uploads_parts
    ADD CONSTRAINT s3_multipart_uploads_parts_upload_id_fkey FOREIGN KEY (upload_id) REFERENCES storage.s3_multipart_uploads(id) ON DELETE CASCADE;


--
-- Name: audit_log_entries; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.audit_log_entries ENABLE ROW LEVEL SECURITY;

--
-- Name: flow_state; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.flow_state ENABLE ROW LEVEL SECURITY;

--
-- Name: identities; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.identities ENABLE ROW LEVEL SECURITY;

--
-- Name: instances; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.instances ENABLE ROW LEVEL SECURITY;

--
-- Name: mfa_amr_claims; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.mfa_amr_claims ENABLE ROW LEVEL SECURITY;

--
-- Name: mfa_challenges; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.mfa_challenges ENABLE ROW LEVEL SECURITY;

--
-- Name: mfa_factors; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.mfa_factors ENABLE ROW LEVEL SECURITY;

--
-- Name: one_time_tokens; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.one_time_tokens ENABLE ROW LEVEL SECURITY;

--
-- Name: refresh_tokens; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.refresh_tokens ENABLE ROW LEVEL SECURITY;

--
-- Name: saml_providers; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.saml_providers ENABLE ROW LEVEL SECURITY;

--
-- Name: saml_relay_states; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.saml_relay_states ENABLE ROW LEVEL SECURITY;

--
-- Name: schema_migrations; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.schema_migrations ENABLE ROW LEVEL SECURITY;

--
-- Name: sessions; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.sessions ENABLE ROW LEVEL SECURITY;

--
-- Name: sso_domains; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.sso_domains ENABLE ROW LEVEL SECURITY;

--
-- Name: sso_providers; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.sso_providers ENABLE ROW LEVEL SECURITY;

--
-- Name: users; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.users ENABLE ROW LEVEL SECURITY;

--
-- Name: messages; Type: ROW SECURITY; Schema: realtime; Owner: supabase_realtime_admin
--

ALTER TABLE realtime.messages ENABLE ROW LEVEL SECURITY;

--
-- Name: buckets; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE storage.buckets ENABLE ROW LEVEL SECURITY;

--
-- Name: migrations; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE storage.migrations ENABLE ROW LEVEL SECURITY;

--
-- Name: objects; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE storage.objects ENABLE ROW LEVEL SECURITY;

--
-- Name: prefixes; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE storage.prefixes ENABLE ROW LEVEL SECURITY;

--
-- Name: s3_multipart_uploads; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE storage.s3_multipart_uploads ENABLE ROW LEVEL SECURITY;

--
-- Name: s3_multipart_uploads_parts; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE storage.s3_multipart_uploads_parts ENABLE ROW LEVEL SECURITY;

--
-- Name: supabase_realtime; Type: PUBLICATION; Schema: -; Owner: postgres
--

CREATE PUBLICATION supabase_realtime WITH (publish = 'insert, update, delete, truncate');


ALTER PUBLICATION supabase_realtime OWNER TO postgres;

--
-- Name: supabase_realtime shopping_lists; Type: PUBLICATION TABLE; Schema: public; Owner: postgres
--

ALTER PUBLICATION supabase_realtime ADD TABLE ONLY public.shopping_lists;


--
-- Name: SCHEMA auth; Type: ACL; Schema: -; Owner: supabase_admin
--

GRANT USAGE ON SCHEMA auth TO anon;
GRANT USAGE ON SCHEMA auth TO authenticated;
GRANT USAGE ON SCHEMA auth TO service_role;
GRANT ALL ON SCHEMA auth TO supabase_auth_admin;
GRANT ALL ON SCHEMA auth TO dashboard_user;
GRANT ALL ON SCHEMA auth TO postgres;


--
-- Name: SCHEMA extensions; Type: ACL; Schema: -; Owner: postgres
--

GRANT USAGE ON SCHEMA extensions TO anon;
GRANT USAGE ON SCHEMA extensions TO authenticated;
GRANT USAGE ON SCHEMA extensions TO service_role;
GRANT ALL ON SCHEMA extensions TO dashboard_user;


--
-- Name: SCHEMA net; Type: ACL; Schema: -; Owner: supabase_admin
--

GRANT USAGE ON SCHEMA net TO supabase_functions_admin;
GRANT USAGE ON SCHEMA net TO postgres;
GRANT USAGE ON SCHEMA net TO anon;
GRANT USAGE ON SCHEMA net TO authenticated;
GRANT USAGE ON SCHEMA net TO service_role;


--
-- Name: SCHEMA public; Type: ACL; Schema: -; Owner: pg_database_owner
--

GRANT USAGE ON SCHEMA public TO postgres;
GRANT USAGE ON SCHEMA public TO anon;
GRANT USAGE ON SCHEMA public TO authenticated;
GRANT USAGE ON SCHEMA public TO service_role;


--
-- Name: SCHEMA realtime; Type: ACL; Schema: -; Owner: supabase_admin
--

GRANT USAGE ON SCHEMA realtime TO postgres;
GRANT USAGE ON SCHEMA realtime TO anon;
GRANT USAGE ON SCHEMA realtime TO authenticated;
GRANT USAGE ON SCHEMA realtime TO service_role;
GRANT ALL ON SCHEMA realtime TO supabase_realtime_admin;


--
-- Name: SCHEMA storage; Type: ACL; Schema: -; Owner: supabase_admin
--

GRANT ALL ON SCHEMA storage TO postgres;
GRANT USAGE ON SCHEMA storage TO anon;
GRANT USAGE ON SCHEMA storage TO authenticated;
GRANT USAGE ON SCHEMA storage TO service_role;
GRANT ALL ON SCHEMA storage TO supabase_storage_admin;
GRANT ALL ON SCHEMA storage TO dashboard_user;


--
-- Name: SCHEMA supabase_functions; Type: ACL; Schema: -; Owner: supabase_admin
--

GRANT USAGE ON SCHEMA supabase_functions TO postgres;
GRANT USAGE ON SCHEMA supabase_functions TO anon;
GRANT USAGE ON SCHEMA supabase_functions TO authenticated;
GRANT USAGE ON SCHEMA supabase_functions TO service_role;
GRANT ALL ON SCHEMA supabase_functions TO supabase_functions_admin;


--
-- Name: SCHEMA vault; Type: ACL; Schema: -; Owner: supabase_admin
--

GRANT USAGE ON SCHEMA vault TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION email(); Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON FUNCTION auth.email() TO dashboard_user;


--
-- Name: FUNCTION jwt(); Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON FUNCTION auth.jwt() TO postgres;
GRANT ALL ON FUNCTION auth.jwt() TO dashboard_user;


--
-- Name: FUNCTION role(); Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON FUNCTION auth.role() TO dashboard_user;


--
-- Name: FUNCTION uid(); Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON FUNCTION auth.uid() TO dashboard_user;


--
-- Name: FUNCTION algorithm_sign(signables text, secret text, algorithm text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.algorithm_sign(signables text, secret text, algorithm text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.algorithm_sign(signables text, secret text, algorithm text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION armor(bytea); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.armor(bytea) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.armor(bytea) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION armor(bytea, text[], text[]); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.armor(bytea, text[], text[]) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.armor(bytea, text[], text[]) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION crypt(text, text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.crypt(text, text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.crypt(text, text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION dearmor(text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.dearmor(text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.dearmor(text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION decrypt(bytea, bytea, text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.decrypt(bytea, bytea, text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.decrypt(bytea, bytea, text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION decrypt_iv(bytea, bytea, bytea, text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.decrypt_iv(bytea, bytea, bytea, text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.decrypt_iv(bytea, bytea, bytea, text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION digest(bytea, text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.digest(bytea, text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.digest(bytea, text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION digest(text, text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.digest(text, text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.digest(text, text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION encrypt(bytea, bytea, text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.encrypt(bytea, bytea, text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.encrypt(bytea, bytea, text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION encrypt_iv(bytea, bytea, bytea, text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.encrypt_iv(bytea, bytea, bytea, text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.encrypt_iv(bytea, bytea, bytea, text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION gen_random_bytes(integer); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.gen_random_bytes(integer) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.gen_random_bytes(integer) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION gen_random_uuid(); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.gen_random_uuid() TO dashboard_user;
GRANT ALL ON FUNCTION extensions.gen_random_uuid() TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION gen_salt(text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.gen_salt(text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.gen_salt(text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION gen_salt(text, integer); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.gen_salt(text, integer) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.gen_salt(text, integer) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION grant_pg_cron_access(); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.grant_pg_cron_access() FROM postgres;
GRANT ALL ON FUNCTION extensions.grant_pg_cron_access() TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.grant_pg_cron_access() TO dashboard_user;


--
-- Name: FUNCTION grant_pg_graphql_access(); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.grant_pg_graphql_access() TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION grant_pg_net_access(); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.grant_pg_net_access() FROM postgres;
GRANT ALL ON FUNCTION extensions.grant_pg_net_access() TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.grant_pg_net_access() TO dashboard_user;


--
-- Name: FUNCTION hmac(bytea, bytea, text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.hmac(bytea, bytea, text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.hmac(bytea, bytea, text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION hmac(text, text, text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.hmac(text, text, text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.hmac(text, text, text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION pg_stat_statements(showtext boolean, OUT userid oid, OUT dbid oid, OUT toplevel boolean, OUT queryid bigint, OUT query text, OUT plans bigint, OUT total_plan_time double precision, OUT min_plan_time double precision, OUT max_plan_time double precision, OUT mean_plan_time double precision, OUT stddev_plan_time double precision, OUT calls bigint, OUT total_exec_time double precision, OUT min_exec_time double precision, OUT max_exec_time double precision, OUT mean_exec_time double precision, OUT stddev_exec_time double precision, OUT rows bigint, OUT shared_blks_hit bigint, OUT shared_blks_read bigint, OUT shared_blks_dirtied bigint, OUT shared_blks_written bigint, OUT local_blks_hit bigint, OUT local_blks_read bigint, OUT local_blks_dirtied bigint, OUT local_blks_written bigint, OUT temp_blks_read bigint, OUT temp_blks_written bigint, OUT blk_read_time double precision, OUT blk_write_time double precision, OUT temp_blk_read_time double precision, OUT temp_blk_write_time double precision, OUT wal_records bigint, OUT wal_fpi bigint, OUT wal_bytes numeric, OUT jit_functions bigint, OUT jit_generation_time double precision, OUT jit_inlining_count bigint, OUT jit_inlining_time double precision, OUT jit_optimization_count bigint, OUT jit_optimization_time double precision, OUT jit_emission_count bigint, OUT jit_emission_time double precision); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pg_stat_statements(showtext boolean, OUT userid oid, OUT dbid oid, OUT toplevel boolean, OUT queryid bigint, OUT query text, OUT plans bigint, OUT total_plan_time double precision, OUT min_plan_time double precision, OUT max_plan_time double precision, OUT mean_plan_time double precision, OUT stddev_plan_time double precision, OUT calls bigint, OUT total_exec_time double precision, OUT min_exec_time double precision, OUT max_exec_time double precision, OUT mean_exec_time double precision, OUT stddev_exec_time double precision, OUT rows bigint, OUT shared_blks_hit bigint, OUT shared_blks_read bigint, OUT shared_blks_dirtied bigint, OUT shared_blks_written bigint, OUT local_blks_hit bigint, OUT local_blks_read bigint, OUT local_blks_dirtied bigint, OUT local_blks_written bigint, OUT temp_blks_read bigint, OUT temp_blks_written bigint, OUT blk_read_time double precision, OUT blk_write_time double precision, OUT temp_blk_read_time double precision, OUT temp_blk_write_time double precision, OUT wal_records bigint, OUT wal_fpi bigint, OUT wal_bytes numeric, OUT jit_functions bigint, OUT jit_generation_time double precision, OUT jit_inlining_count bigint, OUT jit_inlining_time double precision, OUT jit_optimization_count bigint, OUT jit_optimization_time double precision, OUT jit_emission_count bigint, OUT jit_emission_time double precision) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION pg_stat_statements_info(OUT dealloc bigint, OUT stats_reset timestamp with time zone); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pg_stat_statements_info(OUT dealloc bigint, OUT stats_reset timestamp with time zone) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION pg_stat_statements_reset(userid oid, dbid oid, queryid bigint); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pg_stat_statements_reset(userid oid, dbid oid, queryid bigint) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION pgp_armor_headers(text, OUT key text, OUT value text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgp_armor_headers(text, OUT key text, OUT value text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.pgp_armor_headers(text, OUT key text, OUT value text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION pgp_key_id(bytea); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgp_key_id(bytea) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.pgp_key_id(bytea) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION pgp_pub_decrypt(bytea, bytea); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt(bytea, bytea) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt(bytea, bytea) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION pgp_pub_decrypt(bytea, bytea, text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt(bytea, bytea, text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt(bytea, bytea, text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION pgp_pub_decrypt(bytea, bytea, text, text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt(bytea, bytea, text, text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt(bytea, bytea, text, text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION pgp_pub_decrypt_bytea(bytea, bytea); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION pgp_pub_decrypt_bytea(bytea, bytea, text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea, text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea, text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION pgp_pub_decrypt_bytea(bytea, bytea, text, text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea, text, text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea, text, text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION pgp_pub_encrypt(text, bytea); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgp_pub_encrypt(text, bytea) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.pgp_pub_encrypt(text, bytea) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION pgp_pub_encrypt(text, bytea, text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgp_pub_encrypt(text, bytea, text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.pgp_pub_encrypt(text, bytea, text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION pgp_pub_encrypt_bytea(bytea, bytea); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgp_pub_encrypt_bytea(bytea, bytea) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.pgp_pub_encrypt_bytea(bytea, bytea) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION pgp_pub_encrypt_bytea(bytea, bytea, text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgp_pub_encrypt_bytea(bytea, bytea, text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.pgp_pub_encrypt_bytea(bytea, bytea, text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION pgp_sym_decrypt(bytea, text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgp_sym_decrypt(bytea, text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.pgp_sym_decrypt(bytea, text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION pgp_sym_decrypt(bytea, text, text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgp_sym_decrypt(bytea, text, text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.pgp_sym_decrypt(bytea, text, text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION pgp_sym_decrypt_bytea(bytea, text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgp_sym_decrypt_bytea(bytea, text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.pgp_sym_decrypt_bytea(bytea, text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION pgp_sym_decrypt_bytea(bytea, text, text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgp_sym_decrypt_bytea(bytea, text, text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.pgp_sym_decrypt_bytea(bytea, text, text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION pgp_sym_encrypt(text, text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgp_sym_encrypt(text, text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.pgp_sym_encrypt(text, text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION pgp_sym_encrypt(text, text, text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgp_sym_encrypt(text, text, text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.pgp_sym_encrypt(text, text, text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION pgp_sym_encrypt_bytea(bytea, text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgp_sym_encrypt_bytea(bytea, text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.pgp_sym_encrypt_bytea(bytea, text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION pgp_sym_encrypt_bytea(bytea, text, text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgp_sym_encrypt_bytea(bytea, text, text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.pgp_sym_encrypt_bytea(bytea, text, text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION pgrst_ddl_watch(); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgrst_ddl_watch() TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION pgrst_drop_watch(); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgrst_drop_watch() TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION set_graphql_placeholder(); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.set_graphql_placeholder() TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION sign(payload json, secret text, algorithm text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.sign(payload json, secret text, algorithm text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.sign(payload json, secret text, algorithm text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION try_cast_double(inp text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.try_cast_double(inp text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.try_cast_double(inp text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION url_decode(data text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.url_decode(data text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.url_decode(data text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION url_encode(data bytea); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.url_encode(data bytea) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.url_encode(data bytea) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION uuid_generate_v1(); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.uuid_generate_v1() TO dashboard_user;
GRANT ALL ON FUNCTION extensions.uuid_generate_v1() TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION uuid_generate_v1mc(); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.uuid_generate_v1mc() TO dashboard_user;
GRANT ALL ON FUNCTION extensions.uuid_generate_v1mc() TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION uuid_generate_v3(namespace uuid, name text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.uuid_generate_v3(namespace uuid, name text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.uuid_generate_v3(namespace uuid, name text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION uuid_generate_v4(); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.uuid_generate_v4() TO dashboard_user;
GRANT ALL ON FUNCTION extensions.uuid_generate_v4() TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION uuid_generate_v5(namespace uuid, name text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.uuid_generate_v5(namespace uuid, name text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.uuid_generate_v5(namespace uuid, name text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION uuid_nil(); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.uuid_nil() TO dashboard_user;
GRANT ALL ON FUNCTION extensions.uuid_nil() TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION uuid_ns_dns(); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.uuid_ns_dns() TO dashboard_user;
GRANT ALL ON FUNCTION extensions.uuid_ns_dns() TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION uuid_ns_oid(); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.uuid_ns_oid() TO dashboard_user;
GRANT ALL ON FUNCTION extensions.uuid_ns_oid() TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION uuid_ns_url(); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.uuid_ns_url() TO dashboard_user;
GRANT ALL ON FUNCTION extensions.uuid_ns_url() TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION uuid_ns_x500(); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.uuid_ns_x500() TO dashboard_user;
GRANT ALL ON FUNCTION extensions.uuid_ns_x500() TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION verify(token text, secret text, algorithm text); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.verify(token text, secret text, algorithm text) TO dashboard_user;
GRANT ALL ON FUNCTION extensions.verify(token text, secret text, algorithm text) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION graphql("operationName" text, query text, variables jsonb, extensions jsonb); Type: ACL; Schema: graphql_public; Owner: supabase_admin
--

GRANT ALL ON FUNCTION graphql_public.graphql("operationName" text, query text, variables jsonb, extensions jsonb) TO postgres;
GRANT ALL ON FUNCTION graphql_public.graphql("operationName" text, query text, variables jsonb, extensions jsonb) TO anon;
GRANT ALL ON FUNCTION graphql_public.graphql("operationName" text, query text, variables jsonb, extensions jsonb) TO authenticated;
GRANT ALL ON FUNCTION graphql_public.graphql("operationName" text, query text, variables jsonb, extensions jsonb) TO service_role;


--
-- Name: FUNCTION http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer); Type: ACL; Schema: net; Owner: supabase_admin
--

REVOKE ALL ON FUNCTION net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) FROM PUBLIC;
GRANT ALL ON FUNCTION net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) TO supabase_functions_admin;
GRANT ALL ON FUNCTION net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) TO postgres;
GRANT ALL ON FUNCTION net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) TO anon;
GRANT ALL ON FUNCTION net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) TO authenticated;
GRANT ALL ON FUNCTION net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) TO service_role;


--
-- Name: FUNCTION http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer); Type: ACL; Schema: net; Owner: supabase_admin
--

REVOKE ALL ON FUNCTION net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) FROM PUBLIC;
GRANT ALL ON FUNCTION net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) TO supabase_functions_admin;
GRANT ALL ON FUNCTION net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) TO postgres;
GRANT ALL ON FUNCTION net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) TO anon;
GRANT ALL ON FUNCTION net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) TO authenticated;
GRANT ALL ON FUNCTION net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) TO service_role;


--
-- Name: FUNCTION get_auth(p_usename text); Type: ACL; Schema: pgbouncer; Owner: supabase_admin
--

REVOKE ALL ON FUNCTION pgbouncer.get_auth(p_usename text) FROM PUBLIC;
GRANT ALL ON FUNCTION pgbouncer.get_auth(p_usename text) TO pgbouncer;
GRANT ALL ON FUNCTION pgbouncer.get_auth(p_usename text) TO postgres;


--
-- Name: FUNCTION handle_new_user(); Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON FUNCTION public.handle_new_user() TO anon;
GRANT ALL ON FUNCTION public.handle_new_user() TO authenticated;
GRANT ALL ON FUNCTION public.handle_new_user() TO service_role;


--
-- Name: FUNCTION trigger_set_timestamp(); Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON FUNCTION public.trigger_set_timestamp() TO anon;
GRANT ALL ON FUNCTION public.trigger_set_timestamp() TO authenticated;
GRANT ALL ON FUNCTION public.trigger_set_timestamp() TO service_role;


--
-- Name: FUNCTION trigger_set_timestamp_users(); Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON FUNCTION public.trigger_set_timestamp_users() TO anon;
GRANT ALL ON FUNCTION public.trigger_set_timestamp_users() TO authenticated;
GRANT ALL ON FUNCTION public.trigger_set_timestamp_users() TO service_role;


--
-- Name: FUNCTION apply_rls(wal jsonb, max_record_bytes integer); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer) TO postgres;
GRANT ALL ON FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer) TO dashboard_user;
GRANT ALL ON FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer) TO anon;
GRANT ALL ON FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer) TO authenticated;
GRANT ALL ON FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer) TO service_role;
GRANT ALL ON FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer) TO supabase_realtime_admin;


--
-- Name: FUNCTION broadcast_changes(topic_name text, event_name text, operation text, table_name text, table_schema text, new record, old record, level text); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.broadcast_changes(topic_name text, event_name text, operation text, table_name text, table_schema text, new record, old record, level text) TO postgres;
GRANT ALL ON FUNCTION realtime.broadcast_changes(topic_name text, event_name text, operation text, table_name text, table_schema text, new record, old record, level text) TO dashboard_user;


--
-- Name: FUNCTION build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]) TO postgres;
GRANT ALL ON FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]) TO dashboard_user;
GRANT ALL ON FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]) TO anon;
GRANT ALL ON FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]) TO authenticated;
GRANT ALL ON FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]) TO service_role;
GRANT ALL ON FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]) TO supabase_realtime_admin;


--
-- Name: FUNCTION "cast"(val text, type_ regtype); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime."cast"(val text, type_ regtype) TO postgres;
GRANT ALL ON FUNCTION realtime."cast"(val text, type_ regtype) TO dashboard_user;
GRANT ALL ON FUNCTION realtime."cast"(val text, type_ regtype) TO anon;
GRANT ALL ON FUNCTION realtime."cast"(val text, type_ regtype) TO authenticated;
GRANT ALL ON FUNCTION realtime."cast"(val text, type_ regtype) TO service_role;
GRANT ALL ON FUNCTION realtime."cast"(val text, type_ regtype) TO supabase_realtime_admin;


--
-- Name: FUNCTION check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text) TO postgres;
GRANT ALL ON FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text) TO dashboard_user;
GRANT ALL ON FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text) TO anon;
GRANT ALL ON FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text) TO authenticated;
GRANT ALL ON FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text) TO service_role;
GRANT ALL ON FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text) TO supabase_realtime_admin;


--
-- Name: FUNCTION is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]) TO postgres;
GRANT ALL ON FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]) TO dashboard_user;
GRANT ALL ON FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]) TO anon;
GRANT ALL ON FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]) TO authenticated;
GRANT ALL ON FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]) TO service_role;
GRANT ALL ON FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]) TO supabase_realtime_admin;


--
-- Name: FUNCTION list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer) TO postgres;
GRANT ALL ON FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer) TO dashboard_user;
GRANT ALL ON FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer) TO anon;
GRANT ALL ON FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer) TO authenticated;
GRANT ALL ON FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer) TO service_role;
GRANT ALL ON FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer) TO supabase_realtime_admin;


--
-- Name: FUNCTION quote_wal2json(entity regclass); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.quote_wal2json(entity regclass) TO postgres;
GRANT ALL ON FUNCTION realtime.quote_wal2json(entity regclass) TO dashboard_user;
GRANT ALL ON FUNCTION realtime.quote_wal2json(entity regclass) TO anon;
GRANT ALL ON FUNCTION realtime.quote_wal2json(entity regclass) TO authenticated;
GRANT ALL ON FUNCTION realtime.quote_wal2json(entity regclass) TO service_role;
GRANT ALL ON FUNCTION realtime.quote_wal2json(entity regclass) TO supabase_realtime_admin;


--
-- Name: FUNCTION send(payload jsonb, event text, topic text, private boolean); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.send(payload jsonb, event text, topic text, private boolean) TO postgres;
GRANT ALL ON FUNCTION realtime.send(payload jsonb, event text, topic text, private boolean) TO dashboard_user;


--
-- Name: FUNCTION subscription_check_filters(); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.subscription_check_filters() TO postgres;
GRANT ALL ON FUNCTION realtime.subscription_check_filters() TO dashboard_user;
GRANT ALL ON FUNCTION realtime.subscription_check_filters() TO anon;
GRANT ALL ON FUNCTION realtime.subscription_check_filters() TO authenticated;
GRANT ALL ON FUNCTION realtime.subscription_check_filters() TO service_role;
GRANT ALL ON FUNCTION realtime.subscription_check_filters() TO supabase_realtime_admin;


--
-- Name: FUNCTION to_regrole(role_name text); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.to_regrole(role_name text) TO postgres;
GRANT ALL ON FUNCTION realtime.to_regrole(role_name text) TO dashboard_user;
GRANT ALL ON FUNCTION realtime.to_regrole(role_name text) TO anon;
GRANT ALL ON FUNCTION realtime.to_regrole(role_name text) TO authenticated;
GRANT ALL ON FUNCTION realtime.to_regrole(role_name text) TO service_role;
GRANT ALL ON FUNCTION realtime.to_regrole(role_name text) TO supabase_realtime_admin;


--
-- Name: FUNCTION topic(); Type: ACL; Schema: realtime; Owner: supabase_realtime_admin
--

GRANT ALL ON FUNCTION realtime.topic() TO postgres;
GRANT ALL ON FUNCTION realtime.topic() TO dashboard_user;


--
-- Name: FUNCTION http_request(); Type: ACL; Schema: supabase_functions; Owner: supabase_functions_admin
--

REVOKE ALL ON FUNCTION supabase_functions.http_request() FROM PUBLIC;
GRANT ALL ON FUNCTION supabase_functions.http_request() TO postgres;
GRANT ALL ON FUNCTION supabase_functions.http_request() TO anon;
GRANT ALL ON FUNCTION supabase_functions.http_request() TO authenticated;
GRANT ALL ON FUNCTION supabase_functions.http_request() TO service_role;


--
-- Name: FUNCTION _crypto_aead_det_decrypt(message bytea, additional bytea, key_id bigint, context bytea, nonce bytea); Type: ACL; Schema: vault; Owner: supabase_admin
--

GRANT ALL ON FUNCTION vault._crypto_aead_det_decrypt(message bytea, additional bytea, key_id bigint, context bytea, nonce bytea) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION create_secret(new_secret text, new_name text, new_description text, new_key_id uuid); Type: ACL; Schema: vault; Owner: supabase_admin
--

GRANT ALL ON FUNCTION vault.create_secret(new_secret text, new_name text, new_description text, new_key_id uuid) TO postgres WITH GRANT OPTION;


--
-- Name: FUNCTION update_secret(secret_id uuid, new_secret text, new_name text, new_description text, new_key_id uuid); Type: ACL; Schema: vault; Owner: supabase_admin
--

GRANT ALL ON FUNCTION vault.update_secret(secret_id uuid, new_secret text, new_name text, new_description text, new_key_id uuid) TO postgres WITH GRANT OPTION;


--
-- Name: TABLE audit_log_entries; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON TABLE auth.audit_log_entries TO dashboard_user;
GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.audit_log_entries TO postgres;
GRANT SELECT ON TABLE auth.audit_log_entries TO postgres WITH GRANT OPTION;


--
-- Name: TABLE flow_state; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.flow_state TO postgres;
GRANT SELECT ON TABLE auth.flow_state TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.flow_state TO dashboard_user;


--
-- Name: TABLE identities; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.identities TO postgres;
GRANT SELECT ON TABLE auth.identities TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.identities TO dashboard_user;


--
-- Name: TABLE instances; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON TABLE auth.instances TO dashboard_user;
GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.instances TO postgres;
GRANT SELECT ON TABLE auth.instances TO postgres WITH GRANT OPTION;


--
-- Name: TABLE mfa_amr_claims; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.mfa_amr_claims TO postgres;
GRANT SELECT ON TABLE auth.mfa_amr_claims TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.mfa_amr_claims TO dashboard_user;


--
-- Name: TABLE mfa_challenges; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.mfa_challenges TO postgres;
GRANT SELECT ON TABLE auth.mfa_challenges TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.mfa_challenges TO dashboard_user;


--
-- Name: TABLE mfa_factors; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.mfa_factors TO postgres;
GRANT SELECT ON TABLE auth.mfa_factors TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.mfa_factors TO dashboard_user;


--
-- Name: TABLE one_time_tokens; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.one_time_tokens TO postgres;
GRANT SELECT ON TABLE auth.one_time_tokens TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.one_time_tokens TO dashboard_user;


--
-- Name: TABLE refresh_tokens; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON TABLE auth.refresh_tokens TO dashboard_user;
GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.refresh_tokens TO postgres;
GRANT SELECT ON TABLE auth.refresh_tokens TO postgres WITH GRANT OPTION;


--
-- Name: SEQUENCE refresh_tokens_id_seq; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON SEQUENCE auth.refresh_tokens_id_seq TO dashboard_user;
GRANT ALL ON SEQUENCE auth.refresh_tokens_id_seq TO postgres;


--
-- Name: TABLE saml_providers; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.saml_providers TO postgres;
GRANT SELECT ON TABLE auth.saml_providers TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.saml_providers TO dashboard_user;


--
-- Name: TABLE saml_relay_states; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.saml_relay_states TO postgres;
GRANT SELECT ON TABLE auth.saml_relay_states TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.saml_relay_states TO dashboard_user;


--
-- Name: TABLE schema_migrations; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON TABLE auth.schema_migrations TO dashboard_user;
GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.schema_migrations TO postgres;
GRANT SELECT ON TABLE auth.schema_migrations TO postgres WITH GRANT OPTION;


--
-- Name: TABLE sessions; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.sessions TO postgres;
GRANT SELECT ON TABLE auth.sessions TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.sessions TO dashboard_user;


--
-- Name: TABLE sso_domains; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.sso_domains TO postgres;
GRANT SELECT ON TABLE auth.sso_domains TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.sso_domains TO dashboard_user;


--
-- Name: TABLE sso_providers; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.sso_providers TO postgres;
GRANT SELECT ON TABLE auth.sso_providers TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.sso_providers TO dashboard_user;


--
-- Name: TABLE users; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON TABLE auth.users TO dashboard_user;
GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.users TO postgres;
GRANT SELECT ON TABLE auth.users TO postgres WITH GRANT OPTION;


--
-- Name: TABLE pg_stat_statements; Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON TABLE extensions.pg_stat_statements TO postgres WITH GRANT OPTION;


--
-- Name: TABLE pg_stat_statements_info; Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON TABLE extensions.pg_stat_statements_info TO postgres WITH GRANT OPTION;


--
-- Name: TABLE conversations; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.conversations TO anon;
GRANT ALL ON TABLE public.conversations TO authenticated;
GRANT ALL ON TABLE public.conversations TO service_role;


--
-- Name: TABLE shopping_list_items; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.shopping_list_items TO anon;
GRANT ALL ON TABLE public.shopping_list_items TO authenticated;
GRANT ALL ON TABLE public.shopping_list_items TO service_role;


--
-- Name: TABLE shopping_lists; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.shopping_lists TO anon;
GRANT ALL ON TABLE public.shopping_lists TO authenticated;
GRANT ALL ON TABLE public.shopping_lists TO service_role;


--
-- Name: TABLE users; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.users TO anon;
GRANT ALL ON TABLE public.users TO authenticated;
GRANT ALL ON TABLE public.users TO service_role;


--
-- Name: TABLE messages; Type: ACL; Schema: realtime; Owner: supabase_realtime_admin
--

GRANT ALL ON TABLE realtime.messages TO postgres;
GRANT ALL ON TABLE realtime.messages TO dashboard_user;
GRANT SELECT,INSERT,UPDATE ON TABLE realtime.messages TO anon;
GRANT SELECT,INSERT,UPDATE ON TABLE realtime.messages TO authenticated;
GRANT SELECT,INSERT,UPDATE ON TABLE realtime.messages TO service_role;


--
-- Name: TABLE schema_migrations; Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON TABLE realtime.schema_migrations TO postgres;
GRANT ALL ON TABLE realtime.schema_migrations TO dashboard_user;
GRANT SELECT ON TABLE realtime.schema_migrations TO anon;
GRANT SELECT ON TABLE realtime.schema_migrations TO authenticated;
GRANT SELECT ON TABLE realtime.schema_migrations TO service_role;
GRANT ALL ON TABLE realtime.schema_migrations TO supabase_realtime_admin;


--
-- Name: TABLE subscription; Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON TABLE realtime.subscription TO postgres;
GRANT ALL ON TABLE realtime.subscription TO dashboard_user;
GRANT SELECT ON TABLE realtime.subscription TO anon;
GRANT SELECT ON TABLE realtime.subscription TO authenticated;
GRANT SELECT ON TABLE realtime.subscription TO service_role;
GRANT ALL ON TABLE realtime.subscription TO supabase_realtime_admin;


--
-- Name: SEQUENCE subscription_id_seq; Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON SEQUENCE realtime.subscription_id_seq TO postgres;
GRANT ALL ON SEQUENCE realtime.subscription_id_seq TO dashboard_user;
GRANT USAGE ON SEQUENCE realtime.subscription_id_seq TO anon;
GRANT USAGE ON SEQUENCE realtime.subscription_id_seq TO authenticated;
GRANT USAGE ON SEQUENCE realtime.subscription_id_seq TO service_role;
GRANT ALL ON SEQUENCE realtime.subscription_id_seq TO supabase_realtime_admin;


--
-- Name: TABLE buckets; Type: ACL; Schema: storage; Owner: supabase_storage_admin
--

GRANT ALL ON TABLE storage.buckets TO anon;
GRANT ALL ON TABLE storage.buckets TO authenticated;
GRANT ALL ON TABLE storage.buckets TO service_role;
GRANT ALL ON TABLE storage.buckets TO postgres;


--
-- Name: TABLE migrations; Type: ACL; Schema: storage; Owner: supabase_storage_admin
--

GRANT ALL ON TABLE storage.migrations TO anon;
GRANT ALL ON TABLE storage.migrations TO authenticated;
GRANT ALL ON TABLE storage.migrations TO service_role;
GRANT ALL ON TABLE storage.migrations TO postgres;


--
-- Name: TABLE objects; Type: ACL; Schema: storage; Owner: supabase_storage_admin
--

GRANT ALL ON TABLE storage.objects TO anon;
GRANT ALL ON TABLE storage.objects TO authenticated;
GRANT ALL ON TABLE storage.objects TO service_role;
GRANT ALL ON TABLE storage.objects TO postgres;


--
-- Name: TABLE prefixes; Type: ACL; Schema: storage; Owner: supabase_storage_admin
--

GRANT ALL ON TABLE storage.prefixes TO service_role;
GRANT ALL ON TABLE storage.prefixes TO authenticated;
GRANT ALL ON TABLE storage.prefixes TO anon;


--
-- Name: TABLE s3_multipart_uploads; Type: ACL; Schema: storage; Owner: supabase_storage_admin
--

GRANT ALL ON TABLE storage.s3_multipart_uploads TO service_role;
GRANT SELECT ON TABLE storage.s3_multipart_uploads TO authenticated;
GRANT SELECT ON TABLE storage.s3_multipart_uploads TO anon;


--
-- Name: TABLE s3_multipart_uploads_parts; Type: ACL; Schema: storage; Owner: supabase_storage_admin
--

GRANT ALL ON TABLE storage.s3_multipart_uploads_parts TO service_role;
GRANT SELECT ON TABLE storage.s3_multipart_uploads_parts TO authenticated;
GRANT SELECT ON TABLE storage.s3_multipart_uploads_parts TO anon;


--
-- Name: TABLE hooks; Type: ACL; Schema: supabase_functions; Owner: supabase_functions_admin
--

GRANT ALL ON TABLE supabase_functions.hooks TO postgres;
GRANT ALL ON TABLE supabase_functions.hooks TO anon;
GRANT ALL ON TABLE supabase_functions.hooks TO authenticated;
GRANT ALL ON TABLE supabase_functions.hooks TO service_role;


--
-- Name: SEQUENCE hooks_id_seq; Type: ACL; Schema: supabase_functions; Owner: supabase_functions_admin
--

GRANT ALL ON SEQUENCE supabase_functions.hooks_id_seq TO postgres;
GRANT ALL ON SEQUENCE supabase_functions.hooks_id_seq TO anon;
GRANT ALL ON SEQUENCE supabase_functions.hooks_id_seq TO authenticated;
GRANT ALL ON SEQUENCE supabase_functions.hooks_id_seq TO service_role;


--
-- Name: TABLE migrations; Type: ACL; Schema: supabase_functions; Owner: supabase_functions_admin
--

GRANT ALL ON TABLE supabase_functions.migrations TO postgres;
GRANT ALL ON TABLE supabase_functions.migrations TO anon;
GRANT ALL ON TABLE supabase_functions.migrations TO authenticated;
GRANT ALL ON TABLE supabase_functions.migrations TO service_role;


--
-- Name: TABLE secrets; Type: ACL; Schema: vault; Owner: supabase_admin
--

GRANT SELECT,DELETE ON TABLE vault.secrets TO postgres WITH GRANT OPTION;


--
-- Name: TABLE decrypted_secrets; Type: ACL; Schema: vault; Owner: supabase_admin
--

GRANT SELECT,DELETE ON TABLE vault.decrypted_secrets TO postgres WITH GRANT OPTION;


--
-- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: auth; Owner: supabase_auth_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_auth_admin IN SCHEMA auth GRANT ALL ON SEQUENCES  TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_auth_admin IN SCHEMA auth GRANT ALL ON SEQUENCES  TO dashboard_user;


--
-- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: auth; Owner: supabase_auth_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_auth_admin IN SCHEMA auth GRANT ALL ON FUNCTIONS  TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_auth_admin IN SCHEMA auth GRANT ALL ON FUNCTIONS  TO dashboard_user;


--
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: auth; Owner: supabase_auth_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_auth_admin IN SCHEMA auth GRANT ALL ON TABLES  TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_auth_admin IN SCHEMA auth GRANT ALL ON TABLES  TO dashboard_user;


--
-- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: extensions; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA extensions GRANT ALL ON SEQUENCES  TO postgres WITH GRANT OPTION;


--
-- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: extensions; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA extensions GRANT ALL ON FUNCTIONS  TO postgres WITH GRANT OPTION;


--
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: extensions; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA extensions GRANT ALL ON TABLES  TO postgres WITH GRANT OPTION;


--
-- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: graphql; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON SEQUENCES  TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON SEQUENCES  TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON SEQUENCES  TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON SEQUENCES  TO service_role;


--
-- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: graphql; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON FUNCTIONS  TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON FUNCTIONS  TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON FUNCTIONS  TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON FUNCTIONS  TO service_role;


--
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: graphql; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON TABLES  TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON TABLES  TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON TABLES  TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON TABLES  TO service_role;


--
-- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: graphql_public; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON SEQUENCES  TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON SEQUENCES  TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON SEQUENCES  TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON SEQUENCES  TO service_role;


--
-- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: graphql_public; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON FUNCTIONS  TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON FUNCTIONS  TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON FUNCTIONS  TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON FUNCTIONS  TO service_role;


--
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: graphql_public; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON TABLES  TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON TABLES  TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON TABLES  TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON TABLES  TO service_role;


--
-- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: public; Owner: postgres
--

ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON SEQUENCES  TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON SEQUENCES  TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON SEQUENCES  TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON SEQUENCES  TO service_role;


--
-- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: public; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON SEQUENCES  TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON SEQUENCES  TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON SEQUENCES  TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON SEQUENCES  TO service_role;


--
-- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: public; Owner: postgres
--

ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON FUNCTIONS  TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON FUNCTIONS  TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON FUNCTIONS  TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON FUNCTIONS  TO service_role;


--
-- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: public; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON FUNCTIONS  TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON FUNCTIONS  TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON FUNCTIONS  TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON FUNCTIONS  TO service_role;


--
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: public; Owner: postgres
--

ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON TABLES  TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON TABLES  TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON TABLES  TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON TABLES  TO service_role;


--
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: public; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON TABLES  TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON TABLES  TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON TABLES  TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON TABLES  TO service_role;


--
-- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: realtime; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA realtime GRANT ALL ON SEQUENCES  TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA realtime GRANT ALL ON SEQUENCES  TO dashboard_user;


--
-- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: realtime; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA realtime GRANT ALL ON FUNCTIONS  TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA realtime GRANT ALL ON FUNCTIONS  TO dashboard_user;


--
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: realtime; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA realtime GRANT ALL ON TABLES  TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA realtime GRANT ALL ON TABLES  TO dashboard_user;


--
-- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: storage; Owner: postgres
--

ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON SEQUENCES  TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON SEQUENCES  TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON SEQUENCES  TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON SEQUENCES  TO service_role;


--
-- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: storage; Owner: postgres
--

ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON FUNCTIONS  TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON FUNCTIONS  TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON FUNCTIONS  TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON FUNCTIONS  TO service_role;


--
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: storage; Owner: postgres
--

ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON TABLES  TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON TABLES  TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON TABLES  TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON TABLES  TO service_role;


--
-- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: supabase_functions; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA supabase_functions GRANT ALL ON SEQUENCES  TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA supabase_functions GRANT ALL ON SEQUENCES  TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA supabase_functions GRANT ALL ON SEQUENCES  TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA supabase_functions GRANT ALL ON SEQUENCES  TO service_role;


--
-- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: supabase_functions; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA supabase_functions GRANT ALL ON FUNCTIONS  TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA supabase_functions GRANT ALL ON FUNCTIONS  TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA supabase_functions GRANT ALL ON FUNCTIONS  TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA supabase_functions GRANT ALL ON FUNCTIONS  TO service_role;


--
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: supabase_functions; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA supabase_functions GRANT ALL ON TABLES  TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA supabase_functions GRANT ALL ON TABLES  TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA supabase_functions GRANT ALL ON TABLES  TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA supabase_functions GRANT ALL ON TABLES  TO service_role;


--
-- Name: issue_graphql_placeholder; Type: EVENT TRIGGER; Schema: -; Owner: supabase_admin
--

CREATE EVENT TRIGGER issue_graphql_placeholder ON sql_drop
         WHEN TAG IN ('DROP EXTENSION')
   EXECUTE FUNCTION extensions.set_graphql_placeholder();


ALTER EVENT TRIGGER issue_graphql_placeholder OWNER TO supabase_admin;

--
-- Name: issue_pg_cron_access; Type: EVENT TRIGGER; Schema: -; Owner: supabase_admin
--

CREATE EVENT TRIGGER issue_pg_cron_access ON ddl_command_end
         WHEN TAG IN ('CREATE EXTENSION')
   EXECUTE FUNCTION extensions.grant_pg_cron_access();


ALTER EVENT TRIGGER issue_pg_cron_access OWNER TO supabase_admin;

--
-- Name: issue_pg_graphql_access; Type: EVENT TRIGGER; Schema: -; Owner: supabase_admin
--

CREATE EVENT TRIGGER issue_pg_graphql_access ON ddl_command_end
         WHEN TAG IN ('CREATE FUNCTION')
   EXECUTE FUNCTION extensions.grant_pg_graphql_access();


ALTER EVENT TRIGGER issue_pg_graphql_access OWNER TO supabase_admin;

--
-- Name: issue_pg_net_access; Type: EVENT TRIGGER; Schema: -; Owner: postgres
--

CREATE EVENT TRIGGER issue_pg_net_access ON ddl_command_end
         WHEN TAG IN ('CREATE EXTENSION')
   EXECUTE FUNCTION extensions.grant_pg_net_access();


ALTER EVENT TRIGGER issue_pg_net_access OWNER TO postgres;

--
-- Name: pgrst_ddl_watch; Type: EVENT TRIGGER; Schema: -; Owner: supabase_admin
--

CREATE EVENT TRIGGER pgrst_ddl_watch ON ddl_command_end
   EXECUTE FUNCTION extensions.pgrst_ddl_watch();


ALTER EVENT TRIGGER pgrst_ddl_watch OWNER TO supabase_admin;

--
-- Name: pgrst_drop_watch; Type: EVENT TRIGGER; Schema: -; Owner: supabase_admin
--

CREATE EVENT TRIGGER pgrst_drop_watch ON sql_drop
   EXECUTE FUNCTION extensions.pgrst_drop_watch();


ALTER EVENT TRIGGER pgrst_drop_watch OWNER TO supabase_admin;

--
-- PostgreSQL database dump complete
--




================================================
File: supabase/config.toml
================================================
# For detailed configuration reference documentation, visit:
# https://supabase.com/docs/guides/local-development/cli/config
# A string used to distinguish different Supabase projects on the same host. Defaults to the
# working directory name when running `supabase init`.
project_id = "ShopListeo"

[api]
enabled = true
# Port to use for the API URL.
port = 54321
# Schemas to expose in your API. Tables, views and stored procedures in this schema will get API
# endpoints. `public` and `graphql_public` schemas are included by default.
schemas = ["public", "graphql_public"]
# Extra schemas to add to the search_path of every request.
extra_search_path = ["public", "extensions"]
# The maximum number of rows returns from a view, table, or stored procedure. Limits payload size
# for accidental or malicious requests.
max_rows = 1000

[api.tls]
# Enable HTTPS endpoints locally using a self-signed certificate.
enabled = false

[db]
# Port to use for the local database URL.
port = 54322
# Port used by db diff command to initialize the shadow database.
shadow_port = 54320
# The database major version to use. This has to be the same as your remote database's. Run `SHOW
# server_version;` on the remote database to check.
major_version = 15

[db.pooler]
enabled = false
# Port to use for the local connection pooler.
port = 54329
# Specifies when a server connection can be reused by other clients.
# Configure one of the supported pooler modes: `transaction`, `session`.
pool_mode = "transaction"
# How many server connections to allow per user/database pair.
default_pool_size = 20
# Maximum number of client connections allowed.
max_client_conn = 100

# [db.vault]
# secret_key = "env(SECRET_VALUE)"

[db.migrations]
# Specifies an ordered list of schema files that describe your database.
# Supports glob patterns relative to supabase directory: "./schemas/*.sql"
schema_paths = []

[db.seed]
# If enabled, seeds the database after migrations during a db reset.
enabled = true
# Specifies an ordered list of seed files to load during db reset.
# Supports glob patterns relative to supabase directory: "./seeds/*.sql"
sql_paths = ["./seed.sql"]

[realtime]
enabled = true
# Bind realtime via either IPv4 or IPv6. (default: IPv4)
# ip_version = "IPv6"
# The maximum length in bytes of HTTP request headers. (default: 4096)
# max_header_length = 4096

[studio]
enabled = true
# Port to use for Supabase Studio.
port = 54323
# External URL of the API server that frontend connects to.
api_url = "http://127.0.0.1"
# OpenAI API Key to use for Supabase AI in the Supabase Studio.
openai_api_key = "env(OPENAI_API_KEY)"

# Email testing server. Emails sent with the local dev setup are not actually sent - rather, they
# are monitored, and you can view the emails that would have been sent from the web interface.
[inbucket]
enabled = true
# Port to use for the email testing server web interface.
port = 54324
# Uncomment to expose additional ports for testing user applications that send emails.
# smtp_port = 54325
# pop3_port = 54326
# admin_email = "admin@email.com"
# sender_name = "Admin"

[storage]
enabled = true
# The maximum file size allowed (e.g. "5MB", "500KB").
file_size_limit = "50MiB"

# Image transformation API is available to Supabase Pro plan.
# [storage.image_transformation]
# enabled = true

# Uncomment to configure local storage buckets
# [storage.buckets.images]
# public = false
# file_size_limit = "50MiB"
# allowed_mime_types = ["image/png", "image/jpeg"]
# objects_path = "./images"

[auth]
enabled = true
# The base URL of your website. Used as an allow-list for redirects and for constructing URLs used
# in emails.
site_url = "http://127.0.0.1:3000"
# A list of *exact* URLs that auth providers are permitted to redirect to post authentication.
additional_redirect_urls = ["https://127.0.0.1:3000"]
# How long tokens are valid for, in seconds. Defaults to 3600 (1 hour), maximum 604,800 (1 week).
jwt_expiry = 3600
# If disabled, the refresh token will never expire.
enable_refresh_token_rotation = true
# Allows refresh tokens to be reused after expiry, up to the specified interval in seconds.
# Requires enable_refresh_token_rotation = true.
refresh_token_reuse_interval = 10
# Allow/disallow new user signups to your project.
enable_signup = true
# Allow/disallow anonymous sign-ins to your project.
enable_anonymous_sign_ins = false
# Allow/disallow testing manual linking of accounts
enable_manual_linking = false
# Passwords shorter than this value will be rejected as weak. Minimum 6, recommended 8 or more.
minimum_password_length = 6
# Passwords that do not meet the following requirements will be rejected as weak. Supported values
# are: `letters_digits`, `lower_upper_letters_digits`, `lower_upper_letters_digits_symbols`
password_requirements = ""

[auth.rate_limit]
# Number of emails that can be sent per hour. Requires auth.email.smtp to be enabled.
email_sent = 2
# Number of SMS messages that can be sent per hour. Requires auth.sms to be enabled.
sms_sent = 30
# Number of anonymous sign-ins that can be made per hour per IP address. Requires enable_anonymous_sign_ins = true.
anonymous_users = 30
# Number of sessions that can be refreshed in a 5 minute interval per IP address.
token_refresh = 150
# Number of sign up and sign-in requests that can be made in a 5 minute interval per IP address (excludes anonymous users).
sign_in_sign_ups = 30
# Number of OTP / Magic link verifications that can be made in a 5 minute interval per IP address.
token_verifications = 30

# Configure one of the supported captcha providers: `hcaptcha`, `turnstile`.
# [auth.captcha]
# enabled = true
# provider = "hcaptcha"
# secret = ""

[auth.email]
# Allow/disallow new user signups via email to your project.
enable_signup = true
# If enabled, a user will be required to confirm any email change on both the old, and new email
# addresses. If disabled, only the new email is required to confirm.
double_confirm_changes = true
# If enabled, users need to confirm their email address before signing in.
enable_confirmations = false
# If enabled, users will need to reauthenticate or have logged in recently to change their password.
secure_password_change = false
# Controls the minimum amount of time that must pass before sending another signup confirmation or password reset email.
max_frequency = "1s"
# Number of characters used in the email OTP.
otp_length = 6
# Number of seconds before the email OTP expires (defaults to 1 hour).
otp_expiry = 3600

# Use a production-ready SMTP server
# [auth.email.smtp]
# enabled = true
# host = "smtp.sendgrid.net"
# port = 587
# user = "apikey"
# pass = "env(SENDGRID_API_KEY)"
# admin_email = "admin@email.com"
# sender_name = "Admin"

# Uncomment to customize email template
# [auth.email.template.invite]
# subject = "You have been invited"
# content_path = "./supabase/templates/invite.html"

[auth.sms]
# Allow/disallow new user signups via SMS to your project.
enable_signup = false
# If enabled, users need to confirm their phone number before signing in.
enable_confirmations = false
# Template for sending OTP to users
template = "Your code is {{ .Code }}"
# Controls the minimum amount of time that must pass before sending another sms otp.
max_frequency = "5s"

# Use pre-defined map of phone number to OTP for testing.
# [auth.sms.test_otp]
# 4152127777 = "123456"

# Configure logged in session timeouts.
# [auth.sessions]
# Force log out after the specified duration.
# timebox = "24h"
# Force log out if the user has been inactive longer than the specified duration.
# inactivity_timeout = "8h"

# This hook runs before a token is issued and allows you to add additional claims based on the authentication method used.
# [auth.hook.custom_access_token]
# enabled = true
# uri = "pg-functions://<database>/<schema>/<hook_name>"

# Configure one of the supported SMS providers: `twilio`, `twilio_verify`, `messagebird`, `textlocal`, `vonage`.
[auth.sms.twilio]
enabled = false
account_sid = ""
message_service_sid = ""
# DO NOT commit your Twilio auth token to git. Use environment variable substitution instead:
auth_token = "env(SUPABASE_AUTH_SMS_TWILIO_AUTH_TOKEN)"

# Multi-factor-authentication is available to Supabase Pro plan.
[auth.mfa]
# Control how many MFA factors can be enrolled at once per user.
max_enrolled_factors = 10

# Control MFA via App Authenticator (TOTP)
[auth.mfa.totp]
enroll_enabled = false
verify_enabled = false

# Configure MFA via Phone Messaging
[auth.mfa.phone]
enroll_enabled = false
verify_enabled = false
otp_length = 6
template = "Your code is {{ .Code }}"
max_frequency = "5s"

# Configure MFA via WebAuthn
# [auth.mfa.web_authn]
# enroll_enabled = true
# verify_enabled = true

# Use an external OAuth provider. The full list of providers are: `apple`, `azure`, `bitbucket`,
# `discord`, `facebook`, `github`, `gitlab`, `google`, `keycloak`, `linkedin_oidc`, `notion`, `twitch`,
# `twitter`, `slack`, `spotify`, `workos`, `zoom`.
[auth.external.apple]
enabled = false
client_id = ""
# DO NOT commit your OAuth provider secret to git. Use environment variable substitution instead:
secret = "env(SUPABASE_AUTH_EXTERNAL_APPLE_SECRET)"
# Overrides the default auth redirectUrl.
redirect_uri = ""
# Overrides the default auth provider URL. Used to support self-hosted gitlab, single-tenant Azure,
# or any other third-party OIDC providers.
url = ""
# If enabled, the nonce check will be skipped. Required for local sign in with Google auth.
skip_nonce_check = false

# Use Firebase Auth as a third-party provider alongside Supabase Auth.
[auth.third_party.firebase]
enabled = false
# project_id = "my-firebase-project"

# Use Auth0 as a third-party provider alongside Supabase Auth.
[auth.third_party.auth0]
enabled = false
# tenant = "my-auth0-tenant"
# tenant_region = "us"

# Use AWS Cognito (Amplify) as a third-party provider alongside Supabase Auth.
[auth.third_party.aws_cognito]
enabled = false
# user_pool_id = "my-user-pool-id"
# user_pool_region = "us-east-1"

# Use Clerk as a third-party provider alongside Supabase Auth.
[auth.third_party.clerk]
enabled = false
# Obtain from https://clerk.com/setup/supabase
# domain = "example.clerk.accounts.dev"

[edge_runtime]
enabled = true
# Configure one of the supported request policies: `oneshot`, `per_worker`.
# Use `oneshot` for hot reload, or `per_worker` for load testing.
policy = "oneshot"
# Port to attach the Chrome inspector for debugging edge functions.
inspector_port = 8083
# The Deno major version to use.
deno_version = 1

# [edge_runtime.secrets]
# secret_key = "env(SECRET_VALUE)"

[analytics]
enabled = true
port = 54327
# Configure one of the supported backends: `postgres`, `bigquery`.
backend = "postgres"

# Experimental features may be deprecated any time
[experimental]
# Configures Postgres storage engine to use OrioleDB (S3)
orioledb_version = ""
# Configures S3 bucket URL, eg. <bucket_name>.s3-<region>.amazonaws.com
s3_host = "env(S3_HOST)"
# Configures S3 bucket region, eg. us-east-1
s3_region = "env(S3_REGION)"
# Configures AWS_ACCESS_KEY_ID for S3 bucket
s3_access_key = "env(S3_ACCESS_KEY)"
# Configures AWS_SECRET_ACCESS_KEY for S3 bucket
s3_secret_key = "env(S3_SECRET_KEY)"



================================================
File: supabase/.gitignore
================================================
# Supabase
.branches
.temp

# dotenvx
.env.keys
.env.local
.env.*.local
.env.test


================================================
File: supabase/migrations/20240612130015_initial_schema.sql
================================================
-- Migration: initial_schema
-- Description: Creates the initial database schema with users, conversations, shopping lists, and items
-- Created at: 2024-06-12 13:00:15

-- users table
create table if not exists public.users (
  id uuid primary key default gen_random_uuid(),
  email varchar(128) not null unique,
  password_hash text not null,
  registration_date timestamp not null default current_timestamp,
  last_login_date timestamp,
  updated_date timestamp not null default current_timestamp
);

-- RLS disabled for MVP stage
-- enable row level security
-- alter table public.users enable row level security;

-- rls policies for users
-- create policy "Users can view their own data" 
--   on public.users 
--   for select 
--   to authenticated 
--   using (auth.uid() = id);

-- create policy "Users can update their own data" 
--   on public.users 
--   for update 
--   to authenticated 
--   using (auth.uid() = id);

-- conversations table
create table if not exists public.conversations (
  id uuid primary key default gen_random_uuid(),
  user_id uuid not null references public.users(id) on delete cascade,
  started_at timestamp not null default current_timestamp,
  ended_at timestamp,
  openai_thread_id text,
  answer_accepted boolean not null default false,
  messages jsonb
);

-- RLS disabled for MVP stage
-- enable row level security
-- alter table public.conversations enable row level security;

-- rls policies for conversations
-- create policy "Users can view their own conversations" 
--   on public.conversations 
--   for select 
--   to authenticated 
--   using (auth.uid() = user_id);

-- create policy "Users can insert their own conversations" 
--   on public.conversations 
--   for insert 
--   to authenticated 
--   with check (auth.uid() = user_id);

-- create policy "Users can update their own conversations" 
--   on public.conversations 
--   for update 
--   to authenticated 
--   using (auth.uid() = user_id);

-- create policy "Users can delete their own conversations" 
--   on public.conversations 
--   for delete 
--   to authenticated 
--   using (auth.uid() = user_id);

-- shopping_lists table
create table if not exists public.shopping_lists (
  id uuid primary key default gen_random_uuid(),
  user_id uuid not null references public.users(id) on delete cascade,
  title varchar(255) not null,
  created_at timestamp not null default current_timestamp,
  updated_at timestamp not null default current_timestamp
);

-- RLS disabled for MVP stage
-- enable row level security
-- alter table public.shopping_lists enable row level security;

-- rls policies for shopping_lists
-- create policy "Users can view their own shopping lists" 
--   on public.shopping_lists 
--   for select 
--   to authenticated 
--   using (auth.uid() = user_id);

-- create policy "Users can insert their own shopping lists" 
--   on public.shopping_lists 
--   for insert 
--   to authenticated 
--   with check (auth.uid() = user_id);

-- create policy "Users can update their own shopping lists" 
--   on public.shopping_lists 
--   for update 
--   to authenticated 
--   using (auth.uid() = user_id);

-- create policy "Users can delete their own shopping lists" 
--   on public.shopping_lists 
--   for delete 
--   to authenticated 
--   using (auth.uid() = user_id);

-- shopping_list_items table
create table if not exists public.shopping_list_items (
  id uuid primary key default gen_random_uuid(),
  shopping_list_id uuid not null references public.shopping_lists(id) on delete cascade,
  item_name text not null,
  purchased boolean not null default false,
  created_at timestamp not null default current_timestamp,
  updated_at timestamp not null default current_timestamp
);

-- RLS disabled for MVP stage
-- enable row level security
-- alter table public.shopping_list_items enable row level security;

-- rls policies for shopping_list_items
-- create policy "Users can view items from their shopping lists" 
--   on public.shopping_list_items 
--   for select 
--   to authenticated 
--   using (
--     shopping_list_id in (
--       select id from public.shopping_lists where user_id = auth.uid()
--     )
--   );

-- create policy "Users can insert items to their shopping lists" 
--   on public.shopping_list_items 
--   for insert 
--   to authenticated 
--   with check (
--     shopping_list_id in (
--       select id from public.shopping_lists where user_id = auth.uid()
--     )
--   );

-- create policy "Users can update items from their shopping lists" 
--   on public.shopping_list_items 
--   for update 
--   to authenticated 
--   using (
--     shopping_list_id in (
--       select id from public.shopping_lists where user_id = auth.uid()
--     )
--   );

-- create policy "Users can delete items from their shopping lists" 
--   on public.shopping_list_items 
--   for delete 
--   to authenticated 
--   using (
--     shopping_list_id in (
--       select id from public.shopping_lists where user_id = auth.uid()
--     )
--   );

-- add indexes to improve query performance
create index if not exists idx_conversations_user_id on public.conversations(user_id);
create index if not exists idx_shopping_lists_user_id on public.shopping_lists(user_id);
create index if not exists idx_shopping_list_items_shopping_list_id on public.shopping_list_items(shopping_list_id);

-- add triggers for updated_at columns
create or replace function trigger_set_timestamp()
returns trigger as $$
begin
  new.updated_at = current_timestamp;
  return new;
end;
$$ language plpgsql;

create trigger set_timestamp_users
before update on public.users
for each row
execute function trigger_set_timestamp();

create trigger set_timestamp_shopping_lists
before update on public.shopping_lists
for each row
execute function trigger_set_timestamp();

create trigger set_timestamp_shopping_list_items
before update on public.shopping_list_items
for each row
execute function trigger_set_timestamp(); 


================================================
File: supabase/migrations/20240620150045_add_admin_column.sql
================================================
-- Migration: add_admin_column
-- Description: Adds an admin boolean column to the users table to identify administrators
-- Created at: 2024-06-20 15:00:45

-- add admin column to users table with default value of false
-- this allows identification of users with administrative privileges
alter table public.users add column if not exists admin boolean not null default false;

-- add comment to explain the purpose of the column
comment on column public.users.admin is 'Identifies users with administrative privileges. Default is false for regular users.';

-- update existing comment on table if needed
comment on table public.users is 'Stores user accounts including regular users and administrators'; 


================================================
File: supabase/migrations/20240620151530_fix_user_timestamp_trigger.sql
================================================
-- Migration: fix_user_timestamp_trigger
-- Description: Fixes the issue with the trigger for updating timestamp on the users table
-- Created at: 2024-06-20 15:15:30

-- Problem: The trigger tries to update "updated_at" but users table has "updated_date"
-- Solution: Create a modified trigger function specifically for the users table

-- drop the existing trigger on users to avoid conflicts
drop trigger if exists set_timestamp_users on public.users;

-- create a specific trigger function for users table that uses updated_date instead of updated_at
create or replace function trigger_set_timestamp_users()
returns trigger as $$
begin
  new.updated_date = current_timestamp;
  return new;
end;
$$ language plpgsql;

-- create a new trigger with the correct function
create trigger set_timestamp_users
before update on public.users
for each row
execute function trigger_set_timestamp_users();

-- add comment to explain the fix
comment on function trigger_set_timestamp_users() is 'Updates the updated_date column to current timestamp on record update'; 


================================================
File: supabase/migrations/20250428090746_fix_apply_changes_function_schema.sql
================================================
    -- Upewnij się, że typ istnieje w schemacie public
    DO $$
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM pg_type t JOIN pg_namespace n ON t.typnamespace = n.oid WHERE t.typname = 'new_shopping_list_item' AND n.nspname = 'public') THEN
            CREATE TYPE public.new_shopping_list_item AS (
                item_name TEXT,
                purchased BOOLEAN
            );
        END IF;
    END$$;

    -- Poprawka: Jawne dodanie schematu 'public' do funkcji RPC
    CREATE OR REPLACE FUNCTION public.apply_shopping_list_changes(
        p_list_id UUID,            -- ID listy zakupów
        p_user_id UUID,            -- ID użytkownika (do weryfikacji uprawnień)
        items_to_add new_shopping_list_item[], -- Tablica obiektów do dodania
        items_to_delete UUID[]     -- Tablica UUID elementów do usunięcia
    )
    RETURNS VOID -- Funkcja nie zwraca wartości
    LANGUAGE plpgsql
    SECURITY INVOKER
    AS $$
    DECLARE
        list_owner_id UUID;
        item_to_add new_shopping_list_item;
    BEGIN
        -- 1. Weryfikacja uprawnień: Sprawdź, czy lista należy do użytkownika
        SELECT user_id INTO list_owner_id
        FROM public.shopping_lists
        WHERE id = p_list_id;

        IF list_owner_id IS NULL THEN
            RAISE EXCEPTION 'Shopping list with ID % not found', p_list_id;
        END IF;

        IF list_owner_id != p_user_id THEN
            RAISE EXCEPTION 'User % does not have permission to modify shopping list %', p_user_id, p_list_id;
        END IF;

        -- 2. Usunięcie elementów (jeśli są jakieś do usunięcia)
        IF array_length(items_to_delete, 1) > 0 THEN
            DELETE FROM public.shopping_list_items
            WHERE shopping_list_id = p_list_id
              AND id = ANY(items_to_delete);
        END IF;

        -- 3. Dodanie nowych elementów (jeśli są jakieś do dodania)
        IF array_length(items_to_add, 1) > 0 THEN
            FOREACH item_to_add IN ARRAY items_to_add
            LOOP
                INSERT INTO public.shopping_list_items (shopping_list_id, item_name, purchased)
                VALUES (p_list_id, item_to_add.item_name, item_to_add.purchased);
            END LOOP;
        END IF;
    END;
    $$;


================================================
File: supabase/migrations/23240612130015_create_user_sync_trigger.sql
================================================
-- Function to insert a new user into public.users when a user is created in auth.users
create or replace function public.handle_new_user()
returns trigger
language plpgsql
security definer set search_path = public
as $$
begin
  -- Ensure the table name 'users' matches your public table name
  insert into public.users (id, email)
  values (new.id, new.email);
  return new;
end;
$$;

-- Trigger to call handle_new_user function after a new user is inserted into auth.users
-- Drop trigger first if it exists to make the migration idempotent
drop trigger if exists on_auth_user_created on auth.users;

create trigger on_auth_user_created
  after insert on auth.users
  for each row execute procedure public.handle_new_user();


================================================
File: supabase/.branches/_current_branch
================================================
main


================================================
File: test-results/.last-run.json
================================================
{
  "status": "failed",
  "failedTests": []
}



================================================
File: .ai/admin-user-details-view-implementation-plan.md
================================================
# Plan implementacji widoku Szczegółów Użytkownika (Admin)

## 1. Przegląd
Widok Szczegółów Użytkownika (`AdminUserDetailView`) jest przeznaczony dla administratorów systemu. Pozwala na przeglądanie szczegółowych informacji o wybranym użytkowniku (e-mail, data rejestracji, data ostatniego logowania) oraz na edycję jego adresu e-mail i hasła. Umożliwia również usunięcie konta użytkownika. Widok jest częścią głównego layoutu aplikacji z nawigacją boczną specyficzną dla administratora.

## 2. Routing widoku
- **Ścieżka**: `/admin/users/:id`
- `:id` jest dynamicznym parametrem reprezentującym UUID użytkownika.

## 3. Struktura komponentów
```
AppLayout
└── SideNav (Admin variant)
└── AdminUserDetailView (Route: /admin/users/:id)
    ├── PageHeader (np. "Szczegóły Użytkownika: {email}")
    ├── UserInfoSection
    │   ├── DataField (Email)
    │   ├── DataField (Data Rejestracji)
    │   └── DataField (Ostatnie Logowanie)
    ├── EditUserForm
    │   ├── EmailInput (Shadcn Input)
    │   ├── PasswordInput (Shadcn Input - type="password")
    │   └── SubmitButton (Shadcn Button - "Aktualizuj Dane")
    └── DeleteUserSection
        └── DeleteUserButton (Shadcn Button - wariant destructive)
```

## 4. Szczegóły komponentów

### `AdminUserDetailView`
- **Opis**: Główny kontener widoku. Odpowiedzialny za pobranie danych użytkownika na podstawie `:id` z URL, zarządzanie stanem (ładowanie, błędy, edycja, usuwanie) oraz koordynację między komponentami podrzędnymi.
- **Główne elementy**: `PageHeader`, `UserInfoSection`, `EditUserForm`, `DeleteUserSection`, komponenty stanu ładowania/błędu.
- **Obsługiwane interakcje**: Inicjuje pobieranie danych przy montowaniu.
- **Obsługiwana walidacja**: Brak bezpośredniej, obsługuje błędy API.
- **Typy**: `AdminUserDetailViewModel`, `UserDTO`.
- **Propsy**: Brak (pobiera `:id` z parametrów routingu).

### `PageHeader`
- **Opis**: Wyświetla tytuł strony, dynamicznie wstawiając email edytowanego użytkownika.
- **Główne elementy**: `<h1>` lub podobny tag semantyczny.
- **Obsługiwane interakcje**: Brak.
- **Obsługiwana walidacja**: Brak.
- **Typy**: Brak.
- **Propsy**: `email: string | undefined`.

### `UserInfoSection`
- **Opis**: Sekcja wyświetlająca statyczne informacje o użytkowniku.
- **Główne elementy**: Komponenty `DataField` dla E-maila, Daty Rejestracji, Ostatniego Logowania.
- **Obsługiwane interakcje**: Brak.
- **Obsługiwana walidacja**: Brak.
- **Typy**: `UserDTO`.
- **Propsy**: `user: UserDTO | null`.

### `DataField`
- **Opis**: Prosty komponent do wyświetlania etykiety i wartości pola danych.
- **Główne elementy**: `div`, `span` (etykieta), `span` (wartość).
- **Obsługiwane interakcje**: Brak.
- **Obsługiwana walidacja**: Brak.
- **Typy**: Brak.
- **Propsy**: `label: string`, `value: string | null | undefined`.

### `EditUserForm`
- **Opis**: Formularz umożliwiający edycję adresu e-mail i hasła użytkownika. Powinien być zarządzany np. przez `react-hook-form`.
- **Główne elementy**: `form`, `EmailInput`, `PasswordInput`, `SubmitButton`.
- **Obsługiwane interakcje**: Wprowadzanie danych, `onSubmit`.
- **Obsługiwana walidacja**: Format adresu e-mail, złożoność hasła (jeśli jest wprowadzane).
- **Typy**: `UserDTO`, `UpdateUserRequest`, `UpdateUserResponse`.
- **Propsy**: `user: UserDTO`, `onSubmit: (data: UpdateUserRequest) => Promise<void>`, `isSubmitting: boolean`.

### `EmailInput` / `PasswordInput`
- **Opis**: Kontrolowane komponenty `Input` (Shadcn) zintegrowane z `react-hook-form`, wyświetlające błędy walidacji.
- **Główne elementy**: `Label`, `Input`, komunikat błędu (Shadcn).
- **Obsługiwane interakcje**: Wprowadzanie tekstu.
- **Obsługiwana walidacja**: Specyficzna dla pola (email/password).
- **Typy**: Zintegrowane z `react-hook-form`.
- **Propsy**: Rejestracja z `react-hook-form`, `label`.

### `SubmitButton`
- **Opis**: Przycisk wysyłający formularz edycji.
- **Główne elementy**: `Button` (Shadcn).
- **Obsługiwane interakcje**: `onClick` (wywołuje submit formularza).
- **Obsługiwana walidacja**: Brak.
- **Typy**: Brak.
- **Propsy**: `isSubmitting: boolean` (do wyłączania przycisku).

### `DeleteUserSection`
- **Opis**: Sekcja zawierająca przycisk do usuwania użytkownika.
- **Główne elementy**: `DeleteUserButton`.
- **Obsługiwane interakcje**: Brak.
- **Obsługiwana walidacja**: Brak.
- **Typy**: Brak.
- **Propsy**: `userId: string`, `userEmail: string`, `onDeleteUser: (userId: string) => Promise<void>`.

### `DeleteUserButton`
- **Opis**: Przycisk inicjujący proces usuwania użytkownika. Otwiera modal potwierdzający.
- **Główne elementy**: `Button` (Shadcn, wariant `destructive`).
- **Obsługiwane interakcje**: `onClick`.
- **Obsługiwana walidacja**: Brak.
- **Typy**: Brak.
- **Propsy**: `userId: string`, `userEmail: string`, `onConfirmDelete: (userId: string) => Promise<void>`, `isDeleting: boolean`.

## 5. Typy

- **Istniejące typy (z `src/types.ts`)**: `UserDTO`, `GetUserByIdResponse`, `UpdateUserRequest`, `UpdateUserResponse`.

- **Nowe typy ViewModel**:
  ```typescript
  // Model widoku dla szczegółów użytkownika (Admin)
  interface AdminUserDetailViewModel {
    user: UserDTO | null;       // Dane użytkownika lub null jeśli nie załadowano
    isLoading: boolean;         // Status ładowania danych
    isUpdating: boolean;        // Status aktualizacji danych
    isDeleting: boolean;        // Status usuwania użytkownika
    error: string | null;       // Komunikat błędu API (ogólny lub z operacji)
    updateFormError: string | null; // Błąd specyficzny dla formularza aktualizacji
  }
  ```

## 6. Zarządzanie stanem
- **Główny stan widoku** (`AdminUserDetailView`):
  - `viewModel: AdminUserDetailViewModel` - Przechowuje dane użytkownika i stany UI.
  - Będzie zarządzany przez custom hook `useAdminUserDetail`.
- **Custom Hook `useAdminUserDetail(userId: string)`**:
  - **Cel**: Hermetyzacja logiki pobierania danych użytkownika, aktualizacji, usuwania i zarządzania stanem.
  - **Stan wewnętrzny**: Zarządza `viewModel`.
  - **Funkcje API**: Implementuje funkcje do wywoływania endpointów API (`GET /api/users/:id`, `PUT /api/users/:id`, `DELETE /api/users/:id`).
  - **Aktualizacje stanu**: Aktualizuje `viewModel` w odpowiedzi na akcje administratora i odpowiedzi API.
  - **Obsługa błędów**: Przechwytuje błędy API i aktualizuje pola `error` lub `updateFormError`.
  - **Przekierowanie**: Po usunięciu użytkownika, hook może sygnalizować potrzebę przekierowania (np. do listy użytkowników).
- **Stan formularza** (`EditUserForm`):
  - Zarządzany przez `react-hook-form` do obsługi wartości pól, walidacji i stanu przesyłania.
- **Stan lokalny komponentów**:
  - `DeleteUserButton`: Stan zarządzania widocznością modala potwierdzającego.

## 7. Integracja API
- **Pobieranie danych**: Po zamontowaniu komponentu, hook `useAdminUserDetail` wywołuje `GET /api/users/:id` używając ID z parametrów routingu. Oczekiwana odpowiedź typu `GetUserByIdResponse`.
- **Aktualizacja danych**: Funkcja `updateUser` w hooku (wywołana po submicie `EditUserForm`) wywołuje `PUT /api/users/:id`. Oczekiwane żądanie typu `UpdateUserRequest`, odpowiedź `UpdateUserResponse`. Tylko zmienione pola (email i/lub password) powinny być wysyłane.
- **Usuwanie użytkownika**: Funkcja `deleteUser` w hooku (wywołana po potwierdzeniu w modalu) wywołuje `DELETE /api/users/:id`. Oczekiwana pusta odpowiedź (204).
- **Autoryzacja**: Wszystkie żądania muszą zawierać token JWT. Endpointy API same weryfikują uprawnienia administratora.

## 8. Interakcje użytkownika
- **Wprowadzanie danych w formularzu**: Aktualizuje stan `react-hook-form`.
- **Wysyłanie formularza edycji**: Wywołuje funkcję `updateUser` w hooku -> API PUT -> aktualizacja stanu -> notyfikacja sukcesu lub błędu.
- **Kliknięcie przycisku usuwania**: Otwiera modal potwierdzający.
- **Potwierdzenie usunięcia w modalu**: Wywołuje funkcję `deleteUser` w hooku -> API DELETE -> (po sukcesie) przekierowanie np. do `/admin/users` -> notyfikacja.

## 9. Warunki i walidacja
- **Formularz edycji**: Walidacja formatu e-maila, złożoności hasła (jeśli podane) przy użyciu `react-hook-form` i schematu Zod (zdefiniowanego w planie implementacji endpointów). Błędy wyświetlane przy polach.
- **Unikalność Emaila**: Walidacja po stronie serwera (API zwróci 409 Conflict).
- **Przyciski**: Przycisk "Aktualizuj Dane" wyłączony podczas wysyłania (`isSubmitting`). Przycisk "Usuń użytkownika" wyłączony podczas usuwania (`isDeleting`).
- **Widok**: Wyświetla stan ładowania (`isLoading`) lub komunikat o błędzie (`error`).
- **Autoryzacja**: Dostęp do widoku chroniony na poziomie routingu/middleware.

## 10. Obsługa błędów
- **Błąd pobierania użytkownika (np. 404, 401, 403, 500)**: Wyświetlić dedykowany komunikat błędu zamiast zawartości widoku.
- **Błąd aktualizacji (np. 400, 401, 403, 404, 409, 500)**: Wyświetlić powiadomienie (toast) z treścią błędu z API. W przypadku błędu walidacji (400) lub konfliktu (409), błąd powinien być również powiązany z formularzem (`updateFormError`).
- **Błąd usuwania (np. 401, 403, 404, 500)**: Wyświetlić powiadomienie (toast) z treścią błędu z API.

## 11. Kroki implementacji
1.  **Routing**: Skonfigurować routing w Astro, aby ścieżka `/admin/users/:id` renderowała komponent React `AdminUserDetailView` i była dostępna tylko dla administratorów.
2.  **Główny komponent (`AdminUserDetailView`)**: Stworzyć komponent, który pobiera `:id` z routingu.
3.  **Custom Hook (`useAdminUserDetail`)**: Zaimplementować hook do zarządzania stanem (`viewModel`) i logiką pobierania danych (`GET /api/users/:id`). Obsłużyć stany ładowania i błędu.
4.  **Renderowanie podstawowe**: W `AdminUserDetailView` użyć hooka i renderować `PageHeader`, `UserInfoSection`, `EditUserForm`, `DeleteUserSection`. Obsłużyć stan ładowania/błędu.
5.  **Komponent `UserInfoSection`**: Zaimplementować wyświetlanie statycznych danych użytkownika.
6.  **Komponent `EditUserForm`**: Zaimplementować formularz z `react-hook-form`, polami `EmailInput`, `PasswordInput` (pozostawienie pustego hasła nie powinno go zmieniać) i przyciskiem `SubmitButton`. Podłączyć walidację Zod. Podłączyć `onSubmit` do funkcji `updateUser` w hooku.
7.  **Logika aktualizacji**: Zaimplementować funkcję `updateUser` w hooku, która wywołuje `PUT /api/users/:id` tylko z polami, które zostały zmienione.
8.  **Komponent `DeleteUserSection` i `DeleteUserButton`**: Zaimplementować przycisk usuwania i integrację z modalem potwierdzającym.
9.  **Logika usuwania**: Zaimplementować funkcję `deleteUser` w hooku, która wywołuje `DELETE /api/users/:id` i obsługuje przekierowanie po sukcesie.
10. **Powiadomienia**: Zintegrować z globalnym systemem powiadomień (toastów) dla operacji aktualizacji i usuwania.
11. **Responsywność i Style**: Dopracować style Tailwind.
12. **Tryb Ciemny/Jasny**: Upewnić się, że komponenty poprawnie reagują na zmianę motywu.
13. **Testowanie**: Napisać testy jednostkowe dla logiki hooka, walidacji formularza oraz testy integracyjne dla całego widoku. 


================================================
File: .ai/admin-users-list-view-implementation-plan.md
================================================
# Plan implementacji widoku Listy Użytkowników (Admin)

## 1. Przegląd
Widok Listy Użytkowników (`AdminUsersListView`) jest głównym widokiem dla zalogowanego administratora. Wyświetla on listę wszystkich zarejestrowanych użytkowników systemu wraz z podstawowymi informacjami (e-mail, data rejestracji, data ostatniego logowania). Widok obsługuje paginację oraz wybór liczby elementów wyświetlanych na stronie. Umożliwia przejście do szczegółów konkretnego użytkownika. Jest częścią głównego layoutu aplikacji z nawigacją boczną specyficzną dla administratora.

## 2. Routing widoku
- **Ścieżka**: `/admin/users`

## 3. Struktura komponentów
```
AppLayout
└── SideNav (Admin variant)
└── AdminUsersListView (Route: /admin/users)
    ├── PageHeader (np. "Zarządzanie Użytkownikami")
    ├── UserListControls
    │   └── PageSizeSelector (Shadcn Select - 10, 20, 50)
    ├── UsersTable (Shadcn Table)
    │   ├── TableHeader (Kolumny: Email, Data Rejestracji, Ostatnie Logowanie)
    │   └── TableRow (mapped)
    │       ├── UserEmailLink
    │       ├── RegistrationDateCell
    │       └── LastLoginDateCell
    └── PaginationControls (Shadcn Pagination)
```

## 4. Szczegóły komponentów

### `AdminUsersListView`
- **Opis**: Główny kontener widoku. Odpowiedzialny za pobieranie listy użytkowników z paginacją, zarządzanie stanem (ładowanie, błędy, parametry paginacji) oraz przekazywanie danych do komponentów podrzędnych.
- **Główne elementy**: `PageHeader`, `UserListControls`, `UsersTable`, `PaginationControls`.
- **Obsługiwane interakcje**: Inicjuje pobieranie danych przy montowaniu, reaguje na zmiany paginacji i rozmiaru strony.
- **Obsługiwana walidacja**: Brak bezpośredniej walidacji, obsługuje stany błędów z API.
- **Typy**: `AdminUsersListViewModel`, `UserDTO`, `PaginationResponse`.
- **Propsy**: Brak.

### `PageHeader`
- **Opis**: Prosty komponent wyświetlający tytuł strony.
- **Główne elementy**: `<h1>` lub podobny tag semantyczny.
- **Obsługiwane interakcje**: Brak.
- **Obsługiwana walidacja**: Brak.
- **Typy**: Brak.
- **Propsy**: `title: string`.

### `UserListControls`
- **Opis**: Kontener na kontrolki listy, np. wybór rozmiaru strony.
- **Główne elementy**: `PageSizeSelector`.
- **Obsługiwane interakcje**: Brak.
- **Obsługiwana walidacja**: Brak.
- **Typy**: Brak.
- **Propsy**: `pageSize: number`, `onPageSizeChange: (newPageSize: number) => void`.

### `PageSizeSelector`
- **Opis**: Komponent `Select` z Shadcn/ui pozwalający wybrać liczbę użytkowników na stronie (10, 20, 50).
- **Główne elementy**: `Select`, `SelectTrigger`, `SelectContent`, `SelectItem` (Shadcn).
- **Obsługiwane interakcje**: Zmiana wybranej wartości.
- **Obsługiwana walidacja**: Brak.
- **Typy**: Brak.
- **Propsy**: `value: number`, `onChange: (newValue: number) => void`.

### `UsersTable`
- **Opis**: Tabela (Shadcn `Table`) wyświetlająca listę użytkowników.
- **Główne elementy**: `Table`, `TableHeader`, `TableRow`, `TableHead`, `TableBody`, `TableCell` (Shadcn). Renderuje `TableRow` dla każdego użytkownika.
- **Obsługiwane interakcje**: Brak bezpośrednich interakcji.
- **Obsługiwana walidacja**: Brak.
- **Typy**: `UserDTO[]`.
- **Propsy**: `users: UserDTO[]`, `isLoading: boolean` (do wyświetlania stanu ładowania w tabeli, np. skeleton rows).

### `TableRow` (wewnątrz `UsersTable`)
- **Opis**: Reprezentuje pojedynczy wiersz w tabeli użytkowników.
- **Główne elementy**: `TableRow`, `TableCell` (Shadcn) dla każdej kolumny, `UserEmailLink`, `RegistrationDateCell`, `LastLoginDateCell`.
- **Obsługiwane interakcje**: Kliknięcie w email użytkownika (nawigacja).
- **Obsługiwana walidacja**: Brak.
- **Typy**: `UserDTO`.
- **Propsy**: `user: UserDTO`.

### `UserEmailLink`
- **Opis**: Wyświetla email użytkownika jako link nawigujący do szczegółów tego użytkownika.
- **Główne elementy**: Komponent Link z Astro/React Router (`<a href={`/admin/users/${userId}`}>`).
- **Obsługiwane interakcje**: Kliknięcie.
- **Obsługiwana walidacja**: Brak.
- **Typy**: Brak.
- **Propsy**: `userId: string`, `email: string`.

### `RegistrationDateCell` / `LastLoginDateCell`
- **Opis**: Komponenty (lub prosta logika w `TableCell`) formatujące i wyświetlające datę.
- **Główne elementy**: `TableCell` (Shadcn).
- **Obsługiwane interakcje**: Brak.
- **Obsługiwana walidacja**: Brak.
- **Typy**: Brak.
- **Propsy**: `date: string | null`.

### `PaginationControls`
- **Opis**: Komponent paginacji (Shadcn `Pagination`) umożliwiający nawigację między stronami wyników.
- **Główne elementy**: Komponenty Shadcn `Pagination`.
- **Obsługiwane interakcje**: Kliknięcie na numery stron, przyciski "Następna"/"Poprzednia".
- **Obsługiwana walidacja**: Brak.
- **Typy**: `PaginationResponse`.
- **Propsy**: `pagination: PaginationResponse`, `onPageChange: (newPage: number) => void`.

## 5. Typy

- **Istniejące typy (z `src/types.ts`)**: `UserDTO`, `GetAllUsersResponse`, `PaginationResponse`.

- **Nowe typy ViewModel**:
  ```typescript
  // Model widoku dla widoku listy użytkowników administratora
  interface AdminUsersListViewModel {
    users: UserDTO[];                 // Lista użytkowników na bieżącej stronie
    isLoading: boolean;             // Status ładowania danych
    error: string | null;           // Komunikat błędu API
    pagination: PaginationResponse | null; // Informacje o paginacji
    currentPage: number;            // Aktualnie wybrana strona
    pageSize: number;               // Aktualnie wybrany rozmiar strony
    // Opcjonalnie można dodać sortowanie i filtrowanie, jeśli będzie potrzebne w przyszłości
    // sortField: string | null;
    // sortOrder: 'asc' | 'desc' | null;
    // emailFilter: string | null;
  }
  ```

## 6. Zarządzanie stanem
- **Główny stan widoku** (`AdminUsersListView`):
  - `viewModel: AdminUsersListViewModel` - Przechowuje dane użytkowników, stan UI i parametry paginacji.
  - Będzie zarządzany przez custom hook `useAdminUsersList`.
- **Custom Hook `useAdminUsersList()`**:
  - **Cel**: Hermetyzacja logiki pobierania listy użytkowników, zarządzania paginacją i stanem widoku.
  - **Stan wewnętrzny**: Zarządza `viewModel`, w tym `isLoading`, `error`, `users`, `pagination`, `currentPage`, `pageSize`.
  - **Funkcje API**: Implementuje funkcję do wywoływania endpointu `GET /api/users` z odpowiednimi parametrami zapytania.
  - **Aktualizacje stanu**: Aktualizuje `viewModel` w odpowiedzi na zmiany strony (`onPageChange`), rozmiaru strony (`onPageSizeChange`) oraz po otrzymaniu odpowiedzi z API.
  - **Obsługa błędów**: Przechwytuje błędy API i aktualizuje pole `error` w `viewModel`.
- **Stan lokalny komponentów**: Brak znaczącego stanu lokalnego poza wewnętrznym stanem komponentów Shadcn.

## 7. Integracja API
- **Pobieranie danych**: Hook `useAdminUsersList` wywołuje `GET /api/users` przy montowaniu komponentu oraz przy zmianie strony lub rozmiaru strony. Parametry `page` i `pageSize` są dynamicznie dołączane do zapytania. Oczekiwana odpowiedź typu `GetAllUsersResponse`.
- **Sortowanie/Filtrowanie (przyszłość)**: Jeśli zostaną dodane, hook będzie przekazywał również parametry `sort`, `order`, `emailFilter` do API.
- **Autoryzacja**: Żądanie musi zawierać token JWT. Endpoint API `/api/users` sam weryfikuje uprawnienia administratora.

## 8. Interakcje użytkownika
- **Zmiana rozmiaru strony**: Użytkownik wybiera nową wartość w `PageSizeSelector`. Wywołuje to `onPageSizeChange` -> aktualizacja stanu w hooku -> ponowne pobranie danych z API z nowym `pageSize` (i `page=1`).
- **Zmiana strony**: Użytkownik klika na numer strony lub przycisk w `PaginationControls`. Wywołuje to `onPageChange` -> aktualizacja stanu w hooku -> ponowne pobranie danych z API z nowym `page`.
- **Kliknięcie w email użytkownika**: Nawigacja do widoku `/admin/users/:id`.

## 9. Warunki i walidacja
- **Widok**: Wyświetla stan ładowania (`isLoading`, np. skeletony w tabeli) lub komunikat o błędzie (`error`).
- **Paginacja**: Kontrolki paginacji są aktywne/nieaktywne w zależności od `currentPage` i `totalPages`.
- **Autoryzacja**: Dostęp do całego widoku jest chroniony na poziomie routingu/middleware, tylko dla administratorów.

## 10. Obsługa błędów
- **Błąd pobierania użytkowników (np. 401, 403, 500)**: Wyświetlić dedykowany komunikat błędu zamiast tabeli użytkowników.
- **Błąd parametrów zapytania (np. 400)**: Teoretycznie nie powinien wystąpić przy poprawnym zarządzaniu stanem w hooku, ale na wszelki wypadek można wyświetlić ogólny błąd.

## 11. Kroki implementacji
1.  **Routing**: Skonfigurować routing w Astro, aby ścieżka `/admin/users` renderowała komponent React `AdminUsersListView` i była dostępna tylko dla administratorów.
2.  **Główny komponent (`AdminUsersListView`)**: Stworzyć komponent.
3.  **Custom Hook (`useAdminUsersList`)**: Zaimplementować hook do zarządzania stanem (`viewModel`) i logiką pobierania danych (`GET /api/users`) z obsługą paginacji.
4.  **Renderowanie podstawowe**: W `AdminUsersListView` użyć hooka i renderować `PageHeader`, `UserListControls`, `UsersTable`, `PaginationControls`.
5.  **Komponent `UserListControls` i `PageSizeSelector`**: Zaimplementować wybór rozmiaru strony i podłączyć do funkcji w hooku.
6.  **Komponent `UsersTable`**: Zaimplementować tabelę Shadcn z odpowiednimi kolumnami. Renderować `TableRow` dla każdego użytkownika, przekazując dane. Obsłużyć stan `isLoading`.
7.  **Komponenty komórek tabeli (`UserEmailLink`, `...DateCell`)**: Zaimplementować linkowanie do szczegółów użytkownika i formatowanie dat.
8.  **Komponent `PaginationControls`**: Zaimplementować paginację Shadcn i podłączyć do funkcji zmiany strony w hooku.
9.  **Obsługa błędów**: Zaimplementować wyświetlanie komunikatów o błędach API.
10. **Responsywność i Style**: Dopracować style Tailwind, zapewnić responsywność tabeli i kontrolek.
11. **Tryb Ciemny/Jasny**: Upewnić się, że komponenty poprawnie reagują na zmianę motywu.
12. **Testowanie**: Napisać testy jednostkowe dla logiki hooka oraz testy integracyjne dla całego widoku, w tym paginacji i zmiany rozmiaru strony. 


================================================
File: .ai/api-plan.md
================================================
# REST API Plan

## 1. Resources
- **Users** - maps to `users` table
- **Authentication** - handles user registration and login
- **Shopping Lists** - maps to `shopping_lists` table
- **Shopping List Items** - maps to `shopping_list_items` table

## 2. Endpoints

### Authentication

#### Register User
- **Method**: POST
- **Path**: `/api/auth/register`
- **Description**: Register a new user in the system
- **Request Body**:
  ```json
  {
    "email": "string",
    "password": "string"
  }
  ```
- **Response Body**:
  ```json
  {
    "id": "uuid",
    "email": "string",
    "registrationDate": "timestamp",
    "token": "string"
  }
  ```
- **Success Codes**: 201 Created
- **Error Codes**:
  - 400 Bad Request - Invalid input
  - 409 Conflict - Email already exists

#### Login User
- **Method**: POST
- **Path**: `/api/auth/login`
- **Description**: Authenticate a user and receive an access token
- **Request Body**:
  ```json
  {
    "email": "string",
    "password": "string"
  }
  ```
- **Response Body**:
  ```json
  {
    "id": "uuid",
    "email": "string",
    "token": "string"
  }
  ```
- **Success Codes**: 200 OK
- **Error Codes**:
  - 400 Bad Request - Invalid input
  - 401 Unauthorized - Invalid credentials

### Users

#### Get All Users
- **Method**: GET
- **Path**: `/api/users`
- **Description**: Retrieve a list of all users (admin only)
- **Query Parameters**:
  - `page` (integer, default: 1) - Page number
  - `pageSize` (integer, default: 20) - Number of items per page
  - `sort` (string, optional) - Field to sort by (email, registrationDate)
  - `order` (string, optional) - Sort order (asc, desc)
  - `emailFilter` (string, optional) - Filter by email pattern
- **Response Body**:
  ```json
  {
    "data": [
      {
        "id": "uuid",
        "email": "string",
        "registrationDate": "timestamp",
        "lastLoginDate": "timestamp"
      }
    ],
    "pagination": {
      "totalItems": "integer",
      "totalPages": "integer",
      "currentPage": "integer",
      "pageSize": "integer"
    }
  }
  ```
- **Success Codes**: 200 OK
- **Error Codes**:
  - 401 Unauthorized - Not authenticated
  - 403 Forbidden - Not authorized (non-admin)

#### Get User by ID
- **Method**: GET
- **Path**: `/api/users/{id}`
- **Description**: Retrieve a specific user by ID
- **Response Body**:
  ```json
  {
    "id": "uuid",
    "email": "string",
    "registrationDate": "timestamp",
    "lastLoginDate": "timestamp"
  }
  ```
- **Success Codes**: 200 OK
- **Error Codes**:
  - 401 Unauthorized - Not authenticated
  - 403 Forbidden - Not authorized
  - 404 Not Found - User not found

#### Update User
- **Method**: PUT
- **Path**: `/api/users/{id}`
- **Description**: Update a user's information
- **Request Body**:
  ```json
  {
    "email": "string",
    "password": "string"
  }
  ```
- **Response Body**:
  ```json
  {
    "id": "uuid",
    "email": "string",
    "updatedDate": "timestamp"
  }
  ```
- **Success Codes**: 200 OK
- **Error Codes**:
  - 400 Bad Request - Invalid input
  - 401 Unauthorized - Not authenticated
  - 403 Forbidden - Not authorized
  - 404 Not Found - User not found
  - 409 Conflict - Email already exists

#### Delete User
- **Method**: DELETE
- **Path**: `/api/users/{id}`
- **Description**: Delete a user account
- **Response Body**: No content
- **Success Codes**: 204 No Content
- **Error Codes**:
  - 401 Unauthorized - Not authenticated
  - 403 Forbidden - Not authorized
  - 404 Not Found - User not found

### Shopping Lists

#### Get All Shopping Lists
- **Method**: GET
- **Path**: `/api/shopping-lists`
- **Description**: Retrieve all shopping lists belonging to the authenticated user
- **Query Parameters**:
  - `page` (integer, default: 1) - Page number
  - `pageSize` (integer, default: 20) - Number of items per page
  - `sort` (string, optional) - Field to sort by (title, createdAt, updatedAt)
  - `order` (string, optional) - Sort order (asc, desc)
- **Response Body**:
  ```json
  {
    "data": [
      {
        "id": "uuid",
        "title": "string",
        "createdAt": "timestamp",
        "updatedAt": "timestamp",
        "itemCount": "integer"
      }
    ],
    "pagination": {
      "totalItems": "integer",
      "totalPages": "integer",
      "currentPage": "integer",
      "pageSize": "integer"
    }
  }
  ```
- **Success Codes**: 200 OK
- **Error Codes**:
  - 401 Unauthorized - Not authenticated

#### Get Shopping List by ID
- **Method**: GET
- **Path**: `/api/shopping-lists/{id}`
- **Description**: Retrieve a specific shopping list with its items
- **Response Body**:
  ```json
  {
    "id": "uuid",
    "title": "string",
    "createdAt": "timestamp",
    "updatedAt": "timestamp",
    "items": [
      {
        "id": "uuid",
        "itemName": "string",
        "purchased": "boolean",
        "createdAt": "timestamp",
        "updatedAt": "timestamp"
      }
    ]
  }
  ```
- **Success Codes**: 200 OK
- **Error Codes**:
  - 401 Unauthorized - Not authenticated
  - 403 Forbidden - Not authorized (not owner)
  - 404 Not Found - List not found

#### Create Shopping List
- **Method**: POST
- **Path**: `/api/shopping-lists`
- **Description**: Create a new shopping list
- **Request Body**:
  ```json
  {
    "title": "string"
  }
  ```
- **Response Body**:
  ```json
  {
    "id": "uuid",
    "title": "string",
    "createdAt": "timestamp",
    "updatedAt": "timestamp"
  }
  ```
- **Success Codes**: 201 Created
- **Error Codes**:
  - 400 Bad Request - Invalid input
  - 401 Unauthorized - Not authenticated

#### Update Shopping List
- **Method**: PUT
- **Path**: `/api/shopping-lists/{id}`
- **Description**: Update a shopping list's title
- **Request Body**:
  ```json
  {
    "title": "string"
  }
  ```
- **Response Body**:
  ```json
  {
    "id": "uuid",
    "title": "string",
    "updatedAt": "timestamp"
  }
  ```
- **Success Codes**: 200 OK
- **Error Codes**:
  - 400 Bad Request - Invalid input
  - 401 Unauthorized - Not authenticated
  - 403 Forbidden - Not authorized (not owner)
  - 404 Not Found - List not found

#### Delete Shopping List
- **Method**: DELETE
- **Path**: `/api/shopping-lists/{id}`
- **Description**: Delete a shopping list and all its items
- **Response Body**: No content
- **Success Codes**: 204 No Content
- **Error Codes**:
  - 401 Unauthorized - Not authenticated
  - 403 Forbidden - Not authorized (not owner)
  - 404 Not Found - List not found

### Shopping List Items

#### Get All Items in a Shopping List
- **Method**: GET
- **Path**: `/api/shopping-lists/{listId}/items`
- **Description**: Retrieve all items in a specific shopping list
- **Query Parameters**:
  - `purchased` (boolean, optional) - Filter by purchase status
  - `sort` (string, optional) - Field to sort by (itemName, purchased, createdAt)
  - `order` (string, optional) - Sort order (asc, desc)
- **Response Body**:
  ```json
  {
    "data": [
      {
        "id": "uuid",
        "itemName": "string",
        "purchased": "boolean",
        "createdAt": "timestamp",
        "updatedAt": "timestamp"
      }
    ]
  }
  ```
- **Success Codes**: 200 OK
- **Error Codes**:
  - 401 Unauthorized - Not authenticated
  - 403 Forbidden - Not authorized (not owner)
  - 404 Not Found - List not found

#### Get Shopping List Item by ID
- **Method**: GET
- **Path**: `/api/shopping-lists/{listId}/items/{itemId}`
- **Description**: Retrieve a specific item from a shopping list
- **Response Body**:
  ```json
  {
    "id": "uuid",
    "itemName": "string",
    "purchased": "boolean",
    "createdAt": "timestamp",
    "updatedAt": "timestamp"
  }
  ```
- **Success Codes**: 200 OK
- **Error Codes**:
  - 401 Unauthorized - Not authenticated
  - 403 Forbidden - Not authorized (not owner)
  - 404 Not Found - List or item not found

#### Add Item to Shopping List
- **Method**: POST
- **Path**: `/api/shopping-lists/{listId}/items`
- **Description**: Add a new item to a shopping list
- **Request Body**:
  ```json
  {
    "itemName": "string",
    "purchased": "boolean" // optional, defaults to false
  }
  ```
- **Response Body**:
  ```json
  {
    "id": "uuid",
    "itemName": "string",
    "purchased": "boolean",
    "createdAt": "timestamp",
    "updatedAt": "timestamp"
  }
  ```
- **Success Codes**: 201 Created
- **Error Codes**:
  - 400 Bad Request - Invalid input
  - 401 Unauthorized - Not authenticated
  - 403 Forbidden - Not authorized (not owner)
  - 404 Not Found - List not found

#### Update Shopping List Item
- **Method**: PUT
- **Path**: `/api/shopping-lists/{listId}/items/{itemId}`
- **Description**: Update a shopping list item
- **Request Body**:
  ```json
  {
    "itemName": "string", // optional
    "purchased": "boolean" // optional
  }
  ```
- **Response Body**:
  ```json
  {
    "id": "uuid",
    "itemName": "string",
    "purchased": "boolean",
    "updatedAt": "timestamp"
  }
  ```
- **Success Codes**: 200 OK
- **Error Codes**:
  - 400 Bad Request - Invalid input
  - 401 Unauthorized - Not authenticated
  - 403 Forbidden - Not authorized (not owner)
  - 404 Not Found - List or item not found

#### Delete Shopping List Item
- **Method**: DELETE
- **Path**: `/api/shopping-lists/{listId}/items/{itemId}`
- **Description**: Remove an item from a shopping list
- **Response Body**: No content
- **Success Codes**: 204 No Content
- **Error Codes**:
  - 401 Unauthorized - Not authenticated
  - 403 Forbidden - Not authorized (not owner)
  - 404 Not Found - List or item not found

#### Bulk Update Items
- **Method**: PATCH
- **Path**: `/api/shopping-lists/{listId}/items`
- **Description**: Update multiple items in a shopping list at once
- **Request Body**:
  ```json
  {
    "items": [
      {
        "id": "uuid",
        "purchased": "boolean"
      }
    ]
  }
  ```
- **Response Body**:
  ```json
  {
    "updatedCount": "integer",
    "updatedAt": "timestamp"
  }
  ```
- **Success Codes**: 200 OK
- **Error Codes**:
  - 400 Bad Request - Invalid input
  - 401 Unauthorized - Not authenticated
  - 403 Forbidden - Not authorized (not owner)
  - 404 Not Found - List not found

## 3. Authentication and Authorization

The API will use JWT (JSON Web Token) based authentication implemented through Supabase Auth.

### Authentication Flow
1. Users register or login through the `/api/auth` endpoints
2. Upon successful authentication, a JWT token is returned
3. For subsequent requests, clients must include this token in the Authorization header:
   `Authorization: Bearer {token}`

### Authorization Rules
- Users can only access and modify their own resources (shopping lists and items)
- Admin users can access the user management endpoints
- Unauthenticated requests are rejected with 401 Unauthorized responses
- Requests to resources owned by other users are rejected with 403 Forbidden responses

## 4. Validation and Business Logic

### User Validation
- Email must be a valid format
- Email must be unique in the system
- Password must meet security requirements (minimum 8 characters, combination of letters, numbers, and special characters)
- Passwords are stored as secure hashes, not plaintext

### Shopping List Validation
- Title is required and must be between 1-255 characters
- Each user can have multiple shopping lists
- Shopping lists are private to their owners

### Shopping List Item Validation
- Item name is required
- Items can only belong to one shopping list
- Purchase status is a boolean flag (true/false)

### Business Logic Implementation
- When a user is deleted, all associated shopping lists and items are automatically deleted (CASCADE)
- Shopping list creation date and updated date are automatically managed
- Item creation date and updated date are automatically managed
- API endpoints support filtering, sorting, and pagination where appropriate
- The system enforces ownership validation to ensure users can only access their own data 


================================================
File: .ai/auth-endpoint-implementation-plan.md
================================================
# API Endpoint Implementation Plan: Rejestracja i Logowanie Użytkownika

## 1. Przegląd punktów końcowych

### Endpoint rejestracji (`/api/auth/register`)
Endpoint służący do rejestracji nowych użytkowników w systemie. Przyjmuje dane rejestracyjne, waliduje je, tworzy nowe konto użytkownika i zwraca token dostępowy.

### Endpoint logowania (`/api/auth/login`)
Endpoint służący do uwierzytelniania istniejących użytkowników. Przyjmuje dane logowania, weryfikuje je i zwraca token dostępowy.

## 2. Szczegóły żądania

### Rejestracja użytkownika
- **Metoda HTTP**: POST
- **Struktura URL**: `/api/auth/register`
- **Parametry**: Brak
- **Request Body**:
  ```typescript
  {
    email: string;    // Adres email użytkownika
    password: string; // Hasło użytkownika
  }
  ```

### Logowanie użytkownika
- **Metoda HTTP**: POST
- **Struktura URL**: `/api/auth/login`
- **Parametry**: Brak
- **Request Body**:
  ```typescript
  {
    email: string;    // Adres email użytkownika
    password: string; // Hasło użytkownika
  }
  ```

## 3. Wykorzystywane typy

```typescript
// Requestu rejestracji
export interface RegisterUserRequest {
  email: string;
  password: string;
}

// Odpowiedzi rejestracji
export interface RegisterUserResponse {
  id: string;
  email: string;
  registrationDate: string;
  token: string;
}

// Requestu logowania
export interface LoginUserRequest {
  email: string;
  password: string;
}

// Odpowiedzi logowania
export interface LoginUserResponse {
  id: string;
  email: string;
  token: string;
}

// Schemat walidacji Zod dla rejestracji
const registerUserSchema = z.object({
  email: z.string().email({ message: "Podaj poprawny adres email" }),
  password: z
    .string()
    .min(8, { message: "Hasło musi zawierać co najmniej 8 znaków" })
    .regex(/.*[A-Z].*/, { message: "Hasło musi zawierać co najmniej jedną wielką literę" })
    .regex(/.*[a-z].*/, { message: "Hasło musi zawierać co najmniej jedną małą literę" })
    .regex(/.*\d.*/, { message: "Hasło musi zawierać co najmniej jedną cyfrę" })
    .regex(/.*[!@#$%^&*()_+{}\[\]:;<>,.?~\\/-].*/, { 
      message: "Hasło musi zawierać co najmniej jeden znak specjalny" 
    })
});

// Schemat walidacji Zod dla logowania
const loginUserSchema = z.object({
  email: z.string().email({ message: "Podaj poprawny adres email" }),
  password: z.string().min(1, { message: "Podaj hasło" })
});
```

## 4. Szczegóły odpowiedzi

### Rejestracja użytkownika (sukces)
- **Kod statusu**: 201 Created
- **Odpowiedź**:
  ```typescript
  {
    id: string;              // UUID nowego użytkownika
    email: string;           // Potwierdzenie adresu email
    registrationDate: string; // Data rejestracji w formacie ISO 8601
    token: string;           // JWT token uwierzytelniający
  }
  ```

### Rejestracja użytkownika (błąd)
- **Kod statusu**: 400 Bad Request (nieprawidłowe dane) lub 409 Conflict (email już istnieje)
- **Odpowiedź**:
  ```typescript
  {
    error: string;           // Ogólny opis błędu
    details?: string[];      // Opcjonalne szczegóły błędów walidacji
  }
  ```

### Logowanie użytkownika (sukces)
- **Kod statusu**: 200 OK
- **Odpowiedź**:
  ```typescript
  {
    id: string;              // UUID użytkownika
    email: string;           // Adres email użytkownika
    token: string;           // JWT token uwierzytelniający
  }
  ```

### Logowanie użytkownika (błąd)
- **Kod statusu**: 400 Bad Request (nieprawidłowe dane) lub 401 Unauthorized (nieprawidłowe dane logowania)
- **Odpowiedź**:
  ```typescript
  {
    error: string;           // Opis błędu
    details?: string[];      // Opcjonalne szczegóły błędów walidacji
  }
  ```

## 5. Przepływ danych

### Rejestracja użytkownika
1. Endpoint `/api/auth/register` otrzymuje żądanie POST z danymi rejestracyjnymi
2. Walidacja danych przy użyciu schematu Zod
3. Sprawdzenie, czy użytkownik o podanym adresie email już istnieje w bazie danych
4. Utworzenie nowego użytkownika przy użyciu Supabase Auth
5. Zapisanie dodatkowych danych użytkownika w tabeli `users`
6. Wygenerowanie JWT tokenu
7. Zwrócenie danych nowego użytkownika wraz z tokenem

### Logowanie użytkownika
1. Endpoint `/api/auth/login` otrzymuje żądanie POST z danymi logowania
2. Walidacja danych przy użyciu schematu Zod
3. Uwierzytelnienie użytkownika przy użyciu Supabase Auth
4. Aktualizacja pola `last_login_date` w tabeli `users`
5. Wygenerowanie JWT tokenu
6. Zwrócenie danych użytkownika wraz z tokenem

## 6. Względy bezpieczeństwa

1. **Bezpieczne przechowywanie haseł**
   - Wykorzystanie Supabase Auth do bezpiecznego hashowania haseł
   - Nigdy nie przechowuj haseł w plaintext

2. **Bezpieczeństwo tokenów JWT**
   - Ustaw odpowiedni czas wygaśnięcia tokenu (np. 1 dzień)
   - Zawieraj tylko niezbędne informacje w tokenie
   - Używaj HTTPS dla wszystkich endpointów API

3. **Ograniczanie liczby zapytań**
   - Zastosuj limit prób logowania (np. 5 prób w ciągu 15 minut)
   - Rozważ blokadę czasową po zbyt wielu nieudanych próbach logowania

4. **Walidacja danych wejściowych**
   - Używaj Zod do dokładnej walidacji schematów
   - Sanityzuj wszystkie dane wejściowe, aby zapobiec atakom wstrzykiwania

5. **Komplikacja hasła**
   - Wymagaj złożonych haseł (duże i małe litery, cyfry, znaki specjalne)
   - Minimalna długość hasła: 8 znaków

## 7. Obsługa błędów

### Rejestracja użytkownika
- **400 Bad Request**
  - Brakujące wymagane pola
  - Nieprawidłowy format adresu email
  - Niedostatecznie bezpieczne hasło
- **409 Conflict**
  - Email już istnieje w systemie
- **500 Internal Server Error**
  - Błąd podczas tworzenia użytkownika w Supabase
  - Błąd podczas generowania tokenu JWT

### Logowanie użytkownika
- **400 Bad Request**
  - Brakujące wymagane pola
  - Nieprawidłowy format adresu email
- **401 Unauthorized**
  - Nieprawidłowe dane logowania (email i/lub hasło)
- **500 Internal Server Error**
  - Błąd podczas uwierzytelniania w Supabase
  - Błąd podczas generowania tokenu JWT

## 8. Rozważania dotyczące wydajności

1. **Indeksowanie bazy danych**
   - Upewnij się, że pole `email` w tabeli `users` jest zindeksowane dla szybkiego wyszukiwania

2. **Buforowanie**
   - Rozważ buforowanie tokenów JWT dla aktywnych sesji

3. **Walidacja po stronie klienta**
   - Zaimplementuj podstawową walidację po stronie klienta, aby zmniejszyć liczbę niepotrzebnych zapytań do serwera

4. **Asynchroniczne przetwarzanie logów**
   - Używaj asynchronicznego przetwarzania do zapisywania logów i śledzenia aktywności logowania

## 9. Etapy wdrożenia

### Implementacja endpointu rejestracji
1. Utwórz plik `src/pages/api/auth/register.ts`
2. Zaimplementuj schemat walidacji Zod
3. Obsłuż walidację danych wejściowych
4. Sprawdź czy użytkownik już istnieje
5. Zaimplementuj logikę tworzenia użytkownika przy użyciu Supabase Auth
6. Zapisz dodatkowe dane użytkownika do tabeli `users`
7. Wygeneruj i zwróć token JWT
8. Zaimplementuj obsługę błędów

### Implementacja endpointu logowania
1. Utwórz plik `src/pages/api/auth/login.ts`
2. Zaimplementuj schemat walidacji Zod
3. Obsłuż walidację danych wejściowych
4. Zaimplementuj logikę uwierzytelniania przy użyciu Supabase Auth
5. Zaktualizuj pole `last_login_date` w tabeli `users`
6. Wygeneruj i zwróć token JWT
7. Zaimplementuj obsługę błędów

### Testowanie
1. Utwórz testy jednostkowe dla walidacji danych
2. Utwórz testy integracyjne dla endpointów
3. Przetestuj scenariusze błędów i przypadki brzegowe
4. Przeprowadź testy bezpieczeństwa (np. próby ataków brute force)

### Dokumentacja
1. Zaktualizuj dokumentację API dla obu endpointów
2. Dodaj przykłady użycia do dokumentacji
3. Opisz kody statusów i komunikaty błędów

### Wdrożenie
1. Przegląd kodu przed wdrożeniem
2. Wdrożenie na środowisku testowym
3. Testy akceptacyjne
4. Wdrożenie na środowisku produkcyjnym
5. Monitoring po wdrożeniu 


================================================
File: .ai/auth-spec.md
================================================
# Specyfikacja modułu autoryzacji i uwierzytelniania

Ta specyfikacja opisuje architekturę funkcjonalności związanych z rejestracją, logowaniem, wylogowywaniem oraz odzyskiwaniem hasła, zgodnie z wymaganiami określonymi w PRD (US-001 i US-006) oraz zgodnie z wykorzystaniem stosu technologicznego (Astro 5, React 19, TypeScript 5, Tailwind 4, Shadcn/ui oraz Supabase Auth).

---

## 1. ARCHITEKTURA INTERFEJSU UŻYTKOWNIKA

### 1.1 Strony i układy
- Utworzone zostaną dedykowane strony Astro: 
  - `/login` – strona logowania
  - `/register` – strona rejestracji
  - `/recover` – strona odzyskiwania hasła
  - Dodatkowo, główny layout (np. `@Layout.astro`) zostanie rozszerzony o komponent widoczny w prawym górnym rogu, odpowiedzialny za wyświetlanie stanu autoryzacji (przyciski logowania/wylogowania).
- Wersje interfejsu będą rozdzielone na tryb auth oraz non-auth, gdzie strony chronione będą wymagały weryfikacji autentyczności użytkownika (mechanizm middleware w Astro).

### 1.2 Komponenty client-side (React) i Astro
- Komponenty formularzy rejestracji, logowania i odzyskiwania hasła będą implementowane jako komponenty React. Dzięki integracji z Shadcn/ui będą posiadały spójny i responsywny design.
- Strony Astro będą odpowiedzialne za nawigację, layout oraz integrację z backendem autentykacji. Formularze React będą osadzane w stronach Astro, dzięki czemu zostanie zachowana izolacja stanu sesji i logiki biznesowej.
- Komponenty React będą wykorzystywać hooki (np. useState, useEffect) oraz kontekst użytkownika, co ułatwi zarządzanie stanem autentykacji w całej aplikacji.

### 1.3 Walidacja i komunikaty błędów
- Formularze rejestracji będą zawierały następującą walidację:
  - Poprawny format adresu email.
  - Wymóg minimalnej długości hasła.
  - Sprawdzenie zgodności pola "hasło" i "potwierdź hasło".
- Formularze logowania i odzyskiwania hasła będą walidowały obecność wymaganych pól oraz format wprowadzonych danych.
- Każdy błąd walidacji wyświetlany będzie użytkownikowi za pomocą czytelnych komunikatów (np. "Nieprawidłowy format email" czy "Hasła nie są zgodne").
- Obsługa stanów: ładowanie, błąd, sukces. Komponenty będą odpowiednio reagować na zmiany stanu (np. wyświetlanie spinnera podczas przetwarzania żądania).

### 1.4 Kluczowe scenariusze użytkownika
- Rejestracja nowego konta przy użyciu emaila, hasła i potwierdzenia hasła.
- Logowanie do systemu za pomocą istniejącego konta.
- Odzyskiwanie hasła poprzez podanie adresu email oraz wysłanie linku/resetu hasła.
- Wylogowywanie z aplikacji przez kliknięcie przycisku wylogowania umieszczonego w głównym layout.
- Obsługa komunikacji błędów, takich jak niepoprawne dane logowania, błędy serwera, przekroczenie limitu prób itp.

---

## 2. LOGIKA BACKENDOWA

### 2.1 Struktura endpointów API
- Utworzone zostaną endpointy w katalogu `./src/pages/api/auth`:
  - `/api/auth/register` – obsługuje rejestrację użytkownika.
  - `/api/auth/login` – obsługuje logowanie użytkownika.
  - `/api/auth/logout` – obsługuje wylogowywanie użytkownika.
  - `/api/auth/recover` – obsługuje proces odzyskiwania hasła.
- Każdy endpoint odpowiada za walidację danych wejściowych, komunikację z Supabase Auth oraz przesyłanie odpowiedzi do klienta.

### 2.2 Modele danych
- Dane użytkownika obejmują:
  - email
  - hasło (przechowywane w postaci zahashowanej)
  - data rejestracji (ISO 8601)
  - data ostatniego logowania (ISO 8601)
  - data ostatniej aktualizacji
- Opcjonalnie dodatkowe pola, jak status weryfikacji konta.

### 2.3 Walidacja i obsługa wyjątków
- Implementacja mechanizmów walidacji przy użyciu bibliotek typu Zod lub Yup:
  - Sprawdzenie poprawności formatu email.
  - Weryfikacja spełnienia kryteriów hasła (np. minimalna długość).
  - Weryfikacja zgodności pól (hasło vs. potwierdzenie hasła).
- Każdy endpoint będzie posiadał blok try-catch, który:
  - Rejestruje szczegóły błędu (np. treść błędu, czas, identyfikator użytkownika) w bazie `errors_log`.
  - Zwraca czytelne komunikaty o błędach do użytkownika.

### 2.4 Aktualizacja renderowania stron server-side
- W oparciu o konfigurację w `astro.config.mjs` zostaną wdrożone mechanizmy sprawdzania stanu autentykacji.
- Strony serwerowe będą renderowane conditionally, zależnie od tego, czy użytkownik jest zalogowany, co zostanie zrealizowane przez dedykowane middleware lub warunki w layoutach Astro.

---

## 3. SYSTEM AUTENTYKACJI

### 3.1 Integracja z Supabase Auth
- System uwierzytelniania będzie oparty o Supabase Auth, który umożliwia:
  - Rejestrację (signup) – tworzenie nowego użytkownika z wykorzystaniem emaila i hasła.
  - Logowanie (signin) – uwierzytelnianie istniejącego użytkownika.
  - Wylogowywanie (signout) – zakończenie sesji użytkownika.
  - Odzyskiwanie hasła – wysyłanie linku resetującego hasło oraz proces zmiany hasła.
- Implementacja wykorzysta istniejący klient Supabase zdefiniowany w katalogu `./src/db`.

### 3.2 Mechanizmy sesji i bezpieczeństwa
- Uwierzytelnianie opiera się na tokenach (np. JWT) lub ciasteczkach sesyjnych, które są bezpiecznie przekazywane między klientem a serwerem.
- Dodatkowe zabezpieczenia obejmują:
  - Szyfrowanie haseł (hashing z wykorzystaniem bezpiecznych algorytmów, np. bcrypt).
  - Ograniczenia liczby prób logowania/rejestracji, aby uniknąć ataków typu brute force.
  - Użycie HTTPS dla transmisji danych.

### 3.3 Integracja z warstwą prezentacji
- Strony Astro oraz komponenty React będą komunikować się z backendem poprzez zdefiniowane endpointy API.
- Stan autentykacji będzie przekazywany do komponentów React za pomocą kontekstu i hooków, umożliwiając dynamiczne aktualizacje interfejsu (np. wyświetlanie odpowiednich przycisków, przekierowania).
- Middleware w Astro będzie sprawdzał stan autentykacji przy próbie dostępu do stron chronionych i w razie potrzeby przekierowywał użytkownika na stronę logowania.

---

## Podsumowanie
Specyfikacja ta przedstawia kompleksowe podejście do wdrożenia modułu autoryzacji i uwierzytelniania w projekcie ShopListeo z zastosowaniem nowoczesnych technologii (Astro, React, TypeScript, Tailwind, Shadcn/ui i Supabase Auth). Podejście to uwzględnia zarówno warstwę interfejsu użytkownika, backendową logikę operacyjną, jak i integrację z systemem autoryzacji, gwarantując spójność działania oraz wysokie bezpieczeństwo przetwarzanych danych. 


================================================
File: .ai/authentication-views-implementation-plan.md
================================================
# Plan implementacji widoków Autentykacji

## 1. Przegląd
Zestaw widoków autentykacji (`LoginView`, `RegisterView`, `RequestPasswordResetView`, `SetNewPasswordView`) odpowiada za proces logowania, rejestracji oraz odzyskiwania hasła przez użytkownika. Widoki te są zazwyczaj dostępne dla niezalogowanych użytkowników i stanowią punkt wejścia do aplikacji. Wykorzystują minimalistyczny design zgodny z resztą aplikacji i integrują się z endpointami API `/api/auth`.

## 2. Routing widoków
- **Logowanie**: `/login`
- **Rejestracja**: `/register`
- **Żądanie resetowania hasła**: `/reset-password`
- **Ustawienie nowego hasła**: `/set-new-password` (Ta ścieżka może wymagać tokenu resetującego jako parametru zapytania, np. `/set-new-password?token=...`, co zależy od implementacji Supabase Auth)

## 3. Struktura komponentów

Widoki te zazwyczaj składają się z prostego layoutu i formularza.

```
AuthLayout (prosty layout bez nawigacji bocznej)
├── LoginView (Route: /login)
│   ├── PageHeader ("Zaloguj się")
│   └── LoginForm
│       ├── EmailInput
│       ├── PasswordInput
│       ├── RememberMeCheckbox
│       ├── SubmitButton ("Zaloguj")
│       └── Links (do /register i /reset-password)
├── RegisterView (Route: /register)
│   ├── PageHeader ("Zarejestruj się")
│   └── RegisterForm
│       ├── EmailInput
│       ├── PasswordInput
│       ├── ConfirmPasswordInput
│       ├── SubmitButton ("Zarejestruj")
│       └── Link (do /login)
├── RequestPasswordResetView (Route: /reset-password)
│   ├── PageHeader ("Resetuj hasło")
│   └── RequestPasswordResetForm
│       ├── EmailInput
│       ├── SubmitButton ("Wyślij link")
│       └── Link (do /login)
└── SetNewPasswordView (Route: /set-new-password)
    ├── PageHeader ("Ustaw nowe hasło")
    └── SetNewPasswordForm
        ├── PasswordInput
        ├── ConfirmPasswordInput
        └── SubmitButton ("Ustaw hasło")
```

## 4. Szczegóły komponentów

### `AuthLayout`
- **Opis**: Prosty kontener dla widoków autentykacji, zazwyczaj centrujący zawartość na stronie, bez nawigacji bocznej.
- **Główne elementy**: `div` lub `main`.
- **Propsy**: `children`.

### `LoginView` / `RegisterView` / `RequestPasswordResetView` / `SetNewPasswordView`
- **Opis**: Główne komponenty dla każdej ze stron autentykacji. Renderują odpowiedni nagłówek i formularz.
- **Główne elementy**: `PageHeader`, odpowiedni komponent formularza (`LoginForm`, `RegisterForm`, etc.).
- **Propsy**: Brak (mogą pobierać dane z kontekstu lub hooków).

### `PageHeader`
- **Opis**: Wyświetla tytuł strony (np. "Zaloguj się").
- **Główne elementy**: `<h1>`.
- **Propsy**: `title: string`.

### `LoginForm`
- **Opis**: Formularz logowania zarządzany przez `react-hook-form`.
- **Główne elementy**: `form`, `EmailInput`, `PasswordInput`, `RememberMeCheckbox`, `SubmitButton`, `Links`.
- **Obsługiwane interakcje**: `onSubmit`.
- **Obsługiwana walidacja**: Email (poprawny format), Hasło (niepuste).
- **Typy**: `LoginUserRequest`, `LoginUserResponse`.
- **Propsy**: `onSubmit: (data: LoginUserRequest) => Promise<void>`, `isSubmitting: boolean`, `apiError: string | null`.

### `RegisterForm`
- **Opis**: Formularz rejestracji zarządzany przez `react-hook-form`.
- **Główne elementy**: `form`, `EmailInput`, `PasswordInput`, `ConfirmPasswordInput`, `SubmitButton`, `Link` (do logowania).
- **Obsługiwane interakcje**: `onSubmit`.
- **Obsługiwana walidacja**: Email (format, unikalność - po stronie API), Hasło (złożoność, min. 8 znaków, zgodność z potwierdzeniem).
- **Typy**: `RegisterUserRequest`, `RegisterUserResponse`.
- **Propsy**: `onSubmit: (data: RegisterUserRequest) => Promise<void>`, `isSubmitting: boolean`, `apiError: string | null`.

### `RequestPasswordResetForm`
- **Opis**: Formularz do żądania linku resetującego hasło.
- **Główne elementy**: `form`, `EmailInput`, `SubmitButton`, `Link` (do logowania).
- **Obsługiwane interakcje**: `onSubmit`.
- **Obsługiwana walidacja**: Email (poprawny format).
- **Typy**: Brak specyficznych DTO (wysyła email).
- **Propsy**: `onSubmit: (email: string) => Promise<void>`, `isSubmitting: boolean`, `apiError: string | null`, `successMessage: string | null`.

### `SetNewPasswordForm`
- **Opis**: Formularz do ustawienia nowego hasła.
- **Główne elementy**: `form`, `PasswordInput`, `ConfirmPasswordInput`, `SubmitButton`.
- **Obsługiwane interakcje**: `onSubmit`.
- **Obsługiwana walidacja**: Hasło (złożoność, zgodność z potwierdzeniem).
- **Typy**: Brak specyficznych DTO (operacja Supabase Auth).
- **Propsy**: `onSubmit: (password: string) => Promise<void>`, `isSubmitting: boolean`, `apiError: string | null`, `token: string` (pobrany z URL).

### Wspólne komponenty formularzy (`EmailInput`, `PasswordInput`, `ConfirmPasswordInput`, `RememberMeCheckbox`, `SubmitButton`, `Links`)
- **Opis**: Standardowe komponenty formularza (Shadcn `Input`, `Checkbox`, `Button`, `Label`) zintegrowane z `react-hook-form`, wyświetlające etykiety i błędy walidacji. `Links` zawiera linki do innych stron autentykacji.
- **Obsługiwana walidacja**: Na poziomie formularza nadrzędnego.
- **Propsy**: Rejestracja `react-hook-form`, `label`, ewentualnie `type` dla inputów.

## 5. Typy
- **Istniejące typy (z `src/types.ts`)**: `RegisterUserRequest`, `RegisterUserResponse`, `LoginUserRequest`, `LoginUserResponse`.
- **Nowe typy ViewModel**: Zazwyczaj nie są potrzebne złożone ViewModele dla tych widoków; stan jest zarządzany głównie przez `react-hook-form` i proste stany hooków (`isLoading`, `error`, `successMessage`).

## 6. Zarządzanie stanem
- **Stan formularzy**: Zarządzany przez `react-hook-form` w każdym komponencie formularza (`LoginForm`, `RegisterForm`, etc.). Hook ten obsługuje wartości pól, walidację i stan przesyłania (`isSubmitting`).
- **Stan widoku**: Proste stany zarządzane przez `useState` w głównych komponentach widoku (`LoginView`, `RegisterView`, etc.) do obsługi ogólnych błędów API (`apiError`) lub komunikatów sukcesu (`successMessage`).
- **Stan autentykacji (globalny)**: Po pomyślnym zalogowaniu lub rejestracji, stan autentykacji użytkownika (np. dane użytkownika, token) powinien być zapisany w globalnym stanie aplikacji (np. w kontekście React, Zustand store) i potencjalnie w `localStorage` (dla opcji "Zapamiętaj mnie"). Należy również obsłużyć przekierowanie do odpowiedniego widoku (`/` lub `/admin/users`).

## 7. Integracja API
- **Logowanie (`LoginForm`)**: Wywołuje `POST /api/auth/login` z danymi typu `LoginUserRequest`. Oczekuje odpowiedzi `LoginUserResponse`.
- **Rejestracja (`RegisterForm`)**: Wywołuje `POST /api/auth/register` z danymi typu `RegisterUserRequest`. Oczekuje odpowiedzi `RegisterUserResponse`.
- **Resetowanie hasła (`RequestPasswordResetForm`)**: Wywołuje funkcję Supabase Auth (`supabase.auth.resetPasswordForEmail`) bezpośrednio (lub przez dedykowany endpoint API, jeśli logika ma być po stronie serwera) do wysłania emaila resetującego.
- **Ustawienie nowego hasła (`SetNewPasswordForm`)**: Wywołuje funkcję Supabase Auth (`supabase.auth.updateUser`) bezpośrednio (lub przez dedykowany endpoint API) z nowym hasłem i tokenem resetującym.
- **Obsługa tokenu**: Po zalogowaniu/rejestracji, otrzymany token JWT jest zapisywany (np. w `localStorage` dla "Zapamiętaj mnie", lub w stanie globalnym/pamięci dla sesji) i używany do autoryzacji kolejnych zapytań API.

## 8. Interakcje użytkownika
- **Wprowadzanie danych**: Standardowe interakcje z polami formularzy.
- **Wysyłanie formularza**: Wywołuje odpowiednią funkcję API/Supabase.
- **Klikanie linków**: Nawigacja między widokami logowania, rejestracji, resetowania hasła.
- **Zaznaczenie "Zapamiętaj mnie"**: Wpływa na sposób przechowywania tokenu JWT.

## 9. Warunki i walidacja
- **Walidacja pól**: Implementowana w `react-hook-form` z użyciem schematów Zod (zdefiniowanych w planie implementacji endpointów) lub reguł walidacji `react-hook-form`. Błędy wyświetlane przy polach.
- **Zgodność haseł**: Walidacja w `RegisterForm` i `SetNewPasswordForm`.
- **Przyciski Submit**: Wyłączone (`disabled`) podczas wysyłania (`isSubmitting`).
- **Wyświetlanie błędów API**: Ogólne błędy API (np. "Nieprawidłowe dane logowania", "Email już istnieje") wyświetlane w obrębie formularza.

## 10. Obsługa błędów
- **Błędy walidacji klienta**: Obsługiwane przez `react-hook-form`, wyświetlane przy polach.
- **Błędy API (4xx, 5xx)**: Wyświetlane jako ogólny komunikat błędu w formularzu (`apiError`).
- **Sukces (Rejestracja/Reset)**: Po udanej rejestracji następuje automatyczne logowanie i przekierowanie. Po udanym żądaniu resetu hasła lub ustawieniu nowego hasła, wyświetlany jest komunikat sukcesu (`successMessage`) i/lub następuje przekierowanie do logowania.

## 11. Kroki implementacji
1.  **Routing**: Skonfigurować routing w Astro dla ścieżek `/login`, `/register`, `/reset-password`, `/set-new-password` renderujących odpowiednie komponenty React.
2.  **Layout (`AuthLayout`)**: Stworzyć prosty layout centrujący zawartość.
3.  **Komponent `LoginView` i `LoginForm`**: Zaimplementować formularz logowania z `react-hook-form`, walidacją, integracją z `POST /api/auth/login`, obsługą "Zapamiętaj mnie", zapisem tokenu, globalnym stanem autentykacji i przekierowaniem.
4.  **Komponent `RegisterView` i `RegisterForm`**: Zaimplementować formularz rejestracji z `react-hook-form`, walidacją (w tym zgodności haseł), integracją z `POST /api/auth/register`, automatycznym logowaniem i przekierowaniem.
5.  **Komponent `RequestPasswordResetView` i `RequestPasswordResetForm`**: Zaimplementować formularz żądania resetu, integrację z funkcją wysyłania emaila Supabase Auth, obsługę komunikatów sukcesu/błędu.
6.  **Komponent `SetNewPasswordView` i `SetNewPasswordForm`**: Zaimplementować formularz ustawiania nowego hasła, pobieranie tokenu z URL, integrację z funkcją aktualizacji hasła Supabase Auth, obsługę komunikatów sukcesu/błędu i przekierowanie do logowania.
7.  **Wspólne Komponenty Formularzy**: Stworzyć reużywalne komponenty dla inputów, checkboxa, przycisków i linków, zintegrowane z Shadcn/ui i `react-hook-form`.
8.  **Globalny Stan Autentykacji**: Zaimplementować mechanizm (np. Context API, Zustand) do zarządzania stanem zalogowania użytkownika i tokenem JWT.
9.  **Obsługa Błędów API**: Zaimplementować spójny sposób wyświetlania błędów API w formularzach.
10. **Styling**: Dopracować style Tailwind zgodnie z minimalistycznym designem i paletą niebieskich kolorów.
11. **Testowanie**: Napisać testy jednostkowe dla walidacji formularzy oraz testy integracyjne dla całych przepływów autentykacji. 


================================================
File: .ai/db-plan.md
================================================
# PostgreSQL Database Schema Plan

## 1. Lista tabel

### 1.1. `users`
- `id` UUID PRIMARY KEY
- `email` VARCHAR(128) NOT NULL UNIQUE
- `admin` BOOLEAN NOT NULL DEFAULT FALSE
- `updated_date` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP

### 1.2. `conversations`
- `id` UUID PRIMARY KEY
- `user_id` UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE
- `started_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
- `ended_at` TIMESTAMP
- `openai_thread_id` TEXT
- `answer_accepted` BOOLEAN NOT NULL DEFAULT FALSE
- `messages` JSONB

### 1.3. `shopping_lists`
- `id` UUID PRIMARY KEY
- `user_id` UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE
- `title` VARCHAR(255) NOT NULL
- `created_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
- `updated_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP

### 1.4. `shopping_list_items`
- `id` UUID PRIMARY KEY
- `shopping_list_id` UUID NOT NULL REFERENCES shopping_lists(id) ON DELETE CASCADE
- `item_name` TEXT NOT NULL
- `purchased` BOOLEAN NOT NULL DEFAULT FALSE
- `created_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
- `updated_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP

## 2. Relacje między tabelami
- `users` 1-to-many `conversations`: Jeden użytkownik może mieć wiele zapisanych sesji konwersacji/logów.
- `users` 1-to-many `shopping_lists`: Jeden użytkownik może mieć wiele list zakupów.
- `shopping_lists` 1-to-many `shopping_list_items`: Jedna lista zakupów może zawierać wiele pozycji.

## 3. Indeksy
- Unikalny indeks na `users.email`
- Indeks na `conversations.user_id`
- Indeks na `shopping_lists.user_id`
- Indeks na `shopping_list_items.shopping_list_id`

## 4. Zasady PostgreSQL
- Na etapie MVP nie wdrażamy reguł Row Level Security (RLS).

## 5. Dodatkowe uwagi
- Wszystkie daty są przechowywane jako `TIMESTAMP` zgodnie ze standardem.
- Hasła są przechowywane w kolumnie `password_hash`; należy rozważyć implementację bezpiecznego mechanizmu hashowania.
- Klucze główne są typu UUID, co zapewnia unikalność rekordów.
- Relacje między tabelami zostały zdefiniowane z opcją `ON DELETE CASCADE` dla ułatwienia zarządzania zależnościami.
- Schemat został opracowany zgodnie z zasadami 3NF celem zapewnienia poprawnej normalizacji danych, chyba że denormalizacja będzie uzasadniona ze względu na wydajność.
- Kolumna `admin` w tabeli `users` pozwala identyfikować użytkowników z uprawnieniami administracyjnymi. Domyślnie wartość dla nowych użytkowników to `false`. 


================================================
File: .ai/openrouter-service-implementation-plan.md
================================================
# OpenRouter Service Implementation Plan

## 1. Opis usługi
Usługa OpenRouter ma na celu integrację interfejsu API OpenRouter z systemem czatu w ShopListeo, umożliwiając wykorzystanie modeli LLM do wzbogacania komunikacji. Usługa odpowiada za:
1. Przyjmowanie wiadomości od użytkownika oraz systemowych.
2. Formatowanie żądań zgodnie z wymaganym schematem, w tym ustawienie:
   - Komunikatu systemowego (np. "You are a helpful assistant.")
   - Komunikatu użytkownika (np. "Enter your query here")
   - Ustrukturyzowanej odpowiedzi poprzez response_format, np. `{ type: 'json_schema', json_schema: { name: 'llm_response', strict: true, schema: { /* JSON Schema Object */ } } }`
   - Nazwy modelu (np. "openai/chatgpt-4o-latest")
   - Parametrów modelu (np. `{ max_tokens: 512, temperature: 0.7 }`)
3. Wysyłanie żądań do API OpenRouter oraz przetwarzanie odpowiedzi zgodnie z ustalonym schematem.
4. Obsługę błędów i logowanie zdarzeń, zapewniając stabilność i bezpieczeństwo komunikacji.

## 2. Opis konstruktora
Konstruktor usługi powinien przyjmować konfigurację obejmującą:
- Klucz API (przechowywany bezpiecznie jako zmienna środowiskowa).
- Bazowy URL API OpenRouter.
- Domyślne parametry modelu (np. nazwa modelu, max_tokens, temperature).

Przykładowe pola konstruktora:
- `apiKey: string`
- `baseUrl: string`
- `defaultModelParams: ModelParams`

Konstruktor inicjuje również pola odpowiedzialne za ustawienia komunikatów:
- `systemMessage: string`
- `userMessage: string`

## 3. Publiczne metody i pola
### Metody
1. `sendChatRequest(chatPayload: ChatPayload): Promise<LLMResponse>`
   - Wysyła sformatowane żądanie do API OpenRouter i przetwarza odpowiedź.
2. `setModelParams(params: ModelParams): void`
   - Umożliwia aktualizację parametrów modelu wykorzystywanych przy kolejnych zapytaniach.
3. `updateSystemMessage(message: string): void`
   - Aktualizuje komunikat systemowy dla żądań wysyłanych do API.
4. `updateUserMessage(message: string): void`
   - Aktualizuje treść komunikatu użytkownika.

### Pola
- `apiKey: string`
- `baseUrl: string`
- `defaultModelParams: ModelParams`
- `systemMessage: string`
- `userMessage: string`

## 4. Prywatne metody i pola
### Metody
1. `formatRequest(): RequestPayload`
   - Łączy komunikaty systemowy i użytkownika w jeden sformatowany obiekt zgodny z wymaganiami API OpenRouter.
2. `parseResponse(response: any): LLMResponse`
   - Waliduje i przekształca odpowiedź z API zgodnie z ustalonym response_format.
3. `handleError(error: any): void`
   - Przetwarza błędy, loguje szczegóły oraz inicjuje mechanizm ponowienia lub odpowiedniego reagowania na błąd.
4. `retryRequest(request: RequestPayload): Promise<LLMResponse>`
   - Implementuje mechanizm ponawiania zapytania w przypadku błędów komunikacji lub ograniczeń API.

### Pola
- `retryCount: number` – bieżąca liczba prób ponowienia
- `maxRetries: number` – maksymalna liczba dozwolonych prób

## 5. Obsługa błędów
Potencjalne scenariusze błędów i proponowane rozwiązania:
1. **Błąd połączenia (Network Errors):**
   - Rozwiązanie: Implementacja mechanizmu ponawiania zapytania z eksponencjalnym opóźnieniem oraz zaawansowane logowanie błędów.
2. **Błąd odpowiedzi HTTP (HTTP 4xx/5xx):**
   - Rozwiązanie: Walidacja kodu statusu, zwracanie czytelnych komunikatów błędów oraz analiza przyczyn niepowodzenia.
3. **Błąd walidacji schematu JSON (Schema Validation Errors):**
   - Rozwiązanie: Porównanie odpowiedzi z zdefiniowanym `response_format` i zwrócenie szczegółowych informacji o niezgodnościach.
4. **Timeout zapytania:**
   - Rozwiązanie: Konfiguracja limitu czasu dla zapytań oraz obsługa scenariuszy przekroczenia tego limitu z odpowiednim powiadomieniem użytkownika.

## 6. Kwestie bezpieczeństwa
1. Przechowywanie klucza API wyłącznie w zmiennych środowiskowych, aby zapobiec jego przypadkowemu ujawnieniu w kodzie źródłowym.
2. Używanie HTTPS do komunikacji z API OpenRouter w celu szyfrowania przesyłanych danych.
3. Implementacja mechanizmów limitowania zapytań, aby zabezpieczyć się przed nadużyciami i atakami typu DoS.
4. Walidacja danych wejściowych i wyjściowych, aby zapewnić zgodność z ustalonym schematem oraz zapobiec potencjalnym atakom wstrzyknięć danych.
5. Logowanie zdarzeń i błędów bez ujawniania wrażliwych informacji, co zwiększa bezpieczeństwo całej aplikacji.

## 7. Plan wdrożenia krok po kroku
1. **Przygotowanie środowiska:**
   - Skonfigurowanie zmiennych środowiskowych (API key, URL API).
   - Instalacja niezbędnych zależności przy użyciu npm.
2. **Implementacja modułu usługi OpenRouter:**
   - Stworzenie konstruktora zgodnie z wymaganiami konfiguracji.
   - Implementacja metod formatowania żądań, łączenia komunikatów systemowego i użytkownika.
3. **Integracja z API OpenRouter:**
   - Implementacja metody `sendChatRequest` do wysyłania żądań z odpowiednio sformatowanym payloadem.
   - Konfiguracja `response_format` według wzoru, np.:
     ```json
     { "type": "json_schema", "json_schema": { "name": "llm_response", "strict": true, "schema": { /* JSON Schema Object */ } } }
     ```
   - Ustawienie właściwej nazwy modelu (np. "openrouter-llm-model") oraz model parameters (np. `{ max_tokens: 512, temperature: 0.7 }`).
4. **Implementacja obsługi błędów:**
   - Dodanie mechanizmów ponawiania zapytań w przypadku wystąpienia błędów.
   - Walidacja odpowiedzi oraz implementacja odpowiednich komunikatów w przypadku wystąpienia błędów.



================================================
File: .ai/prd.md
================================================
# Dokument Wymagań Produktu (PRD) - ShopListeo
_Ostatnia aktualizacja: 28.04.2025_

## 1. Przegląd produktu

ShopListeo to nowoczesna aplikacja webowa zaprojektowana w celu uproszczenia procesu tworzenia i zarządzania listami zakupów. Główną cechą aplikacji jest wykorzystanie asystenta AI (poprzez OpenRouter.ai) do inteligentnego parsowania tekstu wprowadzonego przez użytkownika i przekształcania go w uporządkowaną listę produktów. Aplikacja umożliwia użytkownikom nie tylko tworzenie i edycję list, ale także interaktywne oznaczanie zakupionych produktów oraz zarządzanie swoim kontem. Dodatkowo, system zawiera panel administracyjny do zarządzania użytkownikami.

## 2. Problem użytkownika

Tradycyjne metody tworzenia list zakupów (kartka, notatnik, komunikatory) są często nieefektywne, czasochłonne i podatne na błędy. Brak możliwości łatwego oznaczania zakupionych pozycji i dynamicznego zarządzania listą prowadzi do dezorganizacji podczas zakupów. ShopListeo adresuje te problemy, oferując scentralizowane, inteligentne i interaktywne rozwiązanie webowe.

## 3. Wymagania funkcjonalne

### 3.1. Uwierzytelnianie i Zarządzanie Kontem Użytkownika

*   **Rejestracja:** Użytkownicy mogą tworzyć nowe konta za pomocą adresu e-mail i hasła. System waliduje poprawność danych i unikalność adresu e-mail.
*   **Logowanie:** Zarejestrowani użytkownicy mogą logować się przy użyciu e-maila i hasła.
*   **Wylogowywanie:** Użytkownicy mogą bezpiecznie zakończyć sesję.
*   **Odzyskiwanie hasła:**
    *   Użytkownicy mogą zażądać linku do resetowania hasła na podany adres e-mail.
    *   Użytkownicy mogą ustawić nowe hasło, korzystając z otrzymanego linku (tokena).
*   **Zarządzanie sesją:** System wykorzystuje mechanizmy sesji (prawdopodobnie oparte na tokenach/ciasteczkach Supabase) do utrzymania stanu zalogowania użytkownika. Middleware weryfikuje sesję dla chronionych tras.
*   **Profil użytkownika (niejawny w UI, ale wspierany przez API):** API umożliwia pobieranie i potencjalnie aktualizację danych własnego profilu (np. email).

### 3.2. Zarządzanie Listami Zakupów

*   **Tworzenie Listy:** Zalogowani użytkownicy mogą tworzyć nowe listy zakupów. Domyślnie lista może otrzymywać tytuł oparty na dacie utworzenia.
*   **Wyświetlanie List:** Zalogowani użytkownicy widzą listę wszystkich swoich list zakupów, posortowaną (domyślnie po dacie utworzenia). Wyświetlana jest nazwa listy oraz liczba elementów.
*   **Wyświetlanie Szczegółów Listy:** Użytkownicy mogą przeglądać zawartość konkretnej listy zakupów, w tym jej produkty.
*   **Aktualizacja Tytułu Listy:** Użytkownicy mogą edytować tytuł istniejącej listy zakupów (edycja inline).
*   **Usuwanie Listy:** Użytkownicy mogą usuwać swoje listy zakupów (z potwierdzeniem). Usunięcie listy powoduje usunięcie wszystkich powiązanych z nią produktów (cascade delete).

### 3.3. Zarządzanie Produktami na Liście Zakupów

*   **Dodawanie Produktów (przez AI):** Użytkownicy mogą wprowadzić tekst opisujący produkty w polu tekstowym. Po zatwierdzeniu, tekst jest wysyłany do API (`/api/shopping-lists/:listId/ai-parse`), które wykorzystuje AI (OpenRouterService) do przetworzenia go na listę produktów. Istniejące produkty i ich status `purchased` są brane pod uwagę podczas aktualizacji.
*   **Oznaczanie Produktów:** Użytkownicy mogą oznaczać produkty jako zakupione lub niekupione za pomocą checkboxa. Zmiana statusu jest zapisywana i odzwierciedlana w interfejsie (np. stylizacją).
*   **Edycja Nazwy Produktu:** Użytkownicy mogą edytować nazwę istniejącego produktu na liście (edycja inline).
*   **Usuwanie Produktu:** Użytkownicy mogą usuwać pojedyncze produkty z listy.
*   **Czyszczenie Listy:** Istnieje endpoint API (`/api/shopping-lists/:listId/clear-items`) do usuwania wszystkich produktów z listy (funkcjonalność może nie być jeszcze w pełni wyeksponowana w UI).

### 3.4. Panel Administracyjny

*   **Dostęp:** Dostępny tylko dla użytkowników z uprawnieniami administratora.
*   **Lista Użytkowników:** Administratorzy mogą przeglądać listę wszystkich zarejestrowanych użytkowników z paginacją i podstawowymi informacjami (email, data rejestracji, ostatnie logowanie).
*   **Szczegóły Użytkownika:** Administratorzy mogą przeglądać szczegółowe dane wybranego użytkownika.
*   **Zarządzanie Użytkownikami:** Administratorzy mogą aktualizować dane użytkownika (email, potencjalnie reset hasła) oraz usuwać konta użytkowników.

### 3.5. Wymagania Niefunkcjonalne

*   **Interfejs Użytkownika:** Aplikacja posiadać będzie responsywny interfejs użytkownika oparty na Tailwind CSS i komponentach Shadcn/ui, wspierający tryb jasny i ciemny.
*   **Wydajność:** Aplikacja powinna szybko reagować na interakcje użytkownika, zwłaszcza przy ładowaniu list i oznaczaniu produktów.
*   **Bezpieczeństwo:** Hasła są hashowane, komunikacja odbywa się przez HTTPS, stosowane są mechanizmy ochrony przed atakami (walidacja danych, autoryzacja).
*   **Logowanie Błędów:** System powinien logować błędy występujące w aplikacji (backend/frontend) w celu ułatwienia diagnozy.

## 4. Granice produktu (Zakres MVP i Poza MVP)

### 4.1. W zakresie MVP (na podstawie kodu)

*   Pełna funkcjonalność autentykacji (Rejestracja, Logowanie, Wylogowanie, Odzyskiwanie hasła).
*   Podstawowe zarządzanie listami zakupów (Tworzenie, Wyświetlanie listy list, Wyświetlanie szczegółów, Aktualizacja tytułu, Usuwanie).
*   Zarządzanie produktami: Dodawanie przez AI parsing, Oznaczanie kupionych, Edycja nazw, Usuwanie pojedynczych produktów, Czyszczenie listy (API).
*   Panel administracyjny: Wyświetlanie listy użytkowników, Szczegóły użytkownika, Aktualizacja użytkownika (API), Usuwanie użytkownika (API).
*   Aplikacja webowa, responsywna.
*   Tryb jasny/ciemny.

### 4.2. Poza zakresem MVP (na podstawie `app_specs.md` i braku w kodzie)

*   Aplikacje mobilne.
*   Integracja z zewnętrznymi usługami logowania (np. Google, Facebook).
*   Współdzielenie list zakupów między użytkownikami.
*   Dyktowanie treści przez speech-to-text.
*   Bardziej zaawansowane funkcje AI (np. kategoryzacja produktów, sugestie).
*   Powiadomienia push.
*   Funkcjonalność offline.
*   Szczegółowe logowanie historii konwersacji AI w tabeli `conversations` (tabela istnieje, ale brak widocznej logiki jej wykorzystania).
*   Dedykowana tabela `errors_log` (brak migracji dla niej).

## 5. Historyjki użytkowników

### 5.1. Użytkownik Standardowy

*   **US-Auth-01 (Rejestracja):** Jako nowy użytkownik, chcę móc zarejestrować konto używając emaila i bezpiecznego hasła, aby uzyskać dostęp do aplikacji.
*   **US-Auth-02 (Logowanie):** Jako zarejestrowany użytkownik, chcę móc zalogować się do aplikacji przy użyciu mojego emaila i hasła.
*   **US-Auth-03 (Odzyskiwanie Hasła):** Jako użytkownik, który zapomniał hasła, chcę móc zażądać linku resetującego na mój email, aby odzyskać dostęp do konta.
*   **US-Auth-04 (Ustawianie Nowego Hasła):** Jako użytkownik, który otrzymał link resetujący, chcę móc ustawić nowe, bezpieczne hasło dla mojego konta.
*   **US-Auth-05 (Wylogowanie):** Jako zalogowany użytkownik, chcę móc się wylogować, aby zakończyć sesję.
*   **US-List-01 (Tworzenie Listy):** Jako zalogowany użytkownik, chcę móc szybko utworzyć nową listę zakupów, aby zacząć dodawać produkty.
*   **US-List-02 (Przeglądanie List):** Jako zalogowany użytkownik, chcę widzieć wszystkie moje listy zakupów, aby móc łatwo wybrać, którą chcę edytować lub przejrzeć.
*   **US-List-03 (Edycja Tytułu):** Jako zalogowany użytkownik, chcę móc zmienić tytuł mojej listy zakupów, aby lepiej odpowiadał jej zawartości.
*   **US-List-04 (Usuwanie Listy):** Jako zalogowany użytkownik, chcę móc usunąć listę zakupów, której już nie potrzebuję.
*   **US-Item-01 (Dodawanie przez AI):** Jako użytkownik edytujący listę, chcę móc wpisać lub wkleić tekst z produktami, aby AI automatycznie dodało je do mojej listy, uwzględniając istniejące pozycje.
*   **US-Item-02 (Oznaczanie Kupionych):** Jako użytkownik przeglądający listę (np. podczas zakupów), chcę móc łatwo oznaczyć produkt jako kupiony (i odznaczyć), aby śledzić postęp.
*   **US-Item-03 (Edycja Nazwy Produktu):** Jako użytkownik edytujący listę, chcę móc poprawić lub zmienić nazwę produktu na liście.
*   **US-Item-04 (Usuwanie Produktu):** Jako użytkownik edytujący listę, chcę móc usunąć pojedynczy produkt z listy.

### 5.2. Administrator

*   **US-Admin-01 (Przeglądanie Użytkowników):** Jako administrator, chcę widzieć listę wszystkich użytkowników systemu z możliwością paginacji, aby móc nimi zarządzać.
*   **US-Admin-02 (Szczegóły Użytkownika):** Jako administrator, chcę móc zobaczyć szczegółowe informacje o wybranym użytkowniku.
*   **US-Admin-03 (Aktualizacja Użytkownika):** Jako administrator, chcę móc zaktualizować adres e-mail lub zresetować hasło użytkownika.
*   **US-Admin-04 (Usuwanie Użytkownika):** Jako administrator, chcę móc usunąć konto użytkownika z systemu.

## 6. Metryki sukcesu

*   **Aktywacja Użytkowników:** Procent zarejestrowanych użytkowników, którzy utworzyli co najmniej jedną listę zakupów.
*   **Akceptacja AI:** Procent list/produktów dodanych za pomocą AI, które nie zostały natychmiast usunięte lub zmodyfikowane przez użytkownika.
*   **Zaangażowanie:** Średnia liczba list na użytkownika, średnia liczba produktów na liście, częstotliwość oznaczania produktów jako kupione.
*   **Retencja:** Procent użytkowników powracających do aplikacji po pierwszym tygodniu/miesiącu.
*   **Stabilność:** Liczba błędów serwera (5xx) i błędów klienta (4xx) zgłaszanych przez system monitoringu lub logi.
*   **Wydajność:** Średni czas odpowiedzi API dla kluczowych operacji (pobieranie list, aktualizacja statusu produktu). Czas ładowania strony.


================================================
File: .ai/shopping-list-details-view-implementation-plan.md
================================================
# Plan implementacji widoku Szczegółów Listy Zakupów

## 1. Przegląd
Widok Szczegółów Listy Zakupów (`ShoppingListDetailView`) umożliwia użytkownikom zarządzanie konkretną listą zakupów. Pozwala na edycję tytułu listy, dodawanie nowych produktów (w tym przez planowany mechanizm generowania z opisu tekstowego), edycję nazw istniejących produktów, oznaczanie produktów jako zakupione/niezakupione oraz usuwanie produktów. Widok musi być responsywny, obsługiwać tryb ciemny/jasny i integrować się z systemem nawigacji i powiadomień.

## 2. Routing widoku
- **Ścieżka**: `/shopping-lists/:id`
- `:id` jest dynamicznym parametrem reprezentującym UUID listy zakupów.

## 3. Struktura komponentów
```
AppLayout
└── SideNav
└── ShoppingListDetailView (Route: /shopping-lists/:id)
    ├── EditableShoppingListTitle
    ├── ProductInputArea
    │   ├── Textarea (Shadcn)
    │   └── Button (Shadcn - "Wygeneruj listę zakupów")
    └── ProductList
        └── ProductItem (mapped)
            ├── Checkbox (Shadcn)
            ├── EditableItemName
            └── DeleteButton (Shadcn - Icon Button)
```

## 4. Szczegóły komponentów

### `ShoppingListDetailView`
- **Opis**: Główny kontener widoku. Odpowiedzialny za pobranie danych listy (w tym jej elementów) na podstawie `:id` z URL, zarządzanie ogólnym stanem widoku (ładowanie, błędy) oraz przekazywanie danych i funkcji do komponentów podrzędnych.
- **Główne elementy**: `EditableShoppingListTitle`, `ProductInputArea`, `ProductList`, ewentualnie komponenty do wyświetlania stanu ładowania lub błędu.
- **Obsługiwane interakcje**: Inicjuje pobieranie danych przy montowaniu.
- **Obsługiwana walidacja**: Brak bezpośredniej walidacji, obsługuje stany błędów z API.
- **Typy**: `ShoppingListDetailViewModel`, `ShoppingListItemDTO`.
- **Propsy**: Brak (pobiera `:id` z parametrów routingu Astro/React Router).

### `EditableShoppingListTitle`
- **Opis**: Wyświetla tytuł listy zakupów. Po kliknięciu przechodzi w tryb edycji (input tekstowy). Zapisuje zmiany po utracie fokusa (blur) lub naciśnięciu Enter.
- **Główne elementy**: `<h1>` lub podobny tag semantyczny (tryb wyświetlania), `Input` (Shadcn, tryb edycji).
- **Obsługiwane interakcje**: Kliknięcie na tytuł (rozpoczęcie edycji), `onBlur`, `onKeyDown` (Enter) na inpucie (zapisanie zmian).
- **Obsługiwana walidacja**: Długość tytułu (1-255 znaków).
- **Typy**: `EditableTitleViewModel`, `UpdateShoppingListRequest`, `UpdateShoppingListResponse`.
- **Propsy**: `initialTitle: string`, `listId: string`, `onUpdateTitle: (newTitle: string) => Promise<void>`.

### `ProductInputArea`
- **Opis**: Zawiera pole `Textarea` do wprowadzania opisu produktów oraz przycisk "Wygeneruj listę zakupów". W MVP, przycisk może np. parsować linie z textarea i dodawać je jako nowe produkty.
- **Główne elementy**: `Textarea` (Shadcn), `Button` (Shadcn, wyróżniony kolorem).
- **Obsługiwane interakcje**: Wpisywanie tekstu w `Textarea`, kliknięcie przycisku "Wygeneruj listę zakupów".
- **Obsługiwana walidacja**: Brak bezpośredniej walidacji w MVP (do ustalenia przy implementacji generowania).
- **Typy**: `AddItemToShoppingListRequest`, `AddItemToShoppingListResponse`.
- **Propsy**: `listId: string`, `onGenerateItems: (items: string[]) => Promise<void>`.

### `ProductList`
- **Opis**: Renderuje listę komponentów `ProductItem`. Odpowiada za sortowanie produktów (zakupione na końcu).
- **Główne elementy**: Lista (`<ul>` lub `<div>`), mapowanie `ProductItem`.
- **Obsługiwane interakcje**: Brak bezpośrednich interakcji, renderuje listę.
- **Obsługiwana walidacja**: Brak.
- **Typy**: `ProductItemViewModel[]`.
- **Propsy**: `items: ProductItemViewModel[]`, `listId: string`, `onUpdateItem: (itemId: string, data: UpdateShoppingListItemRequest) => Promise<void>`, `onDeleteItem: (itemId: string) => Promise<void>`.

### `ProductItem`
- **Opis**: Reprezentuje pojedynczy element na liście zakupów. Wyświetla nazwę (edytowalną), checkbox statusu zakupienia oraz przycisk usunięcia.
- **Główne elementy**: `div` kontener, `Checkbox` (Shadcn), `EditableItemName` (komponent wewnętrzny lub logika), `Button` (Shadcn, ikona kosza).
- **Obsługiwane interakcje**: Kliknięcie `Checkbox` (zmiana statusu `purchased`), kliknięcie nazwy (edycja inline), kliknięcie przycisku usuwania.
- **Obsługiwana walidacja**: Długość nazwy produktu (1-128 znaków) podczas edycji.
- **Typy**: `ProductItemViewModel`, `UpdateShoppingListItemRequest`, `UpdateShoppingListItemResponse`.
- **Propsy**: `item: ProductItemViewModel`, `listId: string`, `onUpdateItem: (itemId: string, data: UpdateShoppingListItemRequest) => Promise<void>`, `onDeleteItem: (itemId: string) => Promise<void>`.

### `EditableItemName` (Komponent wewnętrzny `ProductItem` lub logika)
- **Opis**: Logika/komponent do wyświetlania i edycji nazwy produktu.
- **Główne elementy**: `<span>` (tryb wyświetlania), `Input` (Shadcn, tryb edycji).
- **Obsługiwane interakcje**: Kliknięcie na nazwę (rozpoczęcie edycji), `onBlur`, `onKeyDown` (Enter) na inpucie (zapisanie zmian).
- **Obsługiwana walidacja**: Długość nazwy (1-128 znaków).
- **Typy**: - (zarządzane w `ProductItem`)
- **Propsy**: `initialName: string`, `onSave: (newName: string) => void`.

## 5. Typy

- **Istniejące typy (z `src/types.ts`)**: `User`, `ShoppingList`, `ShoppingListItem`, `PaginationResponse`, `ShoppingListItemDTO`, `GetShoppingListByIdResponse`, `CreateShoppingListRequest`, `CreateShoppingListResponse`, `UpdateShoppingListRequest`, `UpdateShoppingListResponse`, `AddItemToShoppingListRequest`, `AddItemToShoppingListResponse`, `UpdateShoppingListItemRequest`, `UpdateShoppingListItemResponse`, `BulkUpdateItemRequest`, `BulkUpdateItemsRequest`, `BulkUpdateItemsResponse`.

- **Nowe typy ViewModel**: 
  ```typescript
  // Model widoku dla szczegółów listy zakupów
  interface ShoppingListDetailViewModel {
    id: string;              // ID listy
    title: string;           // Tytuł listy
    isLoading: boolean;      // Status ładowania danych
    isUpdating: boolean;     // Status aktualizacji (np. tytułu, elementów)
    error: string | null;    // Komunikat błędu API
    items: ProductItemViewModel[]; // Lista elementów (ViewModel)
  }

  // Model widoku dla pojedynczego elementu listy zakupów
  interface ProductItemViewModel extends ShoppingListItemDTO {
    isEditingName: boolean; // Czy nazwa jest aktualnie edytowana?
    isUpdating: boolean;    // Czy element jest aktualnie aktualizowany/usuwany?
  }

  // Model widoku dla edytowalnego tytułu
  interface EditableTitleViewModel {
    initialTitle: string;   // Początkowy tytuł (z API)
    isEditing: boolean;     // Czy trwa edycja?
    currentValue: string;   // Aktualna wartość w inpucie
    isLoading: boolean;     // Czy trwa zapisywanie?
    error: string | null;   // Błąd walidacji lub zapisu
  }
  ```

## 6. Zarządzanie stanem
- **Główny stan widoku** (`ShoppingListDetailView`):
  - `listViewModel: ShoppingListDetailViewModel | null` - Przechowuje wszystkie dane i stany UI dla widoku.
  - Będzie zarządzany przez custom hook `useShoppingListDetail`.
- **Custom Hook `useShoppingListDetail(listId: string)`**:
  - **Cel**: Hermetyzacja logiki pobierania danych, zarządzania stanem i interakcji z API dla widoku szczegółów listy.
  - **Stan wewnętrzny**: Zarządza `listViewModel`, w tym `isLoading`, `isUpdating`, `error` oraz listą `items`.
  - **Funkcje API**: Implementuje funkcje do wywoływania endpointów API (fetch, update title, add item, update item, delete item).
  - **Aktualizacje stanu**: Aktualizuje `listViewModel` w odpowiedzi na akcje użytkownika i odpowiedzi API (rozważając aktualizacje optymistyczne).
  - **Sortowanie**: Implementuje logikę sortowania listy `items`, umieszczając zakupione na końcu.
  - **Obsługa błędów**: Przechwytuje błędy API i aktualizuje pole `error` w `listViewModel`.
- **Stan lokalny komponentów**:
  - `EditableShoppingListTitle`: `isEditing`, `currentValue` (wartość w inpucie podczas edycji).
  - `ProductItem`: `isEditingName`, `currentItemName` (wartość w inpucie podczas edycji).
  - `ProductInputArea`: `textareaValue`.

## 7. Integracja API
- **Pobieranie danych**: Po zamontowaniu komponentu `ShoppingListDetailView`, hook `useShoppingListDetail` wywołuje `GET /api/shopping-lists/:id` używając ID z parametrów routingu. Oczekiwana odpowiedź typu `GetShoppingListByIdResponse`.
- **Aktualizacja tytułu**: Funkcja w hooku wywołuje `PUT /api/shopping-lists/:id`. Oczekiwane żądanie typu `UpdateShoppingListRequest`, odpowiedź `UpdateShoppingListResponse`.
- **Dodawanie produktu**: Funkcja w hooku (wywołana np. z `ProductInputArea`) wywołuje `POST /api/shopping-lists/:listId/items`. Oczekiwane żądanie typu `AddItemToShoppingListRequest`, odpowiedź `AddItemToShoppingListResponse`.
- **Aktualizacja produktu**: Funkcja w hooku wywołuje `PUT /api/shopping-lists/:listId/items/:itemId`. Oczekiwane żądanie typu `UpdateShoppingListItemRequest`, odpowiedź `UpdateShoppingListItemResponse`.
- **Usuwanie produktu**: Funkcja w hooku wywołuje `DELETE /api/shopping-lists/:listId/items/:itemId`. Oczekiwana pusta odpowiedź (204).
- **Autoryzacja**: Wszystkie żądania muszą zawierać token JWT w nagłówku `Authorization: Bearer {token}` (obsługiwane przez globalny interceptor lub klienta API).

## 8. Interakcje użytkownika
- **Kliknięcie tytułu listy**: Rozpoczyna edycję inline (`EditableShoppingListTitle`).
- **Zapis tytułu listy**: Po `blur` lub `Enter` w inpucie tytułu, wywoływana jest funkcja aktualizacji w hooku -> API PUT -> aktualizacja stanu -> notyfikacja.
- **Kliknięcie nazwy produktu**: Rozpoczyna edycję inline (`ProductItem`).
- **Zapis nazwy produktu**: Po `blur` lub `Enter` w inpucie nazwy produktu, wywoływana jest funkcja aktualizacji w hooku -> API PUT -> aktualizacja stanu -> notyfikacja.
- **Kliknięcie Checkbox produktu**: Wywołuje funkcję `toggleItemPurchased` w hooku -> API PUT (zmiana `purchased`) -> aktualizacja stanu (styl, pozycja) -> notyfikacja.
- **Kliknięcie ikony usuwania produktu**: Wywołuje funkcję `deleteItem` w hooku -> API DELETE -> aktualizacja stanu (usunięcie z listy) -> notyfikacja.
- **Wpisanie tekstu w Textarea**: Aktualizuje stan lokalny `textareaValue`.
- **Kliknięcie "Wygeneruj listę zakupów"**: W MVP może parsować linie z `textareaValue` i wywoływać `addItem` w hooku dla każdej linii -> API POST -> aktualizacja stanu -> notyfikacja.

## 9. Warunki i walidacja
- **Edycja tytułu listy**: Musi zawierać 1-255 znaków. Walidacja przed wysłaniem do API. Wyświetlenie błędu walidacji przy inpucie.
- **Edycja nazwy produktu**: Musi zawierać 1-128 znaków. Walidacja przed wysłaniem do API. Wyświetlenie błędu walidacji przy inpucie.
- **Przycisk "Wygeneruj listę zakupów"**: Może być wyłączony, jeśli `textarea` jest pusta.
- **Przyciski/Inputy**: Powinny być wyłączone (disabled) i/lub pokazywać stan ładowania podczas trwania operacji API (kontrolowane przez stany `isLoading`, `isUpdating` w ViewModelach).

## 10. Obsługa błędów
- **Błąd pobierania listy (np. 404, 403, 500)**: Wyświetlić dedykowany komunikat błędu zamiast zawartości widoku.
- **Błąd aktualizacji/dodania/usunięcia (np. 400, 403, 500)**: Wyświetlić powiadomienie (toast) z treścią błędu z API. W przypadku aktualizacji optymistycznej, cofnąć zmiany w UI.
- **Błąd walidacji (klient)**: Wyświetlić komunikat błędu bezpośrednio przy odpowiednim polu formularza/inputa.

## 11. Kroki implementacji
1.  **Routing**: Skonfigurować routing w Astro, aby ścieżka `/shopping-lists/:id` renderowała komponent React `ShoppingListDetailView`.
2.  **Główny komponent (`ShoppingListDetailView`)**: Stworzyć komponent, który pobiera `:id` z routingu.
3.  **Custom Hook (`useShoppingListDetail`)**: Zaimplementować hook do zarządzania stanem (`listViewModel`) i logiką pobierania danych (`GET /api/shopping-lists/:id`). Obsłużyć stany ładowania i błędu.
4.  **Renderowanie podstawowe**: W `ShoppingListDetailView` użyć hooka i renderować podstawowe elementy: `EditableShoppingListTitle`, `ProductInputArea` (początkowo może być statyczne), `ProductList` (początkowo pusta lub z mockowymi danymi).
5.  **Komponent `EditableShoppingListTitle`**: Zaimplementować logikę edycji inline, walidację długości i wywołanie funkcji `updateTitle` z hooka `useShoppingListDetail` (którą trzeba będzie dodać do hooka).
6.  **Komponent `ProductList`**: Zaimplementować renderowanie listy `ProductItem` na podstawie danych z hooka. Dodać logikę sortowania (przenoszenie zakupionych na dół).
7.  **Komponent `ProductItem`**: Zaimplementować wyświetlanie nazwy, checkboxa i przycisku usuwania. Dodać logikę edycji inline dla nazwy (`EditableItemName`), walidację długości.
8.  **Integracja API (Aktualizacje/Usuwanie)**: Zaimplementować w hooku `useShoppingListDetail` funkcje `updateItem`, `deleteItem`, `toggleItemPurchased` wywołujące odpowiednie endpointy API (PUT, DELETE).
9.  **Interakcje `ProductItem`**: Podłączyć interakcje (checkbox, edycja, usuwanie) w `ProductItem` do odpowiednich funkcji z hooka przekazanych przez propsy.
10. **Komponent `ProductInputArea`**: Zaimplementować `Textarea` i przycisk. Dodać logikę (w hooku lub komponencie) do parsowania `textarea` i wywoływania funkcji `addItem` (która wywołuje `POST /api/shopping-lists/:listId/items`).
11. **Powiadomienia**: Zintegrować z globalnym systemem powiadomień (toastów) do wyświetlania sukcesu/błędu operacji API.
12. **Responsywność i Style**: Dopracować style Tailwind, zapewnić responsywność układu.
13. **Tryb Ciemny/Jasny**: Upewnić się, że komponenty poprawnie reagują na zmianę motywu.
14. **Testowanie**: Napisać testy jednostkowe dla logiki hooka, walidacji oraz testy integracyjne dla całego widoku. 


================================================
File: .ai/shopping-list-endpoint-implementation-plan.md
================================================
# Plan wdrożenia punktu końcowego API: Utworzenie listy zakupów

## 1. Przegląd punktu końcowego
Ten punkt końcowy pozwala uwierzytelnionym użytkownikom na utworzenie nowej listy zakupów. Jego głównym zadaniem jest dodanie nowego rekordu do tabeli shopping_lists, powiązanego z bieżącym użytkownikiem.

## 2. Szczegóły żądania
- **Metoda HTTP:** POST
- **Adres URL punktu końcowego:** `/api/shopping-lists`
- **Parametry:**
  - **Wymagane:**
    - `title` (string): Tytuł listy zakupów (nie może być pusty i musi zawierać od 1 do 255 znaków).
  - **Opcjonalne:** Brak
- **Treść żądania:**
  ```json
  {
    "title": "string"
  }
  ```

## 3. Wykorzystywane typy
- **DTO i modele komend:**
  - `CreateShoppingListRequest` – reprezentuje przychodzące żądanie, zawierające pojedyncze pole `title`.
  - `CreateShoppingListResponse` – reprezentuje odpowiedź, zawierającą pola `id`, `title`, `createdAt` oraz `updatedAt`.

Te typy są zdefiniowane w pliku `src/types.ts`.

## 4. Szczegóły odpowiedzi
- **Treść odpowiedzi:**
  ```json
  {
    "id": "uuid",
    "title": "string",
    "createdAt": "timestamp",
    "updatedAt": "timestamp"
  }
  ```
- **Kod statusu w przypadku sukcesu:** 201 Created

## 5. Przepływ danych
1. Uwierzytelniony użytkownik wysyła żądanie POST z tytułem listy zakupów.
2. Punkt końcowy waliduje treść żądania przy użyciu schematu Zod (upewniając się, że `title` jest poprawnym ciągiem znaków i spełnia ograniczenia długości).
3. ID użytkownika jest pobierane z kontekstu uwierzytelnienia (przy użyciu `context.locals.supabase` oraz poprawnego typu `SupabaseClient`).
4. Wywoływana jest funkcja warstwy serwisowej, która wykonuje operację wstawienia nowego rekordu do tabeli `shopping_lists`, automatycznie obsługując znaczniki czasu `created_at` i `updated_at`.
5. W przypadku powodzenia, nowo utworzony rekord listy zakupów jest zwracany w odpowiedzi.
6. W przypadku błędów walidacji lub autoryzacji, punkt końcowy zwraca odpowiedni kod błędu HTTP.

## 6. Względy bezpieczeństwa
- **Uwierzytelnienie i autoryzacja:**
  - Dostęp do tego punktu końcowego mają wyłącznie uwierzytelnieni użytkownicy. Token uwierzytelniający jest weryfikowany za pomocą Supabase przy użyciu `context.locals`.
- **Walidacja danych:**
  - Dane wejściowe są walidowane przy użyciu schematu Zod, aby upewnić się, że pole `title` spełnia wymagane kryteria (niepuste, odpowiednia długość).
- **Bezpieczeństwo bazy danych:**
  - Operacje na bazie danych są realizowane przy użyciu klienta Supabase z `context.locals`, co gwarantuje bezpieczne zarządzanie połączeniami oraz właściwą obsługę błędów.

## 7. Obsługa błędów
- **400 Bad Request:** Zwracany, gdy walidacja treści żądania nie powiedzie się (np. brak lub niepoprawne pole `title`).
- **401 Unauthorized:** Zwracany, gdy token uwierzytelniający jest nieobecny lub niepoprawny.
- **500 Internal Server Error:** Zwracany w przypadku nieoczekiwanych błędów po stronie serwera lub bazy danych.
- Wszystkie błędy powinny być logowane z wystarczającą ilością szczegółów, aby ułatwić diagnozowanie problemu, przy jednoczesnym zachowaniu poufności wrażliwych informacji.

## 8. Rozważania dotyczące wydajności
- Operacja polega na pojedynczym wstawieniu rekordu do bazy danych, co zazwyczaj jest szybkie i efektywne.
- Należy zadbać o odpowiednie indeksowanie tabeli `shopping_lists` (szczególnie kolumny `user_id`), aby zoptymalizować przyszłe zapytania.
- Monitorować działanie punktu końcowego pod kątem wydajności wraz ze wzrostem liczby użytkowników i w razie potrzeby dostosowywać indeksowanie oraz optymalizować zapytania.

## 9. Etapy wdrożenia
1. **Konfiguracja uwierzytelnienia:** Upewnić się, że middleware weryfikuje tokeny uwierzytelniające i ogranicza dostęp do punktu końcowego tylko dla uwierzytelnionych użytkowników.
2. **Walidacja danych wejściowych:** Zaimplementować schemat Zod do walidacji pola `title` w treści żądania.
3. **Implementacja warstwy serwisowej:** Utworzyć lub zaktualizować funkcję serwisową, która obsłuży logikę biznesową wstawiania nowej listy zakupów do bazy danych.
4. **Implementacja punktu końcowego API:** Opracować punkt końcowy POST `/api/shopping-lists` w ramach trasy Astro, integrując walidację i warstwę serwisową.
5. **Operacja na bazie danych:** Wykonać operację wstawienia przy użyciu klienta Supabase, zapewniając odpowiednią obsługę błędów podczas transakcji.
6. **Formowanie odpowiedzi:** Zwrócić odpowiedź z kodem 201 Created wraz z danymi nowo utworzonej listy zakupów lub odpowiednio obsłużyć błędy.
7. **Testowanie:** Napisać testy integracyjne, które obejmą scenariusze poprawnego utworzenia, błędy walidacji oraz sytuacje nieautoryzowanego dostępu.
8. **Dokumentacja:** Zaktualizować dokumentację API oraz przewodniki dla deweloperów o nowy punkt końcowy.
9. **Monitorowanie i logowanie:** Skonfigurować logowanie oraz monitorowanie wydajności, aby móc na bieżąco oceniać działanie punktu końcowego w środowisku produkcyjnym. 

# Plan wdrożenia punktu końcowego API: Pobieranie wszystkich list zakupów

## 1. Przegląd punktu końcowego
Ten punkt końcowy umożliwia uwierzytelnionym użytkownikom pobieranie wszystkich swoich list zakupów wraz z podstawowymi informacjami o każdej liście, w tym liczbą elementów. Obsługuje paginację, sortowanie i porządkowanie danych zgodnie z preferencjami użytkownika.

## 2. Szczegóły żądania
- **Metoda HTTP:** GET
- **Adres URL punktu końcowego:** `/api/shopping-lists`
- **Parametry:**
  - **Opcjonalne:**
    - `page` (integer, domyślnie: 1): Numer strony wyników
    - `pageSize` (integer, domyślnie: 20): Liczba elementów na stronę
    - `sort` (string, opcjonalnie): Pole, według którego sortowane są wyniki (title, createdAt, updatedAt)
    - `order` (string, opcjonalnie): Kolejność sortowania (asc, desc)

## 3. Wykorzystywane typy
- **DTO i modele komend:**
  - `ShoppingListSummaryDTO` – reprezentuje podsumowanie pojedynczej listy zakupów w odpowiedzi
  - `GetAllShoppingListsResponse` – reprezentuje pełną odpowiedź z danymi list zakupów i informacjami o paginacji
  - `PaginationResponse` – reprezentuje informacje o paginacji

Te typy są zdefiniowane w pliku `src/types.ts`.

## 4. Szczegóły odpowiedzi
- **Treść odpowiedzi:**
  ```json
  {
    "data": [
      {
        "id": "uuid",
        "title": "string",
        "createdAt": "timestamp",
        "updatedAt": "timestamp",
        "itemCount": "integer"
      }
    ],
    "pagination": {
      "totalItems": "integer",
      "totalPages": "integer",
      "currentPage": "integer",
      "pageSize": "integer"
    }
  }
  ```
- **Kod statusu w przypadku sukcesu:** 200 OK

## 5. Przepływ danych
1. Uwierzytelniony użytkownik wysyła żądanie GET z opcjonalnymi parametrami zapytania (page, pageSize, sort, order).
2. Punkt końcowy waliduje parametry zapytania (używając schematu Zod do sprawdzenia poprawności typów i zakresów wartości).
3. ID użytkownika jest pobierane z kontekstu uwierzytelniania (przy użyciu `context.locals.supabase`).
4. Wywoływana jest funkcja warstwy serwisowej, która:
   - Pobiera listy zakupów należące do użytkownika, uwzględniając parametry paginacji i sortowania
   - Wykonuje zapytanie liczące elementy dla każdej listy zakupów (lub wykorzystuje relację)
   - Oblicza informacje o paginacji (całkowita liczba elementów, liczba stron itp.)
5. W przypadku powodzenia, dane list zakupów wraz z informacjami o paginacji są zwracane w odpowiedzi.
6. W przypadku błędów uwierzytelniania, punkt końcowy zwraca odpowiedni kod błędu HTTP.

## 6. Względy bezpieczeństwa
- **Uwierzytelnienie i autoryzacja:**
  - Dostęp do tego punktu końcowego mają wyłącznie uwierzytelnieni użytkownicy. Token uwierzytelniający jest weryfikowany za pomocą Supabase przy użyciu `context.locals`.
  - Użytkownik może pobierać tylko własne listy zakupów, co jest zapewnione przez filtrowanie po `user_id` w zapytaniu do bazy danych.
- **Walidacja danych:**
  - Parametry zapytania są walidowane przy użyciu schematu Zod, aby zapewnić, że są odpowiedniego typu i mieszczą się w dozwolonych zakresach.
- **Bezpieczeństwo bazy danych:**
  - Zapytania do bazy danych są parametryzowane, aby zapobiec atakom SQL injection.
  - Operacje na bazie danych są realizowane przy użyciu klienta Supabase z `context.locals`, co zapewnia bezpieczne zarządzanie połączeniami.

## 7. Obsługa błędów
- **400 Bad Request:** Zwracany, gdy walidacja parametrów zapytania nie powiedzie się (np. nieprawidłowy format parametru).
- **401 Unauthorized:** Zwracany, gdy token uwierzytelniający jest nieobecny lub niepoprawny.
- **500 Internal Server Error:** Zwracany w przypadku nieoczekiwanych błędów po stronie serwera lub bazy danych.
- Wszystkie błędy powinny być logowane z wystarczającą ilością szczegółów, aby ułatwić diagnozowanie problemu, przy jednoczesnym zachowaniu poufności wrażliwych informacji.

## 8. Rozważania dotyczące wydajności
- Paginacja jest kluczowa dla optymalizacji wydajności, szczególnie gdy użytkownik ma wiele list zakupów.
- Zapytanie liczące elementy dla każdej listy zakupów może obciążać bazę danych; należy rozważyć zoptymalizowanie tego przez:
  - Agregowanie liczby elementów w jednym zapytaniu dla wszystkich list na stronie
  - Wykorzystanie relacji w Supabase do efektywnego pobierania liczby elementów
- Indeksy bazy danych powinny być zoptymalizowane dla zapytań sortowania (na kolumnach `user_id`, `title`, `created_at`, `updated_at`).
- Rozważyć wprowadzenie pamięci podręcznej (caching) dla często używanych list zakupów, aby zmniejszyć obciążenie bazy danych.

## 9. Etapy wdrożenia
1. **Konfiguracja uwierzytelnienia:** Upewnić się, że middleware weryfikuje tokeny uwierzytelniające i ogranicza dostęp do punktu końcowego tylko dla uwierzytelnionych użytkowników.
2. **Walidacja parametrów zapytania:** Zaimplementować schemat Zod do walidacji parametrów zapytania.
3. **Implementacja warstwy serwisowej:** Utworzyć lub zaktualizować funkcję serwisową, która obsłuży logikę biznesową pobierania list zakupów z paginacją i sortowaniem.
4. **Implementacja punktu końcowego API:** Opracować punkt końcowy GET `/api/shopping-lists` w ramach trasy Astro, integrując walidację i warstwę serwisową.
5. **Obsługa paginacji i sortowania:** Zaimplementować logikę do obsługi parametrów paginacji i sortowania w zapytaniach do bazy danych.
6. **Liczenie elementów list:** Zaimplementować efektywną metodę liczenia elementów dla każdej listy zakupów.
7. **Formowanie odpowiedzi:** Odpowiednio formatować odpowiedź z wykorzystaniem typów DTO i uwzględniać informacje o paginacji.
8. **Testowanie:** Napisać testy integracyjne, które obejmą różne scenariusze paginacji, sortowania oraz obsługę błędów.
9. **Optymalizacja wydajności:** Przeanalizować wydajność zapytań i zoptymalizować indeksy bazy danych.
10. **Dokumentacja:** Zaktualizować dokumentację API oraz przewodniki dla deweloperów o nowy punkt końcowy.
11. **Monitorowanie:** Skonfigurować monitorowanie wydajności punktu końcowego, aby identyfikować i rozwiązywać potencjalne problemy.

# Plan wdrożenia punktu końcowego API: Pobieranie listy zakupów według ID

## 1. Przegląd punktu końcowego
Ten punkt końcowy umożliwia uwierzytelnionym użytkownikom pobieranie szczegółowych informacji o konkretnej liście zakupów wraz ze wszystkimi jej elementami. Użytkownik może uzyskać dostęp tylko do własnych list zakupów.

## 2. Szczegóły żądania
- **Metoda HTTP:** GET
- **Adres URL punktu końcowego:** `/api/shopping-lists/{id}`
- **Parametry:**
  - **Wymagane:**
    - `id` (UUID): Identyfikator listy zakupów (jako parametr ścieżki)
  - **Opcjonalne:** Brak

## 3. Wykorzystywane typy
- **DTO i modele komend:**
  - `GetShoppingListByIdResponse` – reprezentuje odpowiedź zawierającą szczegóły listy zakupów i jej elementy
  - `ShoppingListItemDTO` – reprezentuje pojedynczy element listy zakupów w odpowiedzi

Te typy są zdefiniowane w pliku `src/types.ts`.

## 4. Szczegóły odpowiedzi
- **Treść odpowiedzi:**
  ```json
  {
    "id": "uuid",
    "title": "string",
    "createdAt": "timestamp",
    "updatedAt": "timestamp",
    "items": [
      {
        "id": "uuid",
        "itemName": "string",
        "purchased": "boolean",
        "createdAt": "timestamp",
        "updatedAt": "timestamp"
      }
    ]
  }
  ```
- **Kod statusu w przypadku sukcesu:** 200 OK

## 5. Przepływ danych
1. Uwierzytelniony użytkownik wysyła żądanie GET z identyfikatorem listy zakupów jako parametrem ścieżki.
2. Punkt końcowy waliduje format identyfikatora (UUID).
3. ID użytkownika jest pobierane z kontekstu uwierzytelniania (przy użyciu `context.locals.supabase`).
4. Wywoływana jest funkcja warstwy serwisowej, która:
   - Pobiera listę zakupów o określonym ID, należącą do użytkownika
   - Sprawdza, czy lista istnieje i czy należy do bieżącego użytkownika
   - Pobiera wszystkie elementy powiązane z tą listą zakupów
5. W przypadku znalezienia listy, jej dane wraz z elementami są zwracane w odpowiedzi.
6. W przypadku gdy lista nie zostanie znaleziona lub nie należy do bieżącego użytkownika, zwracany jest odpowiedni kod błędu.

## 6. Względy bezpieczeństwa
- **Uwierzytelnienie i autoryzacja:**
  - Dostęp do tego punktu końcowego mają wyłącznie uwierzytelnieni użytkownicy. Token uwierzytelniający jest weryfikowany za pomocą Supabase przy użyciu `context.locals`.
  - Autoryzacja jest implementowana przez sprawdzenie, czy lista zakupów należy do bieżącego użytkownika (`user_id` w rekordzie listy zakupów).
- **Walidacja danych:**
  - Parametr identyfikatora jest walidowany, aby zapewnić, że jest poprawnym UUID.
- **Bezpieczeństwo bazy danych:**
  - Zapytania do bazy danych są parametryzowane, aby zapobiec atakom SQL injection.
  - Operacje na bazie danych są realizowane przy użyciu klienta Supabase z `context.locals`, co zapewnia bezpieczne zarządzanie połączeniami.

## 7. Obsługa błędów
- **400 Bad Request:** Zwracany, gdy format identyfikatora jest nieprawidłowy.
- **401 Unauthorized:** Zwracany, gdy token uwierzytelniający jest nieobecny lub niepoprawny.
- **403 Forbidden:** Zwracany, gdy lista zakupów istnieje, ale nie należy do bieżącego użytkownika.
- **404 Not Found:** Zwracany, gdy lista zakupów o podanym identyfikatorze nie istnieje.
- **500 Internal Server Error:** Zwracany w przypadku nieoczekiwanych błędów po stronie serwera lub bazy danych.
- Wszystkie błędy powinny być logowane z wystarczającą ilością szczegółów, aby ułatwić diagnozowanie problemu, przy jednoczesnym zachowaniu poufności wrażliwych informacji.

## 8. Rozważania dotyczące wydajności
- Zapytanie powinno wykorzystywać relacje w bazie danych, aby efektywnie pobierać listę zakupów wraz z jej elementami.
- Dla list z dużą liczbą elementów może być potrzebna paginacja elementów, choć nie jest to wymagane w bieżącej specyfikacji.
- Indeksy bazy danych powinny być zoptymalizowane dla szybkiego wyszukiwania po `id` oraz `user_id`.
- Rozważyć wprowadzenie pamięci podręcznej (caching) dla często przeglądanych list zakupów, aby zmniejszyć obciążenie bazy danych.

## 9. Etapy wdrożenia
1. **Konfiguracja uwierzytelnienia:** Upewnić się, że middleware weryfikuje tokeny uwierzytelniające i ogranicza dostęp do punktu końcowego tylko dla uwierzytelnionych użytkowników.
2. **Walidacja parametru identyfikatora:** Zaimplementować walidację formatu UUID dla parametru ścieżki.
3. **Implementacja warstwy serwisowej:** Utworzyć lub zaktualizować funkcję serwisową, która obsłuży logikę biznesową pobierania listy zakupów wraz z jej elementami.
4. **Implementacja weryfikacji właściciela:** Upewnić się, że punktu końcowy sprawdza, czy lista należy do bieżącego użytkownika.
5. **Implementacja punktu końcowego API:** Opracować punkt końcowy GET `/api/shopping-lists/{id}` w ramach trasy Astro, integrując walidację i warstwę serwisową.
6. **Obsługa relacji bazy danych:** Zaimplementować efektywne zapytania wykorzystujące relacje między tabelami `shopping_lists` i `shopping_list_items`.
7. **Formowanie odpowiedzi:** Odpowiednio formatować odpowiedź z wykorzystaniem typów DTO.
8. **Testowanie:** Napisać testy integracyjne, które obejmą różne scenariusze, w tym pobieranie istniejącej listy, nieautoryzowany dostęp, nieistniejącą listę itp.
9. **Optymalizacja wydajności:** Przeanalizować wydajność zapytań i zoptymalizować indeksy bazy danych.
10. **Dokumentacja:** Zaktualizować dokumentację API oraz przewodniki dla deweloperów o nowy punkt końcowy.
11. **Monitorowanie:** Skonfigurować monitorowanie wydajności punktu końcowego, aby identyfikować i rozwiązywać potencjalne problemy.

# Plan wdrożenia punktu końcowego API: Aktualizacja listy zakupów

## 1. Przegląd punktu końcowego
Ten punkt końcowy umożliwia uwierzytelnionym użytkownikom aktualizację tytułu istniejącej listy zakupów. Użytkownik może aktualizować tylko własne listy zakupów.

## 2. Szczegóły żądania
- **Metoda HTTP:** PUT
- **Adres URL punktu końcowego:** `/api/shopping-lists/{id}`
- **Parametry:**
  - **Wymagane:**
    - `id` (UUID): Identyfikator listy zakupów (jako parametr ścieżki)
  - **Opcjonalne:** Brak
- **Treść żądania:**
  ```json
  {
    "title": "string"
  }
  ```

## 3. Wykorzystywane typy
- **DTO i modele komend:**
  - `UpdateShoppingListRequest` – reprezentuje przychodzące żądanie, zawierające pole `title`
  - `UpdateShoppingListResponse` – reprezentuje odpowiedź, zawierającą pola `id`, `title` oraz `updatedAt`

Te typy są zdefiniowane w pliku `src/types.ts`.

## 4. Szczegóły odpowiedzi
- **Treść odpowiedzi:**
  ```json
  {
    "id": "uuid",
    "title": "string",
    "updatedAt": "timestamp"
  }
  ```
- **Kod statusu w przypadku sukcesu:** 200 OK

## 5. Przepływ danych
1. Uwierzytelniony użytkownik wysyła żądanie PUT z identyfikatorem listy zakupów jako parametrem ścieżki i nowym tytułem w treści żądania.
2. Punkt końcowy waliduje format identyfikatora (UUID) oraz treść żądania (upewniając się, że pole `title` jest poprawnym ciągiem znaków i spełnia ograniczenia długości).
3. ID użytkownika jest pobierane z kontekstu uwierzytelniania (przy użyciu `context.locals.supabase`).
4. Wywoływana jest funkcja warstwy serwisowej, która:
   - Sprawdza, czy lista zakupów o podanym ID istnieje i należy do bieżącego użytkownika
   - Aktualizuje tytuł listy zakupów w bazie danych
   - Automatycznie aktualizuje znacznik czasu `updated_at`
5. W przypadku powodzenia, zaktualizowane dane listy zakupów są zwracane w odpowiedzi.
6. W przypadku błędów walidacji, autoryzacji lub gdy lista nie zostanie znaleziona, zwracany jest odpowiedni kod błędu.

## 6. Względy bezpieczeństwa
- **Uwierzytelnienie i autoryzacja:**
  - Dostęp do tego punktu końcowego mają wyłącznie uwierzytelnieni użytkownicy. Token uwierzytelniający jest weryfikowany za pomocą Supabase przy użyciu `context.locals`.
  - Autoryzacja jest implementowana przez sprawdzenie, czy lista zakupów należy do bieżącego użytkownika (`user_id` w rekordzie listy zakupów).
- **Walidacja danych:**
  - Parametr identyfikatora jest walidowany, aby zapewnić, że jest poprawnym UUID.
  - Dane wejściowe są walidowane przy użyciu schematu Zod, aby upewnić się, że pole `title` spełnia wymagane kryteria (niepuste, odpowiednia długość).
- **Bezpieczeństwo bazy danych:**
  - Zapytania do bazy danych są parametryzowane, aby zapobiec atakom SQL injection.
  - Operacje na bazie danych są realizowane przy użyciu klienta Supabase z `context.locals`, co zapewnia bezpieczne zarządzanie połączeniami.

## 7. Obsługa błędów
- **400 Bad Request:** Zwracany, gdy format identyfikatora jest nieprawidłowy lub walidacja treści żądania nie powiedzie się.
- **401 Unauthorized:** Zwracany, gdy token uwierzytelniający jest nieobecny lub niepoprawny.
- **403 Forbidden:** Zwracany, gdy lista zakupów istnieje, ale nie należy do bieżącego użytkownika.
- **404 Not Found:** Zwracany, gdy lista zakupów o podanym identyfikatorze nie istnieje.
- **500 Internal Server Error:** Zwracany w przypadku nieoczekiwanych błędów po stronie serwera lub bazy danych.
- Wszystkie błędy powinny być logowane z wystarczającą ilością szczegółów, aby ułatwić diagnozowanie problemu, przy jednoczesnym zachowaniu poufności wrażliwych informacji.

## 8. Rozważania dotyczące wydajności
- Operacja polega na pojedynczej aktualizacji rekordu w bazie danych, co zazwyczaj jest szybkie i efektywne.
- Indeksy bazy danych powinny być zoptymalizowane dla szybkiego wyszukiwania po `id` oraz `user_id`.
- Monitorować działanie punktu końcowego pod kątem wydajności wraz ze wzrostem liczby użytkowników i w razie potrzeby dostosowywać indeksowanie oraz optymalizować zapytania.

## 9. Etapy wdrożenia
1. **Konfiguracja uwierzytelnienia:** Upewnić się, że middleware weryfikuje tokeny uwierzytelniające i ogranicza dostęp do punktu końcowego tylko dla uwierzytelnionych użytkowników.
2. **Walidacja parametru identyfikatora:** Zaimplementować walidację formatu UUID dla parametru ścieżki.
3. **Walidacja danych wejściowych:** Zaimplementować schemat Zod do walidacji pola `title` w treści żądania.
4. **Implementacja warstwy serwisowej:** Utworzyć lub zaktualizować funkcję serwisową, która obsłuży logikę biznesową aktualizacji listy zakupów.
5. **Implementacja weryfikacji właściciela:** Upewnić się, że punktu końcowy sprawdza, czy lista należy do bieżącego użytkownika.
6. **Implementacja punktu końcowego API:** Opracować punkt końcowy PUT `/api/shopping-lists/{id}` w ramach trasy Astro, integrując walidację i warstwę serwisową.
7. **Operacja na bazie danych:** Wykonać operację aktualizacji przy użyciu klienta Supabase, zapewniając odpowiednią obsługę błędów podczas transakcji.
8. **Formowanie odpowiedzi:** Zwrócić odpowiedź z kodem 200 OK wraz z zaktualizowanymi danymi listy zakupów lub odpowiednio obsłużyć błędy.
9. **Testowanie:** Napisać testy integracyjne, które obejmą różne scenariusze aktualizacji, błędy walidacji, nieautoryzowany dostęp, nieistniejącą listę itp.
10. **Dokumentacja:** Zaktualizować dokumentację API oraz przewodniki dla deweloperów o nowy punkt końcowy.
11. **Monitorowanie:** Skonfigurować monitorowanie wydajności punktu końcowego, aby identyfikować i rozwiązywać potencjalne problemy.

# Plan wdrożenia punktu końcowego API: Usuwanie listy zakupów

## 1. Przegląd punktu końcowego
Ten punkt końcowy umożliwia uwierzytelnionym użytkownikom usuwanie istniejącej listy zakupów wraz ze wszystkimi jej elementami. Użytkownik może usuwać tylko własne listy zakupów.

## 2. Szczegóły żądania
- **Metoda HTTP:** DELETE
- **Adres URL punktu końcowego:** `/api/shopping-lists/{id}`
- **Parametry:**
  - **Wymagane:**
    - `id` (UUID): Identyfikator listy zakupów (jako parametr ścieżki)
  - **Opcjonalne:** Brak
- **Treść żądania:** Brak

## 3. Wykorzystywane typy
Dla tego punktu końcowego nie są definiowane specjalne typy DTO, ponieważ nie przekazuje ani nie zwraca danych.

## 4. Szczegóły odpowiedzi
- **Treść odpowiedzi:** Brak (pusta odpowiedź)
- **Kod statusu w przypadku sukcesu:** 204 No Content

## 5. Przepływ danych
1. Uwierzytelniony użytkownik wysyła żądanie DELETE z identyfikatorem listy zakupów jako parametrem ścieżki.
2. Punkt końcowy waliduje format identyfikatora (UUID).
3. ID użytkownika jest pobierane z kontekstu uwierzytelniania (przy użyciu `context.locals.supabase`).
4. Wywoływana jest funkcja warstwy serwisowej, która:
   - Sprawdza, czy lista zakupów o podanym ID istnieje i należy do bieżącego użytkownika
   - Usuwa wszystkie elementy powiązane z listą zakupów (dzięki klauzuli ON DELETE CASCADE w bazie danych)
   - Usuwa samą listę zakupów
5. W przypadku powodzenia, zwracana jest pusta odpowiedź z kodem 204 No Content.
6. W przypadku błędów autoryzacji lub gdy lista nie zostanie znaleziona, zwracany jest odpowiedni kod błędu.

## 6. Względy bezpieczeństwa
- **Uwierzytelnienie i autoryzacja:**
  - Dostęp do tego punktu końcowego mają wyłącznie uwierzytelnieni użytkownicy. Token uwierzytelniający jest weryfikowany za pomocą Supabase przy użyciu `context.locals`.
  - Autoryzacja jest implementowana przez sprawdzenie, czy lista zakupów należy do bieżącego użytkownika (`user_id` w rekordzie listy zakupów).
- **Walidacja danych:**
  - Parametr identyfikatora jest walidowany, aby zapewnić, że jest poprawnym UUID.
- **Bezpieczeństwo bazy danych:**
  - Zapytania do bazy danych są parametryzowane, aby zapobiec atakom SQL injection.
  - Operacje na bazie danych są realizowane przy użyciu klienta Supabase z `context.locals`, co zapewnia bezpieczne zarządzanie połączeniami.
  - Klauzula ON DELETE CASCADE w bazie danych zapewnia integralność danych przez automatyczne usuwanie powiązanych elementów listy.

## 7. Obsługa błędów
- **400 Bad Request:** Zwracany, gdy format identyfikatora jest nieprawidłowy.
- **401 Unauthorized:** Zwracany, gdy token uwierzytelniający jest nieobecny lub niepoprawny.
- **403 Forbidden:** Zwracany, gdy lista zakupów istnieje, ale nie należy do bieżącego użytkownika.
- **404 Not Found:** Zwracany, gdy lista zakupów o podanym identyfikatorze nie istnieje.
- **500 Internal Server Error:** Zwracany w przypadku nieoczekiwanych błędów po stronie serwera lub bazy danych.
- Wszystkie błędy powinny być logowane z wystarczającą ilością szczegółów, aby ułatwić diagnozowanie problemu, przy jednoczesnym zachowaniu poufności wrażliwych informacji.

## 8. Rozważania dotyczące wydajności
- Operacja usuwania powinna wykorzystywać klauzulę ON DELETE CASCADE w bazie danych, aby efektywnie usuwać wszystkie powiązane elementy listy w jednej transakcji.
- Dla list z dużą liczbą elementów, operacja usuwania może być bardziej obciążająca; należy monitorować wydajność.
- Indeksy bazy danych powinny być zoptymalizowane dla szybkiego wyszukiwania po `id` oraz `user_id`.

## 9. Etapy wdrożenia
1. **Konfiguracja uwierzytelnienia:** Upewnić się, że middleware weryfikuje tokeny uwierzytelniające i ogranicza dostęp do punktu końcowego tylko dla uwierzytelnionych użytkowników.
2. **Walidacja parametru identyfikatora:** Zaimplementować walidację formatu UUID dla parametru ścieżki.
3. **Implementacja warstwy serwisowej:** Utworzyć lub zaktualizować funkcję serwisową, która obsłuży logikę biznesową usuwania listy zakupów.
4. **Implementacja weryfikacji właściciela:** Upewnić się, że punktu końcowy sprawdza, czy lista należy do bieżącego użytkownika.
5. **Implementacja punktu końcowego API:** Opracować punkt końcowy DELETE `/api/shopping-lists/{id}` w ramach trasy Astro, integrując walidację i warstwę serwisową.
6. **Operacja na bazie danych:** Wykonać operację usuwania przy użyciu klienta Supabase, zapewniając odpowiednią obsługę błędów podczas transakcji.
7. **Formowanie odpowiedzi:** Zwrócić odpowiedź z kodem 204 No Content w przypadku powodzenia lub odpowiednio obsłużyć błędy.
8. **Testowanie:** Napisać testy integracyjne, które obejmą różne scenariusze usuwania, nieautoryzowany dostęp, nieistniejącą listę itp.
9. **Dokumentacja:** Zaktualizować dokumentację API oraz przewodniki dla deweloperów o nowy punkt końcowy.
10. **Monitorowanie:** Skonfigurować monitorowanie wydajności punktu końcowego, aby identyfikować i rozwiązywać potencjalne problemy.

# Wytyczne dla środowiska deweloperskiego

## Obsługa autoryzacji w wersji deweloperskiej

Zgodnie z istniejącą implementacją w `src/middleware/index.ts`, wszystkie opisane w dokumencie endpointy powinny automatycznie działać w środowisku deweloperskim **bez konieczności ręcznej autoryzacji**. Obecne rozwiązanie działa w następujący sposób:

1. **Wykrywanie środowiska deweloperskiego:**
   ```typescript
   // Sprawdzenie czy środowisko jest developmentem
   const isDevelopment = process.env.NODE_ENV === "development";
   ```

2. **Automatyczne przypisanie testowego użytkownika w trybie deweloperskim:**
   ```typescript
   // W środowisku deweloperskim automatycznie przypisujemy testowego użytkownika
   if (isDevelopment) {
     console.log("🔧 Tryb deweloperski: używanie testowego użytkownika");

     // Testowy użytkownik deweloperski dla łatwiejszego testowania API
     const devUser: User = {
       id: "4e0a9b6a-b416-48e6-8d35-5700bd1d674a",
       app_metadata: {},
       user_metadata: {},
       aud: "authenticated",
       email: "dev@example.com",
       created_at: new Date().toISOString(),
       role: "authenticated",
     };

     (context.locals as AstroLocals).user = devUser;
   } else {
     // W środowisku produkcyjnym standardowa weryfikacja uwierzytelnienia
     const {
       data: { user },
     } = await supabaseClient.auth.getUser();
     (context.locals as AstroLocals).user = user;
   }
   ```

3. **Zapewnienie dostępu do klienta Supabase:**
   ```typescript
   // Przypisanie klienta Supabase do context.locals
   context.locals.supabase = supabaseClient;
   ```

## Stosowanie w endpointach

Każdy z opisanych endpointów powinien wykorzystywać ten mechanizm poprzez:

1. **Pobieranie informacji o użytkowniku z kontekstu:**
   ```typescript
   const { user } = context.locals;
   const userId = user?.id;
   
   // Sprawdzenie czy użytkownik jest dostępny
   if (!userId) {
     return new Response(JSON.stringify({ error: 'Brak autoryzacji' }), {
       status: 401,
       headers: { 'Content-Type': 'application/json' }
     });
   }
   ```

2. **Wykorzystanie klienta Supabase z kontekstu:**
   ```typescript
   const { supabase } = context.locals;
   
   // Przykład operacji na bazie danych
   const { data, error } = await supabase
     .from('shopping_lists')
     .select('*')
     .eq('user_id', userId);
   ```

## Uwagi implementacyjne

1. **Identyfikator użytkownika deweloperskiego:**
   Istniejący identyfikator użytkownika deweloperskiego to `4e0a9b6a-b416-48e6-8d35-5700bd1d674a`. Należy upewnić się, że ten sam identyfikator jest używany we wszystkich endpointach oraz testach.

2. **Weryfikacja właściciela zasobów:**
   Pomimo automatycznego uwierzytelniania w trybie deweloperskim, nadal należy implementować sprawdzanie, czy użytkownik jest właścicielem zasobu. Dzięki temu:
   - Kod będzie spójny między środowiskami deweloperskimi i produkcyjnymi
   - Łatwiejsze będzie wykrycie potencjalnych problemów z autoryzacją
   - Zapewniona zostanie integralność danych testowych

3. **Logowanie:**
   Zachować komunikat logujący informujący o pracy w trybie deweloperskim, co ułatwi diagnostykę podczas testowania:
   ```typescript
   if (isDevelopment) {
     console.log(`🔧 Endpoint ${endpointName} działa w trybie deweloperskim`);
   }
   ```

4. **Testowanie:**
   Testy integracyjne powinny uwzględniać zarówno scenariusze z włączonym trybem deweloperskim, jak i z symulowaną autoryzacją produkcyjną, aby zapewnić pełne pokrycie testami. 


================================================
File: .ai/shopping-lists-view-implementation-plan.md
================================================
# Plan implementacji widoku Listy Zakupów

## 1. Przegląd
Widok Listy Zakupów (`ShoppingListsView`) jest głównym widokiem dla zalogowanego użytkownika. Wyświetla on wszystkie listy zakupów należące do użytkownika, posortowane domyślnie według daty utworzenia (najnowsze na górze). Umożliwia tworzenie nowych list oraz przechodzenie do szczegółów istniejących list, a także ich usuwanie. Widok jest responsywny, obsługuje tryb ciemny/jasny i jest częścią głównego layoutu aplikacji z nawigacją boczną.

## 2. Routing widoku
- **Ścieżka**: `/` (ścieżka główna po zalogowaniu dla zwykłego użytkownika)

## 3. Struktura komponentów
```
AppLayout
└── SideNav
└── ShoppingListsView (Route: /)
    ├── PageHeader (np. "Twoje Listy Zakupów")
    ├── CreateListButton
    └── ShoppingLists
        └── ShoppingListItem (mapped)
            ├── ListTitleLink
            └── DeleteListButton (Shadcn - Icon Button)
```

## 4. Szczegóły komponentów

### `ShoppingListsView`
- **Opis**: Główny kontener widoku. Odpowiedzialny za pobieranie listy zakupów użytkownika, zarządzanie stanem (ładowanie, błędy) oraz przekazywanie danych do komponentów podrzędnych.
- **Główne elementy**: `PageHeader`, `CreateListButton`, `ShoppingLists`.
- **Obsługiwane interakcje**: Inicjuje pobieranie danych przy montowaniu.
- **Obsługiwana walidacja**: Brak bezpośredniej walidacji, obsługuje stany błędów z API.
- **Typy**: `ShoppingListsViewModel`, `ShoppingListSummaryDTO`.
- **Propsy**: Brak.

### `PageHeader`
- **Opis**: Prosty komponent wyświetlający tytuł strony, np. "Twoje Listy Zakupów".
- **Główne elementy**: `<h1>` lub podobny tag semantyczny.
- **Obsługiwane interakcje**: Brak.
- **Obsługiwana walidacja**: Brak.
- **Typy**: Brak.
- **Propsy**: `title: string`.

### `CreateListButton`
- **Opis**: Przycisk inicjujący proces tworzenia nowej listy zakupów. Po kliknięciu wywołuje funkcję API do utworzenia listy z domyślną nazwą i przekierowuje użytkownika do widoku szczegółów nowo utworzonej listy.
- **Główne elementy**: `Button` (Shadcn, wyróżniony kolorem, np. z ikoną plusa).
- **Obsługiwane interakcje**: `onClick`.
- **Obsługiwana walidacja**: Brak.
- **Typy**: `CreateShoppingListRequest`, `CreateShoppingListResponse`.
- **Propsy**: `onCreateList: () => Promise<string | null>` (zwraca ID nowej listy lub null w razie błędu).

### `ShoppingLists`
- **Opis**: Renderuje listę komponentów `ShoppingListItem`. Wyświetla informację, jeśli lista jest pusta lub podczas ładowania.
- **Główne elementy**: Lista (`<ul>` lub `<div>`), mapowanie `ShoppingListItem`, komponent stanu ładowania (np. skeleton), komunikat o braku list.
- **Obsługiwane interakcje**: Brak bezpośrednich interakcji.
- **Obsługiwana walidacja**: Brak.
- **Typy**: `ShoppingListItemViewModel[]`.
- **Propsy**: `lists: ShoppingListItemViewModel[]`, `isLoading: boolean`, `onDeleteList: (listId: string) => Promise<void>`.

### `ShoppingListItem`
- **Opis**: Reprezentuje pojedynczy element na liście list zakupów. Wyświetla tytuł listy (jako link do szczegółów) oraz przycisk usunięcia.
- **Główne elementy**: Kontener (`<li>` lub `<div>`), `ListTitleLink` (komponent wewnętrzny lub link), `DeleteListButton` (Shadcn, ikona kosza).
- **Obsługiwane interakcje**: Kliknięcie tytułu (nawigacja do `/shopping-lists/:id`), kliknięcie przycisku usuwania.
- **Obsługiwana walidacja**: Brak.
- **Typy**: `ShoppingListItemViewModel`.
- **Propsy**: `list: ShoppingListItemViewModel`, `onDeleteList: (listId: string) => Promise<void>`.

### `ListTitleLink` (Komponent wewnętrzny `ShoppingListItem`)
- **Opis**: Wyświetla tytuł listy jako link nawigujący do szczegółów tej listy.
- **Główne elementy**: Komponent Link z Astro/React Router (`<a href={`/shopping-lists/${listId}`}>`).
- **Obsługiwane interakcje**: Kliknięcie.
- **Obsługiwana walidacja**: Brak.
- **Typy**: Brak.
- **Propsy**: `listId: string`, `title: string`.

### `DeleteListButton`
- **Opis**: Przycisk (ikona) inicjujący proces usuwania listy zakupów. Po kliknięciu otwiera modal potwierdzający.
- **Główne elementy**: `Button` (Shadcn, wariant ikony, np. kosz).
- **Obsługiwane interakcje**: `onClick`.
- **Obsługiwana walidacja**: Brak.
- **Typy**: Brak.
- **Propsy**: `listId: string`, `listTitle: string`, `onConfirmDelete: (listId: string) => Promise<void>`.

## 5. Typy

- **Istniejące typy (z `src/types.ts`)**: `ShoppingListSummaryDTO`, `GetAllShoppingListsResponse`, `PaginationResponse`, `CreateShoppingListRequest`, `CreateShoppingListResponse`.

- **Nowe typy ViewModel**:
  ```typescript
  // Model widoku dla całego widoku listy zakupów
  interface ShoppingListsViewModel {
    lists: ShoppingListItemViewModel[]; // Lista list zakupów (ViewModel)
    isLoading: boolean;               // Status ładowania danych
    isCreating: boolean;              // Status tworzenia nowej listy
    error: string | null;             // Komunikat błędu API
    pagination: PaginationResponse | null; // Informacje o paginacji (jeśli zaimplementowana)
  }

  // Model widoku dla pojedynczego elementu na liście list zakupów
  interface ShoppingListItemViewModel extends ShoppingListSummaryDTO {
    isDeleting: boolean; // Czy lista jest aktualnie usuwana?
  }
  ```

## 6. Zarządzanie stanem
- **Główny stan widoku** (`ShoppingListsView`):
  - `viewModel: ShoppingListsViewModel` - Przechowuje wszystkie dane i stany UI dla widoku.
  - Będzie zarządzany przez custom hook `useShoppingLists`.
- **Custom Hook `useShoppingLists()`**:
  - **Cel**: Hermetyzacja logiki pobierania listy zakupów, tworzenia nowych list, usuwania istniejących i zarządzania stanem widoku.
  - **Stan wewnętrzny**: Zarządza `viewModel`, w tym `isLoading`, `isCreating`, `error` oraz listą `lists`.
  - **Funkcje API**: Implementuje funkcje do wywoływania endpointów API (`GET /api/shopping-lists`, `POST /api/shopping-lists`, `DELETE /api/shopping-lists/:id`).
  - **Aktualizacje stanu**: Aktualizuje `viewModel` w odpowiedzi na akcje użytkownika i odpowiedzi API (rozważając aktualizacje optymistyczne dla usuwania).
  - **Sortowanie**: Domyślnie sortuje po `createdAt` malejąco (po stronie API lub klienta).
  - **Obsługa błędów**: Przechwytuje błędy API i aktualizuje pole `error` w `viewModel`.
  - **Przekierowanie**: Po pomyślnym utworzeniu listy, hook może zwrócić ID nowej listy, a komponent `ShoppingListsView` obsłuży przekierowanie.
- **Stan lokalny komponentów**:
  - `DeleteListButton`: Stan zarządzania widocznością modala potwierdzającego.

## 7. Integracja API
- **Pobieranie danych**: Po zamontowaniu komponentu `ShoppingListsView`, hook `useShoppingLists` wywołuje `GET /api/shopping-lists` (z ewentualnymi parametrami domyślnej paginacji/sortowania). Oczekiwana odpowiedź typu `GetAllShoppingListsResponse`.
- **Tworzenie listy**: Funkcja `createList` w hooku wywołuje `POST /api/shopping-lists`. Oczekiwane żądanie typu `CreateShoppingListRequest` (tytuł generowany automatycznie wg formatu), odpowiedź `CreateShoppingListResponse`.
- **Usuwanie listy**: Funkcja `deleteList` w hooku wywołuje `DELETE /api/shopping-lists/:id`. Oczekiwana pusta odpowiedź (204).
- **Autoryzacja**: Wszystkie żądania muszą zawierać token JWT.

## 8. Interakcje użytkownika
- **Kliknięcie "Utwórz nową listę zakupów"**: Wywołuje funkcję `createList` w hooku -> API POST -> (po sukcesie) hook zwraca ID -> `ShoppingListsView` przekierowuje do `/shopping-lists/:newId` -> notyfikacja.
- **Kliknięcie tytułu listy**: Nawigacja do `/shopping-lists/:id`.
- **Kliknięcie ikony usuwania listy**: Otwiera modal potwierdzający.
- **Potwierdzenie usunięcia w modalu**: Wywołuje funkcję `deleteList` w hooku -> API DELETE -> aktualizacja stanu (usunięcie z listy, optymistycznie) -> notyfikacja.

## 9. Warunki i walidacja
- **Przycisk "Utwórz nową listę zakupów"**: Może być wyłączony (`disabled`) podczas tworzenia listy (`isCreating` w `viewModel`).
- **Przyciski usuwania**: Mogą być wyłączone (`disabled`) podczas usuwania danej listy (`isDeleting` w `ShoppingListItemViewModel`).
- **Widok**: Wyświetla stan ładowania (`isLoading`) lub komunikat o błędzie (`error`). Wyświetla informację, jeśli użytkownik nie ma żadnych list.

## 10. Obsługa błędów
- **Błąd pobierania list (np. 401, 500)**: Wyświetlić dedykowany komunikat błędu zamiast listy.
- **Błąd tworzenia listy (np. 400, 401, 500)**: Wyświetlić powiadomienie (toast) z treścią błędu z API.
- **Błąd usuwania listy (np. 401, 403, 404, 500)**: Wyświetlić powiadomienie (toast) z treścią błędu z API. W przypadku aktualizacji optymistycznej, przywrócić usunięty element do listy.

## 11. Kroki implementacji
1.  **Routing**: Upewnić się, że ścieżka `/` dla zalogowanego użytkownika (nie admina) renderuje `ShoppingListsView`.
2.  **Główny komponent (`ShoppingListsView`)**: Stworzyć komponent.
3.  **Custom Hook (`useShoppingLists`)**: Zaimplementować hook do zarządzania stanem (`viewModel`) i logiką pobierania danych (`GET /api/shopping-lists`). Obsłużyć stany ładowania i błędu.
4.  **Renderowanie podstawowe**: W `ShoppingListsView` użyć hooka i renderować `PageHeader`, `CreateListButton`, `ShoppingLists` (z obsługą stanu ładowania i braku list).
5.  **Komponent `ShoppingLists`**: Zaimplementować renderowanie listy `ShoppingListItem` na podstawie danych z hooka.
6.  **Komponent `ShoppingListItem`**: Zaimplementować wyświetlanie tytułu jako linku (`ListTitleLink`) i przycisku usuwania (`DeleteListButton`).
7.  **Logika tworzenia listy**: Zaimplementować funkcję `createList` w hooku `useShoppingLists`, która generuje domyślny tytuł, wywołuje `POST /api/shopping-lists` i obsługuje przekierowanie po sukcesie.
8.  **Logika usuwania listy**: Zaimplementować funkcję `deleteList` w hooku `useShoppingLists`, która wywołuje `DELETE /api/shopping-lists/:id`. Zintegrować z komponentem `Modal` wywoływanym przez `DeleteListButton`.
9.  **Powiadomienia**: Zintegrować z globalnym systemem powiadomień (toastów) dla operacji tworzenia i usuwania.
10. **Responsywność i Style**: Dopracować style Tailwind, zapewnić responsywność układu.
11. **Tryb Ciemny/Jasny**: Upewnić się, że komponenty poprawnie reagują na zmianę motywu.
12. **Testowanie**: Napisać testy jednostkowe dla logiki hooka oraz testy integracyjne dla całego widoku. 


================================================
File: .ai/tech-stack.md
================================================
# ShopListeo

## 1. Project Name
ShopListeo

## 2. Project Description
ShopListeo is a web application designed to simplify the creation, management, and editing of shopping lists. The application leverages an AI assistant to convert free-form text input into a structured shopping list. Users can interact with the system by manually editing the list, as well as toggling items to mark them as purchased in real time. All AI interactions are conducted via JSON, and the complete conversation history is logged to enable detailed analysis.

## 3. Tech Stack
### Frontend
- **Astro 5**: Enables building fast and efficient websites with minimal JavaScript.
- **React 19**: Provides interactive components where needed.
- **TypeScript 5**: Offers static type checking for improved code quality and IDE support.
- **Tailwind CSS 4**: Facilitates rapid styling using a utility-first approach.
- **Shadcn/ui**: A library of accessible React components to serve as the UI foundation.

### Backend
- **Supabase**: Provides a comprehensive backend solution with PostgreSQL, multi-language SDKs (Backend-as-a-Service), built-in authentication, and flexible hosting options.

### Artificial Intelligence
- **Openrouter.ai**: Allows communication with various AI models (such as OpenAI, Anthropic, and Google) to process shopping data efficiently while maintaining low costs. It also supports setting financial limits on API keys.

### CI/CD and Hosting
- **Github Actions**: Used to create CI/CD pipelines.
- **DigitalOcean**: Hosts the application using Docker containers.

### Testing
- **Vitest**: A blazing fast unit testing framework that replaces Jest, providing a better developer experience with features like watch mode and UI.
- **React Testing Library**: Utilities for testing React components in a way that simulates user behavior.
- **Playwright**: End-to-end testing framework for testing web applications across all modern browsers.
- **MSW (Mock Service Worker)**: API mocking library that intercepts requests for testing isolated components.
- **Storybook**: Tool for developing and testing UI components in isolation.
- **Lighthouse CI**: Tool for measuring web performance metrics.
- **Axe**: Automated tool for testing accessibility compliance.

## 4. Getting Started Locally
### Prerequisites
- Node.js v22.14.0 (as specified in the `.nvmrc` file)
- npm (included with Node.js)

### Steps
1. Clone the repository:
   ```bash
   git clone git@github.com:pawel-wojtyczka/ShopListeo.git
   cd ShopListeo
   ```
2. Install dependencies:
   ```bash
   npm install
   ```
3. Run the development server:
   ```bash
   npm run dev
   ```
4. Build the application for production:
   ```bash
   npm run build
   ```

## 5. Available Scripts
- `npm run dev` – Starts the development server.
- `npm run build` – Builds the application for production.
- `npm run preview` – Previews the production build.
- `npm run lint` – Runs ESLint to check code quality.
- `npm run lint:fix` – Automatically fixes linting issues.
- `npm run test` – Runs unit tests with Vitest.
- `npm run test:ui` – Runs Vitest with UI for interactive testing.
- `npm run test:coverage` – Runs tests with coverage report.
- `npm run test:e2e` – Runs end-to-end tests with Playwright.
- `npm run storybook` – Starts Storybook for component development and testing.

## 6. Project Scope
The initial MVP of ShopListeo focuses on the core functionality:
- **User Authentication:** Registration and login via email and password, with data stored in ISO 8601 format.
- **Shopping List Management:** Create, edit, and delete shopping lists. Users can input free text which is processed by the AI, and then manually adjust the list.
- **AI Integration:** Convert free-form text into a structured shopping list using an AI assistant. All communication is done via JSON, preserving conversation history.
- **Item Toggle Functionality:** Real-time marking of items as purchased (which changes their appearance) and the ability to reverse the action.
- **Finalization:** Users can finalize the shopping list, which triggers logging of the entire AI conversation for analytical purposes.

Additional features (such as advanced error handling, admin panels, or mobile support) are not part of the MVP and are planned for future releases.

## 7. Project Status
The project is currently in the MVP stage and under active development. Future enhancements will include additional functionalities such as sharing lists, voice-to-text input, and mobile application support.

## 8. License
MIT 


================================================
File: .ai/test-plan-gemini.md
================================================
# Plan Testów dla Projektu "ShopListeo"

## 1. Wprowadzenie i cele testowania

### 1.1. Wprowadzenie

Niniejszy dokument przedstawia kompleksowy plan testów dla aplikacji webowej "ShopListeo", zbudowanej w oparciu o nowoczesny stack technologiczny включающий Astro, React, TypeScript, Supabase oraz integrację z AI (OpenRouter). Aplikacja umożliwia użytkownikom zarządzanie listami zakupów, w tym ich tworzenie, edycję, usuwanie oraz dodawanie i zarządzanie produktami na listach, z wykorzystaniem inteligentnego parsowania danych wejściowych.

Plan ten definiuje strategię, zakres, zasoby, harmonogram oraz kryteria akceptacji dla procesu testowania projektu, mając na celu zapewnienie wysokiej jakości, niezawodności, bezpieczeństwa i użyteczności aplikacji przed jej wdrożeniem.

### 1.2. Cele testowania

Główne cele procesu testowania obejmują:

*   **Weryfikacja funkcjonalności:** Potwierdzenie, że wszystkie zaimplementowane funkcje (autoryzacja, zarządzanie listami i produktami, integracja AI) działają zgodnie ze specyfikacją i dokumentacją API.
*   **Identyfikacja i eliminacja błędów:** Wykrycie defektów oprogramowania na jak najwcześniejszym etapie cyklu rozwoju.
*   **Ocena jakości:** Zapewnienie, że aplikacja spełnia ustalone standardy jakości, wydajności, bezpieczeństwa i użyteczności.
*   **Weryfikacja integracji:** Sprawdzenie poprawnej współpracy pomiędzy komponentami front-endowymi (React/Astro), back-endowymi (API endpoints, Supabase), middleware oraz usługami zewnętrznymi (OpenRouter).
*   **Zapewnienie bezpieczeństwa:** Weryfikacja mechanizmów autoryzacji, autentykacji oraz ochrony danych użytkowników, w tym Row Level Security (RLS) w Supabase.
*   **Ocena wydajności:** Wstępna ocena czasu odpowiedzi aplikacji i jej zachowania pod obciążeniem (w zakresie określonym w planie).
*   **Walidacja dokumentacji API:** Sprawdzenie zgodności działania endpointów API z dostarczoną dokumentacją (`docs/api/`).

## 2. Zakres testów

### 2.1. Funkcjonalności objęte testami

Testowaniu podlegają następujące moduły i funkcjonalności:

*   **Moduł Autoryzacji:**
    *   Rejestracja użytkownika (formularz, walidacja, API, proces Supabase).
    *   Logowanie użytkownika (formularz, walidacja, API, zarządzanie sesją/tokenem).
    *   Wylogowywanie użytkownika (interfejs, czyszczenie sesji/tokenu, API).
    *   Odzyskiwanie hasła (formularz żądania resetu, wysyłka emaila przez Supabase, formularz ustawiania nowego hasła, walidacja tokenu, API).
    *   Zarządzanie stanem autoryzacji (`AuthContext`, middleware).
    *   Mechanizmy przekierowań dla użytkowników zalogowanych/niezalogowanych (Middleware).
*   **Moduł List Zakupów (CRUD):**
    *   Tworzenie nowej listy zakupów (przycisk, API klienta, API serwera, usługa).
    *   Wyświetlanie listy wszystkich list zakupów (komponent `ShoppingListsView`, hook `useShoppingLists`, paginacja, sortowanie, API).
    *   Wyświetlanie szczegółów pojedynczej listy zakupów (komponent `ShoppingListDetailView`, hook `useShoppingListDetail`, API).
    *   Aktualizacja tytułu listy zakupów (komponent `EditableShoppingListTitle`, API klienta, API serwera, usługa).
    *   Usuwanie listy zakupów (przycisk, dialog potwierdzający, API klienta, API serwera, usługa, usuwanie kaskadowe elementów).
*   **Moduł Produktów na Liście Zakupów (CRUD):**
    *   Dodawanie produktu do listy (ręcznie - niezaimplementowane w pełni, ale planowane).
    *   Dodawanie produktów za pomocą AI (komponent `ProductInputArea`, API `/ai-parse`, `OpenRouterService`, aktualizacja listy).
    *   Oznaczanie produktu jako kupiony/niekupiony (checkbox, hook `useShoppingListDetail`, API klienta, API serwera, usługa).
    *   Edycja nazwy produktu (interfejs w `ProductItem`, hook `useShoppingListDetail`, API klienta, API serwera, usługa).
    *   Usuwanie produktu z listy (przycisk, hook `useShoppingListDetail`, API klienta, API serwera, usługa).
    *   Czyszczenie wszystkich produktów z listy (API `/clear-items`).
*   **Moduł Zarządzania Użytkownikami (Admin & User):**
    *   Pobieranie danych własnego użytkownika (`/api/users/me`).
    *   Pobieranie danych użytkownika po ID (API `/api/users/[id]`, sprawdzanie uprawnień).
    *   Pobieranie listy wszystkich użytkowników (API `/api/users/index`, tylko admin, paginacja, sortowanie, filtrowanie).
    *   Aktualizacja danych użytkownika (API `/api/users/[id]`, własne dane lub admin).
    *   Usuwanie użytkownika (API `/api/users/[id]`, własne konto lub admin).
    *   Mechanizm sprawdzania uprawnień administratora (`adminAuth.ts`).
*   **Komponenty UI:**
    *   Poprawność renderowania i działania podstawowych komponentów UI (`components/ui`).
    *   Działanie powiadomień (`ToastProvider`, `toast-service`).
    *   Layouty (`AuthLayout`, `MainLayout`).
*   **Middleware:**
    *   Obsługa żądań, wstrzykiwanie klienta Supabase (`locals.supabase`).
    *   Ustawianie danych użytkownika i stanu autoryzacji (`locals.user`, `locals.authUser`, `locals.isAuthenticated`).
    *   Logika przekierowań dla ścieżek chronionych, autoryzacyjnych i administracyjnych.
    *   Obsługa plików statycznych.
    *   Zarządzanie cookies sesji (`authToken`, `sb-*`).
*   **API Endpoints:**
    *   Walidacja danych wejściowych (Zod).
    *   Poprawność odpowiedzi (kody statusu, format JSON).
    *   Obsługa błędów (walidacja, autoryzacja, błędy serwera).
    *   Zgodność z dokumentacją (`docs/api/`).
    *   Weryfikacja działania endpointów klienckich (`/api/client/*`) opartych na sesji middleware.
*   **Integracja z Supabase:**
    *   Poprawność zapytań do bazy danych.
    *   Działanie Row Level Security (RLS) - weryfikacja, czy użytkownik ma dostęp tylko do swoich danych.
    *   Obsługa logowania i rejestracji przez Supabase Auth.
    *   Obsługa resetowania hasła przez Supabase Auth.
*   **Integracja z OpenRouter:**
    *   Poprawność wysyłania zapytań do API AI.
    *   Poprawność parsowania odpowiedzi AI.
    *   Obsługa błędów komunikacji z API AI.
    *   Bezpieczeństwo klucza API (uwaga na `HARDCODED_API_KEY`!).

### 2.2. Funkcjonalności wyłączone z testów

*   Testowanie samego frameworka Astro i biblioteki React (zakładamy ich poprawność).
*   Testowanie infrastruktury Supabase (np. dostępność serwerów, wewnętrzne mechanizmy bazy danych).
*   Testowanie wewnętrznych mechanizmów modelu AI OpenRouter (testujemy tylko integrację i przetwarzanie odpowiedzi).
*   Kompleksowe testy penetracyjne (mogą być przeprowadzone osobno).
*   Testowanie kompatybilności ze starszymi lub niszowymi przeglądarkami (skupiamy się na najnowszych wersjach popularnych przeglądarek).
*   Testowanie specyficznych problemów związanych z React 19 wspomnianych w `ShoppingListItem.test.tsx` (wymaga dalszej analizy i potencjalnego rozwiązania problemu przed pełnym testowaniem komponentu).

## 3. Typy testów do przeprowadzenia

*   **Testy Jednostkowe (Unit Tests):**
    *   **Cel:** Weryfikacja poprawności działania izolowanych fragmentów kodu (funkcje, komponenty React, hooki, serwisy, walidatory).
    *   **Narzędzia:** Vitest, React Testing Library.
    *   **Zakres:** Funkcje pomocnicze (`lib/utils`, `lib/auth/adminAuth`), walidatory Zod (`lib/validators`, `lib/schemas`), komponenty UI (renderowanie, podstawowe interakcje), logika w hookach (mockując API/kontekst), serwisy (mockując Supabase/OpenRouter), logika formatowania daty (`ShoppingListItem.test.tsx`).
*   **Testy Integracyjne (Integration Tests):**
    *   **Cel:** Weryfikacja poprawnej współpracy pomiędzy różnymi modułami aplikacji.
    *   **Narzędzia:** Vitest, React Testing Library, Mock Service Worker (MSW) lub mocki `fetch`.
    *   **Zakres:** Interakcja komponentów React z hookami i kontekstem (`AuthContext`), wywołania API z komponentów/hooków (mockując `fetch`), współpraca formularzy (React Hook Form) z logiką walidacji i wysyłki, interakcja serwisów (np. `AuthService` z `userService`). Testowanie API endpointów (`tests/api`, `tests/endpoints`) z mockowanym Supabase.
*   **Testy End-to-End (E2E Tests):**
    *   **Cel:** Symulacja rzeczywistych scenariuszy użytkownika w przeglądarce, weryfikacja przepływów pracy obejmujących UI, API i bazę danych.
    *   **Narzędzia:** Playwright lub Cypress.
    *   **Zakres:** Pełny przepływ rejestracji, logowania i wylogowania. Pełny cykl życia listy zakupów (tworzenie, dodawanie/edycja/usuwanie elementów, usuwanie listy). Scenariusze związane z AI parsing. Podstawowe scenariusze odzyskiwania hasła. Testowanie działania middleware (przekierowania).
*   **Testy API:**
    *   **Cel:** Bezpośrednia weryfikacja działania endpointów API (request/response, walidacja, kody statusu, obsługa błędów, autoryzacja).
    *   **Narzędzia:** Postman, Insomnia, Vitest (dla testów programistycznych API jak w `tests/endpoints`).
    *   **Zakres:** Wszystkie endpointy w `pages/api/`, weryfikacja zgodności z dokumentacją (`docs/api/`). Testowanie zarówno standardowych API, jak i klienckich (`/api/client/*`).
*   **Testy Bezpieczeństwa (Podstawowe):**
    *   **Cel:** Identyfikacja podstawowych luk bezpieczeństwa.
    *   **Narzędzia:** Ręczna weryfikacja, narzędzia deweloperskie przeglądarki, Supabase Studio (RLS).
    *   **Zakres:** Weryfikacja logiki autoryzacji (dostęp do danych innych użytkowników - testy negatywne), sprawdzanie działania RLS w Supabase, walidacja danych wejściowych (zapobieganie XSS/injection - podstawowo), weryfikacja bezpieczeństwa obsługi tokenów/sesji (cookies `httpOnly`, `secure`), sprawdzenie mechanizmu resetu hasła pod kątem podatności, weryfikacja usunięcia `HARDCODED_API_KEY`.
*   **Testy Wydajnościowe (Wstępne):**
    *   **Cel:** Wstępna ocena czasu odpowiedzi aplikacji i zużycia zasobów przy podstawowych operacjach.
    *   **Narzędzia:** Narzędzia deweloperskie przeglądarki (Lighthouse, Performance), `console.time`.
    *   **Zakres:** Czas ładowania kluczowych stron (lista list, szczegóły listy), czas odpowiedzi API dla typowych zapytań (pobieranie list, dodawanie/aktualizacja elementów), czas przetwarzania przez AI.
*   **Testy Użyteczności (Manualne):**
    *   **Cel:** Ocena łatwości obsługi i intuicyjności interfejsu użytkownika.
    *   **Narzędzia:** Manualna eksploracja aplikacji.
    *   **Zakres:** Przejrzystość przepływów (rejestracja, dodawanie listy/produktu), zrozumiałość komunikatów (błędy, toasty), responsywność interfejsu na różnych urządzeniach (desktop/mobile).
*   **Testy Dokumentacji API:**
    *   **Cel:** Weryfikacja zgodności działania API z dokumentacją w `docs/api/`.
    *   **Narzędzia:** Manualne porównanie, Postman/Insomnia (na podstawie dokumentacji).
    *   **Zakres:** Sprawdzenie poprawności URL, metod HTTP, parametrów, formatów body, kodów odpowiedzi i struktur odpowiedzi dla endpointów opisanych w plikach `.md`.

## 4. Scenariusze testowe dla kluczowych funkcjonalności

Poniżej przedstawiono wysokopoziomowe scenariusze testowe. Szczegółowe przypadki testowe zostaną opracowane na ich podstawie.

### 4.1. Autoryzacja i Dostęp

*   **Rejestracja:**
    *   Pomyślna rejestracja nowego użytkownika z poprawnymi danymi.
    *   Próba rejestracji z nieprawidłowym formatem emaila.
    *   Próba rejestracji ze zbyt krótkim hasłem.
    *   Próba rejestracji z już istniejącym adresem email.
*   **Logowanie:**
    *   Pomyślne logowanie z poprawnymi danymi.
    *   Próba logowania z błędnym hasłem.
    *   Próba logowania z nieistniejącym adresem email.
    *   Próba logowania z pustym emailem lub hasłem.
    *   Pomyślne logowanie z opcją "Zapamiętaj mnie" (weryfikacja trwałości sesji/tokenu).
*   **Wylogowanie:**
    *   Pomyślne wylogowanie i przekierowanie na stronę logowania.
    *   Próba dostępu do chronionej strony po wylogowaniu.
*   **Odzyskiwanie Hasła:**
    *   Poprawne wysłanie linku resetującego dla istniejącego użytkownika.
    *   Komunikat zwrotny przy próbie resetu dla nieistniejącego emaila (bez ujawniania istnienia).
    *   Poprawne ustawienie nowego hasła po kliknięciu w link z emaila.
    *   Próba użycia nieprawidłowego lub wygasłego tokenu resetującego.
    *   Próba ustawienia nowego hasła, które nie spełnia wymagań bezpieczeństwa.
*   **Kontrola Dostępu (Middleware):**
    *   Próba dostępu do `/shopping-lists` przez niezalogowanego użytkownika (oczekiwane przekierowanie do `/login`).
    *   Próba dostępu do `/login` przez zalogowanego użytkownika (oczekiwane przekierowanie do `/`).
    *   Próba dostępu do `/api/shopping-lists` bez tokenu (oczekiwany błąd 401).
    *   Próba dostępu do `/api/client/shopping-lists` bez ważnej sesji (oczekiwany błąd 401).

### 4.2. Zarządzanie Listami Zakupów

*   **Tworzenie Listy:**
    *   Pomyślne utworzenie nowej listy z domyślnym tytułem.
    *   Weryfikacja, czy nowa lista pojawia się na widoku list.
*   **Wyświetlanie List:**
    *   Poprawne wyświetlanie listy posiadanych list zakupów.
    *   Poprawne działanie paginacji (jeśli list jest więcej niż `pageSize`).
    *   Poprawne działanie sortowania (po tytule, dacie utworzenia, dacie modyfikacji).
    *   Wyświetlanie informacji o liczbie produktów na każdej liście.
    *   Wyświetlanie komunikatu o braku list, gdy użytkownik ich nie posiada.
*   **Wyświetlanie Szczegółów Listy:**
    *   Poprawne wyświetlanie tytułu i produktów dla wybranej listy.
    *   Poprawne wyświetlanie statusu "kupiony/niekupiony" dla produktów.
    *   Wyświetlanie komunikatu o pustej liście.
    *   Próba dostępu do nieistniejącej listy (oczekiwany błąd 404 lub komunikat).
    *   Próba dostępu do listy innego użytkownika (oczekiwany błąd 403/404).
*   **Aktualizacja Tytułu:**
    *   Pomyślna zmiana tytułu listy przez edytowalny komponent.
    *   Próba ustawienia pustego tytułu (oczekiwany błąd walidacji).
    *   Próba ustawienia zbyt długiego tytułu (oczekiwany błąd walidacji).
*   **Usuwanie Listy:**
    *   Pomyślne usunięcie listy po potwierdzeniu w dialogu.
    *   Weryfikacja, czy lista zniknęła z widoku list.
    *   Anulowanie usuwania w dialogu potwierdzającym.
    *   Weryfikacja (manualna lub przez API), czy produkty powiązane z listą zostały usunięte (cascade delete).

### 4.3. Zarządzanie Produktami na Liście

*   **Dodawanie przez AI:**
    *   Wprowadzenie prostego tekstu (np. "mleko, chleb, jajka") i weryfikacja dodania produktów.
    *   Wprowadzenie tekstu z ilościami (np. "2kg jabłek, litr mleka") i weryfikacja poprawności nazw.
    *   Wprowadzenie tekstu z prośbą o usunięcie (np. "kup masło, ale nie kupuj mleka") i weryfikacja wyniku.
    *   Wprowadzenie tekstu wskazującego na już kupione produkty.
    *   Wprowadzenie bardzo długiego tekstu (test limitów).
    *   Wprowadzenie tekstu niejasnego lub błędnego (oczekiwane rozsądne zachowanie AI lub błąd).
    *   Obsługa błędu, gdy API OpenRouter jest niedostępne lub zwraca błąd.
    *   Obsługa błędu, gdy odpowiedź AI ma nieprawidłowy format JSON.
*   **Zmiana Statusu:**
    *   Oznaczenie produktu jako kupiony (checkbox) i weryfikacja zmiany statusu (UI i ewentualnie API).
    *   Odznaczenie produktu jako kupiony i weryfikacja zmiany statusu.
*   **Edycja Nazwy:**
    *   Pomyślna zmiana nazwy produktu.
    *   Próba ustawienia pustej nazwy (oczekiwany błąd walidacji).
    *   Próba ustawienia zbyt długiej nazwy (oczekiwany błąd walidacji).
    *   Anulowanie edycji (np. przez Esc).
*   **Usuwanie Produktu:**
    *   Pomyślne usunięcie produktu z listy.
    *   Weryfikacja, czy produkt zniknął z widoku szczegółów listy.
*   **Czyszczenie Listy:**
    *   Wywołanie API `/clear-items` i weryfikacja, czy lista jest pusta.

### 4.4. Uprawnienia i Bezpieczeństwo

*   **Dostęp do Danych:**
    *   Użytkownik A próbuje uzyskać dostęp (przez API lub UI, jeśli możliwe) do listy zakupów użytkownika B (oczekiwany błąd 403/404).
    *   Użytkownik A próbuje zaktualizować/usunąć listę/produkt użytkownika B (oczekiwany błąd 403/404).
*   **Uprawnienia Admina:**
    *   Administrator próbuje pobrać listę wszystkich użytkowników (oczekiwany sukces).
    *   Zwykły użytkownik próbuje pobrać listę wszystkich użytkowników (oczekiwany błąd 403).
    *   Administrator próbuje pobrać/zaktualizować/usunąć dane innego użytkownika (oczekiwany sukces).
*   **Bezpieczeństwo API Key:**
    *   Weryfikacja, czy klucz API OpenRouter nie jest publicznie dostępny w kodzie front-endowym.
    *   Weryfikacja, czy `HARDCODED_API_KEY` został usunięty i zastąpiony bezpiecznym mechanizmem (np. zmienna środowiskowa po stronie serwera).

## 5. Środowisko testowe

*   **Środowisko Deweloperskie (Lokalne):** Do przeprowadzania testów jednostkowych i integracyjnych przez deweloperów podczas kodowania. Wymaga lokalnej instancji aplikacji i połączenia z deweloperską instancją Supabase.
*   **Środowisko Testowe/Staging:** Odizolowane środowisko, jak najbardziej zbliżone do produkcyjnego. Będzie używane do testów E2E, testów API, testów regresji i UAT.
    *   **Baza Danych:** Oddzielna instancja Supabase przeznaczona wyłącznie do celów testowych, z możliwością łatwego resetowania danych.
    *   **Usługi Zewnętrzne:** Dostęp do API OpenRouter (możliwe użycie klucza testowego lub mockowanie na poziomie środowiska).
    *   **Konfiguracja:** Zmienne środowiskowe skonfigurowane dla środowiska testowego (np. `NODE_ENV=staging`, klucze API).
*   **Środowisko Produkcyjne:** Używane tylko do testów dymnych (smoke tests) po wdrożeniu nowej wersji.

## 6. Narzędzia do testowania

*   **Framework Testowy:** Vitest (do testów jednostkowych i integracyjnych).
*   **Biblioteka Testowania Komponentów:** React Testing Library (do testowania komponentów React).
*   **Narzędzia E2E:** Playwright (preferowany) lub Cypress.
*   **Testowanie API:** Postman / Insomnia (do manualnego testowania i eksploracji API), Vitest (do automatycznych testów API).
*   **Mockowanie:** Vi.fn() (Vitest), Mock Service Worker (MSW) (do mockowania API w testach integracyjnych/E2E).
*   **Zarządzanie Bazą Danych:** Supabase Studio (do inspekcji i zarządzania danymi w bazie testowej).
*   **Analiza Kodu:** ESLint, Prettier (już w projekcie, do utrzymania jakości kodu).
*   **Raportowanie Błędów:** GitHub Issues lub dedykowane narzędzie (np. Jira).
*   **Przeglądarki:** Najnowsze wersje Chrome, Firefox, Safari, Edge. Narzędzia deweloperskie wbudowane w przeglądarki.

## 7. Harmonogram testów

Harmonogram będzie powiązany z cyklem rozwoju aplikacji.

*   **Faza 1: Przygotowanie i Testy Jednostkowe/Integracyjne (Ciągłe):**
    *   Konfiguracja środowiska testowego.
    *   Rozbudowa istniejących testów jednostkowych i integracyjnych (developers + QA).
    *   Pisanie nowych testów jednostkowych i integracyjnych równolegle z rozwojem nowych funkcji.
    *   Integracja testów z procesem CI/CD.
*   **Faza 2: Testy Systemowe i E2E (Po zakończeniu głównych funkcjonalności / Per Sprint):**
    *   Wykonanie scenariuszy testowych E2E dla kluczowych przepływów.
    *   Wykonanie testów API.
    *   Przeprowadzenie podstawowych testów bezpieczeństwa i użyteczności.
*   **Faza 3: Testy Regresji (Przed każdym wydaniem / Po dużych zmianach):**
    *   Ponowne wykonanie kluczowych testów (jednostkowych, integracyjnych, E2E) w celu zapewnienia, że nowe zmiany nie zepsuły istniejących funkcjonalności.
*   **Faza 4: User Acceptance Testing (UAT) (Przed wdrożeniem na produkcję):**
    *   Testy przeprowadzane przez Product Ownera lub wyznaczonych użytkowników końcowych.
*   **Faza 5: Testy Dymne (Po wdrożeniu na produkcję):**
    *   Szybkie sprawdzenie kluczowych funkcjonalności na środowisku produkcyjnym.

## 8. Kryteria akceptacji testów

### 8.1. Kryteria Wejścia

*   Kod źródłowy dla testowanych funkcjonalności jest dostępny w repozytorium.
*   Build aplikacji dla środowiska testowego zakończył się sukcesem.
*   Środowisko testowe jest dostępne i skonfigurowane.
*   Dokumentacja API (jeśli dotyczy) jest dostępna i aktualna.
*   Kluczowe zależności (Supabase, OpenRouter) są dostępne w środowisku testowym.

### 8.2. Kryteria Wyjścia

*   **Pokrycie Testami:** Osiągnięcie zdefiniowanego poziomu pokrycia kodu testami jednostkowymi i integracyjnymi (np. > 70% dla kluczowych modułów).
*   **Wyniki Testów:** Przynajmniej 95% zdefiniowanych przypadków testowych (manualnych i automatycznych) zakończonych sukcesem.
*   **Błędy Krytyczne:** Brak otwartych błędów o statusie Krytyczny (Blocker) lub Wysoki (High) związanych z testowaną wersją.
*   **Dokumentacja:** Raport z przeprowadzonych testów jest gotowy i zaakceptowany.
*   **Akceptacja UAT:** Testy akceptacyjne użytkownika (UAT) zakończone pomyślnie.

## 9. Role i odpowiedzialności w procesie testowania

*   **Inżynier QA (Ty):**
    *   Opracowanie i utrzymanie planu testów.
    *   Projektowanie i implementacja przypadków testowych (manualnych i automatycznych E2E/API).
    *   Wykonanie testów systemowych, regresji, wydajnościowych, bezpieczeństwa.
    *   Raportowanie i śledzenie błędów.
    *   Przygotowanie raportów z testów.
    *   Współpraca z deweloperami w celu rozwiązywania błędów.
    *   Konfiguracja i utrzymanie środowiska testowego (we współpracy z deweloperami).
*   **Deweloperzy:**
    *   Pisanie i utrzymanie testów jednostkowych i integracyjnych dla swojego kodu.
    *   Naprawa błędów zgłoszonych przez QA.
    *   Wsparcie w konfiguracji środowiska testowego.
    *   Przeglądanie przypadków testowych.
    *   Utrzymanie jakości kodu (ESLint, Prettier).
*   **Product Owner / Menedżer Projektu:**
    *   Definiowanie wymagań i kryteriów akceptacji.
    *   Priorytetyzacja testów i błędów.
    *   Przeprowadzenie testów akceptacyjnych użytkownika (UAT).
    *   Ostateczna decyzja o wdrożeniu wersji.

## 10. Procedury raportowania błędów

*   **Narzędzie:** GitHub Issues (lub dedykowane narzędzie jak Jira, jeśli dostępne).
*   **Format Zgłoszenia Błędu:** Każde zgłoszenie powinno zawierać co najmniej:
    *   **Tytuł:** Krótki, zwięzły opis problemu.
    *   **Środowisko:** Wersja aplikacji, przeglądarka, system operacyjny, środowisko (Test/Staging, Dev).
    *   **Kroki do Reprodukcji:** Szczegółowa lista kroków pozwalająca jednoznacznie odtworzyć błąd.
    *   **Obserwowane Zachowanie:** Co faktycznie się stało.
    *   **Oczekiwane Zachowanie:** Co powinno się stać zgodnie ze specyfikacją.
    *   **Priorytet/Waga (Severity):** (np. Krytyczny, Wysoki, Średni, Niski) - ustalane przez QA, weryfikowane przez PO.
    *   **Zrzuty Ekranu/Nagrania Wideo:** Jeśli to możliwe, dołączone w celu lepszego zrozumienia problemu.
    *   **Logi:** Istotne logi z konsoli przeglądarki lub serwera, jeśli dostępne.
*   **Cykl Życia Błędu:**
    1.  QA zgłasza błąd (Status: Nowy/Open).
    2.  PO/Team Lead weryfikuje i priorytetyzuje błąd.
    3.  Deweloper przypisuje błąd do siebie i rozpoczyna pracę (Status: W toku/In Progress).
    4.  Deweloper naprawia błąd i oznacza go jako rozwiązany (Status: Rozwiązany/Resolved, Gotowy do Testów/Ready for Testing).
    5.  QA weryfikuje poprawkę w środowisku testowym.
    6.  Jeśli poprawka działa: QA zamyka błąd (Status: Zamknięty/Closed).
    7.  Jeśli poprawka nie działa: QA ponownie otwiera błąd (Status: Ponownie Otwarty/Reopened) z komentarzem.


================================================
File: .ai/test-plan.md
================================================
# Plan Testów - ShopListeo

## 1. Wprowadzenie i Cele Testowania
Celem testowania jest zapewnienie wysokiej jakości aplikacji, sprawnego działania kluczowych funkcjonalności oraz stabilności systemu. Testy mają na celu wykrycie błędów na wczesnym etapie, zapewnienie spójności komponentów aplikacji oraz wsparcie procesu ciągłej integracji i wdrażania.

## 2. Zakres Testów
- Testy jednostkowe: sprawdzają poprawność działania pojedynczych funkcji i komponentów (m.in. moduły React, funkcje w Astro, narzędzia pomocnicze w `./src/lib`).
- Testy integracyjne: weryfikują współdziałanie między komponentami oraz komunikację z API (np. `./src/pages/api`).
- Testy end-to-end: symulują rzeczywiste scenariusze użytkownika, obejmujące interakcje UI oraz nawigację po stronie.
- Testy wydajnościowe: oceniają obciążenie systemu, czas odpowiedzi oraz reakcję aplikacji przy dużym ruchu.
- Testy dostępności: sprawdzają zgodność aplikacji z wytycznymi WCAG i ogólną dostępność dla różnych grup użytkowników.
- Testy bezpieczeństwa: identyfikują potencjalne luki w zabezpieczeniach i problemy z ochroną danych.
- Testy wizualne: wykrywają niezamierzone zmiany w interfejsie użytkownika.

## 3. Typy Testów
- **Testy jednostkowe**: użycie Vitest (zamiast Jest) i React Testing Library do testowania pojedynczych funkcji i komponentów.
- **Testy integracyjne**: weryfikacja poprawnej komunikacji między warstwami aplikacji, w tym specjalne testy komponentów Astro oraz połączenia API z bazą danych (Supabase).
- **Testy end-to-end**: wykorzystanie Playwright do symulacji pełnych ścieżek użytkownika.
- **Testy wydajnościowe**: analiza czasu odpowiedzi i obciążenia systemu przy użyciu Lighthouse CI (dla metryki Web Vitals) oraz k6 (dla testów obciążeniowych).
- **Testy dostępności**: automatyczna analiza zgodności z WCAG przy użyciu narzędzia Axe.
- **Testy bezpieczeństwa**: skanowanie pod kątem typowych luk bezpieczeństwa przy użyciu OWASP ZAP.
- **Testy wizualne**: wykrywanie regresji wizualnych przy użyciu Percy lub Chromatic.
- **Testy kontraktowe**: sprawdzanie zgodności API z oczekiwaniami przy użyciu Pactum.js.

## 4. Scenariusze Testowe dla Kluczowych Funkcjonalności
- **Renderowanie i interakcje UI**: testowanie poprawności renderowania komponentów (React, Astro, Shadcn/ui) oraz ich interakcji (np. walidacja formularzy, obsługa zdarzeń kliknięć).
- **Działanie API**: sprawdzenie operacji CRUD w punktach końcowych (`./src/pages/api`) oraz poprawności komunikacji z bazą danych. Użycie MSW (Mock Service Worker) do mockowania odpowiedzi API w testach.
- **Scenariusze użytkownika**: symulacja logowania, przeglądania produktów, wyszukiwania, filtrowania oraz dodawania produktów do koszyka.
- **Responsywność i kompatybilność**: testowanie działania aplikacji na różnych urządzeniach i przeglądarkach.
- **Specyfika Astro**: testowanie hydracji, routing oraz Islands Architecture w komponentach Astro.

## 5. Środowisko Testowe
- **Środowisko deweloperskie**: lokalne maszyny programistów z pełną konfiguracją projektu.
- **Środowisko staging**: serwer symulujący ustawienia produkcyjne, wykorzystywany do testów integracyjnych oraz end-to-end.
- **Testowa baza danych**: oddzielna instancja Supabase do testowania operacji na danych bez wpływu na środowisko produkcyjne.
- **Storybook**: izolowane środowisko do testowania i dokumentowania komponentów UI.

## 6. Narzędzia do Testowania
- **Frameworki testowe**: Vitest, React Testing Library, Playwright.
- **Testowanie komponentów UI**: Storybook z addonsami dla Astro/React.
- **Mockowanie API**: MSW (Mock Service Worker), Pactum.js dla testów kontraktowych.
- **Narzędzia do analizy kodu**: ESLint, Prettier.
- **Narzędzia do pokrycia kodu testami**: Vitest UI, Codecov lub SonarQube.
- **Testowanie wizualne**: Percy lub Chromatic dla testów regresji wizualnej.
- **Testowanie dostępności**: Axe.
- **Testowanie bezpieczeństwa**: OWASP ZAP.
- **Testowanie wydajności**: Lighthouse CI, k6.
- **Systemy CI/CD**: GitHub Actions do automatyzacji uruchamiania testów.
- **Narzędzia do raportowania błędów**: GitHub Issues, JIRA lub inny system zarządzania błędami.

## 7. Harmonogram Testów
- **Testy jednostkowe i integracyjne**: uruchamiane automatycznie przy każdym commicie oraz w ramach pipeline CI/CD.
- **Testy end-to-end**: wykonywane regularnie, np. raz w tygodniu na środowisku staging.
- **Testy wydajnościowe**: przeprowadzane przy większych zmianach w krytycznych komponentach oraz przed wydaniem nowej wersji aplikacji.
- **Testy dostępności i bezpieczeństwa**: przeprowadzane w cyklach miesięcznych oraz przed większymi wydaniami.
- **Testy wizualne**: uruchamiane przy każdym pull requeście zmieniającym komponent UI.

## 8. Kryteria Akceptacji Testów
- Wszystkie testy jednostkowe i integracyjne muszą przechodzić bez błędów.
- Minimalne pokrycie testami kluczowych modułów (zalecane minimum: 80%).
- Brak krytycznych błędów wpływających na funkcjonalność aplikacji.
- Pozytywne wyniki testów end-to-end na środowisku staging.
- Zgodność z podstawowymi standardami dostępności (poziom AA WCAG).
- Brak wykrytych krytycznych luk bezpieczeństwa.
- Metryki Web Vitals w dopuszczalnym zakresie.

## 9. Role i Odpowiedzialności
- **Zespół deweloperski**: tworzenie i utrzymanie testów jednostkowych oraz integracyjnych.
- **Inżynierowie QA**: prowadzenie testów end-to-end, testów wydajnościowych oraz nadzór nad poprawnością wdrożeń.
- **Specjaliści ds. dostępności**: weryfikacja zgodności z wytycznymi WCAG.
- **Specjaliści ds. bezpieczeństwa**: prowadzenie testów bezpieczeństwa i analiza zagrożeń.
- **Menedżerowie projektów**: koordynacja harmonogramu testów oraz monitorowanie raportowania błędów.

## 10. Procedury Raportowania Błędów
- Zgłaszanie błędów poprzez systemy takie jak GitHub Issues lub JIRA.
- Klasyfikacja błędów według krytyczności (krytyczne, średnie, niskie).
- Dokumentacja kroków do reprodukcji błędu, załączanie logów i zrzutów ekranu.
- Regularne przeglądy zgłoszonych błędów oraz ustalanie priorytetów napraw.
- Automatyczne powiadomienia o niepowodzeniach testów w pipeline CI/CD.


================================================
File: .ai/ui-plan.md
================================================
# Architektura UI dla ShopListeo

## 1. Przegląd struktury UI

ShopListeo to aplikacja webowa do zarządzania listami zakupów z minimalistycznym interfejsem opartym na palecie kolorów niebieskich. Aplikacja korzysta z Astro 5, React 19, TypeScript 5, Tailwind 4 i komponentów Shadcn/ui. Interfejs jest pełnoekranowy i responsywny, z boczną nawigacją, która zwija się do hamburger menu na urządzeniach mobilnych. Wspiera tryb jasny i ciemny (domyślnie ciemny). Struktura UI rozdziela funkcjonalności dla zwykłych użytkowników (zarządzanie listami zakupów) i administratorów (zarządzanie użytkownikami).

## 2. Lista widoków

### Widok logowania
- **Ścieżka**: `/login`
- **Główny cel**: Umożliwienie użytkownikom zalogowania się do aplikacji
- **Kluczowe informacje**: 
  - Formularz logowania (e-mail, hasło)
  - Opcja "Zapamiętaj mnie" (30 dni)
  - Link do rejestracji
  - Link do resetowania hasła
- **Kluczowe komponenty**:
  - Formularz z walidacją
  - Checkbox "Zapamiętaj mnie"
  - Przyciski akcji
- **UX, dostępność i bezpieczeństwo**:
  - Minimalistyczny, przejrzysty interfejs
  - Wyraźne komunikaty błędów
  - Zabezpieczenie przez JWT

### Widok rejestracji
- **Ścieżka**: `/register`
- **Główny cel**: Umożliwienie nowym użytkownikom utworzenia konta
- **Kluczowe informacje**:
  - Formularz rejestracji (e-mail, hasło, potwierdzenie hasła)
  - Link powrotu do logowania
- **Kluczowe komponenty**:
  - Formularz z walidacją
  - Przyciski akcji
- **UX, dostępność i bezpieczeństwo**:
  - Walidacja formatu e-mail
  - Walidacja złożoności hasła
  - Wykrywanie już istniejących kont

### Widok resetowania hasła
- **Ścieżka**: `/reset-password`
- **Główny cel**: Umożliwienie użytkownikom zresetowania zapomnianego hasła
- **Kluczowe informacje**:
  - Formularz do wprowadzenia adresu e-mail
  - Potwierdzenie wysłania linku resetującego
- **Kluczowe komponenty**:
  - Formularz z walidacją
  - Komunikat potwierdzający
- **UX, dostępność i bezpieczeństwo**:
  - Prosta instrukcja procesu
  - Zabezpieczenie przez unikalny link

### Widok ustawienia nowego hasła
- **Ścieżka**: `/set-new-password`
- **Główny cel**: Umożliwienie ustawienia nowego hasła po kliknięciu w link z e-maila
- **Kluczowe informacje**:
  - Formularz z polem na nowe hasło i jego potwierdzenie
- **Kluczowe komponenty**:
  - Formularz z walidacją
  - Komunikat powodzenia
- **UX, dostępność i bezpieczeństwo**:
  - Walidacja złożoności hasła
  - Automatyczne przekierowanie po zmianie

### Widok główny użytkownika
- **Ścieżka**: `/`
- **Główny cel**: Wyświetlenie wszystkich list zakupów użytkownika
- **Kluczowe informacje**:
  - Lista list zakupów (nazwa, ikona usunięcia)
  - Przycisk "Utwórz nową listę zakupów"
  - Sortowanie według daty (najnowsze na górze)
  - Informacje o zalogowanym użytkowniku
  - Przycisk "Wyloguj"

- **Kluczowe komponenty**:
  - Boczna nawigacja
  - Lista list zakupów
  - Przycisk akcji (wyróżniony kolorem)
  - Modalne okno potwierdzające usunięcie
- **UX, dostępność i bezpieczeństwo**:
  - Przejrzysta prezentacja list
  - Ochrona przed przypadkowym usunięciem

### Widok szczegółów listy zakupów
- **Ścieżka**: `/shopping-lists/:id`
- **Główny cel**: Zarządzanie konkretną listą zakupów i jej elementami
- **Kluczowe informacje**:
  - Edytowalna nazwa listy
  - Pole textarea do wprowadzania opisu co chcemy kupić, tj. jakie produkty
  - Lista produktów (nazwa, status zakupu - czy już produkt zakupiony)
- **Kluczowe komponenty**:
  - Boczna nawigacja
  - Edytowalny nagłówek (edycja inline)
  - Textarea
  - Przycisk "Wygeneruj listę zakupów"
  - Lista produktów z checkboxami
  - Ikony usunięcia
- **UX, dostępność i bezpieczeństwo**:
  - Zakupione produkty: przekreślone, wyszarzone, na końcu listy
  - Edycja inline po kliknięciu
  - Natychmiastowa synchronizacja z API

### Widok główny administratora
- **Ścieżka**: `/admin/users`
- **Główny cel**: Zarządzanie użytkownikami systemu
- **Kluczowe informacje**:
  - Lista użytkowników (e-mail, data rejestracji, data logowania)
  - Paginacja i wybór liczby elementów na stronę (10, 20, 50)
- **Kluczowe komponenty**:
  - Boczna nawigacja
  - Tabela użytkowników
  - Kontrolki paginacji
- **UX, dostępność i bezpieczeństwo**:
  - Przejrzysta prezentacja danych
  - Dostęp tylko dla administratorów

### Widok szczegółów użytkownika (dla administratora)
- **Ścieżka**: `/admin/users/:id`
- **Główny cel**: Przeglądanie i edycja danych konkretnego użytkownika
- **Kluczowe informacje**:
  - Dane użytkownika (e-mail, data rejestracji, data logowania)
  - Formularze do edycji e-maila i hasła
- **Kluczowe komponenty**:
  - Boczna nawigacja
  - Sekcja informacji o użytkowniku
  - Formularze edycji
  - Przycisk "Aktualizuj dane użytkownika"
  - Przycisk "Usuń użytkownika"
  - Modalne okno potwierdzające usunięcie
- **UX, dostępność i bezpieczeństwo**:
  - Dostęp tylko dla administratorów
  - Ochrona przed przypadkowym usunięciem

### Widok profilu użytkownika
- **Ścieżka**: `/profile`
- **Główny cel**: Zarządzanie własnym kontem
- **Kluczowe informacje**:
  - Dane użytkownika (e-mail)
  - Formularze do edycji e-maila i hasła
- **Kluczowe komponenty**:
  - Boczna nawigacja
  - Formularze edycji
  - Przycisk "Aktualizuj dane"
- **UX, dostępność i bezpieczeństwo**:
  - Walidacja danych wejściowych
  - Zabezpieczenie przed konfliktami e-mail

## 3. Mapa podróży użytkownika

### Podróż nowego użytkownika
1. **Rejestracja**:
   - Użytkownik przechodzi do formularza rejestracji
   - Wprowadza e-mail i hasło (dwukrotnie)
   - System waliduje dane i tworzy konto
   
2. **Pierwsze logowanie**:
   - Użytkownik zostaje automatycznie zalogowany po rejestracji
   - Widzi komunikat powitalny z wprowadzeniem do aplikacji
   
3. **Tworzenie pierwszej listy zakupów**:
   - Użytkownik klika "Utwórz nową listę zakupów"
   - System tworzy listę z domyślną nazwą (format: "<dzień tygodnia>, <DD-MM-RRRR>")
   - Użytkownik jest przekierowany do edycji listy
   
4. **Zarządzanie listą zakupów**:
   - Użytkownik może edytować nazwę listy (kliknięcie aktywuje edycję inline)
   - Użytkownik wpisuje produkty w pole tekstowe
   - Po kliknięciu "Wygeneruj listę zakupów" system przetwarza tekst
   - Użytkownik może zarządzać produktami (edycja, oznaczanie jako zakupione, usuwanie)
   - Zakupione produkty są przekreślone, wyszarzone i przenoszone na koniec listy

### Podróż powracającego użytkownika
1. **Logowanie**:
   - Użytkownik wprowadza dane logowania
   - Opcjonalnie zaznacza "Zapamiętaj mnie"
   - System weryfikuje dane i loguje użytkownika
   
2. **Przeglądanie list zakupów**:
   - Użytkownik widzi wszystkie swoje listy zakupów
   - Listy są sortowane według daty (najnowsze na górze)
   
3. **Zarządzanie istniejącymi listami**:
   - Użytkownik może kliknąć w nazwę listy, aby przejść do jej szczegółów
   - Użytkownik może usunąć listę (z potwierdzeniem w modalnym oknie)

### Podróż administratora
1. **Logowanie**:
   - Administrator loguje się jak zwykły użytkownik
   - System rozpoznaje rolę i przekierowuje do panelu administratora
   
2. **Zarządzanie użytkownikami**:
   - Administrator widzi paginowaną listę użytkowników
   - Może wybrać liczbę elementów na stronę (10, 20, 50)
   - Może kliknąć w e-mail użytkownika, aby przejść do szczegółów
   
3. **Zarządzanie konkretnym użytkownikiem**:
   - Administrator może przeglądać dane użytkownika
   - Może edytować e-mail i hasło użytkownika
   - Może usunąć użytkownika (z potwierdzeniem w modalnym oknie)

## 4. Układ i struktura nawigacji

### Układ globalny
- Pełnoekranowy interfejs z boczną nawigacją
- zalogowany użytkownik widzi w prawym górnym rogu ikonkę, która pozwala mu przejść do jego profilu
- zalogowany użytkownik widzi informację w panelu, że jest zalogowany jako użytkownik o danym adresie e-mail
- Na urządzeniach mobilnych nawigacja zwija się do hamburger menu
- Przełącznik trybu jasny/ciemny w menu głównym
- Stopka aplikacji z informacją "Powered by asperIT"

### Nawigacja dla zwykłego użytkownika
- **Listy zakupów** - link do widoku głównego
- **Profil** - link do widoku profilu użytkownika
- **Wyloguj się** - akcja wylogowania użytkownika

### Nawigacja dla administratora
- **Użytkownicy** - link do listy użytkowników
- **Profil** - link do widoku profilu administratora
- **Wyloguj się** - akcja wylogowania administratora

### Struktura ścieżek
- **/login** - widok logowania
- **/register** - widok rejestracji
- **/reset-password** - widok resetowania hasła
- **/set-new-password** - widok ustawienia nowego hasła
- **/** - widok główny użytkownika (listy zakupów)
- **/shopping-lists/:id** - widok szczegółów listy zakupów
- **/profile** - widok profilu użytkownika
- **/admin/users** - widok główny administratora
- **/admin/users/:id** - widok szczegółów użytkownika

## 5. Kluczowe komponenty

### Komponenty nawigacyjne
- **SideNav** - boczny panel nawigacyjny z linkami
- **MobileMenu** - zwijane menu hamburger dla urządzeń mobilnych
- **ThemeToggle** - przełącznik trybu jasny/ciemny

### Komponenty autentykacji
- **LoginForm** - formularz logowania z walidacją
- **RegisterForm** - formularz rejestracji z walidacją
- **PasswordResetForm** - formularz resetowania hasła
- **SetPasswordForm** - formularz ustawiania nowego hasła

### Komponenty list zakupów
- **ShoppingLists** - lista wszystkich list zakupów użytkownika
- **ShoppingListItem** - pojedynczy element listy zakupów
- **CreateListButton** - przycisk tworzenia nowej listy
- **EditableTitle** - edytowalny inline tytuł listy zakupów
- **ProductList** - lista produktów w liście zakupów
- **ProductItem** - pojedynczy produkt z checkboxem i możliwością edycji
- **GenerateListButton** - przycisk generowania listy z textarea

### Komponenty administratora
- **UsersList** - paginowana lista użytkowników
- **UserDetails** - szczegóły użytkownika z możliwością edycji
- **Pagination** - kontrolki paginacji

### Komponenty UI
- **Modal** - okno modalne do potwierdzania operacji
- **Notification** - system powiadomień (znikające po 10 sekundach)
- **WelcomeMessage** - komunikat powitalny dla nowych użytkowników
- **Button** - przycisk akcji (wyróżniony kolorem)
- **Checkbox** - pole wyboru dla oznaczania produktów jako zakupione 


================================================
File: .ai/ui-planning-session.md
================================================
<conversation_summary>
<decisions>
1. Interfejs rozpoczyna się od minimalistycznego okna logowania z linkiem do rejestracji.
2. Po zalogowaniu użytkownicy widzą swoje listy zakupów, a administratorzy listę użytkowników.
3. Nawigacja będzie boczna, na urządzeniach mobilnych zwijana do hamburger menu.
4. Aplikacja będzie obsługiwać automatyczne tworzenie nowych list zakupów z domyślną nazwą "<dzień tygodnia>, <DD-MM-RRRR>".
5. Edycja nazw list i produktów będzie realizowana przez kliknięcie, z natychmiastowym zapisem do API.
6. Produkty zakupione będą przekreślone, wyszarzone i przenoszone na koniec listy.
7. Administrator będzie mieć dostęp do paginowanej listy użytkowników z możliwością edycji ich danych.
8. Usuwanie list i użytkowników będzie wymagać potwierdzenia w modalnym oknie.
9. Aplikacja będzie wspierać tryb jasny i ciemny, z domyślnym trybem ciemnym.
10. Kolorystyka interfejsu będzie oparta na niebieskim i jego odcieniach.
11. Komunikaty o błędach będą szczegółowe i będą znikać po 10 sekundach.
12. Funkcja "Zapamiętaj mnie" będzie działać przez 30 dni.
13. Odzyskiwanie hasła będzie realizowane poprzez wysyłanie linku na e-mail.
14. Interfejs powinien wyświetlać komunikat powitalny dla nowo zarejestrowanych użytkowników.
15. Stopka aplikacji będzie zawierać informację "Powered by asperIT".
16. Aplikacja będzie zapisywać stan ostatnio edytowanej listy zakupów.
17. Układ aplikacji będzie pełnoekranowy.
18. Przyciski akcji będą wyróżnione kolorem.
19. Listy zakupów będą domyślnie sortowane po dacie (najnowsze na górze).
20. Aplikacja nie wymaga funkcjonalności offline ani dzielenia się listami na etapie MVP.
</decisions>

<matched_recommendations>
1. Zaprojektowanie minimalistycznego interfejsu w palecie kolorów niebieskich, wykorzystując komponenty Shadcn/ui jako podstawę.
2. Implementacja bocznego panelu nawigacyjnego z ikonami, zwijającego się do hamburger menu na urządzeniach mobilnych.
3. Stworzenie systemu uwierzytelniania opartego na Supabase Auth z opcją "Zapamiętaj mnie" na 30 dni i resetowaniem hasła przez email.
4. Zaprojektowanie mechanizmu edycji inline dla nazw list zakupów i produktów z natychmiastową synchronizacją z API.
5. Implementacja systemu automatycznego przenoszenia zakupionych produktów na koniec listy, z możliwością odznaczenia.
6. Stworzenie panelu administratora z funkcjami zarządzania użytkownikami (edycja e-maila, zmiana hasła, usuwanie).
7. Zaprojektowanie modalnych okien potwierdzających operacje usuwania z jasnym opisem konsekwencji.
8. Implementacja przełącznika trybu jasnego/ciemnego w menu głównym z zapisem preferencji w localStorage.
9. Stworzenie systemu powiadomień dla komunikatów z API z automatycznym znikaniem po 10 sekundach.
10. Stworzyć komunikat powitalny dla nowo zarejestrowanych użytkowników przy pierwszym logowaniu.
11. Zaprojektowanie responsywnego układu strony dostosowanego do różnych urządzeń (mobile, tablet, desktop).
12. Zaprojektowanie widoku generowania nowej listy zakupów z automatycznym nazywaniem i przekierowaniem do edycji.
</matched_recommendations>

<ui_architecture_planning_summary>
## Architektura UI dla ShopListeo MVP

### Główna struktura aplikacji

Aplikacja ShopListeo będzie pełnoekranową aplikacją webową opartą na Astro 5, React 19, TypeScript 5, Tailwind 4 i Shadcn/ui. Interfejs będzie minimalistyczny, z kolorystyką opartą na odcieniach niebieskiego.

### Kluczowe widoki i przepływy

#### Autentykacja
- **Logowanie**: Minimalistyczny formularz z polami e-mail i hasło, opcją "Zapamiętaj mnie" (30 dni), linkiem do rejestracji i resetowania hasła.
- **Rejestracja**: Podobny formularz z walidacją e-maila i wymagań dotyczących hasła (dwukrotne wprowadzenie).
- **Resetowanie hasła**: Wysyłanie linku resetującego na e-mail użytkownika.

#### Widok główny użytkownika
- Lista wszystkich list zakupów użytkownika, sortowana domyślnie według daty utworzenia (najnowsze na górze).
- Przycisk "Utwórz nową listę zakupów" na górze listy, który tworzy listę z domyślną nazwą i przekierowuje do jej edycji.
- Każda lista zawiera nazwę oraz ikonę usunięcia.

#### Szczegóły listy zakupów
- Edytowalna nazwa listy (edycja inline po kliknięciu).
- Pole tekstowe (textarea) do wprowadzania produktów.
- Przycisk "Wygeneruj listę zakupów".
- Lista produktów z możliwością edycji nazwy (po kliknięciu), oznaczania jako zakupione (checkbox) i usuwania.
- Produkty zakupione są przekreślone, wyszarzone i przenoszone na koniec listy.

#### Panel administratora
- Paginowana lista użytkowników z możliwością wyboru liczby wyświetlanych elementów (10, 20, 50).
- Szczegóły użytkownika: e-mail, data rejestracji, data logowania, możliwość edycji e-maila i hasła.

### Nawigacja
- Boczny panel nawigacyjny z ikonami, zwijany do hamburger menu na urządzeniach mobilnych.
- Opcje nawigacji dla użytkownika: Listy zakupów, Profil, Wyloguj.
- Opcje nawigacji dla administratora: Lista użytkowników, Profil, Wyloguj.

### Integracja z API i zarządzanie stanem
- Natychmiastowa synchronizacja zmian w listach i produktach z API.
- Zarządzanie stanem aplikacji z wykorzystaniem React Context lub lekkiej biblioteki typu Zustand.
- Obsługa błędów API z prezentacją szczegółowych komunikatów (znikających po 10 sekundach).
- Zapisywanie stanu ostatnio edytowanej listy zakupów.

### Responsywność i dostępność
- Pełna responsywność dzięki Tailwind, z odpowiednim układem dla urządzeń mobilnych, tabletów i desktopów.
- Wsparcie dla trybu jasnego i ciemnego, z domyślnym trybem ciemnym.
- Przełącznik trybu w menu głównym, z zapisem preferencji w localStorage.

### Interakcje i doświadczenie użytkownika
- Modalne okna potwierdzające operacje usuwania list i użytkowników.
- Komunikat powitalny dla nowo zarejestrowanych użytkowników.
- Przyciski akcji wyróżnione kolorystycznie.
- Edycja elementów aktywowana pojedynczym kliknięciem.
- Nowoczesne przejścia między widokami.
- Stopka aplikacji z informacją "Powered by asperIT".

### Bezpieczeństwo
- Autentykacja oparta na Supabase Auth z JWT.
- Walidacja danych wejściowych (np. długość tekstu max. 128 znaków).
- Rozdzielenie uprawnień dla zwykłych użytkowników i administratorów.
</ui_architecture_planning_summary>

<unresolved_issues>
1. Brak szczegółów dotyczących dokładnego wyglądu komunikatu powitalnego dla nowych użytkowników.
2. Brak konkretnych informacji o wyglądzie przełącznika trybu jasnego/ciemnego.
3. Brak szczegółowych treści komunikatów błędów API.
4. Nie określono dokładnie, jakie ikony będą używane w nawigacji i przy funkcjach aplikacji.
5. Brak szczegółów dotyczących dokładnego procesu przejścia między logowaniem a rejestracją.
6. Nie określono dokładnie, jak będzie wyglądać prezentacja błędów walidacji formularzy.
7. Brak szczegółów dotyczących implementacji mechanizmu "Wygeneruj listę zakupów" i współpracy z planowanym w przyszłości asystentem AI.
</unresolved_issues>
</conversation_summary> 


================================================
File: .ai/users-endpoint-implementation-plan.md
================================================
# Plan wdrożenia punktów końcowych API: Zarządzanie użytkownikami

## 1. Przegląd punktu końcowego
Punkty końcowe API związane z użytkownikami umożliwiają wykonywanie operacji CRUD na użytkownikach systemu. Obejmują one pobieranie listy wszystkich użytkowników (tylko dla administratorów), pobieranie szczegółów konkretnego użytkownika, aktualizację informacji o użytkowniku (w tym hasła) oraz usuwanie konta użytkownika.

## 2. Szczegóły żądania

### 2.1. Pobieranie wszystkich użytkowników
- **Metoda HTTP:** GET
- **Adres URL punktu końcowego:** `/api/users`
- **Parametry:**
  - **Opcjonalne:**
    - `page` (integer, domyślnie: 1) - Numer strony wyników
    - `pageSize` (integer, domyślnie: 20) - Liczba elementów na stronę
    - `sort` (string, opcjonalnie) - Pole, według którego sortowane są wyniki (email, registrationDate)
    - `order` (string, opcjonalnie) - Kolejność sortowania (asc, desc)
    - `emailFilter` (string, opcjonalnie) - Filtrowanie według wzorca w adresie email
- **Treść żądania:** Brak

### 2.2. Pobieranie użytkownika według ID
- **Metoda HTTP:** GET
- **Adres URL punktu końcowego:** `/api/users/{id}`
- **Parametry:**
  - **Wymagane:**
    - `id` (UUID): Identyfikator użytkownika (jako parametr ścieżki)
  - **Opcjonalne:** Brak
- **Treść żądania:** Brak

### 2.3. Aktualizacja użytkownika
- **Metoda HTTP:** PUT
- **Adres URL punktu końcowego:** `/api/users/{id}`
- **Parametry:**
  - **Wymagane:**
    - `id` (UUID): Identyfikator użytkownika (jako parametr ścieżki)
  - **Opcjonalne:** Brak
- **Treść żądania:**
  ```json
  {
    "email": "string",
    "password": "string"  // Opcjonalne - przekazane tylko jeśli aktualizujemy hasło
  }
  ```

### 2.4. Usuwanie użytkownika
- **Metoda HTTP:** DELETE
- **Adres URL punktu końcowego:** `/api/users/{id}`
- **Parametry:**
  - **Wymagane:**
    - `id` (UUID): Identyfikator użytkownika (jako parametr ścieżki)
  - **Opcjonalne:** Brak
- **Treść żądania:** Brak

## 3. Wykorzystywane typy
- **DTO i modele komend:**
  - `UserDTO` – reprezentuje podstawowe informacje o użytkowniku
  - `GetAllUsersResponse` – reprezentuje odpowiedź z listą użytkowników i informacjami o paginacji
  - `GetUserByIdResponse` – reprezentuje odpowiedź zawierającą szczegóły użytkownika
  - `UpdateUserRequest` – reprezentuje przychodzące żądanie aktualizacji danych użytkownika
  - `UpdateUserResponse` – reprezentuje odpowiedź po aktualizacji danych użytkownika
  - `PaginationResponse` – reprezentuje informacje o paginacji

Te typy są zdefiniowane w pliku `src/types.ts`.

## 4. Szczegóły odpowiedzi

### 4.1. Pobieranie wszystkich użytkowników
- **Treść odpowiedzi:**
  ```json
  {
    "data": [
      {
        "id": "uuid",
        "email": "string",
        "registrationDate": "string",
        "lastLoginDate": "string"
      }
    ],
    "pagination": {
      "totalItems": "integer",
      "totalPages": "integer",
      "currentPage": "integer",
      "pageSize": "integer"
    }
  }
  ```
- **Kod statusu w przypadku sukcesu:** 200 OK

### 4.2. Pobieranie użytkownika według ID
- **Treść odpowiedzi:**
  ```json
  {
    "id": "uuid",
    "email": "string",
    "registrationDate": "string",
    "lastLoginDate": "string",
    "isAdmin": "boolean"
  }
  ```
- **Kod statusu w przypadku sukcesu:** 200 OK

### 4.3. Aktualizacja użytkownika
- **Treść odpowiedzi:**
  ```json
  {
    "id": "uuid",
    "email": "string",
    "updatedDate": "string",
    "passwordUpdated": "boolean"  // Informacja, czy hasło zostało zaktualizowane
  }
  ```
- **Kod statusu w przypadku sukcesu:** 200 OK

### 4.4. Usuwanie użytkownika
- **Treść odpowiedzi:** Brak (pusta odpowiedź)
- **Kod statusu w przypadku sukcesu:** 204 No Content

## 5. Przepływ danych

### 5.1. Pobieranie wszystkich użytkowników
1. Uwierzytelniony użytkownik z uprawnieniami administratora wysyła żądanie GET z opcjonalnymi parametrami zapytania (page, pageSize, sort, order, emailFilter).
2. Punkt końcowy waliduje parametry zapytania przy użyciu schematu Zod (sprawdzając poprawność typów i zakresów wartości).
3. Punkt końcowy weryfikuje, czy użytkownik ma uprawnienia administratora, sprawdzając wartość kolumny `admin` dla bieżącego użytkownika.
4. Wywoływana jest funkcja warstwy serwisowej, która:
   - Pobiera użytkowników z bazy danych, uwzględniając parametry paginacji, sortowania i filtrowania
   - Oblicza informacje o paginacji (całkowita liczba elementów, liczba stron itp.)
5. W przypadku powodzenia, dane użytkowników wraz z informacjami o paginacji są zwracane w odpowiedzi.
6. W przypadku błędów uwierzytelniania lub autoryzacji, punkt końcowy zwraca odpowiedni kod błędu HTTP.

### 5.2. Pobieranie użytkownika według ID
1. Uwierzytelniony użytkownik wysyła żądanie GET z identyfikatorem użytkownika jako parametrem ścieżki.
2. Punkt końcowy waliduje format identyfikatora (UUID).
3. Punkt końcowy sprawdza, czy żądający użytkownik ma uprawnienia do pobierania danych wskazanego użytkownika:
   - Użytkownik może zawsze pobierać własne dane
   - Jeśli żądający posiada uprawnienia administratora, może pobierać dane dowolnego użytkownika
4. Wywoływana jest funkcja warstwy serwisowej, która:
   - Pobiera użytkownika o określonym ID z bazy danych
   - Sprawdza, czy użytkownik istnieje
   - Określa, czy użytkownik ma uprawnienia administratora, sprawdzając czy jego ID znajduje się na liście administratorów
5. W przypadku znalezienia użytkownika, jego dane wraz z informacją o uprawnieniach administratora są zwracane w odpowiedzi.
6. W przypadku gdy użytkownik nie zostanie znaleziony lub żądający nie ma odpowiednich uprawnień, zwracany jest odpowiedni kod błędu.

### 5.3. Aktualizacja użytkownika
1. Uwierzytelniony użytkownik wysyła żądanie PUT z identyfikatorem użytkownika jako parametrem ścieżki i nowymi danymi w treści żądania.
2. Punkt końcowy waliduje format identyfikatora (UUID) oraz treść żądania (sprawdzając poprawność pól email i password, jeśli są obecne).
3. Punkt końcowy sprawdza, czy żądający użytkownik ma uprawnienia do aktualizacji danych wskazanego użytkownika:
   - Użytkownik może zawsze aktualizować własne dane
   - Jeśli żądający posiada wartość `true` w kolumnie `admin`, może aktualizować dane dowolnego użytkownika
4. W przypadku aktualizacji adresu email, punkt końcowy sprawdza, czy nowy adres email nie jest już używany przez innego użytkownika.
5. Wywoływana jest funkcja warstwy serwisowej, która:
   - Aktualizuje dane użytkownika w bazie danych
   - Automatycznie aktualizuje znacznik czasu `updated_date`
   - W przypadku zmiany hasła, przeprowadza odpowiednie hashowanie hasła i zapisuje hash w polu `password_hash` w bazie danych
6. W przypadku powodzenia, zaktualizowane dane użytkownika są zwracane w odpowiedzi (bez zahaszowanego hasła ze względów bezpieczeństwa).
7. W przypadku błędów walidacji, autoryzacji lub konfliktu adresu email, zwracany jest odpowiedni kod błędu.

### 5.4. Usuwanie użytkownika
1. Uwierzytelniony użytkownik wysyła żądanie DELETE z identyfikatorem użytkownika jako parametrem ścieżki.
2. Punkt końcowy waliduje format identyfikatora (UUID).
3. Punkt końcowy sprawdza, czy żądający użytkownik ma uprawnienia do usunięcia wskazanego użytkownika:
   - Użytkownik może zawsze usunąć własne konto
   - Jeśli żądający posiada wartość `true` w kolumnie `admin`, może usunąć konto dowolnego użytkownika
4. Wywoływana jest funkcja warstwy serwisowej, która:
   - Usuwa użytkownika z bazy danych
   - Dzięki klauzuli ON DELETE CASCADE w bazie danych, wszystkie powiązane dane (listy zakupów, elementy list itp.) są również usuwane
5. W przypadku powodzenia, zwracana jest pusta odpowiedź z kodem 204 No Content.
6. W przypadku błędów autoryzacji lub gdy użytkownik nie zostanie znaleziony, zwracany jest odpowiedni kod błędu.

## 6. Względy bezpieczeństwa
- **Uwierzytelnienie i autoryzacja:**
  - Dostęp do punktów końcowych mają wyłącznie uwierzytelnieni użytkownicy. Token uwierzytelniający jest weryfikowany za pomocą Supabase przy użyciu `context.locals`.
  - Punkt końcowy pobierania wszystkich użytkowników jest dostępny tylko dla administratorów (użytkowników, których ID znajduje się na zdefiniowanej liście administratorów).
  - Użytkownicy mogą pobierać, aktualizować i usuwać tylko własne dane, chyba że posiadają uprawnienia administratora.
  - Informacja o uprawnieniach administratora jest zwracana w odpowiedzi API dla endpointu pobierania użytkownika po ID.
- **Walidacja danych:**
  - Parametry zapytania i treść żądania są walidowane przy użyciu schematu Zod, aby zapewnić, że są odpowiedniego typu i spełniają wymagane kryteria.
  - Adres email jest walidowany pod kątem poprawności formatu i unikalności w systemie.
  - Hasło jest walidowane pod kątem minimalnej długości i złożoności zgodnie z wymaganiami bezpieczeństwa.
- **Bezpieczeństwo bazy danych:**
  - Zapytania do bazy danych są parametryzowane, aby zapobiec atakom SQL injection.
  - Operacje na bazie danych są realizowane przy użyciu klienta Supabase z `context.locals`, co zapewnia bezpieczne zarządzanie połączeniami.
  - Hasła są przechowywane w postaci bezpiecznych skrótów w kolumnie `password_hash`, nie jako zwykły tekst.
  - Hasła nigdy nie są zwracane w odpowiedziach API, nawet w zahaszowanej formie.

## 7. Obsługa błędów
- **400 Bad Request:** Zwracany, gdy walidacja parametrów zapytania lub treści żądania nie powiedzie się (np. nieprawidłowy format parametru, brakujące wymagane pola).
- **401 Unauthorized:** Zwracany, gdy token uwierzytelniający jest nieobecny lub niepoprawny.
- **403 Forbidden:** Zwracany, gdy użytkownik nie ma wystarczających uprawnień do wykonania operacji (np. próba pobrania wszystkich użytkowników przez nie-administratora lub manipulacja danymi innego użytkownika).
- **404 Not Found:** Zwracany, gdy użytkownik o podanym identyfikatorze nie istnieje.
- **409 Conflict:** Zwracany podczas aktualizacji, gdy nowy adres email jest już używany przez innego użytkownika.
- **500 Internal Server Error:** Zwracany w przypadku nieoczekiwanych błędów po stronie serwera lub bazy danych.
- Wszystkie błędy powinny być logowane z wystarczającą ilością szczegółów, aby ułatwić diagnozowanie problemu, przy jednoczesnym zachowaniu poufności wrażliwych informacji.

## 8. Rozważania dotyczące wydajności
- Paginacja jest kluczowa dla optymalizacji wydajności punktu końcowego pobierania wszystkich użytkowników, szczególnie gdy system ma wielu użytkowników.
- Zapytania do bazy danych powinny wykorzystywać indeksy na kolumnach `id` i `email` dla szybkiego wyszukiwania i sortowania.
- Filtrowanie przez wzorzec email powinno korzystać z indeksu tekstowego, jeśli jest dostępny w Supabase.
- Rozważyć implementację pamięci podręcznej (caching) dla często pobieranych danych użytkowników, aby zmniejszyć obciążenie bazy danych.
- Monitorować operację usuwania konta użytkownika, ponieważ może ona być bardziej złożona ze względu na kaskadowe usuwanie powiązanych danych w wielu tabelach.

## 9. Etapy wdrożenia

### 9.1. Pobieranie wszystkich użytkowników
1. **Konfiguracja uwierzytelnienia:** Upewnić się, że middleware weryfikuje tokeny uwierzytelniające i ogranicza dostęp do punktu końcowego tylko dla uwierzytelnionych użytkowników.
2. **Walidacja parametrów zapytania:** Zaimplementować schemat Zod do walidacji parametrów zapytania (page, pageSize, sort, order, emailFilter).
3. **Implementacja warstwy serwisowej:** Utworzyć funkcję serwisową `getUserService.getAllUsers()`, która obsłuży logikę biznesową pobierania użytkowników z paginacją, sortowaniem i filtrowaniem.
4. **Implementacja autoryzacji administratora:** Dodać logikę sprawdzającą, czy żądający użytkownik ma wartość `true` w kolumnie `admin`.
5. **Implementacja punktu końcowego API:** Opracować punkt końcowy GET `/api/users` w ramach trasy Astro, integrując walidację, autoryzację i warstwę serwisową.
6. **Obsługa paginacji i sortowania:** Zaimplementować logikę do obsługi parametrów paginacji i sortowania w zapytaniach do bazy danych.
7. **Formowanie odpowiedzi:** Odpowiednio formatować odpowiedź z wykorzystaniem typów DTO i uwzględniać informacje o paginacji.
8. **Testowanie:** Napisać testy integracyjne, które obejmą różne scenariusze paginacji, sortowania, filtrowania oraz obsługę błędów.
9. **Optymalizacja wydajności:** Przeanalizować wydajność zapytań i zoptymalizować indeksy bazy danych.
10. **Dokumentacja:** Zaktualizować dokumentację API oraz przewodniki dla deweloperów o nowy punkt końcowy.

### 9.2. Pobieranie użytkownika według ID
1. **Konfiguracja uwierzytelnienia:** Upewnić się, że middleware weryfikuje tokeny uwierzytelniające i ogranicza dostęp do punktu końcowego tylko dla uwierzytelnionych użytkowników.
2. **Walidacja parametru identyfikatora:** Zaimplementować walidację formatu UUID dla parametru ścieżki.
3. **Implementacja warstwy serwisowej:** Utworzyć funkcję serwisową `userService.getUserById()`, która obsłuży logikę biznesową pobierania użytkownika o określonym ID.
4. **Implementacja określania uprawnień administratora:** Dodać mechanizm określający, czy użytkownik ma uprawnienia administratora na podstawie jego ID.
5. **Implementacja autoryzacji:** Dodać logikę sprawdzającą, czy żądający użytkownik jest właścicielem konta lub ma uprawnienia administratora.
6. **Implementacja punktu końcowego API:** Opracować punkt końcowy GET `/api/users/{id}` w ramach trasy Astro, integrując walidację, autoryzację i warstwę serwisową.
7. **Formowanie odpowiedzi:** Odpowiednio formatować odpowiedź z wykorzystaniem typu UserDTO, włączając informację o uprawnieniach administratora.
8. **Testowanie:** Napisać testy integracyjne, które obejmą różne scenariusze, w tym pobieranie istniejącego użytkownika, nieautoryzowany dostęp, nieistniejącego użytkownika itp.
9. **Dokumentacja:** Zaktualizować dokumentację API oraz przewodniki dla deweloperów o nowy punkt końcowy, jasno dokumentując pole isAdmin w odpowiedzi API.

### 9.3. Aktualizacja użytkownika
1. **Konfiguracja uwierzytelnienia:** Upewnić się, że middleware weryfikuje tokeny uwierzytelniające i ogranicza dostęp do punktu końcowego tylko dla uwierzytelnionych użytkowników.
2. **Walidacja parametru identyfikatora:** Zaimplementować walidację formatu UUID dla parametru ścieżki.
3. **Walidacja danych wejściowych:** Zaimplementować schemat Zod do walidacji pól email i password w treści żądania.
4. **Implementacja warstwy serwisowej:** Utworzyć funkcję serwisową `userService.updateUser()`, która obsłuży logikę biznesową aktualizacji danych użytkownika, wraz z bezpiecznym hashowaniem hasła.
5. **Implementacja bezpiecznego hashowania hasła:** Zaimplementować funkcję, która bezpiecznie haszuje hasło przed zapisaniem go w bazie danych.
6. **Implementacja autoryzacji:** Dodać logikę sprawdzającą, czy żądający użytkownik jest właścicielem konta lub ma wartość `true` w kolumnie `admin`.
7. **Implementacja sprawdzania unikalności emaila:** Dodać logikę sprawdzającą, czy nowy adres email nie jest już używany przez innego użytkownika.
8. **Implementacja punktu końcowego API:** Opracować punkt końcowy PUT `/api/users/{id}` w ramach trasy Astro, integrując walidację, autoryzację i warstwę serwisową.
9. **Operacja na bazie danych:** Wykonać operację aktualizacji przy użyciu klienta Supabase, zapewniając odpowiednią obsługę błędów podczas transakcji.
10. **Formowanie odpowiedzi:** Zwrócić odpowiedź z kodem 200 OK wraz z zaktualizowanymi danymi użytkownika lub odpowiednio obsłużyć błędy. Upewnić się, że odpowiedź nie zawiera zahaszowanego hasła.
11. **Testowanie:** Napisać testy integracyjne, które obejmą różne scenariusze aktualizacji, błędy walidacji, konflikt adresu email, nieautoryzowany dostęp, nieistniejącego użytkownika itp.
12. **Dokumentacja:** Zaktualizować dokumentację API oraz przewodniki dla deweloperów o nowy punkt końcowy.

### 9.4. Usuwanie użytkownika
1. **Konfiguracja uwierzytelnienia:** Upewnić się, że middleware weryfikuje tokeny uwierzytelniające i ogranicza dostęp do punktu końcowego tylko dla uwierzytelnionych użytkowników.
2. **Walidacja parametru identyfikatora:** Zaimplementować walidację formatu UUID dla parametru ścieżki.
3. **Implementacja warstwy serwisowej:** Utworzyć funkcję serwisową `userService.deleteUser()`, która obsłuży logikę biznesową usuwania użytkownika.
4. **Implementacja autoryzacji:** Dodać logikę sprawdzającą, czy żądający użytkownik jest właścicielem konta lub ma wartość `true` w kolumnie `admin`.
5. **Implementacja punktu końcowego API:** Opracować punkt końcowy DELETE `/api/users/{id}` w ramach trasy Astro, integrując walidację, autoryzację i warstwę serwisową.
6. **Operacja na bazie danych:** Wykonać operację usuwania przy użyciu klienta Supabase, zapewniając odpowiednią obsługę błędów podczas transakcji.
7. **Formowanie odpowiedzi:** Zwrócić odpowiedź z kodem 204 No Content w przypadku powodzenia lub odpowiednio obsłużyć błędy.
8. **Testowanie:** Napisać testy integracyjne, które obejmą różne scenariusze usuwania, nieautoryzowany dostęp, nieistniejącego użytkownika itp.
9. **Dokumentacja:** Zaktualizować dokumentację API oraz przewodniki dla deweloperów o nowy punkt końcowy.
10. **Monitorowanie:** Skonfigurować monitorowanie wydajności punktu końcowego, szczególnie w kontekście kaskadowego usuwania powiązanych danych.

# Wytyczne dla środowiska deweloperskiego

## Obsługa autoryzacji w wersji deweloperskiej

Zgodnie z istniejącą implementacją w `src/middleware/index.ts`, wszystkie opisane w dokumencie endpointy powinny automatycznie działać w środowisku deweloperskim **bez konieczności ręcznej autoryzacji**. Obecne rozwiązanie działa w następujący sposób:

1. **Wykrywanie środowiska deweloperskiego:**
   ```typescript
   // Sprawdzenie czy środowisko jest developmentem
   const isDevelopment = process.env.NODE_ENV === "development";
   ```

2. **Automatyczne przypisanie testowego użytkownika w trybie deweloperskim:**
   ```typescript
   // W środowisku deweloperskim automatycznie przypisujemy testowego użytkownika
   if (isDevelopment) {
     console.log("🔧 Tryb deweloperski: używanie testowego użytkownika");

     // Testowy użytkownik deweloperski dla łatwiejszego testowania API
     const devUser: User = {
       id: "077f7996-bca0-4e19-9a3f-b9c8bcb55347",
       app_metadata: {},
       user_metadata: {},
       aud: "authenticated",
       email: "dev@example.com",
       created_at: new Date().toISOString(),
       role: "authenticated",
     };

     (context.locals as AstroLocals).user = devUser;
   } else {
     // W środowisku produkcyjnym standardowa weryfikacja uwierzytelnienia
     const {
       data: { user },
     } = await supabaseClient.auth.getUser();
     (context.locals as AstroLocals).user = user;
   }
   ```

3. **Zapewnienie dostępu do klienta Supabase:**
   ```typescript
   // Przypisanie klienta Supabase do context.locals
   context.locals.supabase = supabaseClient;
   ```

## Stosowanie w endpointach

Każdy z opisanych endpointów powinien wykorzystywać ten mechanizm poprzez:

1. **Pobieranie informacji o użytkowniku z kontekstu:**
   ```typescript
   const { user } = context.locals;
   const userId = user?.id;
   
   // Sprawdzenie czy użytkownik jest dostępny
   if (!userId) {
     return new Response(JSON.stringify({ error: 'Brak autoryzacji' }), {
       status: 401,
       headers: { 'Content-Type': 'application/json' }
     });
   }
   ```

2. **Sprawdzanie uprawnień administratora:**
   ```typescript
   // Sprawdzenie czy użytkownik ma uprawnienia administratora
   const { data: userData, error: userError } = await supabase
     .from('users')
     .select('admin')
     .eq('id', userId)
     .single();

   // Weryfikacja uprawnień administratora
   if (userError || !userData || !userData.admin) {
     return new Response(JSON.stringify({ error: 'Brak uprawnień' }), {
       status: 403,
       headers: { 'Content-Type': 'application/json' }
     });
   }
   ```

3. **Wykorzystanie klienta Supabase z kontekstu:**
   ```typescript
   const { supabase } = context.locals;
   
   // Przykład operacji na bazie danych
   const { data, error } = await supabase
     .from('users')
     .select('*')
     .eq('id', userId);
   ```

## Uwagi implementacyjne

1. **Identyfikator użytkownika deweloperskiego:**
   Istniejący identyfikator użytkownika deweloperskiego to `077f7996-bca0-4e19-9a3f-b9c8bcb55347`. Należy upewnić się, że ten sam identyfikator jest używany we wszystkich endpointach oraz testach.

2. **Weryfikacja uprawnień administratora:**
   W środowisku deweloperskim należy upewnić się, że testowy użytkownik ma wartość `true` w kolumnie `admin` w bazie danych. Można to ustawić podczas inicjalizacji środowiska deweloperskiego lub poprzez dodatkową logikę w endpointach, która w trybie deweloperskim automatycznie przyznaje uprawnienia administratora:
   ```typescript
   // Automatyczne przyznanie uprawnień administratora w trybie deweloperskim
   let isAdmin = false;
   if (isDevelopment) {
     isAdmin = true; // Testowy użytkownik zawsze ma uprawnienia administratora w trybie deweloperskim
   } else {
     // Sprawdzenie uprawnień w bazie danych
     const { data: userData, error: userError } = await supabase
       .from('users')
       .select('admin')
       .eq('id', userId)
       .single();
     
     isAdmin = userData?.admin || false;
   }
   ```

3. **Logowanie:**
   Zachować komunikat logujący informujący o pracy w trybie deweloperskim, co ułatwi diagnostykę podczas testowania:
   ```typescript
   if (isDevelopment) {
     console.log(`🔧 Endpoint ${endpointName} działa w trybie deweloperskim (uprawnienia administratora: ${isAdmin})`);
   }
   ```

4. **Testowanie:**
   Testy integracyjne powinny uwzględniać zarówno scenariusze z włączonym trybem deweloperskim, jak i z symulowaną autoryzacją produkcyjną, aby zapewnić pełne pokrycie testami. Dodatkowo, testy powinny obejmować scenariusze z użytkownikami posiadającymi różne wartości kolumny `admin`, aby sprawdzić poprawność mechanizmu autoryzacji. Testy powinny też sprawdzać proces aktualizacji hasła, weryfikując czy system poprawnie zapisuje zahaszowane hasło w bazie danych. 


================================================
File: .ai/diagrams/auth-flow.mmd
================================================
<mermaid_diagram>
graph LR
    subgraph Frontend
        A["User"]
        B["Astro Page:\nLogin / Register / Recover"]
        C["React Auth Form"]
        M["Astro Middleware"]
    end

    subgraph Backend
        D["API Endpoints:\nregister, login,\nlogout, request-reset,\nset-new-password"]
        V["Validation & Error Logging"]
        E["Supabase Auth"]
        F["Database:\nUsers & errors_log"]
    end

    A ==> B:::thick
    B ==> C:::thick
    C ==> D:::thick
    D ==> E:::thick
    E ==> F:::thick
    D -- "Validation\nand errors"--> V
    V -.-> F
    M -- "Route protection"--> B

    classDef thick stroke:#333,stroke-width:2px;
</mermaid_diagram> 


================================================
File: .astro/content-assets.mjs
================================================
export default new Map();


================================================
File: .astro/content-modules.mjs
================================================
export default new Map();


================================================
File: .astro/content.d.ts
================================================
declare module 'astro:content' {
	export interface RenderResult {
		Content: import('astro/runtime/server/index.js').AstroComponentFactory;
		headings: import('astro').MarkdownHeading[];
		remarkPluginFrontmatter: Record<string, any>;
	}
	interface Render {
		'.md': Promise<RenderResult>;
	}

	export interface RenderedContent {
		html: string;
		metadata?: {
			imagePaths: Array<string>;
			[key: string]: unknown;
		};
	}
}

declare module 'astro:content' {
	type Flatten<T> = T extends { [K: string]: infer U } ? U : never;

	export type CollectionKey = keyof AnyEntryMap;
	export type CollectionEntry<C extends CollectionKey> = Flatten<AnyEntryMap[C]>;

	export type ContentCollectionKey = keyof ContentEntryMap;
	export type DataCollectionKey = keyof DataEntryMap;

	type AllValuesOf<T> = T extends any ? T[keyof T] : never;
	type ValidContentEntrySlug<C extends keyof ContentEntryMap> = AllValuesOf<
		ContentEntryMap[C]
	>['slug'];

	export type ReferenceDataEntry<
		C extends CollectionKey,
		E extends keyof DataEntryMap[C] = string,
	> = {
		collection: C;
		id: E;
	};
	export type ReferenceContentEntry<
		C extends keyof ContentEntryMap,
		E extends ValidContentEntrySlug<C> | (string & {}) = string,
	> = {
		collection: C;
		slug: E;
	};

	/** @deprecated Use `getEntry` instead. */
	export function getEntryBySlug<
		C extends keyof ContentEntryMap,
		E extends ValidContentEntrySlug<C> | (string & {}),
	>(
		collection: C,
		// Note that this has to accept a regular string too, for SSR
		entrySlug: E,
	): E extends ValidContentEntrySlug<C>
		? Promise<CollectionEntry<C>>
		: Promise<CollectionEntry<C> | undefined>;

	/** @deprecated Use `getEntry` instead. */
	export function getDataEntryById<C extends keyof DataEntryMap, E extends keyof DataEntryMap[C]>(
		collection: C,
		entryId: E,
	): Promise<CollectionEntry<C>>;

	export function getCollection<C extends keyof AnyEntryMap, E extends CollectionEntry<C>>(
		collection: C,
		filter?: (entry: CollectionEntry<C>) => entry is E,
	): Promise<E[]>;
	export function getCollection<C extends keyof AnyEntryMap>(
		collection: C,
		filter?: (entry: CollectionEntry<C>) => unknown,
	): Promise<CollectionEntry<C>[]>;

	export function getEntry<
		C extends keyof ContentEntryMap,
		E extends ValidContentEntrySlug<C> | (string & {}),
	>(
		entry: ReferenceContentEntry<C, E>,
	): E extends ValidContentEntrySlug<C>
		? Promise<CollectionEntry<C>>
		: Promise<CollectionEntry<C> | undefined>;
	export function getEntry<
		C extends keyof DataEntryMap,
		E extends keyof DataEntryMap[C] | (string & {}),
	>(
		entry: ReferenceDataEntry<C, E>,
	): E extends keyof DataEntryMap[C]
		? Promise<DataEntryMap[C][E]>
		: Promise<CollectionEntry<C> | undefined>;
	export function getEntry<
		C extends keyof ContentEntryMap,
		E extends ValidContentEntrySlug<C> | (string & {}),
	>(
		collection: C,
		slug: E,
	): E extends ValidContentEntrySlug<C>
		? Promise<CollectionEntry<C>>
		: Promise<CollectionEntry<C> | undefined>;
	export function getEntry<
		C extends keyof DataEntryMap,
		E extends keyof DataEntryMap[C] | (string & {}),
	>(
		collection: C,
		id: E,
	): E extends keyof DataEntryMap[C]
		? string extends keyof DataEntryMap[C]
			? Promise<DataEntryMap[C][E]> | undefined
			: Promise<DataEntryMap[C][E]>
		: Promise<CollectionEntry<C> | undefined>;

	/** Resolve an array of entry references from the same collection */
	export function getEntries<C extends keyof ContentEntryMap>(
		entries: ReferenceContentEntry<C, ValidContentEntrySlug<C>>[],
	): Promise<CollectionEntry<C>[]>;
	export function getEntries<C extends keyof DataEntryMap>(
		entries: ReferenceDataEntry<C, keyof DataEntryMap[C]>[],
	): Promise<CollectionEntry<C>[]>;

	export function render<C extends keyof AnyEntryMap>(
		entry: AnyEntryMap[C][string],
	): Promise<RenderResult>;

	export function reference<C extends keyof AnyEntryMap>(
		collection: C,
	): import('astro/zod').ZodEffects<
		import('astro/zod').ZodString,
		C extends keyof ContentEntryMap
			? ReferenceContentEntry<C, ValidContentEntrySlug<C>>
			: ReferenceDataEntry<C, keyof DataEntryMap[C]>
	>;
	// Allow generic `string` to avoid excessive type errors in the config
	// if `dev` is not running to update as you edit.
	// Invalid collection names will be caught at build time.
	export function reference<C extends string>(
		collection: C,
	): import('astro/zod').ZodEffects<import('astro/zod').ZodString, never>;

	type ReturnTypeOrOriginal<T> = T extends (...args: any[]) => infer R ? R : T;
	type InferEntrySchema<C extends keyof AnyEntryMap> = import('astro/zod').infer<
		ReturnTypeOrOriginal<Required<ContentConfig['collections'][C]>['schema']>
	>;

	type ContentEntryMap = {
		
	};

	type DataEntryMap = {
		
	};

	type AnyEntryMap = ContentEntryMap & DataEntryMap;

	export type ContentConfig = typeof import("../src/content.config.mjs");
}



================================================
File: .astro/data-store.json
================================================
[["Map",1,2],"meta::meta",["Map",3,4,5,6],"astro-version","5.7.6","astro-config-digest","{\"root\":{},\"srcDir\":{},\"publicDir\":{},\"outDir\":{},\"cacheDir\":{},\"compressHTML\":true,\"base\":\"/\",\"trailingSlash\":\"ignore\",\"output\":\"server\",\"scopedStyleStrategy\":\"attribute\",\"build\":{\"format\":\"directory\",\"client\":{},\"server\":{},\"assets\":\"_astro\",\"serverEntry\":\"entry.mjs\",\"redirects\":true,\"inlineStylesheets\":\"auto\",\"concurrency\":1},\"server\":{\"open\":false,\"host\":false,\"port\":3000,\"streaming\":true,\"allowedHosts\":[]},\"redirects\":{},\"image\":{\"endpoint\":{\"route\":\"/_image\",\"entrypoint\":\"astro/assets/endpoint/node\"},\"service\":{\"entrypoint\":\"astro/assets/services/sharp\",\"config\":{}},\"domains\":[],\"remotePatterns\":[]},\"devToolbar\":{\"enabled\":true},\"markdown\":{\"syntaxHighlight\":{\"type\":\"shiki\",\"excludeLangs\":[\"math\"]},\"shikiConfig\":{\"langs\":[],\"langAlias\":{},\"theme\":\"github-dark\",\"themes\":{},\"wrap\":false,\"transformers\":[]},\"remarkPlugins\":[],\"rehypePlugins\":[],\"remarkRehype\":{},\"gfm\":true,\"smartypants\":true},\"security\":{\"checkOrigin\":true},\"env\":{\"schema\":{},\"validateSecrets\":false},\"experimental\":{\"clientPrerender\":false,\"contentIntellisense\":false,\"responsiveImages\":false,\"headingIdCompat\":false,\"preserveScriptOrder\":false},\"legacy\":{\"collections\":false},\"session\":{\"driver\":\"fs-lite\",\"options\":{\"base\":\"/home/sendix/projects/ShopListeo/node_modules/.astro/sessions\"}}}"]


================================================
File: .astro/settings.json
================================================
{
	"_variables": {
		"lastUpdateCheck": 1745828352998
	}
}


================================================
File: .astro/types.d.ts
================================================
/// <reference types="astro/client" />




================================================
File: .cursor/rules/api-supabase-astro-init.mdc
================================================
---
description: 
globs: 
alwaysApply: false
---
# Supabase Astro Initialization

This document provides a reproducible guide to create the necessary file structure for integrating Supabase with your Astro project.

## Prerequisites

- Your project should use Astro 5, TypeScript 5, React 19, and Tailwind 4.
- Install the `@supabase/supabase-js` package.
- Ensure that `/supabase/config.toml` exists
- Ensure that a file `/src/db/database.types.ts` exists and contains the correct type definitions for your database.

IMPORTANT: Check prerequisites before perfoming actions below. If they're not met, stop and ask a user for the fix.

## File Structure and Setup

### 1. Supabase Client Initialization

Create the file `/src/db/supabase.client.ts` with the following content:

```ts
import { createClient } from '@supabase/supabase-js';

import type { Database } from '../db/database.types.ts';

const supabaseUrl = import.meta.env.SUPABASE_URL;
const supabaseAnonKey = import.meta.env.SUPABASE_KEY;

export const supabaseClient = createClient<Database>(supabaseUrl, supabaseAnonKey);
```

This file initializes the Supabase client using the environment variables `SUPABASE_URL` and `SUPABASE_KEY`.


### 2. Middleware Setup

Create the file `/src/middleware/index.ts` with the following content:

```ts
import { defineMiddleware } from 'astro:middleware';

import { supabaseClient } from '../db/supabase.client.ts';

export const onRequest = defineMiddleware((context, next) => {
  context.locals.supabase = supabaseClient;
  return next();
});
```

This middleware adds the Supabase client to the Astro context locals, making it available throughout your application.


### 3. TypeScript Environment Definitions

Create the file `src/env.d.ts` with the following content:

```ts
/// <reference types="astro/client" />

import type { SupabaseClient } from '@supabase/supabase-js';
import type { Database } from './db/database.types.ts';

declare global {
  namespace App {
    interface Locals {
      supabase: SupabaseClient<Database>;
    }
  }
}

interface ImportMetaEnv {
  readonly SUPABASE_URL: string;
  readonly SUPABASE_KEY: string;
}

interface ImportMeta {
  readonly env: ImportMetaEnv;
}
```

This file augments the global types to include the Supabase client on the Astro `App.Locals` object, ensuring proper typing throughout your application.



================================================
File: .cursor/rules/astro.mdc
================================================
---
description: 
globs: *.astro
alwaysApply: false
---
### Guidelines for Astro

- Leverage View Transitions API for smooth page transitions (use ClientRouter)
- Use content collections with type safety for blog posts, documentation, etc.
- Leverage Server Endpoints for API routes
- Use POST, GET  - uppercase format for endpoint handlers
- Use `export const prerender = false` for API routes
- Use zod for input validation in API routes
- Extract logic into services in `src/lib/services`
- Implement middleware for request/response modification
- Use image optimization with the Astro Image integration
- Implement hybrid rendering with server-side rendering where needed
- Use Astro.cookies for server-side cookie management
- Leverage import.meta.env for environment variables



================================================
File: .cursor/rules/backend.mdc
================================================
---
description: 
globs: src/db/*.ts,src/middleware/*.ts,src/lib/*.ts
alwaysApply: false
---
### Backend and Database

- Use Supabase for backend services, including authentication and database interactions.
- Follow Supabase guidelines for security and performance.
- Use Zod schemas to validate data exchanged with the backend.
- Use supabase from context.locals in Astro routes instead of importing supabaseClient directly
- Use SupabaseClient type from `src/db/supabase.client.ts`, not from `@supabase/supabase-js`


================================================
File: .cursor/rules/db-supabase-migrations.mdc
================================================
---
description: 
globs: 
alwaysApply: false
---
# Database: Create migration

You are a Postgres Expert who loves creating secure database schemas.

This project uses the migrations provided by the Supabase CLI.

## Creating a migration file

Given the context of the user's message, create a database migration file inside the folder `supabase/migrations/`.

The file MUST following this naming convention:

The file MUST be named in the format `YYYYMMDDHHmmss_short_description.sql` with proper casing for months, minutes, and seconds in UTC time:

1. `YYYY` - Four digits for the year (e.g., `2024`).
2. `MM` - Two digits for the month (01 to 12).
3. `DD` - Two digits for the day of the month (01 to 31).
4. `HH` - Two digits for the hour in 24-hour format (00 to 23).
5. `mm` - Two digits for the minute (00 to 59).
6. `ss` - Two digits for the second (00 to 59).
7. Add an appropriate description for the migration.

For example:

```
20240906123045_create_profiles.sql
```


## SQL Guidelines

Write Postgres-compatible SQL code for Supabase migration files that:

- Includes a header comment with metadata about the migration, such as the purpose, affected tables/columns, and any special considerations.
- Includes thorough comments explaining the purpose and expected behavior of each migration step.
- Write all SQL in lowercase.
- Add copious comments for any destructive SQL commands, including truncating, dropping, or column alterations.
- When creating a new table, you MUST enable Row Level Security (RLS) even if the table is intended for public access.
- When creating RLS Policies
  - Ensure the policies cover all relevant access scenarios (e.g. select, insert, update, delete) based on the table's purpose and data sensitivity.
  - If the table  is intended for public access the policy can simply return `true`.
  - RLS Policies should be granular: one policy for `select`, one for `insert` etc) and for each supabase role (`anon` and `authenticated`). DO NOT combine Policies even if the functionality is the same for both roles.
  - Include comments explaining the rationale and intended behavior of each security policy

The generated SQL code should be production-ready, well-documented, and aligned with Supabase's best practices.



================================================
File: .cursor/rules/diagram-auth.mdc
================================================
---
description: 
globs: 
alwaysApply: false
---
Jesteś specjalistą ds. bezpieczeństwa, którego zadaniem jest utworzenie diagramu Mermaid w celu wizualizacji przepływu autentykacji dla modułu logowania i rejestracji. Diagram powinien zostać utworzony w następującym pliku: DESTINATION

Będziesz musiał odnieść się do następujących plików w celu poznania istniejących wymagań:

<file_references>
[project-prd.md](mdc:.ai/project-prd.md)
</file_references>

<destination>
.ai/diagrams/auth.md
</destination>

Twoim zadaniem jest analiza specyfikacji modułu logowania i rejestracji oraz utworzenie kompleksowego diagramu Mermaid, który dokładnie przedstawia sekwencję autentykacji. Diagram powinien być w języku polskim.

Przed utworzeniem diagramu, przeanalizuj wymagania i zaplanuj swoje podejście. Umieść swoją analizę wewnątrz tagów <authentication_analysis>. W tej analizie:

1. Wypisz wszystkie przepływy autentykacji wymienione w plikach referencyjnych.
2. Zidentyfikuj głównych aktorów i ich interakcje.
3. Określ procesy weryfikacji i odświeżania tokenów.
4. Dostarcz krótki opis każdego kroku autentykacji.

Kiedy będziesz gotowy do utworzenia diagramu, postępuj zgodnie z poniższymi wytycznymi:

1. Rozpocznij diagram od następującej składni:

   ```mermaid
   sequenceDiagram
   ```

2. Uwzględnij następujące elementy w swoim diagramie:

   - Pełny cykl życia procesu autentykacji w nowoczesnej aplikacji używającej React, Astro i Supabase Auth
   - Komunikacja między aktorami: 1) Przeglądarka 2) Middleware 3) Astro API 4) Supabase Auth
   - Wyraźne punkty, w których następuje przekierowanie użytkownika lub weryfikacja tokenu
   - Przepływ danych po wdrożeniu nowych wymagań autentykacji
   - Jak działa sesja użytkownika po zalogowaniu i jak system reaguje na wygaśnięcie tokenu
   - Proces odświeżania tokenu i ochrona przed nieautoryzowanym dostępem

3. Przestrzegaj tych zasad składni Mermaid:

   - Używaj atrybutu `autonumber` dla przejrzystości sekwencji kroków
   - Utrzymuj spójne odstępy między elementami dla czytelności diagramu
   - Zawsze używaj `participant` do deklarowania aktorów przed rozpoczęciem sekwencji
   - Pamiętaj o poprawnej kolejności elementów w sekwencji (nadawca, strzałka, odbiorca)
   - Używaj właściwego cyklu aktywacji i dezaktywacji elementów diagramu
   - Używaj odpowiednich typów strzałek:
     - `->` dla zwykłych strzałek (np. `Browser->API`)
     - `-->` dla przerywanych strzałek (np. `API-->Browser: Token expired`)
     - `->>` dla strzałek z pustymi grotami (np. `Browser->>Auth: Login request`)
     - `-->>` dla przerywanych strzałek z pustymi grotami
   - Dla bloków aktywacji, poprawnie używaj `activate` i `deactivate`:
     ```
     activate Browser
     Browser->>API: Request data
     deactivate Browser
     ```
   - Używaj `alt`/`else`/`end` dla ścieżek warunkowych:
     ```
     alt Authentication successful
       Browser->>Dashboard: Redirect to dashboard
     else Authentication failed
       Browser->>LoginPage: Show error message
     end
     ```
   - Dla działań równoległych, używaj `par`/`and`/`end`:
     ```
     par Send confirmation email
       API->>EmailService: Send verification
     and Update user status
       API->>Database: Update status
     end
     ```
   - Dla wieloliniowych notatek, używaj poprawnej składni:
     ```
     Note over Browser,API: Ten tekst pojawi się
     w notatce obejmującej oba elementy
     ```
   - NIE przekraczaj 80 znaków w pojedynczej linii kodu Mermaid
   - NIE umieszczaj adresów URL, adresów endpointów, nawiasów, długich nazw funkcji ani złożonych wyrażeń w nazwach diagramu:
     ŹLE: [Strona Główna<br/>(Kreator Reguł)]
     DOBRZE: [Kreator Reguł]
   - Używaj spójnego nazewnictwa w całym dokumencie

4. Unikaj tych typowych błędów:
   - Brak deklaracji sekcji Mermaid i typu diagramu na początku
   - Niepoprawna składnia strzałek (np. -> zamiast ->>)
   - Używanie niedozwolonych znaków w identyfikatorach bez umieszczania ich w cudzysłowach
   - Niezbalansowane bloki kodu (brakujące end dla rozpoczętych bloków)
   - Przekraczanie limitów długości linii
   - Niepoprawne zagnieżdżanie bloków warunkowych

Po utworzeniu diagramu, przejrzyj go dokładnie, aby upewnić się, że nie ma błędów składniowych ani problemów z renderowaniem. Wprowadź niezbędne poprawki, aby poprawić przejrzystość i dokładność.

Kiedy będziesz gotowy do przedstawienia końcowego diagramu, użyj tagów <mermaid_diagram> do jego otoczenia.



================================================
File: .cursor/rules/diagram-journey.mdc
================================================
---
description: 
globs: 
alwaysApply: false
---
Jesteś specjalistą UX, którego zadaniem jest utworzenie diagramu Mermaid w celu wizualizacji podróży użytkownika dla modułu logowania i rejestracji. Diagram powinien zostać utworzony w następującym pliku: DESTINATION

Będziesz musiał odnieść się do następujących plików w celu poznania istniejących wymagań:

<file_references>
[project-prd.md](mdc:.ai/project-prd.md)
</file_references>

<destination>
.ai/diagrams/journey.md
</destination>

Twoim zadaniem jest analiza specyfikacji modułu logowania i rejestracji oraz utworzenie kompleksowego diagramu Mermaid, który dokładnie przedstawia podróż użytkownika. Diagram powinien być w języku polskim.

Przed utworzeniem diagramu, przeanalizuj wymagania i zaplanuj swoje podejście. Umieść swoją analizę wewnątrz tagów <user_journey_analysis>. W tej analizie:

1. Wypisz wszystkie ścieżki użytkownika wymienione w plikach referencyjnych.
2. Zidentyfikuj główne podróże i ich odpowiadające stany.
3. Określ punkty decyzyjne i alternatywne ścieżki.
4. Dostarcz krótki opis celu każdego stanu.

Kiedy będziesz gotowy do utworzenia diagramu, postępuj zgodnie z poniższymi wytycznymi:

1. Rozpocznij diagram od następującej składni:

   ```mermaid
   stateDiagram-v2
   ```

2. Uwzględnij następujące elementy w swoim diagramie:

   - Ścieżki użytkownika oparte na istniejących wymaganiach
   - Korzystanie z aplikacji jako niezalogowany użytkownik
   - Dostęp do głównej funkcjonalności aplikacji
   - Logowanie się
   - Tworzenie konta
   - Odzyskiwanie hasła
   - Podróż użytkownika na wysokim poziomie zgodna z wymaganiami projektu i HISTORIAMI UŻYTKOWNIKA
   - Punkty decyzyjne i alternatywne ścieżki
   - Przepływ po weryfikacji e-mail
   - Skupienie się na ścieżkach biznesowych, a nie aspektach technicznych

3. Przestrzegaj tych zasad składni Mermaid:

   - Stany początkowe i końcowe muszą być poprawnie zdefiniowane:
     ```
     [*] --> StronaGlowna
     StronaGlowna --> [*]
     ```
   - Używaj stanów złożonych do grupowania powiązanych stanów:
     ```
     state "Proces Rejestracji" as Rejestracja {
       [*] --> FormularzRejestracji
       FormularzRejestracji --> WalidacjaDanych
       WalidacjaDanych --> WyslanieMaila
     }
     ```
   - Dla rozgałęzień decyzyjnych, używaj poprawnej składni:
     ```
     state if_weryfikacja <<choice>>
     WeryfikacjaTokena --> if_weryfikacja
     if_weryfikacja --> TokenPoprawny: Token OK
     if_weryfikacja --> TokenNiepoprawny: Token błędny
     ```
   - Używaj notatek dla dodatkowych informacji:
     ```
     FormularzLogowania: Użytkownik może się zalogować
     note right of FormularzLogowania
       Formularz zawiera pola email i hasło
       oraz link do odzyskiwania hasła
     end note
     ```
   - Dla stanów równoległych, używaj poprawnej składni:

     ```
     state fork_state <<fork>>
     state join_state <<join>>

     Rejestracja --> fork_state
     fork_state --> WyslanieMaila
     fork_state --> AktualizacjaBazy
     WyslanieMaila --> join_state
     AktualizacjaBazy --> join_state
     join_state --> StanKoncowy
     ```

   - Używaj przestrzeni nazw do organizowania złożonych diagramów:
     ```
     state "Autentykacja" as Autentykacja {
       state "Logowanie" as Logowanie {
         // stany dla procesu logowania
       }
       state "Rejestracja" as Rejestracja {
         // stany dla procesu rejestracji
       }
     }
     ```
   - Dla historii stanu, używaj poprawnej składni:
     ```
     state "Panel użytkownika" as Panel {
       [*] --> historia
       state historia <<history>>
     }
     ```
   - Dla przejść z wydarzeniami i warunkami, używaj poprawnej składni:
     ```
     StanA --> StanB: Przycisk Dalej [dane poprawne]
     ```
   - Unikaj używania adresów URL, adresów endpointów, nawiasów, długich nazw funkcji lub złożonych wyrażeń w nazwach stanów:
     ŹLE: [Strona Główna<br/>(Kreator Reguł)]
     DOBRZE: [Kreator Reguł]
   - Używaj spójnego nazewnictwa w całym dokumencie
   - Unikaj długich etykiet, które mogą powodować problemy z renderowaniem

4. Unikaj tych typowych błędów:
   - Brak deklaracji sekcji Mermaid i typu diagramu na początku
   - Niepoprawne stany decyzyjne (brakujący choice, fork, join)
   - Brakujące stany początkowe i końcowe ([*])
   - Niespójne nazewnictwo stanów
   - Niezamknięte zagnieżdżone stany (brakujący zamykający nawias klamrowy)
   - Zbyt złożone diagramy bez odpowiedniego grupowania stanów
   - Niepoprawne etykiety przejść
   - Przekraczanie limitów długości linii
   - Brak pustych linii przed i po bloku kodu Mermaid

Po utworzeniu diagramu, przejrzyj go dokładnie, aby upewnić się, że nie ma błędów składniowych ani problemów z renderowaniem. Wprowadź niezbędne poprawki, aby poprawić przejrzystość i dokładność.

Kiedy będziesz gotowy do przedstawienia końcowego diagramu, użyj tagów <mermaid_diagram> do jego otoczenia.



================================================
File: .cursor/rules/diagram-ui.mdc
================================================
---
description: 
globs: 
alwaysApply: false
---
Jesteś doświadczonym architektem oprogramowania, którego zadaniem jest utworzenie diagramu Mermaid w celu wizualizacji architektury stron Astro i komponentów React dla modułu logowania i rejestracji. Diagram powinien zostać utworzony w następującym pliku: DESTINATION

Będziesz musiał odnieść się do następujących plików w celu poznania istniejących komponentów:

<file_references>
[project-prd.md](mdc:.ai/project-prd.md)
</file_references>

<destination>
.ai/diagrams/ui.md
</destination>

Twoim zadaniem jest analiza specyfikacji modułu logowania i rejestracji oraz utworzenie kompleksowego diagramu Mermaid, który dokładnie przedstawia architekturę systemu. Diagram powinien być w języku polskim.

Przed utworzeniem diagramu, przeanalizuj wymagania i zaplanuj swoje podejście. Umieść swoją analizę wewnątrz tagów <architecture_analysis>. W tej analizie:

1. Wypisz wszystkie komponenty wymienione w plikach referencyjnych.
2. Zidentyfikuj główne strony i ich odpowiadające komponenty.
3. Określ przepływ danych między komponentami.
4. Dostarcz krótki opis funkcjonalności każdego komponentu.

Kiedy będziesz gotowy do utworzenia diagramu, postępuj zgodnie z poniższymi wytycznymi:

1. Rozpocznij diagram od następującej składni:

   ```mermaid
   flowchart TD
   ```

2. Uwzględnij następujące elementy w swoim diagramie:

   - Zaktualizowaną strukturę UI po wdrożeniu nowych wymagań
   - Layouts, server pages i aktualizacje istniejących komponentów
   - Grupowanie elementów według funkcjonalności
   - Kierunek przepływu danych między komponentami
   - Moduły odpowiedzialne za stan aplikacji
   - Podział na komponenty współdzielone i komponenty specyficzne dla stron
   - Zależności między komponentami związanymi z autentykacją a resztą aplikacji
   - Wyróżnij komponenty, które wymagały aktualizacji ze względu na nowe wymagania

3. Przestrzegaj tych zasad składni Mermaid:

   - Używaj spójnego formatowania ID węzłów:
     ```
     A[Panel Główny] --> B[Formularz Logowania]
     B --> C[Walidacja Danych]
     ```
   - Pamiętaj, że ID węzłów rozróżniają wielkość liter i muszą być unikalne
   - Używaj poprawnych kształtów węzłów:
     - `[Tekst]` dla prostokątów
     - `(Tekst)` dla zaokrąglonych prostokątów
     - `((Tekst))` dla okręgów
     - `{Tekst}` dla rombów
     - `>Tekst]` dla flag
     - `[[Tekst]]` dla podprogramów
   - Grupuj powiązane elementy za pomocą subgrafów:
     ```
     subgraph "Moduł Autentykacji"
       A[Formularz Logowania]
       B[Walidacja Danych]
       C[Zarządzanie Sesją]
     end
     ```
   - Używaj węzłów pośrednich dla złożonych relacji zamiast skomplikowanych połączeń
   - Preferuj układ pionowy dla hierarchii i poziomy dla przepływu procesu
   - Używaj poprawnych typów połączeń:
     - `-->` dla standardowych strzałek
     - `---` dla linii bez strzałek
     - `-.->` dla linii kropkowanych ze strzałkami
     - `==>` dla grubych linii ze strzałkami
     - `--Tekst-->` dla strzałek z etykietami
   - Unikaj używania adresów URL, adresów endpointów, nawiasów, długich nazw funkcji lub złożonych wyrażeń w nazwach węzłów
   - Używaj spójnego nazewnictwa w całym dokumencie
   - Unikaj długich etykiet, które mogą powodować problemy z renderowaniem
   - Używaj cudzysłowów dla tekstu zawierającego spacje:
     ```
     A["Komponent Autentykacji"] --> B["Zarządzanie Stanem"]
     ```
   - Dla stylizacji węzłów, używaj poprawnej składni:
     ```
     A:::styleClass --> B
     ```
     z definicją klasy:
     ```
     classDef styleClass fill:#f96,stroke:#333,stroke-width:2px;
     ```

4. Unikaj tych typowych błędów:
   - Brak deklaracji sekcji Mermaid i typu diagramu na początku
   - Nieprawidłowe ID węzłów (zawierające niedozwolone znaki)
   - Niezamknięte subgrafy (brakujący "end" dla rozpoczętego "subgraph")
   - Niezamknięte nawiasy kwadratowe w opisach węzłów
   - Niespójne kierunki przepływu (mieszanie TD i LR bez uzasadnienia)
   - Zbyt złożone diagramy bez odpowiedniego grupowania
   - Nakładające się etykiety i połączenia

Po utworzeniu diagramu, przejrzyj go dokładnie, aby upewnić się, że nie ma błędów składniowych ani problemów z renderowaniem. Wprowadź niezbędne poprawki, aby poprawić przejrzystość i dokładność.

Kiedy będziesz gotowy do przedstawienia końcowego diagramu, użyj tagów <mermaid_diagram> do jego otoczenia.



================================================
File: .cursor/rules/frontend.mdc
================================================
---
description: 
globs: *.tsx,*.astro
alwaysApply: false
---
## Frontend

### General Guidelines

- Use Astro components (.astro) for static content and layout
- Implement framework components in React only when interactivity is needed

### Guidelines for Styling

#### Tailwind

- Use the @layer directive to organize styles into components, utilities, and base layers
- Use arbitrary values with square brackets (e.g., w-[123px]) for precise one-off designs
- Implement the Tailwind configuration file for customizing theme, plugins, and variants
- Leverage the theme() function in CSS for accessing Tailwind theme values
- Implement dark mode with the dark: variant
- Use responsive variants (sm:, md:, lg:, etc.) for adaptive designs
- Leverage state variants (hover:, focus-visible:, active:, etc.) for interactive elements

### Guidelines for Accessibility

#### ARIA Best Practices

- Use ARIA landmarks to identify regions of the page (main, navigation, search, etc.)
- Apply appropriate ARIA roles to custom interface elements that lack semantic HTML equivalents
- Set aria-expanded and aria-controls for expandable content like accordions and dropdowns
- Use aria-live regions with appropriate politeness settings for dynamic content updates
- Implement aria-hidden to hide decorative or duplicative content from screen readers
- Apply aria-label or aria-labelledby for elements without visible text labels
- Use aria-describedby to associate descriptive text with form inputs or complex elements
- Implement aria-current for indicating the current item in a set, navigation, or process
- Avoid redundant ARIA that duplicates the semantics of native HTML elements


================================================
File: .cursor/rules/react.mdc
================================================
---
description: 
globs: *.tsx
alwaysApply: false
---
### Guidelines for React

- Use functional components with hooks instead of class components
- Never use "use client" and other Next.js directives as we use React with Astro
- Extract logic into custom hooks in `src/components/hooks`
- Implement React.memo() for expensive components that render often with the same props
- Utilize React.lazy() and Suspense for code-splitting and performance optimization
- Use the useCallback hook for event handlers passed to child components to prevent unnecessary re-renders
- Prefer useMemo for expensive calculations to avoid recomputation on every render
- Implement useId() for generating unique IDs for accessibility attributes
- Consider using the new useOptimistic hook for optimistic UI updates in forms
- Use useTransition for non-urgent state updates to keep the UI responsive


================================================
File: .cursor/rules/shared.mdc
================================================
---
description: 
globs: 
alwaysApply: true
---
# AI Rules for ShopListeo

{project-description}

## Tech Stack

- Astro 5
- TypeScript 5
- React 19
- Tailwind 4
- Shadcn/ui

## Project Structure

When introducing changes to the project, always follow the directory structure below:

- `./src` - source code
- `./src/layouts` - Astro layouts
- `./src/pages` - Astro pages
- `./src/pages/api` - API endpoints
- `./src/middleware/index.ts` - Astro middleware
- `./src/db` - Supabase clients and types
- `./src/types.ts` - Shared types for backend and frontend (Entities, DTOs)
- `./src/components` - Client-side components written in Astro (static) and React (dynamic)
- `./src/components/ui` - Client-side components from Shadcn/ui
- `./src/lib` - Services and helpers 
- `./src/assets` - static internal assets
- `./public` - public assets

When modifying the directory structure, always update this section.

## Coding practices

### Guidelines for clean code

- Use feedback from linters to improve the code when making changes.
- Prioritize error handling and edge cases.
- Handle errors and edge cases at the beginning of functions.
- Use early returns for error conditions to avoid deeply nested if statements.
- Place the happy path last in the function for improved readability.
- Avoid unnecessary else statements; use if-return pattern instead.
- Use guard clauses to handle preconditions and invalid states early.
- Implement proper error logging and user-friendly error messages.
- Consider using custom error types or error factories for consistent error handling.
- I am new at programming. Make comments with details to let me better understand the code.
- Write comments in polish language.



================================================
File: .cursor/rules/supabase-auth.mdc
================================================
---
description: 
globs: 
alwaysApply: false
---
---
description:
globs:
alwaysApply: false
---
# Supabase Auth Integration with Astro

Use this guide to introduce authentication (sign-up & sign-in) in Astro applications with server-side rendering (SSR) support

## Before we start

VERY IMPORTANT: Ask me which pages or components should behave differently after introducing authentication. Adjust further steps accordingly.

## Core Requirements

1. Use `@supabase/ssr` package (NOT auth-helpers)
2. Use ONLY `getAll` and `setAll` for cookie management
3. NEVER use individual `get`, `set`, or `remove` cookie methods
4. Implement proper session management with middleware based on JWT (Supabase Auth)

## Installation

```bash
npm install @supabase/ssr @supabase/supabase-js
```

## Environment Variables

Create `.env` file with required Supabase credentials (based on the snippet below or `.env.example` in project root)

```env
SUPABASE_URL=your_project_url
SUPABASE_KEY=your_anon_key
```

For better TypeScript support, create or update `src/env.d.ts`:

```typescript
/// <reference types="astro/client" />
interface ImportMetaEnv {
  readonly SUPABASE_URL: string;
  readonly SUPABASE_KEY: string;
}

interface ImportMeta {
  readonly env: ImportMetaEnv;
}
```
When introducing new env variables or values stored on Astro.locals, always update `src/env.d.ts` to reflect these changes.

Make sure `.env.example` is updated with the correct environment variables.

## Implementation Steps

### 1. Create OR Extend Supabase Server Instance

Update existing Supabase client or create one in `src/db/supabase.client.ts`:

```typescript
import type { AstroCookies } from 'astro';
import { createServerClient, type CookieOptionsWithName } from '@supabase/ssr';
import type { Database } from '../db/database.types.ts';

export const cookieOptions: CookieOptionsWithName = {
  path: '/',
  secure: true,
  httpOnly: true,
  sameSite: 'lax',
};

function parseCookieHeader(cookieHeader: string): { name: string; value: string }[] {
  return cookieHeader.split(';').map((cookie) => {
    const [name, ...rest] = cookie.trim().split('=');
    return { name, value: rest.join('=') };
  });
}

export const createSupabaseServerInstance = (context: {
  headers: Headers;
  cookies: AstroCookies;
}) => {
  const supabase = createServerClient<Database>(
    import.meta.env.SUPABASE_URL,
    import.meta.env.SUPABASE_KEY,
    {
      cookieOptions,
      cookies: {
        getAll() {
          return parseCookieHeader(context.headers.get('Cookie') ?? '');
        },
        setAll(cookiesToSet) {
          cookiesToSet.forEach(({ name, value, options }) =>
            context.cookies.set(name, value, options),
          );
        },
      },
    },
  );

  return supabase;
};
```

### 2. Implement OR Extend Authentication Middleware

Update existing auth middleware or create one in `src/middleware/index.ts`:

```typescript
import { createSupabaseServerInstance } from '../db/supabase.client.ts';
import { defineMiddleware } from 'astro:middleware';

// Public paths - Auth API endpoints & Server-Rendered Astro Pages
const PUBLIC_PATHS = [
  // Server-Rendered Astro Pages
  "/auth/login",
  "/auth/register",
  "/auth/reset-password",
  // Auth API endpoints
  "/api/auth/login",
  "/api/auth/register",
  "/api/auth/reset-password",
];

export const onRequest = defineMiddleware(
  async ({ locals, cookies, url, request, redirect }, next) => {
    // Skip auth check for public paths
    if (PUBLIC_PATHS.includes(url.pathname)) {
      return next();
    }

    const supabase = createSupabaseServerInstance({
      cookies,
      headers: request.headers,
    });

    // IMPORTANT: Always get user session first before any other operations
    const {
      data: { user },
    } = await supabase.auth.getUser();

    if (user) {
      locals.user = {
        email: user.email,
        id: user.id,
      };
    } else if (!PUBLIC_PATHS.includes(url.pathname)) {
      // Redirect to login for protected routes
      return redirect('/auth/login');
    }

    return next();
  },
);
```

### 3. Create Auth API Endpoints

Create the following endpoints in `src/pages/api/auth/`:

```typescript
// src/pages/api/auth/login.ts
import type { APIRoute } from 'astro';
import { createSupabaseServerInstance } from '../../db/supabase.client.ts';

export const POST: APIRoute = async ({ request, cookies }) => {
  const { email, password } = await request.json();

  const supabase = createSupabaseServerInstance({ cookies, headers: request.headers });

  const { data, error } = await supabase.auth.signInWithPassword({
    email,
    password,
  });

  if (error) {
    return new Response(JSON.stringify({ error: error.message }), {
      status: 400,
    });
  }

  return new Response(JSON.stringify({ user: data.user }), {
    status: 200,
  });
};

// src/pages/api/auth/register.ts
export const POST: APIRoute = async ({ request, cookies }) => {
  const { email, password } = await request.json();

  const supabase = createSupabaseServerInstance({ cookies, headers: request.headers });

  const { data, error } = await supabase.auth.signUp({
    email,
    password,
  });

  if (error) {
    return new Response(JSON.stringify({ error: error.message }), {
      status: 400,
    });
  }

  return new Response(JSON.stringify({ user: data.user }), {
    status: 200,
  });
};

// src/pages/api/auth/logout.ts
export const POST: APIRoute = async ({ cookies, request }) => {
  const supabase = createSupabaseServerInstance({ cookies, headers: request.headers });

  const { error } = await supabase.auth.signOut();

  if (error) {
    return new Response(JSON.stringify({ error: error.message }), {
      status: 400,
    });
  }

  return new Response(null, { status: 200 });
};
```

### 4. Protect Routes

In protected Astro pages:

```astro
---
// pages/protected.astro
const { user } = Astro.locals;

if (!user) {
  return Astro.redirect('/auth/login');
}
---

<h1>Protected Page</h1>
<p>Welcome {user.email}!</p>
```

### 5. Verify SSR Configuration

Verify whether auth pages are rendered server-side, either by `export const prerender = false;` or by `output: "server"` in `astro.config.mjs`.

## Security Best Practices

- Set proper cookie options (httpOnly, secure, sameSite)
- Never expose Supabase integration & keys in client-side components
- Validate all user input server-side
- Use proper error handling and logging

## Common Pitfalls

1. DO NOT use individual cookie methods (get/set/remove)
2. DO NOT import from @supabase/auth-helpers-nextjs
3. DO NOT skip the auth.getUser() call in middleware
4. DO NOT modify cookie handling logic
5. Always handle auth state changes properly



================================================
File: .cursor/rules/test-plan-rule.mdc
================================================
---
description: 
globs: 
alwaysApply: false
---
Jesteś doświadczonym inżynierem QA, którego zadaniem jest stworzenie kompleksowego planu testów dla projektu programistycznego. Przeanalizuj poniższe informacje o projekcie:

<stos_technologiczny>
[tech-stack.md](mdc:.ai/tech-stack.md)
</stos_technologiczny>

Twoim zadaniem jest wygenerowanie szczegółowego planu testów, który będzie dostosowany do specyfiki projektu, uwzględniając wykorzystywane technologie, strukturę kodu oraz kluczowe elementy repozytorium. Plan testów powinien być napisany w języku polskim.

Przed stworzeniem planu testów, przeprowadź dogłębną analizę projektu wewnątrz bloku <analiza_projektu> w swoim bloku myślowym. W analizie uwzględnij:

1. Kluczowe komponenty projektu wynikające z analizy kodu:
   - Wymień i opisz główne komponenty projektu
2. Specyfikę stosu technologicznego i jego wpływ na strategię testowania:
   - Przeanalizuj każdy element stosu technologicznego i jego implikacje dla testowania
3. Priorytety testowe bazujące na strukturze repozytorium:
   - Zidentyfikuj i uszereguj obszary testowe według ważności
4. Potencjalne obszary ryzyka wymagające szczególnej uwagi w testach:
   - Wymień potencjalne ryzyka i uzasadnij, dlaczego wymagają specjalnej uwagi

Po zakończeniu analizy, stwórz plan testów wewnątrz bloku <plan_testów>. Plan powinien zawierać:

1. Wprowadzenie i cele testowania
2. Zakres testów
3. Typy testów do przeprowadzenia (np. testy jednostkowe, integracyjne, wydajnościowe)
4. Scenariusze testowe dla kluczowych funkcjonalności
5. Środowisko testowe
6. Narzędzia do testowania
7. Harmonogram testów
8. Kryteria akceptacji testów
9. Role i odpowiedzialności w procesie testowania
10. Procedury raportowania błędów

Pamiętaj, aby plan testów był:
- Dokładnie dostosowany do kontekstu projektu
- Uwzględniał specyfikę wykorzystywanych technologii
- Priorytetyzował kluczowe elementy repozytorium
- Był napisany w języku polskim
- Prezentował wysoką jakość i profesjonalizm

Rozpocznij od analizy, a następnie przejdź do tworzenia planu testów. Twój końcowy wynik powinien składać się tylko z planu testów i nie powinien powielać ani streszczać żadnej pracy wykonanej w bloku analizy projektu.

Przedstaw ten plan w formacie Markdown i zapisz go do .ai/test-plan.mdc .


================================================
File: .cursor/rules/testing-e2e-playwright.mdc
================================================
---
description: 
globs: 
alwaysApply: false
---
## TESTING

### Guidelines for E2E

#### PLAYWRIGHT

- Initialize configuration only with Chromium/Desktop Chrome browser
- Use browser contexts for isolating test environments
- Implement the Page Object Model for maintainable tests
- Use locators for resilient element selection
- Leverage API testing for backend validation
- Implement visual comparison with expect(page).toHaveScreenshot()
- Use the codegen tool for test recording
- Leverage trace viewer for debugging test failures
- Implement test hooks for setup and teardown
- Use expect assertions with specific matchers
- Leverage parallel execution for faster test runs




================================================
File: .cursor/rules/testing-unit-vitest.mdc
================================================
---
description: 
globs: 
alwaysApply: false
---
## TESTING

### Guidelines for UNIT

#### VITEST

- Leverage the `vi` object for test doubles - Use `vi.fn()` for function mocks, `vi.spyOn()` to monitor existing functions, and `vi.stubGlobal()` for global mocks. Prefer spies over mocks when you only need to verify interactions without changing behavior.
- Master `vi.mock()` factory patterns - Place mock factory functions at the top level of your test file, return typed mock implementations, and use `mockImplementation()` or `mockReturnValue()` for dynamic control during tests. Remember the factory runs before imports are processed.
- Create setup files for reusable configuration - Define global mocks, custom matchers, and environment setup in dedicated files referenced in your `vitest.config.ts`. This keeps your test files clean while ensuring consistent test environments.
- Use inline snapshots for readable assertions - Replace complex equality checks with `expect(value).toMatchInlineSnapshot()` to capture expected output directly in your test file, making changes more visible in code reviews.
- Monitor coverage with purpose and only when asked - Configure coverage thresholds in `vitest.config.ts` to ensure critical code paths are tested, but focus on meaningful tests rather than arbitrary coverage percentages.
- Make watch mode part of your workflow - Run `vitest --watch` during development for instant feedback as you modify code, filtering tests with `-t` to focus on specific areas under development.
- Explore UI mode for complex test suites - Use `vitest --ui` to visually navigate large test suites, inspect test results, and debug failures more efficiently during development.
- Handle optional dependencies with smart mocking - Use conditional mocking to test code with optional dependencies by implementing `vi.mock()` with the factory pattern for modules that might not be available in all environments.
- Configure jsdom for DOM testing - Set `environment: 'jsdom'` in your configuration for frontend component tests and combine with testing-library utilities for realistic user interaction simulation.
- Structure tests for maintainability - Group related tests with descriptive `describe` blocks, use explicit assertion messages, and follow the Arrange-Act-Assert pattern to make tests self-documenting.
- Leverage TypeScript type checking in tests - Enable strict typing in your tests to catch type errors early, use `expectTypeOf()` for type-level assertions, and ensure mocks preserve the original type signatures.




================================================
File: .cursor/rules/ui-shadcn-helper.mdc
================================================
---
description: 
globs: 
alwaysApply: false
---
# Shadcn UI Components

Ten projekt wykorzystuje @shadcn/ui dla komponentów interfejsu użytkownika. Są to pięknie zaprojektowane, dostępne komponenty, które można dostosować do swojej aplikacji.

## Odszukiwanie zainstalowanych komponentów

Komponenty są dostępne w folderze `src/components/ui`, zgodnie z aliasami z pliku `components.json`

## Wykorzystanie komponentu

Zaimportuj komponent zgodnie ze skonfigurowanym aliasem `@/`

```tsx
import { Button } from "@/components/ui/button"
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs"
import { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from "@/components/ui/card"
```

Przykładowe wykorzsytanie komponnetów:

```tsx
<Button variant="outline">Click me</Button>

<Card>
  <CardHeader>
    <CardTitle>Card Title</CardTitle>
    <CardDescription>Card Description</CardDescription>
  </CardHeader>
  <CardContent>
    <p>Card Content</p>
  </CardContent>
  <CardFooter>
    <p>Card Footer</p>
  </CardFooter>
</Card>
```

## Instalowanie dodatkowych komponentów

Wiele innych komponentów jest dostępnych, ale nie są one obecnie zainstalowane. Pełną listę można znaleźć na stronie https://ui.shadcn.com/r

Aby zainstalować nowy komponent, wykorzystaj shadcn CLI


```bash
npx shadcn@latest add [component-name]
```

Przykładowo, aby dodać komponent accordion

```bash
npx shadcn@latest add accordion
```

Ważne: `npx shadcn-ui@latest` zostało wycofane, korzystaj z `npx shadcn@latest`

Niektóre popularne komponenty to:

- Accordion
- Alert
- AlertDialog
- AspectRatio
- Avatar
- Calendar
- Checkbox
- Collapsible
- Command
- ContextMenu
- DataTable
- DatePicker
- Dropdown Menu
- Form
- Hover Card
- Menubar
- Navigation Menu
- Popover
- Progress
- Radio Group
- ScrollArea
- Select
- Separator
- Sheet
- Skeleton
- Slider
- Switch
- Table
- Textarea
- Sonner (previously Toast)
- Toggle
- Tooltip

## Component Styling

Ten projekt wykorzystuje wariant stylu „new-york” z kolorem bazowym "neutral" i zmiennymi CSS do tworzenia motywów, zgodnie z konfiguracją w sekcji `components.json`.


================================================
File: .github/copilot-instructions.md
================================================
# AI Rules for {{project-name}}

{{project-description}}

## Tech Stack

- Astro 5
- TypeScript 5
- React 19
- Tailwind 4
- Shadcn/ui

## Project Structure

When introducing changes to the project, always follow the directory structure below:

- `./src` - source code
- `./src/layouts` - Astro layouts
- `./src/pages` - Astro pages
- `./src/pages/api` - API endpoints
- `./src/middleware/index.ts` - Astro middleware
- `./src/db` - Supabase clients and types
- `./src/types.ts` - Shared types for backend and frontend (Entities, DTOs)
- `./src/components` - Client-side components written in Astro (static) and React (dynamic)
- `./src/components/ui` - Client-side components from Shadcn/ui
- `./src/lib` - Services and helpers
- `./src/assets` - static internal assets
- `./public` - public assets

When modifying the directory structure, always update this section.

## Coding practices

### Guidelines for clean code

- Use feedback from linters to improve the code when making changes.
- Prioritize error handling and edge cases.
- Handle errors and edge cases at the beginning of functions.
- Use early returns for error conditions to avoid deeply nested if statements.
- Place the happy path last in the function for improved readability.
- Avoid unnecessary else statements; use if-return pattern instead.
- Use guard clauses to handle preconditions and invalid states early.
- Implement proper error logging and user-friendly error messages.
- Consider using custom error types or error factories for consistent error handling.

## Frontend

### General Guidelines

- Use Astro components (.astro) for static content and layout
- Implement framework components in React only when interactivity is needed

### Guidelines for Styling

#### Tailwind

- Use the @layer directive to organize styles into components, utilities, and base layers
- Use arbitrary values with square brackets (e.g., w-[123px]) for precise one-off designs
- Implement the Tailwind configuration file for customizing theme, plugins, and variants
- Leverage the theme() function in CSS for accessing Tailwind theme values
- Implement dark mode with the dark: variant
- Use responsive variants (sm:, md:, lg:, etc.) for adaptive designs
- Leverage state variants (hover:, focus-visible:, active:, etc.) for interactive elements

### Guidelines for Accessibility

#### ARIA Best Practices

- Use ARIA landmarks to identify regions of the page (main, navigation, search, etc.)
- Apply appropriate ARIA roles to custom interface elements that lack semantic HTML equivalents
- Set aria-expanded and aria-controls for expandable content like accordions and dropdowns
- Use aria-live regions with appropriate politeness settings for dynamic content updates
- Implement aria-hidden to hide decorative or duplicative content from screen readers
- Apply aria-label or aria-labelledby for elements without visible text labels
- Use aria-describedby to associate descriptive text with form inputs or complex elements
- Implement aria-current for indicating the current item in a set, navigation, or process
- Avoid redundant ARIA that duplicates the semantics of native HTML elements

### Guidelines for Astro

- Leverage View Transitions API for smooth page transitions (use ClientRouter)
- Use content collections with type safety for blog posts, documentation, etc.
- Leverage Server Endpoints for API routes
- Use POST, GET  - uppercase format for endpoint handlers
- Use `export const prerender = false` for API routes
- Use zod for input validation in API routes
- Extract logic into services in `src/lib/services`
- Implement middleware for request/response modification
- Use image optimization with the Astro Image integration
- Implement hybrid rendering with server-side rendering where needed
- Use Astro.cookies for server-side cookie management
- Leverage import.meta.env for environment variables

### Guidelines for React

- Use functional components with hooks instead of class components
- Never use "use client" and other Next.js directives as we use React with Astro
- Extract logic into custom hooks in `src/components/hooks`
- Implement React.memo() for expensive components that render often with the same props
- Utilize React.lazy() and Suspense for code-splitting and performance optimization
- Use the useCallback hook for event handlers passed to child components to prevent unnecessary re-renders
- Prefer useMemo for expensive calculations to avoid recomputation on every render
- Implement useId() for generating unique IDs for accessibility attributes
- Consider using the new useOptimistic hook for optimistic UI updates in forms
- Use useTransition for non-urgent state updates to keep the UI responsive

### Backend and Database

- Use Supabase for backend services, including authentication and database interactions.
- Follow Supabase guidelines for security and performance.
- Use Zod schemas to validate data exchanged with the backend.
- Use supabase from context.locals in Astro routes instead of importing supabaseClient directly
- Use SupabaseClient type from `src/db/supabase.client.ts`, not from `@supabase/supabase-js`


================================================
File: .husky/pre-commit
================================================
npx lint-staged


